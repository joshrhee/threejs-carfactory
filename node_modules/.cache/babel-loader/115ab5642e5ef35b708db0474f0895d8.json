{"ast":null,"code":"/**\n * postprocessing v6.18.0 build Mon Nov 02 2020\n * https://github.com/vanruesc/postprocessing\n * Copyright 2020 Raoul van RÃ¼schen\n * @license Zlib\n */\nimport { ShaderMaterial, Uniform, Vector2 as Vector2$1, Vector4, PerspectiveCamera, Matrix4, Camera, Scene, Mesh, BufferGeometry, BufferAttribute, WebGLRenderTarget, LinearFilter, UnsignedByteType, RGBFormat, Color, MeshDepthMaterial, RGBADepthPacking, NearestFilter, FloatType, EventDispatcher, MeshNormalMaterial, WebGLMultisampleRenderTarget, DepthTexture, DepthStencilFormat, UnsignedInt248Type, UnsignedIntType, RGBAFormat, DataTexture, LuminanceFormat, RedFormat, RGFormat, RepeatWrapping, Vector3, MeshBasicMaterial, Texture, sRGBEncoding, LinearEncoding, Matrix3, LinearMipmapLinearFilter, LinearMipMapLinearFilter, Loader, LoadingManager } from 'three';\n/**\r\n * A color channel enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} RED - Red.\r\n * @property {Number} GREEN - Green.\r\n * @property {Number} BLUE - Blue.\r\n * @property {Number} ALPHA - Alpha.\r\n */\n\nconst ColorChannel = {\n  RED: 0,\n  GREEN: 1,\n  BLUE: 2,\n  ALPHA: 3\n};\n/**\r\n * The Disposable contract.\r\n *\r\n * Implemented by objects that can free internal resources.\r\n *\r\n * @interface\r\n */\n\nclass Disposable {\n  /**\r\n   * Frees internal resources.\r\n   */\n  dispose() {}\n\n}\n\nvar fragmentShader = \"uniform sampler2D previousLuminanceBuffer;uniform sampler2D currentLuminanceBuffer;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float previousLuminance=texture2D(previousLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;float currentLuminance=texture2D(currentLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;previousLuminance=max(minLuminance,previousLuminance);currentLuminance=max(minLuminance,currentLuminance);float adaptedLum=previousLuminance+(currentLuminance-previousLuminance)*(1.0-exp(-deltaTime*tau));gl_FragColor.r=adaptedLum;}\";\nvar vertexShader = \"varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * An adaptive luminance shader material.\r\n */\n\nclass AdaptiveLuminanceMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new adaptive luminance material.\r\n   */\n  constructor() {\n    super({\n      type: \"AdaptiveLuminanceMaterial\",\n      defines: {\n        MIP_LEVEL_1X1: \"0.0\"\n      },\n      uniforms: {\n        previousLuminanceBuffer: new Uniform(null),\n        currentLuminanceBuffer: new Uniform(null),\n        minLuminance: new Uniform(0.01),\n        deltaTime: new Uniform(0.0),\n        tau: new Uniform(1.0)\n      },\n      fragmentShader,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n\n}\n\nvar fragmentShader$1 = \"uniform sampler2D inputBuffer;uniform sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;\\n#if PASS == 1\\nuniform vec4 kernel64[32];\\n#else\\nuniform vec4 kernel16[8];\\n#endif\\nvarying vec2 vUv;void main(){\\n#ifdef FOREGROUND\\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\\n#else\\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\\n#endif\\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\\n#ifdef FOREGROUND\\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\\n#else\\nvec2 step=texelSize*CoC;\\n#endif\\n#if PASS == 1\\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;\\n#else\\nvec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;\\n#endif\\n}}\";\n/**\r\n * A bokeh blur material.\r\n *\r\n * This material should be applied twice in a row, with `fill` mode enabled for\r\n * the second pass.\r\n *\r\n * Enabling the `foreground` option causes the shader to combine the near and\r\n * far CoC values around foreground objects.\r\n */\n\nclass BokehMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new bokeh material.\r\n   *\r\n   * @param {Boolean} [fill=false] - Enables or disables the bokeh highlight fill mode.\r\n   * @param {Boolean} [foreground=false] - Determines whether this material will be applied to foreground colors.\r\n   */\n  constructor(fill = false, foreground = false) {\n    super({\n      type: \"BokehMaterial\",\n      defines: {\n        PASS: fill ? \"2\" : \"1\"\n      },\n      uniforms: {\n        kernel64: new Uniform(null),\n        kernel16: new Uniform(null),\n        inputBuffer: new Uniform(null),\n        cocBuffer: new Uniform(null),\n        texelSize: new Uniform(new Vector2$1()),\n        scale: new Uniform(1.0)\n      },\n      fragmentShader: fragmentShader$1,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n\n    if (foreground) {\n      this.defines.FOREGROUND = \"1\";\n    }\n\n    this.generateKernel();\n  }\n  /**\r\n   * Generates the blur kernels.\r\n   *\r\n   * @private\r\n   */\n\n\n  generateKernel() {\n    const GOLDEN_ANGLE = 2.39996323;\n    const points64 = new Float32Array(128);\n    const points16 = new Float32Array(32);\n    let i64 = 0,\n        i16 = 0;\n\n    for (let i = 0; i < 80; ++i) {\n      const theta = i * GOLDEN_ANGLE;\n      const r = Math.sqrt(i) / Math.sqrt(80);\n      const u = r * Math.cos(theta),\n            v = r * Math.sin(theta);\n\n      if (i % 5 === 0) {\n        points16[i16++] = u;\n        points16[i16++] = v;\n      } else {\n        points64[i64++] = u;\n        points64[i64++] = v;\n      }\n    } // Pack points into vec4 instances to reduce the uniform count.\n\n\n    const kernel64 = [];\n    const kernel16 = [];\n\n    for (let i = 0; i < 128;) {\n      kernel64.push(new Vector4(points64[i++], points64[i++], points64[i++], points64[i++]));\n    }\n\n    for (let i = 0; i < 32;) {\n      kernel16.push(new Vector4(points16[i++], points16[i++], points16[i++], points16[i++]));\n    }\n\n    this.uniforms.kernel64.value = kernel64;\n    this.uniforms.kernel16.value = kernel16;\n  }\n  /**\r\n   * Sets the texel size.\r\n   *\r\n   * @param {Number} x - The texel width.\r\n   * @param {Number} y - The texel height.\r\n   */\n\n\n  setTexelSize(x, y) {\n    this.uniforms.texelSize.value.set(x, y);\n  }\n\n}\n\nvar fragmentShader$2 = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform float focusDistance;uniform float focalLength;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}void main(){float depth=readDepth(vUv);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focalLength,abs(signedDistance));gl_FragColor.rg=vec2(step(signedDistance,0.0)*magnitude,step(0.0,signedDistance)*magnitude);}\";\n/**\r\n * A CoC shader material.\r\n */\n\nclass CircleOfConfusionMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new CoC material.\r\n   *\r\n   * @param {Camera} camera - A camera.\r\n   */\n  constructor(camera) {\n    super({\n      type: \"CircleOfConfusionMaterial\",\n      defines: {\n        DEPTH_PACKING: \"0\"\n      },\n      uniforms: {\n        depthBuffer: new Uniform(null),\n        focusDistance: new Uniform(0.0),\n        focalLength: new Uniform(0.0),\n        cameraNear: new Uniform(0.3),\n        cameraFar: new Uniform(1000)\n      },\n      fragmentShader: fragmentShader$2,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.adoptCameraSettings(camera);\n  }\n  /**\r\n   * The current depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get depthPacking() {\n    return Number(this.defines.DEPTH_PACKING);\n  }\n  /**\r\n   * Sets the depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set depthPacking(value) {\n    this.defines.DEPTH_PACKING = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Adopts the settings of the given camera.\r\n   *\r\n   * @param {Camera} [camera=null] - A camera.\r\n   */\n\n\n  adoptCameraSettings(camera = null) {\n    if (camera !== null) {\n      this.uniforms.cameraNear.value = camera.near;\n      this.uniforms.cameraFar.value = camera.far;\n\n      if (camera instanceof PerspectiveCamera) {\n        this.defines.PERSPECTIVE_CAMERA = \"1\";\n      } else {\n        delete this.defines.PERSPECTIVE_CAMERA;\n      }\n\n      this.needsUpdate = true;\n    }\n  }\n\n}\n\nvar fragmentShader$3 = \"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\\n#if EDGE_DETECTION_MODE != 0\\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\\n#endif\\n#if EDGE_DETECTION_MODE == 1\\n#include <common>\\n#endif\\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nfloat readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\\n#elif PREDICATION_MODE == 2\\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\\n#endif\\n#if PREDICATION_MODE != 0\\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\\n#endif\\n#if EDGE_DETECTION_MODE != 0\\nuniform sampler2D inputBuffer;\\n#endif\\nvoid main(){\\n#if EDGE_DETECTION_MODE == 0\\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\\n#elif PREDICATION_MODE != 0\\nvec2 threshold=calculatePredicatedThreshold();\\n#else\\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\\n#endif\\n#if EDGE_DETECTION_MODE == 0\\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\\n#elif EDGE_DETECTION_MODE == 1\\nfloat l=linearToRelativeLuminance(texture2D(inputBuffer,vUv).rgb);float lLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv0).rgb);float lTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=linearToRelativeLuminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=linearToRelativeLuminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\\n#elif EDGE_DETECTION_MODE == 2\\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\\n#endif\\n}\";\nvar vertexShader$1 = \"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\\n#if EDGE_DETECTION_MODE != 0\\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\\n#endif\\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\\n#if EDGE_DETECTION_MODE != 0\\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\\n#endif\\ngl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * A material that detects edges in a color texture.\r\n *\r\n * @deprecated Use EdgeDetectionMaterial instead.\r\n */\n\nclass ColorEdgesMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new color edges material.\r\n   *\r\n   * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n   */\n  constructor(texelSize = new Vector2$1()) {\n    super({\n      type: \"ColorEdgesMaterial\",\n      defines: {\n        EDGE_DETECTION_MODE: \"2\",\n        LOCAL_CONTRAST_ADAPTATION_FACTOR: \"2.0\",\n        EDGE_THRESHOLD: \"0.1\"\n      },\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        texelSize: new Uniform(texelSize)\n      },\n      fragmentShader: fragmentShader$3,\n      vertexShader: vertexShader$1,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n  /**\r\n   * Sets the local contrast adaptation factor.\r\n   *\r\n   * If there is a neighbor edge that has _factor_ times bigger contrast than\r\n   * the current edge, the edge will be discarded.\r\n   *\r\n   * This allows to eliminate spurious crossing edges and is based on the fact\r\n   * that if there is too much contrast in a direction, the perceptual contrast\r\n   * in the other neighbors will be hidden.\r\n   *\r\n   * @param {Number} factor - The local contrast adaptation factor. Default is 2.0.\r\n   */\n\n\n  setLocalContrastAdaptationFactor(factor) {\n    this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR = factor.toFixed(\"2\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the edge detection sensitivity.\r\n   *\r\n   * A lower value results in more edges being detected at the expense of\r\n   * performance.\r\n   *\r\n   * 0.1 is a reasonable value, and allows to catch most visible edges.\r\n   * 0.05 is a rather overkill value, that allows to catch 'em all.\r\n   *\r\n   * If temporal supersampling is used, 0.2 could be a reasonable value, as low\r\n   * contrast edges are properly filtered by just 2x.\r\n   *\r\n   * @param {Number} threshold - The edge detection sensitivity. Range: [0.05, 0.5].\r\n   */\n\n\n  setEdgeDetectionThreshold(threshold) {\n    const t = Math.min(Math.max(threshold, 0.05), 0.5);\n    this.defines.EDGE_THRESHOLD = t.toFixed(\"2\");\n    this.needsUpdate = true;\n  }\n\n}\n\nvar fragmentShader$4 = \"#include <common>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\\n#include <dithering_fragment>\\n}\";\nvar vertexShader$2 = \"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;/*Packing multiple texture coordinates into one varying and using a swizzle toextract them in the fragment shader still causes a dependent texture read.*/varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * An optimised convolution shader material.\r\n *\r\n * This material supports dithering.\r\n *\r\n * Based on the GDC2003 Presentation by Masaki Kawase, Bunkasha Games:\r\n *  Frame Buffer Postprocessing Effects in DOUBLE-S.T.E.A.L (Wreckless)\r\n * and an article by Filip Strugar, Intel:\r\n *  An investigation of fast real-time GPU-based image blur algorithms\r\n *\r\n * Further modified according to Apple's\r\n * [Best Practices for Shaders](https://goo.gl/lmRoM5).\r\n *\r\n * @todo Remove dithering code from fragment shader.\r\n */\n\nclass ConvolutionMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new convolution material.\r\n   *\r\n   * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n   */\n  constructor(texelSize = new Vector2$1()) {\n    super({\n      type: \"ConvolutionMaterial\",\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        texelSize: new Uniform(new Vector2$1()),\n        halfTexelSize: new Uniform(new Vector2$1()),\n        kernel: new Uniform(0.0),\n        scale: new Uniform(1.0)\n      },\n      fragmentShader: fragmentShader$4,\n      vertexShader: vertexShader$2,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.setTexelSize(texelSize.x, texelSize.y);\n    /**\r\n     * The current kernel size.\r\n     *\r\n     * @type {KernelSize}\r\n     */\n\n    this.kernelSize = KernelSize.LARGE;\n  }\n  /**\r\n   * Returns the kernel.\r\n   *\r\n   * @return {Float32Array} The kernel.\r\n   */\n\n\n  getKernel() {\n    return kernelPresets[this.kernelSize];\n  }\n  /**\r\n   * Sets the texel size.\r\n   *\r\n   * @param {Number} x - The texel width.\r\n   * @param {Number} y - The texel height.\r\n   */\n\n\n  setTexelSize(x, y) {\n    this.uniforms.texelSize.value.set(x, y);\n    this.uniforms.halfTexelSize.value.set(x, y).multiplyScalar(0.5);\n  }\n\n}\n/**\r\n * The Kawase blur kernel presets.\r\n *\r\n * @type {Float32Array[]}\r\n * @private\r\n */\n\n\nconst kernelPresets = [new Float32Array([0.0, 0.0]), new Float32Array([0.0, 1.0, 1.0]), new Float32Array([0.0, 1.0, 1.0, 2.0]), new Float32Array([0.0, 1.0, 2.0, 2.0, 3.0]), new Float32Array([0.0, 1.0, 2.0, 3.0, 4.0, 4.0, 5.0]), new Float32Array([0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 7.0, 8.0, 9.0, 10.0])];\n/**\r\n * A kernel size enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} VERY_SMALL - A very small kernel that matches a 7x7 Gauss blur kernel.\r\n * @property {Number} SMALL - A small kernel that matches a 15x15 Gauss blur kernel.\r\n * @property {Number} MEDIUM - A medium sized kernel that matches a 23x23 Gauss blur kernel.\r\n * @property {Number} LARGE - A large kernel that matches a 35x35 Gauss blur kernel.\r\n * @property {Number} VERY_LARGE - A very large kernel that matches a 63x63 Gauss blur kernel.\r\n * @property {Number} HUGE - A huge kernel that matches a 127x127 Gauss blur kernel.\r\n */\n\nconst KernelSize = {\n  VERY_SMALL: 0,\n  SMALL: 1,\n  MEDIUM: 2,\n  LARGE: 3,\n  VERY_LARGE: 4,\n  HUGE: 5\n};\nvar fragmentShader$5 = \"uniform sampler2D inputBuffer;uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\\n#include <encodings_fragment>\\n}\";\n/**\r\n * A simple copy shader material.\r\n */\n\nclass CopyMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new copy material.\r\n   */\n  constructor() {\n    super({\n      type: \"CopyMaterial\",\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        opacity: new Uniform(1.0)\n      },\n      fragmentShader: fragmentShader$5,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n\n}\n\nvar fragmentShader$6 = \"#include <packing>\\n#include <clipping_planes_pars_fragment>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform float cameraNear;uniform float cameraFar;varying float vViewZ;varying vec4 vProjTexCoord;void main(){\\n#include <clipping_planes_fragment>\\nvec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);float fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\\n#else\\nfloat viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\\n#endif\\nfloat depthTest=(-vViewZ>-viewZ)? 1.0 : 0.0;gl_FragColor.rg=vec2(0.0,depthTest);}\";\nvar vertexShader$3 = \"#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying float vViewZ;varying vec4 vProjTexCoord;void main(){\\n#include <skinbase_vertex>\\n#include <begin_vertex>\\n#include <morphtarget_vertex>\\n#include <skinning_vertex>\\n#include <project_vertex>\\nvViewZ=mvPosition.z;vProjTexCoord=gl_Position;\\n#include <clipping_planes_vertex>\\n}\";\n/**\r\n * A depth comparison shader material.\r\n */\n\nclass DepthComparisonMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new depth comparison material.\r\n   *\r\n   * @param {Texture} [depthTexture=null] - A depth texture.\r\n   * @param {PerspectiveCamera} [camera] - A camera.\r\n   */\n  constructor(depthTexture = null, camera) {\n    super({\n      type: \"DepthComparisonMaterial\",\n      uniforms: {\n        depthBuffer: new Uniform(depthTexture),\n        cameraNear: new Uniform(0.3),\n        cameraFar: new Uniform(1000)\n      },\n      fragmentShader: fragmentShader$6,\n      vertexShader: vertexShader$3,\n      depthWrite: false,\n      depthTest: false,\n      morphTargets: true,\n      skinning: true\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.adoptCameraSettings(camera);\n  }\n  /**\r\n   * Adopts the settings of the given camera.\r\n   *\r\n   * @param {Camera} [camera=null] - A camera.\r\n   */\n\n\n  adoptCameraSettings(camera = null) {\n    if (camera !== null) {\n      this.uniforms.cameraNear.value = camera.near;\n      this.uniforms.cameraFar.value = camera.far;\n\n      if (camera instanceof PerspectiveCamera) {\n        this.defines.PERSPECTIVE_CAMERA = \"1\";\n      } else {\n        delete this.defines.PERSPECTIVE_CAMERA;\n      }\n    }\n  }\n\n}\n\nvar fragmentShader$7 = \"#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\n#ifdef DOWNSAMPLE_NORMALS\\nuniform sampler2D normalBuffer;\\n#endif\\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}/***Returns the index of the most representative depth in the 2x2 neighborhood.*/int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])/4.0;float distances[4]=float[](abs(c-samples[0]),abs(c-samples[1]),abs(c-samples[2]),abs(c-samples[3]));float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4]=float[](readDepth(vUv0),readDepth(vUv1),readDepth(vUv2),readDepth(vUv3));int index=findBestDepth(d);\\n#ifdef DOWNSAMPLE_NORMALS\\nvec2 uvs[4]=vec2[](vUv0,vUv1,vUv2,vUv3);vec3 n=texture2D(normalBuffer,uvs[index]).rgb;\\n#else\\nvec3 n=vec3(0.0);\\n#endif\\ngl_FragColor=vec4(n,d[index]);}\";\nvar vertexShader$4 = \"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * A depth downsampling shader material.\r\n *\r\n * Based on an article by Eleni Maria Stea:\r\n * https://eleni.mutantstargoat.com/hikiko/depth-aware-upsampling-6\r\n */\n\nclass DepthDownsamplingMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new depth downsampling material.\r\n   */\n  constructor() {\n    super({\n      type: \"DepthDownsamplingMaterial\",\n      defines: {\n        DEPTH_PACKING: \"0\"\n      },\n      uniforms: {\n        depthBuffer: new Uniform(null),\n        normalBuffer: new Uniform(null),\n        texelSize: new Uniform(new Vector2$1())\n      },\n      fragmentShader: fragmentShader$7,\n      vertexShader: vertexShader$4,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n  /**\r\n   * The depth packing of the source depth buffer.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get depthPacking() {\n    return Number(this.defines.DEPTH_PACKING);\n  }\n  /**\r\n   * Sets the depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set depthPacking(value) {\n    this.defines.DEPTH_PACKING = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the texel size.\r\n   *\r\n   * @param {Number} x - The texel width.\r\n   * @param {Number} y - The texel height.\r\n   */\n\n\n  setTexelSize(x, y) {\n    this.uniforms.texelSize.value.set(x, y);\n  }\n\n}\n\nvar fragmentShader$8 = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer0;uniform highp sampler2D depthBuffer1;\\n#else\\nuniform mediump sampler2D depthBuffer0;uniform mediump sampler2D depthBuffer1;\\n#endif\\nuniform sampler2D inputBuffer;varying vec2 vUv;void main(){\\n#if DEPTH_PACKING_0 == 3201\\nfloat d0=unpackRGBAToDepth(texture2D(depthBuffer0,vUv));\\n#else\\nfloat d0=texture2D(depthBuffer0,vUv).r;\\n#endif\\n#if DEPTH_PACKING_1 == 3201\\nfloat d1=unpackRGBAToDepth(texture2D(depthBuffer1,vUv));\\n#else\\nfloat d1=texture2D(depthBuffer1,vUv).r;\\n#endif\\nif(d0<d1){discard;}gl_FragColor=texture2D(inputBuffer,vUv);}\";\n/**\r\n * A depth mask shader material.\r\n *\r\n * This material masks a color buffer by comparing two depth textures.\r\n */\n\nclass DepthMaskMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new depth mask material.\r\n   */\n  constructor() {\n    super({\n      type: \"DepthMaskMaterial\",\n      defines: {\n        DEPTH_PACKING_0: \"0\",\n        DEPTH_PACKING_1: \"0\"\n      },\n      uniforms: {\n        depthBuffer0: new Uniform(null),\n        depthBuffer1: new Uniform(null),\n        inputBuffer: new Uniform(null)\n      },\n      fragmentShader: fragmentShader$8,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n\n}\n/**\r\n * An edge detection material.\r\n *\r\n * Mainly used for Subpixel Morphological Antialiasing.\r\n */\n\n\nclass EdgeDetectionMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new edge detection material.\r\n   *\r\n   * @param {Vector2} [texelSize] - The screen texel size.\r\n   * @param {EdgeDetectionMode} [mode=EdgeDetectionMode.COLOR] - The edge detection mode.\r\n   * @todo Remove texelSize parameter.\r\n   */\n  constructor(texelSize = new Vector2$1(), mode = EdgeDetectionMode.COLOR) {\n    super({\n      type: \"EdgeDetectionMaterial\",\n      defines: {\n        LOCAL_CONTRAST_ADAPTATION_FACTOR: \"2.0\",\n        EDGE_THRESHOLD: \"0.1\",\n        DEPTH_THRESHOLD: \"0.01\",\n        PREDICATION_MODE: \"0\",\n        PREDICATION_THRESHOLD: \"0.01\",\n        PREDICATION_SCALE: \"2.0\",\n        PREDICATION_STRENGTH: \"1.0\",\n        DEPTH_PACKING: \"0\"\n      },\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        depthBuffer: new Uniform(null),\n        predicationBuffer: new Uniform(null),\n        texelSize: new Uniform(texelSize)\n      },\n      fragmentShader: fragmentShader$3,\n      vertexShader: vertexShader$1,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.setEdgeDetectionMode(mode);\n  }\n  /**\r\n   * The current depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get depthPacking() {\n    return Number(this.defines.DEPTH_PACKING);\n  }\n  /**\r\n   * Sets the depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set depthPacking(value) {\n    this.defines.DEPTH_PACKING = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the edge detection mode.\r\n   *\r\n   * @param {EdgeDetectionMode} mode - The edge detection mode.\r\n   */\n\n\n  setEdgeDetectionMode(mode) {\n    this.defines.EDGE_DETECTION_MODE = mode.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the local contrast adaptation factor. Has no effect if the edge\r\n   * detection mode is set to DEPTH.\r\n   *\r\n   * If there is a neighbor edge that has _factor_ times bigger contrast than\r\n   * the current edge, the edge will be discarded.\r\n   *\r\n   * This allows to eliminate spurious crossing edges and is based on the fact\r\n   * that if there is too much contrast in a direction, the perceptual contrast\r\n   * in the other neighbors will be hidden.\r\n   *\r\n   * @param {Number} factor - The local contrast adaptation factor. Default is 2.0.\r\n   */\n\n\n  setLocalContrastAdaptationFactor(factor) {\n    this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR = factor.toFixed(\"6\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the edge detection sensitivity.\r\n   *\r\n   * A lower value results in more edges being detected at the expense of\r\n   * performance.\r\n   *\r\n   * For luma- and chroma-based edge detection, 0.1 is a reasonable value and\r\n   * allows to catch most visible edges. 0.05 is a rather overkill value that\r\n   * allows to catch 'em all. Darker scenes may require an even lower threshold.\r\n   *\r\n   * If depth-based edge detection is used, the threshold will depend on the\r\n   * scene depth.\r\n   *\r\n   * @param {Number} threshold - The edge detection sensitivity. Range: [0.0, 0.5].\r\n   */\n\n\n  setEdgeDetectionThreshold(threshold) {\n    this.defines.EDGE_THRESHOLD = threshold.toFixed(\"6\");\n    this.defines.DEPTH_THRESHOLD = (threshold * 0.1).toFixed(\"6\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the predication mode.\r\n   *\r\n   * Predicated thresholding allows to better preserve texture details and to\r\n   * improve edge detection using an additional buffer such as a light\r\n   * accumulation or depth buffer.\r\n   *\r\n   * @param {PredicationMode} mode - The predication mode.\r\n   */\n\n\n  setPredicationMode(mode) {\n    this.defines.PREDICATION_MODE = mode.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets a custom predication buffer.\r\n   *\r\n   * @param {Texture} predicationBuffer - The predication buffer.\r\n   */\n\n\n  setPredicationBuffer(predicationBuffer) {\n    this.uniforms.predicationBuffer.value = predicationBuffer;\n  }\n  /**\r\n   * Sets the predication threshold.\r\n   *\r\n   * @param {Number} threshold - The threshold.\r\n   */\n\n\n  setPredicationThreshold(threshold) {\n    this.defines.PREDICATION_THRESHOLD = threshold.toFixed(\"6\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the predication scale.\r\n   *\r\n   * Determines how much the edge detection threshold should be scaled when\r\n   * using predication.\r\n   *\r\n   * @param {Number} scale - The scale. Range: [1.0, 5.0].\r\n   */\n\n\n  setPredicationScale(scale) {\n    this.defines.PREDICATION_SCALE = scale.toFixed(\"6\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the predication strength.\r\n   *\r\n   * Determines how much the edge detection threshold should be decreased\r\n   * locally when using predication.\r\n   *\r\n   * @param {Number} strength - The strength. Range: [0.0, 1.0].\r\n   */\n\n\n  setPredicationStrength(strength) {\n    this.defines.PREDICATION_STRENGTH = strength.toFixed(\"6\");\n    this.needsUpdate = true;\n  }\n\n}\n/**\r\n * An enumeration of edge detection modes.\r\n *\r\n * @type {Object}\r\n * @property {Number} DEPTH - Depth-based edge detection.\r\n * @property {Number} LUMA - Luminance-based edge detection.\r\n * @property {Number} COLOR - Chroma-based edge detection.\r\n */\n\n\nconst EdgeDetectionMode = {\n  DEPTH: 0,\n  LUMA: 1,\n  COLOR: 2\n};\n/**\r\n * An enumeration of predication modes.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISABLED - No predicated thresholding.\r\n * @property {Number} DEPTH - Depth-based predicated thresholding.\r\n * @property {Number} CUSTOM - Predicated thresholding using a custom buffer.\r\n */\n\nconst PredicationMode = {\n  DISABLED: 0,\n  DEPTH: 1,\n  CUSTOM: 2\n};\nvar fragmentTemplate = \"#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}float getViewZ(const in float depth){\\n#ifdef PERSPECTIVE_CAMERA\\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\\n#else\\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\\n#endif\\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\\n#ifdef ENCODE_OUTPUT\\n#include <encodings_fragment>\\n#endif\\n#include <dithering_fragment>\\n}\";\nvar vertexTemplate = \"uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * An effect material for compound shaders.\r\n *\r\n * This material supports dithering.\r\n *\r\n * @implements {Resizable}\r\n */\n\nclass EffectMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new effect material.\r\n   *\r\n   * @param {Map<String, String>} [shaderParts=null] - A collection of shader snippets. See {@link Section}.\r\n   * @param {Map<String, String>} [defines=null] - A collection of preprocessor macro definitions.\r\n   * @param {Map<String, Uniform>} [uniforms=null] - A collection of uniforms.\r\n   * @param {Camera} [camera] - A camera.\r\n   * @param {Boolean} [dithering=false] - Whether dithering should be enabled.\r\n   */\n  constructor(shaderParts = null, defines = null, uniforms = null, camera, dithering = false) {\n    super({\n      type: \"EffectMaterial\",\n      defines: {\n        DEPTH_PACKING: \"0\",\n        ENCODE_OUTPUT: \"1\"\n      },\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        depthBuffer: new Uniform(null),\n        resolution: new Uniform(new Vector2$1()),\n        texelSize: new Uniform(new Vector2$1()),\n        cameraNear: new Uniform(0.3),\n        cameraFar: new Uniform(1000.0),\n        aspect: new Uniform(1.0),\n        time: new Uniform(0.0)\n      },\n      depthWrite: false,\n      depthTest: false,\n      dithering\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n\n    if (shaderParts !== null) {\n      this.setShaderParts(shaderParts);\n    }\n\n    if (defines !== null) {\n      this.setDefines(defines);\n    }\n\n    if (uniforms !== null) {\n      this.setUniforms(uniforms);\n    }\n\n    this.adoptCameraSettings(camera);\n  }\n  /**\r\n   * The current depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get depthPacking() {\n    return Number(this.defines.DEPTH_PACKING);\n  }\n  /**\r\n   * Sets the depth packing.\r\n   *\r\n   * Use `BasicDepthPacking` or `RGBADepthPacking` if your depth texture\r\n   * contains packed depth.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set depthPacking(value) {\n    this.defines.DEPTH_PACKING = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the shader parts.\r\n   *\r\n   * @param {Map<String, String>} shaderParts - A collection of shader snippets. See {@link Section}.\r\n   * @return {EffectMaterial} This material.\r\n   */\n\n\n  setShaderParts(shaderParts) {\n    this.fragmentShader = fragmentTemplate.replace(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD)).replace(Section.FRAGMENT_MAIN_UV, shaderParts.get(Section.FRAGMENT_MAIN_UV)).replace(Section.FRAGMENT_MAIN_IMAGE, shaderParts.get(Section.FRAGMENT_MAIN_IMAGE));\n    this.vertexShader = vertexTemplate.replace(Section.VERTEX_HEAD, shaderParts.get(Section.VERTEX_HEAD)).replace(Section.VERTEX_MAIN_SUPPORT, shaderParts.get(Section.VERTEX_MAIN_SUPPORT));\n    this.needsUpdate = true;\n    return this;\n  }\n  /**\r\n   * Sets the shader macros.\r\n   *\r\n   * @param {Map<String, String>} defines - A collection of preprocessor macro definitions.\r\n   * @return {EffectMaterial} This material.\r\n   */\n\n\n  setDefines(defines) {\n    for (const entry of defines.entries()) {\n      this.defines[entry[0]] = entry[1];\n    }\n\n    this.needsUpdate = true;\n    return this;\n  }\n  /**\r\n   * Sets the shader uniforms.\r\n   *\r\n   * @param {Map<String, Uniform>} uniforms - A collection of uniforms.\r\n   * @return {EffectMaterial} This material.\r\n   */\n\n\n  setUniforms(uniforms) {\n    for (const entry of uniforms.entries()) {\n      this.uniforms[entry[0]] = entry[1];\n    }\n\n    return this;\n  }\n  /**\r\n   * Adopts the settings of the given camera.\r\n   *\r\n   * @param {Camera} [camera=null] - A camera.\r\n   */\n\n\n  adoptCameraSettings(camera = null) {\n    if (camera !== null) {\n      this.uniforms.cameraNear.value = camera.near;\n      this.uniforms.cameraFar.value = camera.far;\n\n      if (camera instanceof PerspectiveCamera) {\n        this.defines.PERSPECTIVE_CAMERA = \"1\";\n      } else {\n        delete this.defines.PERSPECTIVE_CAMERA;\n      }\n\n      this.needsUpdate = true;\n    }\n  }\n  /**\r\n   * Sets the resolution.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const w = Math.max(width, 1);\n    const h = Math.max(height, 1);\n    this.uniforms.resolution.value.set(w, h);\n    this.uniforms.texelSize.value.set(1.0 / w, 1.0 / h);\n    this.uniforms.aspect.value = w / h;\n  }\n\n}\n/**\r\n * An enumeration of shader code placeholders used by the {@link EffectPass}.\r\n *\r\n * @type {Object}\r\n * @property {String} FRAGMENT_HEAD - A placeholder for function and variable declarations inside the fragment shader.\r\n * @property {String} FRAGMENT_MAIN_UV - A placeholder for UV transformations inside the fragment shader.\r\n * @property {String} FRAGMENT_MAIN_IMAGE - A placeholder for color calculations inside the fragment shader.\r\n * @property {String} VERTEX_HEAD - A placeholder for function and variable declarations inside the vertex shader.\r\n * @property {String} VERTEX_MAIN_SUPPORT - A placeholder for supporting calculations inside the vertex shader.\r\n */\n\n\nconst Section = {\n  FRAGMENT_HEAD: \"FRAGMENT_HEAD\",\n  FRAGMENT_MAIN_UV: \"FRAGMENT_MAIN_UV\",\n  FRAGMENT_MAIN_IMAGE: \"FRAGMENT_MAIN_IMAGE\",\n  VERTEX_HEAD: \"VERTEX_HEAD\",\n  VERTEX_MAIN_SUPPORT: \"VERTEX_MAIN_SUPPORT\"\n};\nvar fragmentShader$9 = \"#include <common>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;uniform vec2 lightPosition;uniform float exposure;uniform float decay;uniform float density;uniform float weight;uniform float clampMax;varying vec2 vUv;void main(){vec2 coord=vUv;vec2 delta=lightPosition-coord;delta*=1.0/SAMPLES_FLOAT*density;float illuminationDecay=1.0;vec4 color=vec4(0.0);/*Estimate the probability of occlusion at each pixel by summing samplesalong a ray to the light position.*/for(int i=0;i<SAMPLES_INT;++i){coord+=delta;vec4 texel=texture2D(inputBuffer,coord);texel*=illuminationDecay*weight;color+=texel;illuminationDecay*=decay;}gl_FragColor=clamp(color*exposure,0.0,clampMax);\\n#include <dithering_fragment>\\n}\";\n/**\r\n * A crepuscular rays shader material.\r\n *\r\n * This material supports dithering.\r\n *\r\n * References:\r\n *\r\n * Thibaut Despoulain, 2012:\r\n *  [(WebGL) Volumetric Light Approximation in Three.js](\r\n *  http://bkcore.com/blog/3d/webgl-three-js-volumetric-light-godrays.html)\r\n *\r\n * Nvidia, GPU Gems 3, 2008:\r\n *  [Chapter 13. Volumetric Light Scattering as a Post-Process](\r\n *  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch13.html)\r\n *\r\n * @todo Remove dithering code from fragment shader.\r\n */\n\nclass GodRaysMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new god rays material.\r\n   *\r\n   * @param {Vector2} lightPosition - The light position in screen space.\r\n   */\n  constructor(lightPosition) {\n    super({\n      type: \"GodRaysMaterial\",\n      defines: {\n        SAMPLES_INT: \"60\",\n        SAMPLES_FLOAT: \"60.0\"\n      },\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        lightPosition: new Uniform(lightPosition),\n        density: new Uniform(1.0),\n        decay: new Uniform(1.0),\n        weight: new Uniform(1.0),\n        exposure: new Uniform(1.0),\n        clampMax: new Uniform(1.0)\n      },\n      fragmentShader: fragmentShader$9,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n  /**\r\n   * The amount of samples per pixel.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get samples() {\n    return Number(this.defines.SAMPLES_INT);\n  }\n  /**\r\n   * Sets the amount of samples per pixel.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set samples(value) {\n    const s = Math.floor(value);\n    this.defines.SAMPLES_INT = s.toFixed(0);\n    this.defines.SAMPLES_FLOAT = s.toFixed(1);\n    this.needsUpdate = true;\n  }\n\n}\n\nvar fragmentShader$a = \"#include <common>\\nuniform sampler2D inputBuffer;\\n#ifdef RANGE\\nuniform vec2 range;\\n#elif defined(THRESHOLD)\\nuniform float threshold;uniform float smoothing;\\n#endif\\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);\\n#ifdef RANGE\\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\\n#elif defined(THRESHOLD)\\nl=smoothstep(threshold,threshold+smoothing,l);\\n#endif\\n#ifdef COLOR\\ngl_FragColor=vec4(texel.rgb*l,l);\\n#else\\ngl_FragColor=vec4(l);\\n#endif\\n}\";\n/**\r\n * A luminance shader material.\r\n *\r\n * This shader produces a greyscale luminance map that describes the absolute\r\n * amount of light emitted by a scene. It can also be configured to output\r\n * colours that are scaled with their respective luminance value. Additionally,\r\n * a range may be provided to mask out undesired texels.\r\n *\r\n * The alpha channel always contains the luminance value.\r\n *\r\n * On luminance coefficients:\r\n *  http://www.poynton.com/notes/colour_and_gamma/ColorFAQ.html#RTFToC9\r\n *\r\n * Coefficients for different colour spaces:\r\n *  https://hsto.org/getpro/habr/post_images/2ab/69d/084/2ab69d084f9a597e032624bcd74d57a7.png\r\n *\r\n * Luminance range reference:\r\n *  https://cycling74.com/2007/05/23/your-first-shader/#.Vty9FfkrL4Z\r\n */\n\nclass LuminanceMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new luminance material.\r\n   *\r\n   * @param {Boolean} [colorOutput=false] - Defines whether the shader should output colors scaled with their luminance value.\r\n   * @param {Vector2} [luminanceRange] - If provided, the shader will mask out texels that aren't in the specified luminance range.\r\n   */\n  constructor(colorOutput = false, luminanceRange = null) {\n    const useRange = luminanceRange !== null;\n    super({\n      type: \"LuminanceMaterial\",\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        threshold: new Uniform(0.0),\n        smoothing: new Uniform(1.0),\n        range: new Uniform(useRange ? luminanceRange : new Vector2$1())\n      },\n      fragmentShader: fragmentShader$a,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.colorOutput = colorOutput;\n    this.useThreshold = true;\n    this.useRange = useRange;\n  }\n  /**\r\n   * The luminance threshold.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get threshold() {\n    return this.uniforms.threshold.value;\n  }\n  /**\r\n   * Sets the luminance threshold.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set threshold(value) {\n    this.uniforms.threshold.value = value;\n  }\n  /**\r\n   * The luminance threshold smoothing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get smoothing() {\n    return this.uniforms.smoothing.value;\n  }\n  /**\r\n   * Sets the luminance threshold smoothing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set smoothing(value) {\n    this.uniforms.smoothing.value = value;\n  }\n  /**\r\n   * Indicates whether the luminance threshold is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get useThreshold() {\n    return this.defines.THRESHOLD !== undefined;\n  }\n  /**\r\n   * Enables or disables the luminance threshold.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set useThreshold(value) {\n    if (value) {\n      this.defines.THRESHOLD = \"1\";\n    } else {\n      delete this.defines.THRESHOLD;\n    }\n\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether color output is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get colorOutput() {\n    return this.defines.COLOR !== undefined;\n  }\n  /**\r\n   * Enables or disables color output.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set colorOutput(value) {\n    if (value) {\n      this.defines.COLOR = \"1\";\n    } else {\n      delete this.defines.COLOR;\n    }\n\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Enables or disables color output.\r\n   *\r\n   * @deprecated Use colorOutput instead.\r\n   * @param {Boolean} enabled - Whether color output should be enabled.\r\n   */\n\n\n  setColorOutputEnabled(enabled) {\n    this.colorOutput = enabled;\n  }\n  /**\r\n   * Indicates whether luminance masking is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get useRange() {\n    return this.defines.RANGE !== undefined;\n  }\n  /**\r\n   * Enables or disables luminance masking.\r\n   *\r\n   * If enabled, the threshold will be ignored.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set useRange(value) {\n    if (value) {\n      this.defines.RANGE = \"1\";\n    } else {\n      delete this.defines.RANGE;\n    }\n\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether luminance masking is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Use useRange instead.\r\n   */\n\n\n  get luminanceRange() {\n    return this.useRange;\n  }\n  /**\r\n   * Enables or disables luminance masking.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Use useRange instead.\r\n   */\n\n\n  set luminanceRange(value) {\n    this.useRange = value;\n  }\n  /**\r\n   * Enables or disables the luminance mask.\r\n   *\r\n   * @deprecated Use luminanceRange instead.\r\n   * @param {Boolean} enabled - Whether the luminance mask should be enabled.\r\n   */\n\n\n  setLuminanceRangeEnabled(enabled) {\n    this.useRange = enabled;\n  }\n\n}\n\nvar fragmentShader$b = \"uniform sampler2D maskTexture;uniform sampler2D inputBuffer;\\n#if MASK_FUNCTION != 0\\nuniform float strength;\\n#endif\\nvarying vec2 vUv;void main(){\\n#if COLOR_CHANNEL == 0\\nfloat mask=texture2D(maskTexture,vUv).r;\\n#elif COLOR_CHANNEL == 1\\nfloat mask=texture2D(maskTexture,vUv).g;\\n#elif COLOR_CHANNEL == 2\\nfloat mask=texture2D(maskTexture,vUv).b;\\n#else\\nfloat mask=texture2D(maskTexture,vUv).a;\\n#endif\\n#if MASK_FUNCTION == 0\\n#ifdef INVERTED\\nif(mask>0.0){discard;}\\n#else\\nif(mask==0.0){discard;}\\n#endif\\n#else\\nmask=clamp(mask*strength,0.0,1.0);\\n#ifdef INVERTED\\nmask=(1.0-mask);\\n#endif\\n#if MASK_FUNCTION == 1\\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\\n#else\\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\\n#endif\\n#endif\\n}\";\n/**\r\n * A mask shader material.\r\n *\r\n * This material applies a mask texture to a buffer.\r\n */\n\nclass MaskMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new mask material.\r\n   *\r\n   * @param {Texture} [maskTexture] - The mask texture.\r\n   */\n  constructor(maskTexture = null) {\n    super({\n      type: \"MaskMaterial\",\n      uniforms: {\n        maskTexture: new Uniform(maskTexture),\n        inputBuffer: new Uniform(null),\n        strength: new Uniform(1.0)\n      },\n      fragmentShader: fragmentShader$b,\n      vertexShader,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.colorChannel = ColorChannel.RED;\n    this.maskFunction = MaskFunction.DISCARD;\n  }\n  /**\r\n   * Sets the mask texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  set maskTexture(value) {\n    this.uniforms.maskTexture.value = value;\n  }\n  /**\r\n   * Sets the color channel to use for masking.\r\n   *\r\n   * The default channel is `RED`.\r\n   *\r\n   * @type {ColorChannel}\r\n   */\n\n\n  set colorChannel(value) {\n    this.defines.COLOR_CHANNEL = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the masking technique.\r\n   *\r\n   * The default function is `DISCARD`.\r\n   *\r\n   * @type {MaskFunction}\r\n   */\n\n\n  set maskFunction(value) {\n    this.defines.MASK_FUNCTION = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether the masking is inverted.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get inverted() {\n    return this.defines.INVERTED !== undefined;\n  }\n  /**\r\n   * Determines whether the masking should be inverted.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set inverted(value) {\n    if (this.inverted && !value) {\n      delete this.defines.INVERTED;\n    } else if (value) {\n      this.defines.INVERTED = \"1\";\n    }\n\n    this.needsUpdate = true;\n  }\n  /**\r\n   * The current mask strength.\r\n   *\r\n   * Individual mask values will be clamped to [0.0, 1.0].\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get strength() {\n    return this.uniforms.strength.value;\n  }\n  /**\r\n   * Sets the strength of the mask.\r\n   *\r\n   * Has no effect when the mask function is set to `DISCARD`.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set strength(value) {\n    this.uniforms.strength.value = value;\n  }\n\n}\n/**\r\n * A mask function enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISCARD - Discards elements when the respective mask value is zero.\r\n * @property {Number} MULTIPLY - Multiplies the input buffer with the mask texture.\r\n * @property {Number} MULTIPLY_RGB_SET_ALPHA - Multiplies the input RGB values with the mask and sets alpha to the mask value.\r\n */\n\n\nconst MaskFunction = {\n  DISCARD: 0,\n  MULTIPLY: 1,\n  MULTIPLY_RGB_SET_ALPHA: 2\n};\nvar fragmentShader$c = \"uniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)? vec2(d,0.0): vec2(0.0,d);}\";\nvar vertexShader$5 = \"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * An outline shader material.\r\n */\n\nclass OutlineMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new outline material.\r\n   *\r\n   * @param {Vector2} [texelSize] - The screen texel size.\r\n   */\n  constructor(texelSize = new Vector2$1()) {\n    super({\n      type: \"OutlineMaterial\",\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        texelSize: new Uniform(new Vector2$1())\n      },\n      fragmentShader: fragmentShader$c,\n      vertexShader: vertexShader$5,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.setTexelSize(texelSize.x, texelSize.y); // @todo Added for backward compatibility.\n\n    this.uniforms.maskTexture = this.uniforms.inputBuffer;\n  }\n  /**\r\n   * Sets the texel size.\r\n   *\r\n   * @param {Number} x - The texel width.\r\n   * @param {Number} y - The texel height.\r\n   */\n\n\n  setTexelSize(x, y) {\n    this.uniforms.texelSize.value.set(x, y);\n  }\n\n}\n/**\r\n * An outline shader material.\r\n *\r\n * @deprecated Use OutlineMaterial instead.\r\n */\n\n\nconst OutlineEdgesMaterial = OutlineMaterial;\nvar fragmentShader$d = \"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\\n#if __VERSION__ < 300\\n#define round(v) floor(v + 0.5)\\n#endif\\nuniform sampler2D inputBuffer;uniform sampler2D areaTexture;uniform sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}/***Allows to decode two binary values from a bilinear-filtered access.**Bilinear access for fetching 'e' have a 0.25 offset,and we are interested*in the R and G edges:**+---G---+-------+*|x o R   x|*+-------+-------+**Then,if one of these edge is enabled:*Red:(0.75*X+0.25*1)=>0.25 or 1.0*Green:(0.75*1+0.25*X)=>0.75 or 1.0**This function will unpack the values(mad+mul+round):*wolframalpha.com: round(x*abs(5*x-5*0.75))plot 0 to 1*/vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}/***Diagonal pattern searches.*/vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}/***Calculates the area corresponding to a certain diagonal distance and crossing*edges 'e'.*/vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}/***Searches for diagonal patterns and returns the corresponding weights.*/vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}/***Determines how much length should be added in the last step of the searches.**Takes the bilinearly interpolated edge(see @PSEUDO_GATHER4),and adds 0,1*or 2 depending on which edges and crossing edges are active.*/float searchLength(const in vec2 e,const in float offset){/*The texture is flipped vertically,with left and right cases taking halfof the space horizontally.*/vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}/***Horizontal search for the second pass.*/float searchXLeft(in vec2 texCoord,const in float end){/*@PSEUDO_GATHER4This texCoord has been offset by(-0.25,-0.125)in the vertex shader tosample between edges,thus fetching four edges in a row.Sampling with different offsets in each direction allows to disambiguatewhich edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}/***Vertical search for the second pass.*/float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}/***Determines the areas at each side of the current edge.*/vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}/***Corner detection.*/void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\\n#if !defined(DISABLE_CORNER_DETECTION)\\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\\n#endif\\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\\n#if !defined(DISABLE_CORNER_DETECTION)\\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\\n#endif\\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\\n#if !defined(DISABLE_DIAG_DETECTION)\\n/*Diagonals have both north and west edges,so searching for them in one ofthe boundaries is enough.*/weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\\n#endif\\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;/*Now fetch the left crossing edges,two at a time using bilinearfiltering. Sampling at-0.25(see @CROSSING_OFFSET)enables to discern whatvalue each edge has.*/float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;/*Translate distances to pixel units for better interleave arithmetic andmemory accesses.*/d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\\n#if !defined(DISABLE_DIAG_DETECTION)\\n}else{e.r=0.0;}\\n#endif\\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}\";\nvar vertexShader$6 = \"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * Subpixel Morphological Antialiasing.\r\n *\r\n * This material computes weights for detected edges.\r\n */\n\nclass SMAAWeightsMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new SMAA weights material.\r\n   *\r\n   * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n   * @param {Vector2} [resolution] - The resolution.\r\n   */\n  constructor(texelSize = new Vector2$1(), resolution = new Vector2$1()) {\n    super({\n      type: \"SMAAWeightsMaterial\",\n      defines: {\n        // Configurable settings:\n        MAX_SEARCH_STEPS_INT: \"16\",\n        MAX_SEARCH_STEPS_FLOAT: \"16.0\",\n        MAX_SEARCH_STEPS_DIAG_INT: \"8\",\n        MAX_SEARCH_STEPS_DIAG_FLOAT: \"8.0\",\n        CORNER_ROUNDING: \"25\",\n        CORNER_ROUNDING_NORM: \"0.25\",\n        // Non-configurable settings:\n        AREATEX_MAX_DISTANCE: \"16.0\",\n        AREATEX_MAX_DISTANCE_DIAG: \"20.0\",\n        AREATEX_PIXEL_SIZE: \"(1.0 / vec2(160.0, 560.0))\",\n        AREATEX_SUBTEX_SIZE: \"(1.0 / 7.0)\",\n        SEARCHTEX_SIZE: \"vec2(66.0, 33.0)\",\n        SEARCHTEX_PACKED_SIZE: \"vec2(64.0, 16.0)\"\n      },\n      uniforms: {\n        inputBuffer: new Uniform(null),\n        areaTexture: new Uniform(null),\n        searchTexture: new Uniform(null),\n        texelSize: new Uniform(texelSize),\n        resolution: new Uniform(resolution)\n      },\n      fragmentShader: fragmentShader$d,\n      vertexShader: vertexShader$6,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n  }\n  /**\r\n   * Sets the maximum amount of steps performed in the horizontal/vertical\r\n   * pattern searches, at each side of the pixel.\r\n   *\r\n   * In number of pixels, it's actually the double. So the maximum line length\r\n   * perfectly handled by, for example 16, is 64 (perfectly means that longer\r\n   * lines won't look as good, but are still antialiased).\r\n   *\r\n   * @param {Number} steps - The search steps. Range: [0, 112].\r\n   */\n\n\n  setOrthogonalSearchSteps(steps) {\n    const s = Math.min(Math.max(steps, 0), 112);\n    this.defines.MAX_SEARCH_STEPS_INT = s.toFixed(\"0\");\n    this.defines.MAX_SEARCH_STEPS_FLOAT = s.toFixed(\"1\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Specifies the maximum steps performed in the diagonal pattern searches, at\r\n   * each side of the pixel. This search jumps one pixel at time.\r\n   *\r\n   * On high-end machines this search is cheap (between 0.8x and 0.9x slower for\r\n   * 16 steps), but it can have a significant impact on older machines.\r\n   *\r\n   * @param {Number} steps - The search steps. Range: [0, 20].\r\n   */\n\n\n  setDiagonalSearchSteps(steps) {\n    const s = Math.min(Math.max(steps, 0), 20);\n    this.defines.MAX_SEARCH_STEPS_DIAG_INT = s.toFixed(\"0\");\n    this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT = s.toFixed(\"1\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Specifies how much sharp corners will be rounded.\r\n   *\r\n   * @param {Number} rounding - The corner rounding amount. Range: [0, 100].\r\n   */\n\n\n  setCornerRounding(rounding) {\n    const r = Math.min(Math.max(rounding, 0), 100);\n    this.defines.CORNER_ROUNDING = r.toFixed(\"4\");\n    this.defines.CORNER_ROUNDING_NORM = (r / 100.0).toFixed(\"4\");\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether diagonal pattern detection is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get diagonalDetection() {\n    return this.defines.DISABLE_DIAG_DETECTION === undefined;\n  }\n  /**\r\n   * Enables or disables diagonal pattern detection.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set diagonalDetection(value) {\n    if (value) {\n      delete this.defines.DISABLE_DIAG_DETECTION;\n    } else {\n      this.defines.DISABLE_DIAG_DETECTION = \"1\";\n    }\n\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether corner rounding is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get cornerRounding() {\n    return this.defines.DISABLE_CORNER_DETECTION === undefined;\n  }\n  /**\r\n   * Enables or disables corner rounding.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set cornerRounding(value) {\n    if (value) {\n      delete this.defines.DISABLE_CORNER_DETECTION;\n    } else {\n      this.defines.DISABLE_CORNER_DETECTION = \"1\";\n    }\n\n    this.needsUpdate = true;\n  }\n\n}\n\nvar fragmentShader$e = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D normalDepthBuffer;\\n#else\\nuniform mediump sampler2D normalDepthBuffer;\\n#endif\\n#ifndef NORMAL_DEPTH\\nuniform sampler2D normalBuffer;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(normalDepthBuffer,uv));\\n#else\\nreturn texture2D(normalDepthBuffer,uv).r;\\n#endif\\n}\\n#endif\\nuniform sampler2D noiseTexture;uniform mat4 inverseProjectionMatrix;uniform mat4 projectionMatrix;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float minRadiusScale;uniform float intensity;uniform float fade;uniform float bias;uniform vec2 distanceCutoff;uniform vec2 proximityCutoff;varying vec2 vUv;varying vec2 vUv2;float getViewZ(const in float depth){\\n#ifdef PERSPECTIVE_CAMERA\\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\\n#else\\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\\n#endif\\n}vec3 getViewPosition(const in vec2 screenPosition,const in float depth,const in float viewZ){float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];vec4 clipPosition=vec4((vec3(screenPosition,depth)-0.5)*2.0,1.0);clipPosition*=clipW;return(inverseProjectionMatrix*clipPosition).xyz;}float getAmbientOcclusion(const in vec3 p,const in vec3 n,const in float depth,const in vec2 uv){\\n#ifdef DISTANCE_SCALING\\nfloat radiusScale=1.0-smoothstep(0.0,distanceCutoff.y,depth);radiusScale=radiusScale*(1.0-minRadiusScale)+minRadiusScale;float radius=RADIUS*radiusScale;\\n#else\\nfloat radius=RADIUS;\\n#endif\\nfloat noise=texture2D(noiseTexture,vUv2).r;float baseAngle=noise*PI2;float invSamples=1.0/SAMPLES_FLOAT;float rings=SPIRAL_TURNS*PI2;float occlusion=0.0;int taps=0;for(int i=0;i<SAMPLES_INT;++i){float alpha=(float(i)+0.5)*invSamples;float angle=alpha*rings+baseAngle;vec2 coord=alpha*radius*vec2(cos(angle),sin(angle))*texelSize+uv;if(coord.s<0.0||coord.s>1.0||coord.t<0.0||coord.t>1.0){continue;}\\n#ifdef NORMAL_DEPTH\\nfloat sampleDepth=texture2D(normalDepthBuffer,coord).a;\\n#else\\nfloat sampleDepth=readDepth(coord);\\n#endif\\nfloat viewZ=getViewZ(sampleDepth);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat linearSampleDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearSampleDepth=sampleDepth;\\n#endif\\nfloat proximity=abs(depth-linearSampleDepth);if(proximity<proximityCutoff.y){float falloff=1.0-smoothstep(proximityCutoff.x,proximityCutoff.y,proximity);vec3 Q=getViewPosition(coord,sampleDepth,viewZ);vec3 v=Q-p;float vv=dot(v,v);float vn=dot(v,n)-bias;float f=max(RADIUS_SQ-vv,0.0)/RADIUS_SQ;occlusion+=(f*f*f*max(vn/(fade+vv),0.0))*falloff;}++taps;}return occlusion/(4.0*max(float(taps),1.0));}void main(){\\n#ifdef NORMAL_DEPTH\\nvec4 normalDepth=texture2D(normalDepthBuffer,vUv);\\n#else\\nvec4 normalDepth=vec4(texture2D(normalBuffer,vUv).rgb,readDepth(vUv));\\n#endif\\nfloat ao=1.0;float depth=normalDepth.a;float viewZ=getViewZ(depth);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nif(linearDepth<distanceCutoff.y){vec3 viewPosition=getViewPosition(vUv,depth,viewZ);vec3 viewNormal=unpackRGBToNormal(normalDepth.rgb);ao-=getAmbientOcclusion(viewPosition,viewNormal,linearDepth,vUv);float d=smoothstep(distanceCutoff.x,distanceCutoff.y,linearDepth);ao=mix(ao,1.0,d);ao=clamp(pow(ao,abs(intensity)),0.0,1.0);}gl_FragColor.r=ao;}\";\nvar vertexShader$7 = \"uniform vec2 noiseScale;varying vec2 vUv;varying vec2 vUv2;void main(){vUv=position.xy*0.5+0.5;vUv2=vUv*noiseScale;gl_Position=vec4(position.xy,1.0,1.0);}\";\n/**\r\n * A Screen Space Ambient Occlusion (SSAO) shader material.\r\n */\n\nclass SSAOMaterial extends ShaderMaterial {\n  /**\r\n   * Constructs a new SSAO material.\r\n   *\r\n   * @param {Camera} camera - A camera.\r\n   */\n  constructor(camera) {\n    super({\n      type: \"SSAOMaterial\",\n      defines: {\n        SAMPLES_INT: \"0\",\n        SAMPLES_FLOAT: \"0.0\",\n        SPIRAL_TURNS: \"0.0\",\n        RADIUS: \"1.0\",\n        RADIUS_SQ: \"1.0\",\n        DISTANCE_SCALING: \"1\",\n        DEPTH_PACKING: \"0\"\n      },\n      uniforms: {\n        normalBuffer: new Uniform(null),\n        normalDepthBuffer: new Uniform(null),\n        noiseTexture: new Uniform(null),\n        inverseProjectionMatrix: new Uniform(new Matrix4()),\n        projectionMatrix: new Uniform(new Matrix4()),\n        texelSize: new Uniform(new Vector2$1()),\n        cameraNear: new Uniform(0.0),\n        cameraFar: new Uniform(0.0),\n        distanceCutoff: new Uniform(new Vector2$1()),\n        proximityCutoff: new Uniform(new Vector2$1()),\n        noiseScale: new Uniform(new Vector2$1()),\n        minRadiusScale: new Uniform(0.33),\n        intensity: new Uniform(1.0),\n        fade: new Uniform(0.01),\n        bias: new Uniform(0.0)\n      },\n      fragmentShader: fragmentShader$e,\n      vertexShader: vertexShader$7,\n      depthWrite: false,\n      depthTest: false\n    });\n    /** @ignore */\n\n    this.toneMapped = false;\n    this.adoptCameraSettings(camera);\n  }\n  /**\r\n   * The depth packing of the source depth buffer.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get depthPacking() {\n    return Number(this.defines.DEPTH_PACKING);\n  }\n  /**\r\n   * Sets the depth packing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set depthPacking(value) {\n    this.defines.DEPTH_PACKING = value.toFixed(0);\n    this.needsUpdate = true;\n  }\n  /**\r\n   * Sets the texel size.\r\n   *\r\n   * @param {Number} x - The texel width.\r\n   * @param {Number} y - The texel height.\r\n   */\n\n\n  setTexelSize(x, y) {\n    this.uniforms.texelSize.value.set(x, y);\n  }\n  /**\r\n   * Adopts the settings of the given camera.\r\n   *\r\n   * @param {Camera} [camera=null] - A camera.\r\n   */\n\n\n  adoptCameraSettings(camera = null) {\n    if (camera !== null) {\n      const uniforms = this.uniforms;\n      uniforms.cameraNear.value = camera.near;\n      uniforms.cameraFar.value = camera.far;\n\n      if (camera instanceof PerspectiveCamera) {\n        this.defines.PERSPECTIVE_CAMERA = \"1\";\n      } else {\n        delete this.defines.PERSPECTIVE_CAMERA;\n      }\n\n      this.needsUpdate = true;\n    }\n  }\n\n}\n/**\r\n * An auto sizing constant.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\n\nconst AUTO_SIZE = -1;\n/**\r\n * A resizer that can be used to store a base and a target resolution.\r\n *\r\n * The attached resizeable will be updated with the base resolution when the\r\n * target resolution changes. The new calculated resolution can then be\r\n * retrieved via {@link Resizer.width} and {@link Resizer.height}.\r\n */\n\nclass Resizer {\n  /**\r\n   * Constructs a new resizer.\r\n   *\r\n   * @param {Resizable} resizeable - A resizable object.\r\n   * @param {Number} [width=Resizer.AUTO_SIZE] - The width.\r\n   * @param {Number} [height=Resizer.AUTO_SIZE] - The height.\r\n   * @param {Number} [scale=1.0] - An alternative resolution scale.\r\n   */\n  constructor(resizable, width = AUTO_SIZE, height = AUTO_SIZE, scale = 1.0) {\n    /**\r\n     * A resizable object.\r\n     *\r\n     * @type {Resizable}\r\n     */\n    this.resizable = resizable;\n    /**\r\n     * The base size.\r\n     *\r\n     * This size will be passed to the resizable object every time the target\r\n     * width, height or scale is changed.\r\n     *\r\n     * @type {Vector2}\r\n     */\n\n    this.base = new Vector2$1(1, 1);\n    /**\r\n     * The target size.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.target = new Vector2$1(width, height);\n    /**\r\n     * A scale.\r\n     *\r\n     * If both the width and the height are set to {@link Resizer.AUTO_SIZE},\r\n     * they will be scaled uniformly using this scalar.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.s = scale;\n  }\n  /**\r\n   * The current resolution scale.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get scale() {\n    return this.s;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * Also sets the width and height to {@link Resizer.AUTO_SIZE}.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set scale(value) {\n    this.s = value;\n    this.target.x = AUTO_SIZE;\n    this.target.y = AUTO_SIZE;\n    this.resizable.setSize(this.base.x, this.base.y);\n  }\n  /**\r\n   * The calculated width.\r\n   *\r\n   * If both the width and the height are set to {@link Resizer.AUTO_SIZE}, the\r\n   * base width will be returned.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get width() {\n    const base = this.base;\n    const target = this.target;\n    let result;\n\n    if (target.x !== AUTO_SIZE) {\n      result = target.x;\n    } else if (target.y !== AUTO_SIZE) {\n      result = Math.round(target.y * (base.x / base.y));\n    } else {\n      result = Math.round(base.x * this.s);\n    }\n\n    return result;\n  }\n  /**\r\n   * Sets the target width.\r\n   *\r\n   * Use {@link Resizer.AUTO_SIZE} to automatically calculate the width based\r\n   * on the height and the original aspect ratio.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set width(value) {\n    this.target.x = value;\n    this.resizable.setSize(this.base.x, this.base.y);\n  }\n  /**\r\n   * The calculated height.\r\n   *\r\n   * If both the width and the height are set to {@link Resizer.AUTO_SIZE}, the\r\n   * base height will be returned.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get height() {\n    const base = this.base;\n    const target = this.target;\n    let result;\n\n    if (target.y !== AUTO_SIZE) {\n      result = target.y;\n    } else if (target.x !== AUTO_SIZE) {\n      result = Math.round(target.x / (base.x / base.y));\n    } else {\n      result = Math.round(base.y * this.s);\n    }\n\n    return result;\n  }\n  /**\r\n   * Sets the target height.\r\n   *\r\n   * Use {@link Resizer.AUTO_SIZE} to automatically calculate the height based\r\n   * on the width and the original aspect ratio.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set height(value) {\n    this.target.y = value;\n    this.resizable.setSize(this.base.x, this.base.y);\n  }\n  /**\r\n   * An auto sizing constant.\r\n   *\r\n   * Can be used to automatically calculate the width or height based on the\r\n   * original aspect ratio.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  static get AUTO_SIZE() {\n    return AUTO_SIZE;\n  }\n\n}\n/**\r\n * A dummy camera\r\n *\r\n * @type {Camera}\r\n * @private\r\n */\n\n\nconst dummyCamera = new Camera();\n/**\r\n * Shared fullscreen geometry.\r\n *\r\n * @type {BufferGeometry}\r\n * @private\r\n */\n\nlet geometry = null;\n/**\r\n * Returns a shared fullscreen triangle.\r\n *\r\n * The size of the screen is 2x2 units (NDC). A triangle that fills the screen\r\n * needs to be 4 units wide and 4 units tall.\r\n *\r\n * @private\r\n * @return {BufferGeometry} The fullscreen geometry.\r\n */\n\nfunction getFullscreenTriangle() {\n  if (geometry === null) {\n    const vertices = new Float32Array([-1, -1, 0, 3, -1, 0, -1, 3, 0]);\n    const uvs = new Float32Array([0, 0, 2, 0, 0, 2]);\n    geometry = new BufferGeometry(); // Added for backward compatibility (setAttribute was added in three r110).\n\n    if (geometry.setAttribute !== undefined) {\n      geometry.setAttribute(\"position\", new BufferAttribute(vertices, 3));\n      geometry.setAttribute(\"uv\", new BufferAttribute(uvs, 2));\n    } else {\n      geometry.addAttribute(\"position\", new BufferAttribute(vertices, 3));\n      geometry.addAttribute(\"uv\", new BufferAttribute(uvs, 2));\n    }\n  }\n\n  return geometry;\n}\n/**\r\n * An abstract pass.\r\n *\r\n * Passes that do not rely on the depth buffer should explicitly disable the\r\n * depth test and depth write flags of their fullscreen shader material.\r\n *\r\n * Fullscreen passes use a shared fullscreen triangle:\r\n * https://michaldrobot.com/2014/04/01/gcn-execution-patterns-in-full-screen-passes/\r\n *\r\n * @implements {Initializable}\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\n\n\nclass Pass {\n  /**\r\n   * Constructs a new pass.\r\n   *\r\n   * @param {String} [name] - The name of this pass. Does not have to be unique.\r\n   * @param {Scene} [scene] - The scene to render. The default scene contains a single mesh that fills the screen.\r\n   * @param {Camera} [camera] - A camera. Fullscreen effect passes don't require a camera.\r\n   */\n  constructor(name = \"Pass\", scene = new Scene(), camera = dummyCamera) {\n    /**\r\n     * The name of this pass.\r\n     *\r\n     * @type {String}\r\n     */\n    this.name = name;\n    /**\r\n     * The scene to render.\r\n     *\r\n     * @type {Scene}\r\n     * @protected\r\n     */\n\n    this.scene = scene;\n    /**\r\n     * The camera.\r\n     *\r\n     * @type {Camera}\r\n     * @protected\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * A mesh that fills the screen.\r\n     *\r\n     * @type {Mesh}\r\n     * @private\r\n     */\n\n    this.screen = null;\n    /**\r\n     * Indicates whether this pass should render to texture.\r\n     *\r\n     * @type {Boolean}\r\n     * @private\r\n     */\n\n    this.rtt = true;\n    /**\r\n     * Only relevant for subclassing.\r\n     *\r\n     * Indicates whether the {@link EffectComposer} should swap the frame\r\n     * buffers after this pass has finished rendering.\r\n     *\r\n     * Set this to `false` if this pass doesn't render to the output buffer or\r\n     * the screen. Otherwise, the contents of the input buffer will be lost.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.needsSwap = true;\n    /**\r\n     * Only relevant for subclassing.\r\n     *\r\n     * Indicates whether the {@link EffectComposer} should prepare a depth\r\n     * texture for this pass.\r\n     *\r\n     * Set this to `true` if this pass relies on depth information from a\r\n     * preceding {@link RenderPass}.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.needsDepthTexture = false;\n    /**\r\n     * Indicates whether this pass should be executed.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.enabled = true;\n  }\n  /**\r\n   * Indicates whether this pass should render to screen.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get renderToScreen() {\n    return !this.rtt;\n  }\n  /**\r\n   * Sets the render to screen flag.\r\n   *\r\n   * If the flag is changed to a different value, the fullscreen material will\r\n   * be updated as well.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set renderToScreen(value) {\n    if (this.rtt === value) {\n      const material = this.getFullscreenMaterial();\n\n      if (material !== null) {\n        material.needsUpdate = true;\n      }\n\n      this.rtt = !value;\n    }\n  }\n  /**\r\n   * Returns the current fullscreen material.\r\n   *\r\n   * @return {Material} The current fullscreen material, or null if there is none.\r\n   */\n\n\n  getFullscreenMaterial() {\n    return this.screen !== null ? this.screen.material : null;\n  }\n  /**\r\n   * Sets the fullscreen material.\r\n   *\r\n   * The material will be assigned to a mesh that fills the screen. The mesh\r\n   * will be created once a material is assigned via this method.\r\n   *\r\n   * @protected\r\n   * @param {Material} material - A fullscreen material.\r\n   */\n\n\n  setFullscreenMaterial(material) {\n    let screen = this.screen;\n\n    if (screen !== null) {\n      screen.material = material;\n    } else {\n      screen = new Mesh(getFullscreenTriangle(), material);\n      screen.frustumCulled = false;\n\n      if (this.scene === null) {\n        this.scene = new Scene();\n      }\n\n      this.scene.add(screen);\n      this.screen = screen;\n    }\n  }\n  /**\r\n   * Returns the current depth texture.\r\n   *\r\n   * @return {Texture} The current depth texture, or null if there is none.\r\n   */\n\n\n  getDepthTexture() {\n    return null;\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * This method will be called automatically by the {@link EffectComposer}.\r\n   *\r\n   * You may override this method if your pass relies on the depth information\r\n   * of a preceding {@link RenderPass}.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {}\n  /**\r\n   * Renders the effect.\r\n   *\r\n   * This is an abstract method that must be overridden.\r\n   *\r\n   * @abstract\r\n   * @throws {Error} An error is thrown if the method is not overridden.\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    throw new Error(\"Render method not implemented!\");\n  }\n  /**\r\n   * Updates this pass with the renderer's size.\r\n   *\r\n   * You may override this method in case you want to be informed about the size\r\n   * of the main frame buffer.\r\n   *\r\n   * The {@link EffectComposer} calls this method before this pass is\r\n   * initialized and every time its own size is updated.\r\n   *\r\n   * @param {Number} width - The renderer's width.\r\n   * @param {Number} height - The renderer's height.\r\n   * @example this.myRenderTarget.setSize(width, height);\r\n   */\n\n\n  setSize(width, height) {}\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * By overriding this method you gain access to the renderer. You'll also be\r\n   * able to configure your custom render targets to use the appropriate format\r\n   * (RGB or RGBA).\r\n   *\r\n   * The provided renderer can be used to warm up special off-screen render\r\n   * targets by performing a preliminary render operation.\r\n   *\r\n   * The {@link EffectComposer} calls this method when this pass is added to its\r\n   * queue, but not before its size has been set.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   * @example if(!alpha && frameBufferType === UnsignedByteType) { this.myRenderTarget.texture.format = RGBFormat; }\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {}\n  /**\r\n   * Performs a shallow search for disposable properties and deletes them. The\r\n   * pass will be inoperative after this method was called!\r\n   *\r\n   * The {@link EffectComposer} calls this method when it is being destroyed.\r\n   * You may, however, use it independently to free memory when you are certain\r\n   * that you don't need this pass anymore.\r\n   */\n\n\n  dispose() {\n    const material = this.getFullscreenMaterial();\n\n    if (material !== null) {\n      material.dispose();\n    }\n\n    for (const key of Object.keys(this)) {\n      const property = this[key];\n\n      if (property !== null && typeof property.dispose === \"function\") {\n        if (property instanceof Scene) {\n          continue;\n        }\n        /** @ignore */\n\n\n        this[key].dispose();\n      }\n    }\n  }\n\n}\n/**\r\n * An efficient, incremental blur pass.\r\n */\n\n\nclass BlurPass extends Pass {\n  /**\r\n   * Constructs a new blur pass.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {Number} [options.resolutionScale=0.5] - Deprecated. Adjust the height or width instead for consistent results.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The blur render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The blur render height.\r\n   * @param {KernelSize} [options.kernelSize=KernelSize.LARGE] - The blur kernel size.\r\n   */\n  constructor({\n    resolutionScale = 0.5,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    kernelSize = KernelSize.LARGE\n  } = {}) {\n    super(\"BlurPass\");\n    /**\r\n     * A render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetA = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false\n    });\n    this.renderTargetA.texture.name = \"Blur.Target.A\";\n    /**\r\n     * A second render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetB = this.renderTargetA.clone();\n    this.renderTargetB.texture.name = \"Blur.Target.B\";\n    /**\r\n     * The render resolution.\r\n     *\r\n     * It's recommended to set the height or the width to an absolute value for\r\n     * consistent results across different devices and resolutions.\r\n     *\r\n     * @type {Resizer}\r\n     */\n\n    this.resolution = new Resizer(this, width, height, resolutionScale);\n    /**\r\n     * A convolution shader material.\r\n     *\r\n     * @type {ConvolutionMaterial}\r\n     * @private\r\n     */\n\n    this.convolutionMaterial = new ConvolutionMaterial();\n    /**\r\n     * A convolution shader material that uses dithering.\r\n     *\r\n     * @type {ConvolutionMaterial}\r\n     * @private\r\n     */\n\n    this.ditheredConvolutionMaterial = new ConvolutionMaterial();\n    this.ditheredConvolutionMaterial.dithering = true;\n    /**\r\n     * Whether the blurred result should also be dithered using noise.\r\n     *\r\n     * @type {Boolean}\r\n     * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n     */\n\n    this.dithering = false;\n    this.kernelSize = kernelSize;\n  }\n  /**\r\n   * The current width of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  get width() {\n    return this.resolution.width;\n  }\n  /**\r\n   * Sets the render width.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  set width(value) {\n    this.resolution.width = value;\n  }\n  /**\r\n   * The current height of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  get height() {\n    return this.resolution.height;\n  }\n  /**\r\n   * Sets the render height.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  set height(value) {\n    this.resolution.height = value;\n  }\n  /**\r\n   * The current blur scale.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get scale() {\n    return this.convolutionMaterial.uniforms.scale.value;\n  }\n  /**\r\n   * Sets the blur scale.\r\n   *\r\n   * This value influences the overall blur strength and should not be greater\r\n   * than 1. For larger blurs please increase the {@link kernelSize}!\r\n   *\r\n   * Note that the blur strength is closely tied to the resolution. For a smooth\r\n   * transition from no blur to full blur, set the width or the height to a high\r\n   * enough value.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set scale(value) {\n    this.convolutionMaterial.uniforms.scale.value = value;\n    this.ditheredConvolutionMaterial.uniforms.scale.value = value;\n  }\n  /**\r\n   * The kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   */\n\n\n  get kernelSize() {\n    return this.convolutionMaterial.kernelSize;\n  }\n  /**\r\n   * Sets the kernel size.\r\n   *\r\n   * Larger kernels require more processing power but scale well with larger\r\n   * render resolutions.\r\n   *\r\n   * @type {KernelSize}\r\n   */\n\n\n  set kernelSize(value) {\n    this.convolutionMaterial.kernelSize = value;\n    this.ditheredConvolutionMaterial.kernelSize = value;\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolution.scale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolution.scale = scale;\n  }\n  /**\r\n   * Blurs the input buffer and writes the result to the output buffer. The\r\n   * input buffer remains intact, unless it's also the output buffer.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const scene = this.scene;\n    const camera = this.camera;\n    const renderTargetA = this.renderTargetA;\n    const renderTargetB = this.renderTargetB;\n    let material = this.convolutionMaterial;\n    let uniforms = material.uniforms;\n    const kernel = material.getKernel();\n    let lastRT = inputBuffer;\n    let destRT;\n    let i, l;\n    this.setFullscreenMaterial(material); // Apply the multi-pass blur.\n\n    for (i = 0, l = kernel.length - 1; i < l; ++i) {\n      // Alternate between targets.\n      destRT = (i & 1) === 0 ? renderTargetA : renderTargetB;\n      uniforms.kernel.value = kernel[i];\n      uniforms.inputBuffer.value = lastRT.texture;\n      renderer.setRenderTarget(destRT);\n      renderer.render(scene, camera);\n      lastRT = destRT;\n    }\n\n    if (this.dithering) {\n      material = this.ditheredConvolutionMaterial;\n      uniforms = material.uniforms;\n      this.setFullscreenMaterial(material);\n    }\n\n    uniforms.kernel.value = kernel[i];\n    uniforms.inputBuffer.value = lastRT.texture;\n    renderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\n    renderer.render(scene, camera);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    resolution.base.set(width, height);\n    const w = resolution.width;\n    const h = resolution.height;\n    this.renderTargetA.setSize(w, h);\n    this.renderTargetB.setSize(w, h);\n    this.convolutionMaterial.setTexelSize(1.0 / w, 1.0 / h);\n    this.ditheredConvolutionMaterial.setTexelSize(1.0 / w, 1.0 / h);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTargetA.texture.format = RGBFormat;\n      this.renderTargetB.texture.format = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTargetA.texture.type = frameBufferType;\n      this.renderTargetB.texture.type = frameBufferType;\n    }\n  }\n  /**\r\n   * An auto sizing flag.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use {@link Resizer.AUTO_SIZE} instead.\r\n   */\n\n\n  static get AUTO_SIZE() {\n    return Resizer.AUTO_SIZE;\n  }\n\n}\n/**\r\n * A pass that disables the stencil test.\r\n */\n\n\nclass ClearMaskPass extends Pass {\n  /**\r\n   * Constructs a new clear mask pass.\r\n   */\n  constructor() {\n    super(\"ClearMaskPass\", null, null);\n    this.needsSwap = false;\n  }\n  /**\r\n   * Disables the global stencil test.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const stencil = renderer.state.buffers.stencil;\n    stencil.setLocked(false);\n    stencil.setTest(false);\n  }\n\n}\n/**\r\n * Stores the original clear color of the renderer.\r\n *\r\n * @type {Color}\r\n * @private\r\n */\n\n\nconst color = new Color();\n/**\r\n * A pass that clears the input buffer or the screen.\r\n */\n\nclass ClearPass extends Pass {\n  /**\r\n   * Constructs a new clear pass.\r\n   *\r\n   * @param {Boolean} [color=true] - Determines whether the color buffer should be cleared.\r\n   * @param {Boolean} [depth=true] - Determines whether the depth buffer should be cleared.\r\n   * @param {Boolean} [stencil=false] - Determines whether the stencil buffer should be cleared.\r\n   */\n  constructor(color = true, depth = true, stencil = false) {\n    super(\"ClearPass\", null, null);\n    this.needsSwap = false;\n    /**\r\n     * Indicates whether the color buffer should be cleared.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.color = color;\n    /**\r\n     * Indicates whether the depth buffer should be cleared.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.depth = depth;\n    /**\r\n     * Indicates whether the stencil buffer should be cleared.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.stencil = stencil;\n    /**\r\n     * An override clear color.\r\n     *\r\n     * The default value is null.\r\n     *\r\n     * @type {Color}\r\n     */\n\n    this.overrideClearColor = null;\n    /**\r\n     * An override clear alpha.\r\n     *\r\n     * The default value is -1.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.overrideClearAlpha = -1.0;\n  }\n  /**\r\n   * Clears the input buffer or the screen.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const overrideClearColor = this.overrideClearColor;\n    const overrideClearAlpha = this.overrideClearAlpha;\n    const clearAlpha = renderer.getClearAlpha();\n    const hasOverrideClearColor = overrideClearColor !== null;\n    const hasOverrideClearAlpha = overrideClearAlpha >= 0.0;\n\n    if (hasOverrideClearColor) {\n      color.copy(renderer.getClearColor());\n      renderer.setClearColor(overrideClearColor, hasOverrideClearAlpha ? overrideClearAlpha : clearAlpha);\n    } else if (hasOverrideClearAlpha) {\n      renderer.setClearAlpha(overrideClearAlpha);\n    }\n\n    renderer.setRenderTarget(this.renderToScreen ? null : inputBuffer);\n    renderer.clear(this.color, this.depth, this.stencil);\n\n    if (hasOverrideClearColor) {\n      renderer.setClearColor(color, clearAlpha);\n    } else if (hasOverrideClearAlpha) {\n      renderer.setClearAlpha(clearAlpha);\n    }\n  }\n\n}\n/**\r\n * A flag that indicates whether the override material workaround is enabled.\r\n *\r\n * @type {Boolean}\r\n * @private\r\n */\n\n\nlet workaroundEnabled = false;\n/**\r\n * An override material manager.\r\n *\r\n * Includes a workaround that fixes override materials for skinned meshes and\r\n * instancing. Doesn't fix uniforms such as normal maps and displacement maps.\r\n * Using the workaround may have a negative impact on performance if the scene\r\n * contains a lot of meshes.\r\n *\r\n * @implements {Disposable}\r\n */\n\nclass OverrideMaterialManager {\n  /**\r\n   * Constructs a new override material manager.\r\n   *\r\n   * @param {Material} [material=null] - An override material.\r\n   */\n  constructor(material = null) {\n    /**\r\n     * Keeps track of original materials.\r\n     *\r\n     * @type {Map<Object3D, Material>}\r\n     * @private\r\n     */\n    this.originalMaterials = new Map();\n    /**\r\n     * The override material.\r\n     *\r\n     * @type {Material}\r\n     * @private\r\n     */\n\n    this.material = null;\n    /**\r\n     * A clone of the override material.\r\n     *\r\n     * @type {Material}\r\n     * @private\r\n     */\n\n    this.materialInstanced = null;\n    /**\r\n     * A clone of the override material.\r\n     *\r\n     * @type {Material}\r\n     * @private\r\n     */\n\n    this.materialSkinning = null;\n    this.setMaterial(material);\n  }\n  /**\r\n   * Sets the override material.\r\n   *\r\n   * @param {Material} material - The material.\r\n   */\n\n\n  setMaterial(material) {\n    this.disposeMaterials();\n\n    if (material !== null) {\n      this.material = material;\n      this.materialInstanced = material.clone();\n      this.materialInstanced.uniforms = Object.assign({}, material.uniforms);\n      this.materialSkinning = material.clone();\n      this.materialSkinning.uniforms = Object.assign({}, material.uniforms);\n      this.materialSkinning.skinning = true;\n    }\n  }\n  /**\r\n   * Renders the scene with the override material.\r\n   *\r\n   * @private\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Scene} scene - A scene.\r\n   * @param {Camera} camera - A camera.\r\n   */\n\n\n  render(renderer, scene, camera) {\n    const material = this.material;\n    const materialSkinning = this.materialSkinning;\n    const materialInstanced = this.materialInstanced;\n    const originalMaterials = this.originalMaterials; // Ignore shadows.\n\n    const shadowMapEnabled = renderer.shadowMap.enabled;\n    renderer.shadowMap.enabled = false;\n\n    if (workaroundEnabled) {\n      let meshCount = 0; // Replace materials of all meshes with the correct override materials.\n\n      scene.traverse(node => {\n        if (node.isMesh) {\n          originalMaterials.set(node, node.material);\n\n          if (node.isInstancedMesh) {\n            node.material = materialInstanced;\n          } else if (node.isSkinnedMesh) {\n            node.material = materialSkinning;\n          } else {\n            node.material = material;\n          }\n\n          ++meshCount;\n        }\n      });\n      renderer.render(scene, camera);\n\n      for (const entry of originalMaterials) {\n        entry[0].material = entry[1];\n      }\n\n      if (meshCount !== originalMaterials.size) {\n        originalMaterials.clear();\n      }\n    } else {\n      const overrideMaterial = scene.overrideMaterial;\n      scene.overrideMaterial = material;\n      renderer.render(scene, camera);\n      scene.overrideMaterial = overrideMaterial;\n    }\n\n    renderer.shadowMap.enabled = shadowMapEnabled;\n  }\n  /**\r\n   * Deletes cloned override materials.\r\n   *\r\n   * @private\r\n   */\n\n\n  disposeMaterials() {\n    if (this.materialInstanced !== null) {\n      this.materialInstanced.dispose();\n    }\n\n    if (this.materialSkinning !== null) {\n      this.materialSkinning.dispose();\n    }\n  }\n  /**\r\n   * Performs cleanup tasks.\r\n   */\n\n\n  dispose() {\n    this.originalMaterials.clear();\n    this.disposeMaterials();\n  }\n  /**\r\n   * Indicates whether the override material workaround is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  static get workaroundEnabled() {\n    return workaroundEnabled;\n  }\n  /**\r\n   * Enables or disables the override material workaround globally.\r\n   *\r\n   * This only affects post processing passes and effects.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  static set workaroundEnabled(value) {\n    workaroundEnabled = value;\n  }\n\n}\n/**\r\n * A pass that renders a given scene into the input buffer or to screen.\r\n *\r\n * This pass uses a {@link ClearPass} to clear the target buffer.\r\n */\n\n\nclass RenderPass extends Pass {\n  /**\r\n   * Constructs a new render pass.\r\n   *\r\n   * @param {Scene} scene - The scene to render.\r\n   * @param {Camera} camera - The camera to use to render the scene.\r\n   * @param {Material} [overrideMaterial=null] - An override material.\r\n   */\n  constructor(scene, camera, overrideMaterial = null) {\n    super(\"RenderPass\", scene, camera);\n    this.needsSwap = false;\n    /**\r\n     * A clear pass.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass();\n    /**\r\n     * An override material manager.\r\n     *\r\n     * @type {OverrideMaterialManager}\r\n     * @private\r\n     */\n\n    this.overrideMaterialManager = overrideMaterial === null ? null : new OverrideMaterialManager(overrideMaterial);\n  }\n  /**\r\n   * Indicates whether this pass should render to screen.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get renderToScreen() {\n    return super.renderToScreen;\n  }\n  /**\r\n   * Sets the render to screen flag.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set renderToScreen(value) {\n    super.renderToScreen = value;\n    this.clearPass.renderToScreen = value;\n  }\n  /**\r\n   * The current override material.\r\n   *\r\n   * @type {Material}\r\n   */\n\n\n  get overrideMaterial() {\n    const manager = this.overrideMaterialManager;\n    return manager !== null ? manager.material : null;\n  }\n  /**\r\n   * Sets the override material.\r\n   *\r\n   * @type {Material}\r\n   */\n\n\n  set overrideMaterial(value) {\n    const manager = this.overrideMaterialManager;\n\n    if (value !== null) {\n      if (manager !== null) {\n        manager.setMaterial(value);\n      } else {\n        this.overrideMaterialManager = new OverrideMaterialManager(value);\n      }\n    } else if (manager !== null) {\n      manager.dispose();\n      this.overrideMaterialManager = null;\n    }\n  }\n  /**\r\n   * Indicates whether the target buffer should be cleared before rendering.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get clear() {\n    return this.clearPass.enabled;\n  }\n  /**\r\n   * Enables or disables auto clear.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set clear(value) {\n    this.clearPass.enabled = value;\n  }\n  /**\r\n   * Returns the clear pass.\r\n   *\r\n   * @return {ClearPass} The clear pass.\r\n   */\n\n\n  getClearPass() {\n    return this.clearPass;\n  }\n  /**\r\n   * Renders the scene.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const scene = this.scene;\n    const camera = this.camera;\n    const background = scene.background;\n    const renderTarget = this.renderToScreen ? null : inputBuffer;\n\n    if (this.clear) {\n      if (this.clearPass.overrideClearColor !== null) {\n        // This clear color is important! Ignore the scene background.\n        scene.background = null;\n      }\n\n      this.clearPass.render(renderer, inputBuffer);\n    }\n\n    renderer.setRenderTarget(renderTarget);\n\n    if (this.overrideMaterialManager !== null) {\n      this.overrideMaterialManager.render(renderer, scene, camera);\n    } else {\n      renderer.render(scene, camera);\n    }\n\n    if (scene.background !== background) {\n      // Restore the background.\n      scene.background = background;\n    }\n  }\n\n}\n/**\r\n * A pass that renders the depth of a given scene into a color buffer.\r\n */\n\n\nclass DepthPass extends Pass {\n  /**\r\n   * Constructs a new depth pass.\r\n   *\r\n   * @param {Scene} scene - The scene to render.\r\n   * @param {Camera} camera - The camera to use to render the scene.\r\n   * @param {Object} [options] - The options.\r\n   * @param {Number} [options.resolutionScale=1.0] - Deprecated. Adjust the height or width instead for consistent results.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   * @param {WebGLRenderTarget} [options.renderTarget] - A custom render target.\r\n   */\n  constructor(scene, camera, {\n    resolutionScale = 1.0,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    renderTarget\n  } = {}) {\n    super(\"DepthPass\");\n    this.needsSwap = false;\n    /**\r\n     * A render pass.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.renderPass = new RenderPass(scene, camera, new MeshDepthMaterial({\n      depthPacking: RGBADepthPacking\n    }));\n    const clearPass = this.renderPass.getClearPass();\n    clearPass.overrideClearColor = new Color(0xffffff);\n    clearPass.overrideClearAlpha = 1.0;\n    /**\r\n     * A render target that contains the scene depth.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     */\n\n    this.renderTarget = renderTarget;\n\n    if (this.renderTarget === undefined) {\n      this.renderTarget = new WebGLRenderTarget(1, 1, {\n        minFilter: NearestFilter,\n        magFilter: NearestFilter,\n        stencilBuffer: false\n      });\n      this.renderTarget.texture.name = \"DepthPass.Target\";\n    }\n    /**\r\n     * The desired render resolution.\r\n     *\r\n     * Use {@link Resizer.AUTO_SIZE} for the width or height to automatically\r\n     * calculate it based on its counterpart and the original aspect ratio.\r\n     *\r\n     * @type {Resizer}\r\n     */\n\n\n    this.resolution = new Resizer(this, width, height, resolutionScale);\n  }\n  /**\r\n   * The depth texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTarget.texture;\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolutionScale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolutionScale = scale;\n    this.setSize(this.resolution.base.x, this.resolution.base.y);\n  }\n  /**\r\n   * Renders the scene depth.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const renderTarget = this.renderToScreen ? null : this.renderTarget;\n    this.renderPass.render(renderer, renderTarget);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    resolution.base.set(width, height);\n    this.renderTarget.setSize(resolution.width, resolution.height);\n  }\n\n}\n/**\r\n * A pass that downsamples the scene depth by picking the most representative\r\n * depth in 2x2 texel neighborhoods. If a normal buffer is provided, the\r\n * corresponding normals will be stored as well.\r\n *\r\n * Attention: This pass requires WebGL 2.\r\n */\n\n\nclass DepthDownsamplingPass extends Pass {\n  /**\r\n   * Constructs a new depth downsampling pass.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {Texture} [options.normalBuffer=null] - A texture that contains view space normals. See {@link NormalPass}.\r\n   * @param {Number} [options.resolutionScale=0.5] - The resolution scale.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   */\n  constructor({\n    normalBuffer = null,\n    resolutionScale = 0.5,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE\n  } = {}) {\n    super(\"DepthDownsamplingPass\");\n    this.setFullscreenMaterial(new DepthDownsamplingMaterial());\n    this.needsDepthTexture = true;\n    this.needsSwap = false;\n\n    if (normalBuffer !== null) {\n      const material = this.getFullscreenMaterial();\n      material.uniforms.normalBuffer.value = normalBuffer;\n      material.defines.DOWNSAMPLE_NORMALS = \"1\";\n    }\n    /**\r\n     * A render target that contains the downsampled normals and depth.\r\n     *\r\n     * Normals are stored as RGB and depth is stored as alpha.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     */\n\n\n    this.renderTarget = new WebGLRenderTarget(1, 1, {\n      minFilter: NearestFilter,\n      magFilter: NearestFilter,\n      stencilBuffer: false,\n      depthBuffer: false,\n      type: FloatType\n    });\n    this.renderTarget.texture.name = \"DepthDownsamplingPass.Target\";\n    this.renderTarget.texture.generateMipmaps = false;\n    /**\r\n     * The resolution of this effect.\r\n     *\r\n     * @type {Resizer}\r\n     */\n\n    this.resolution = new Resizer(this, width, height);\n    this.resolution.scale = resolutionScale;\n  }\n  /**\r\n   * The normal(RGB) + depth(A) texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTarget.texture;\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.getFullscreenMaterial();\n    material.uniforms.depthBuffer.value = depthTexture;\n    material.depthPacking = depthPacking;\n  }\n  /**\r\n   * Downsamples depth and scene normals.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    renderer.setRenderTarget(this.renderToScreen ? null : this.renderTarget);\n    renderer.render(this.scene, this.camera);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    resolution.base.set(width, height); // Use the full resolution to calculate the depth/normal buffer texel size.\n\n    this.getFullscreenMaterial().setTexelSize(1.0 / width, 1.0 / height);\n    this.renderTarget.setSize(resolution.width, resolution.height);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    if (!renderer.capabilities.isWebGL2) {\n      console.error(\"The DepthDownsamplingPass requires WebGL 2\");\n    }\n  }\n\n}\n/**\r\n * A blend function enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} SKIP - No blending. The effect will not be included in the final shader.\r\n * @property {Number} ADD - Additive blending. Fast, but may produce washed out results.\r\n * @property {Number} ALPHA - Alpha blending. Blends based on the alpha value of the new color.\r\n * @property {Number} AVERAGE - Average blending.\r\n * @property {Number} COLOR_BURN - Color burn.\r\n * @property {Number} COLOR_DODGE - Color dodge.\r\n * @property {Number} DARKEN - Prioritize darker colors.\r\n * @property {Number} DIFFERENCE - Color difference.\r\n * @property {Number} EXCLUSION - Color exclusion.\r\n * @property {Number} LIGHTEN - Prioritize lighter colors.\r\n * @property {Number} MULTIPLY - Color multiplication.\r\n * @property {Number} DIVIDE - Color division.\r\n * @property {Number} NEGATION - Color negation.\r\n * @property {Number} NORMAL - Normal blending. The new color overwrites the old one.\r\n * @property {Number} OVERLAY - Color overlay.\r\n * @property {Number} REFLECT - Color reflection.\r\n * @property {Number} SCREEN - Screen blending. The two colors are effectively projected on a white screen simultaneously.\r\n * @property {Number} SOFT_LIGHT - Soft light blending.\r\n * @property {Number} SUBTRACT - Color subtraction.\r\n */\n\n\nconst BlendFunction = {\n  SKIP: 0,\n  ADD: 1,\n  ALPHA: 2,\n  AVERAGE: 3,\n  COLOR_BURN: 4,\n  COLOR_DODGE: 5,\n  DARKEN: 6,\n  DIFFERENCE: 7,\n  EXCLUSION: 8,\n  LIGHTEN: 9,\n  MULTIPLY: 10,\n  DIVIDE: 11,\n  NEGATION: 12,\n  NORMAL: 13,\n  OVERLAY: 14,\n  REFLECT: 15,\n  SCREEN: 16,\n  SOFT_LIGHT: 17,\n  SUBTRACT: 18\n};\nvar addBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}\";\nvar alphaBlendFunction = \"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}\";\nvar averageBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}\";\nvar colorBurnBlendFunction = \"float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar colorDodgeBlendFunction = \"float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar darkenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}\";\nvar differenceBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}\";\nvar exclusionBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}\";\nvar lightenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}\";\nvar multiplyBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}\";\nvar divideBlendFunction = \"float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar negationBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}\";\nvar normalBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}\";\nvar overlayBlendFunction = \"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar reflectBlendFunction = \"float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar screenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}\";\nvar softLightBlendFunction = \"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\nvar subtractBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}\";\n/**\r\n * A blend function shader code catalogue.\r\n *\r\n * @type {Map<BlendFunction, String>}\r\n * @private\r\n */\n\nconst blendFunctions = new Map([[BlendFunction.SKIP, null], [BlendFunction.ADD, addBlendFunction], [BlendFunction.ALPHA, alphaBlendFunction], [BlendFunction.AVERAGE, averageBlendFunction], [BlendFunction.COLOR_BURN, colorBurnBlendFunction], [BlendFunction.COLOR_DODGE, colorDodgeBlendFunction], [BlendFunction.DARKEN, darkenBlendFunction], [BlendFunction.DIFFERENCE, differenceBlendFunction], [BlendFunction.EXCLUSION, exclusionBlendFunction], [BlendFunction.LIGHTEN, lightenBlendFunction], [BlendFunction.MULTIPLY, multiplyBlendFunction], [BlendFunction.DIVIDE, divideBlendFunction], [BlendFunction.NEGATION, negationBlendFunction], [BlendFunction.NORMAL, normalBlendFunction], [BlendFunction.OVERLAY, overlayBlendFunction], [BlendFunction.REFLECT, reflectBlendFunction], [BlendFunction.SCREEN, screenBlendFunction], [BlendFunction.SOFT_LIGHT, softLightBlendFunction], [BlendFunction.SUBTRACT, subtractBlendFunction]]);\n/**\r\n * A blend mode.\r\n */\n\nclass BlendMode extends EventDispatcher {\n  /**\r\n   * Constructs a new blend mode.\r\n   *\r\n   * @param {BlendFunction} blendFunction - The blend function to use.\r\n   * @param {Number} opacity - The opacity of the color that will be blended with the base color.\r\n   */\n  constructor(blendFunction, opacity = 1.0) {\n    super();\n    /**\r\n     * The blend function.\r\n     *\r\n     * @type {BlendFunction}\r\n     * @private\r\n     */\n\n    this.blendFunction = blendFunction;\n    /**\r\n     * The opacity of the color that will be blended with the base color.\r\n     *\r\n     * @type {Uniform}\r\n     */\n\n    this.opacity = new Uniform(opacity);\n  }\n  /**\r\n   * Returns the blend function.\r\n   *\r\n   * @return {BlendFunction} The blend function.\r\n   */\n\n\n  getBlendFunction() {\n    return this.blendFunction;\n  }\n  /**\r\n   * Sets the blend function.\r\n   *\r\n   * @param {BlendFunction} blendFunction - The blend function.\r\n   */\n\n\n  setBlendFunction(blendFunction) {\n    this.blendFunction = blendFunction;\n    this.dispatchEvent({\n      type: \"change\"\n    });\n  }\n  /**\r\n   * Returns the blend function shader code.\r\n   *\r\n   * @return {String} The blend function shader code.\r\n   */\n\n\n  getShaderCode() {\n    return blendFunctions.get(this.blendFunction);\n  }\n\n}\n/**\r\n * An abstract effect.\r\n *\r\n * Effects can be combined using the {@link EffectPass}.\r\n *\r\n * @implements {Initializable}\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\n\n\nclass Effect extends EventDispatcher {\n  /**\r\n   * Constructs a new effect.\r\n   *\r\n   * @param {String} name - The name of this effect. Doesn't have to be unique.\r\n   * @param {String} fragmentShader - The fragment shader. This shader is required.\r\n   * @param {Object} [options] - Additional options.\r\n   * @param {EffectAttribute} [options.attributes=EffectAttribute.NONE] - The effect attributes that determine the execution priority and resource requirements.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n   * @param {Map<String, String>} [options.defines] - Custom preprocessor macro definitions. Keys are names and values are code.\r\n   * @param {Map<String, Uniform>} [options.uniforms] - Custom shader uniforms. Keys are names and values are uniforms.\r\n   * @param {Set<WebGLExtension>} [options.extensions] - WebGL extensions.\r\n   * @param {String} [options.vertexShader=null] - The vertex shader. Most effects don't need one.\r\n   */\n  constructor(name, fragmentShader, {\n    attributes = EffectAttribute.NONE,\n    blendFunction = BlendFunction.SCREEN,\n    defines = new Map(),\n    uniforms = new Map(),\n    extensions = null,\n    vertexShader = null\n  } = {}) {\n    super();\n    /**\r\n     * The name of this effect.\r\n     *\r\n     * @type {String}\r\n     */\n\n    this.name = name;\n    /**\r\n     * The effect attributes.\r\n     *\r\n     * @type {EffectAttribute}\r\n     * @private\r\n     */\n\n    this.attributes = attributes;\n    /**\r\n     * The fragment shader.\r\n     *\r\n     * @type {String}\r\n     * @private\r\n     */\n\n    this.fragmentShader = fragmentShader;\n    /**\r\n     * The vertex shader.\r\n     *\r\n     * @type {String}\r\n     * @private\r\n     */\n\n    this.vertexShader = vertexShader;\n    /**\r\n     * Preprocessor macro definitions.\r\n     *\r\n     * Call {@link Effect.setChanged} after changing macro definitions.\r\n     *\r\n     * @type {Map<String, String>}\r\n     */\n\n    this.defines = defines;\n    /**\r\n     * Shader uniforms.\r\n     *\r\n     * You may freely modify the values of these uniforms at runtime. However,\r\n     * uniforms should not be removed or added after the effect was created.\r\n     *\r\n     * Call {@link Effect.setChanged} after adding or removing uniforms.\r\n     *\r\n     * @type {Map<String, Uniform>}\r\n     */\n\n    this.uniforms = uniforms;\n    /**\r\n     * WebGL extensions that are required by this effect.\r\n     *\r\n     * Call {@link Effect.setChanged} after adding or removing extensions.\r\n     *\r\n     * @type {Set<WebGLExtension>}\r\n     */\n\n    this.extensions = extensions;\n    /**\r\n     * The blend mode of this effect.\r\n     *\r\n     * The result of this effect will be blended with the result of the previous\r\n     * effect using this blend mode.\r\n     *\r\n     * @type {BlendMode}\r\n     */\n\n    this.blendMode = new BlendMode(blendFunction);\n    this.blendMode.addEventListener(\"change\", event => this.setChanged());\n  }\n  /**\r\n   * Informs the associated {@link EffectPass} that this effect has changed in\r\n   * a way that requires a shader recompilation.\r\n   *\r\n   * Call this method after changing macro definitions or extensions and after\r\n   * adding or removing uniforms.\r\n   *\r\n   * @protected\r\n   */\n\n\n  setChanged() {\n    this.dispatchEvent({\n      type: \"change\"\n    });\n  }\n  /**\r\n   * Returns the effect attributes.\r\n   *\r\n   * @return {EffectAttribute} The attributes.\r\n   */\n\n\n  getAttributes() {\n    return this.attributes;\n  }\n  /**\r\n   * Sets the effect attributes.\r\n   *\r\n   * Effects that have the same attributes will be executed in the order in\r\n   * which they were registered. Some attributes imply a higher priority.\r\n   *\r\n   * @protected\r\n   * @param {EffectAttribute} attributes - The attributes.\r\n   */\n\n\n  setAttributes(attributes) {\n    this.attributes = attributes;\n    this.setChanged();\n  }\n  /**\r\n   * Returns the fragment shader.\r\n   *\r\n   * @return {String} The fragment shader.\r\n   */\n\n\n  getFragmentShader() {\n    return this.fragmentShader;\n  }\n  /**\r\n   * Sets the fragment shader.\r\n   *\r\n   * @protected\r\n   * @param {String} fragmentShader - The fragment shader.\r\n   */\n\n\n  setFragmentShader(fragmentShader) {\n    this.fragmentShader = fragmentShader;\n    this.setChanged();\n  }\n  /**\r\n   * Returns the vertex shader.\r\n   *\r\n   * @return {String} The vertex shader.\r\n   */\n\n\n  getVertexShader() {\n    return this.vertexShader;\n  }\n  /**\r\n   * Sets the vertex shader.\r\n   *\r\n   * @protected\r\n   * @param {String} vertexShader - The vertex shader.\r\n   */\n\n\n  setVertexShader(vertexShader) {\n    this.vertexShader = vertexShader;\n    this.setChanged();\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * You may override this method if your effect requires direct access to the\r\n   * depth texture that is bound to the associated {@link EffectPass}.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {}\n  /**\r\n   * Updates the effect by performing supporting operations.\r\n   *\r\n   * This method is called by the {@link EffectPass} right before the main\r\n   * fullscreen render operation, even if the blend function is set to `SKIP`.\r\n   *\r\n   * You may override this method if you need to render additional off-screen\r\n   * textures or update custom uniforms.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {}\n  /**\r\n   * Updates the size of this effect.\r\n   *\r\n   * You may override this method in case you want to be informed about the main\r\n   * render size.\r\n   *\r\n   * The {@link EffectPass} calls this method before this effect is initialized\r\n   * and every time its own size is updated.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   * @example this.myRenderTarget.setSize(width, height);\r\n   */\n\n\n  setSize(width, height) {}\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * By overriding this method you gain access to the renderer. You'll also be\r\n   * able to configure your custom render targets to use the appropriate format\r\n   * (RGB or RGBA).\r\n   *\r\n   * The provided renderer can be used to warm up special off-screen render\r\n   * targets by performing a preliminary render operation.\r\n   *\r\n   * The {@link EffectPass} calls this method during its own initialization\r\n   * which happens after the size has been set.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   * @example if(!alpha && frameBufferType === UnsignedByteType) { this.myRenderTarget.texture.format = RGBFormat; }\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {}\n  /**\r\n   * Performs a shallow search for properties that define a dispose method and\r\n   * deletes them. The effect will be inoperative after this method was called!\r\n   *\r\n   * The {@link EffectPass} calls this method when it is being destroyed. Do not\r\n   * call this method directly.\r\n   */\n\n\n  dispose() {\n    for (const key of Object.keys(this)) {\n      const property = this[key];\n\n      if (property !== null && typeof property.dispose === \"function\") {\n        if (property instanceof Scene) {\n          continue;\n        }\n        /** @ignore */\n\n\n        this[key].dispose();\n      }\n    }\n  }\n\n}\n/**\r\n * An enumeration of effect attributes.\r\n *\r\n * Attributes can be concatenated using the bitwise OR operator.\r\n *\r\n * @type {Object}\r\n * @property {Number} NONE - No attributes. Most effects don't need to specify any attributes.\r\n * @property {Number} DEPTH - Describes effects that require a depth texture.\r\n * @property {Number} CONVOLUTION - Describes effects that fetch additional samples from the input buffer. There cannot be more than one effect with this attribute per {@link EffectPass}.\r\n * @example const attributes = EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH;\r\n */\n\n\nconst EffectAttribute = {\n  NONE: 0,\n  DEPTH: 1,\n  CONVOLUTION: 2\n};\n/**\r\n * An enumeration of WebGL extensions.\r\n *\r\n * @type {Object}\r\n * @property {String} DERIVATIVES - Enables derivatives by adding the functions dFdx, dFdy and fwidth.\r\n * @property {String} FRAG_DEPTH - Enables gl_FragDepthEXT to set a depth value of a fragment from within the fragment shader.\r\n * @property {String} DRAW_BUFFERS - Enables multiple render targets (MRT) support.\r\n * @property {String} SHADER_TEXTURE_LOD - Enables explicit control of texture LOD.\r\n */\n\nconst WebGLExtension = {\n  DERIVATIVES: \"derivatives\",\n  FRAG_DEPTH: \"fragDepth\",\n  DRAW_BUFFERS: \"drawBuffers\",\n  SHADER_TEXTURE_LOD: \"shaderTextureLOD\"\n};\n/**\r\n * Finds and collects substrings that match the given regular expression.\r\n *\r\n * @private\r\n * @param {RegExp} regExp - A regular expression.\r\n * @param {String} string - A string.\r\n * @return {String[]} The matching substrings.\r\n */\n\nfunction findSubstrings(regExp, string) {\n  const substrings = [];\n  let result;\n\n  while ((result = regExp.exec(string)) !== null) {\n    substrings.push(result[1]);\n  }\n\n  return substrings;\n}\n/**\r\n * Prefixes substrings within the given strings.\r\n *\r\n * @private\r\n * @param {String} prefix - A prefix.\r\n * @param {String[]} substrings - The substrings.\r\n * @param {Map<String, String>} strings - A collection of named strings.\r\n */\n\n\nfunction prefixSubstrings(prefix, substrings, strings) {\n  let prefixed, regExp;\n\n  for (const substring of substrings) {\n    prefixed = \"$1\" + prefix + substring.charAt(0).toUpperCase() + substring.slice(1);\n    regExp = new RegExp(\"([^\\\\.])(\\\\b\" + substring + \"\\\\b)\", \"g\");\n\n    for (const entry of strings.entries()) {\n      if (entry[1] !== null) {\n        strings.set(entry[0], entry[1].replace(regExp, prefixed));\n      }\n    }\n  }\n}\n/**\r\n * Integrates the given effect.\r\n *\r\n * @private\r\n * @param {String} prefix - A prefix.\r\n * @param {Effect} effect - An effect.\r\n * @param {Map<String, String>} shaderParts - The shader parts.\r\n * @param {Map<BlendFunction, BlendMode>} blendModes - The blend modes.\r\n * @param {Map<String, String>} defines - The macro definitions.\r\n * @param {Map<String, Uniform>} uniforms - The uniforms.\r\n * @param {EffectAttribute} attributes - The global, collective attributes.\r\n * @return {Object} The results.\r\n * @property {String[]} varyings - The varyings used by the given effect.\r\n * @property {Boolean} transformedUv - Indicates whether the effect transforms UV coordinates in the fragment shader.\r\n * @property {Boolean} readDepth - Indicates whether the effect actually uses depth in the fragment shader.\r\n */\n\n\nfunction integrateEffect(prefix, effect, shaderParts, blendModes, defines, uniforms, attributes) {\n  const functionRegExp = /(?:\\w+\\s+(\\w+)\\([\\w\\s,]*\\)\\s*{[^}]+})/g;\n  const varyingRegExp = /(?:varying\\s+\\w+\\s+(\\w*))/g;\n  const blendMode = effect.blendMode;\n  const shaders = new Map([[\"fragment\", effect.getFragmentShader()], [\"vertex\", effect.getVertexShader()]]);\n  const mainImageExists = shaders.get(\"fragment\") !== undefined && shaders.get(\"fragment\").indexOf(\"mainImage\") >= 0;\n  const mainUvExists = shaders.get(\"fragment\") !== undefined && shaders.get(\"fragment\").indexOf(\"mainUv\") >= 0;\n  let varyings = [],\n      names = [];\n  let transformedUv = false;\n  let readDepth = false;\n\n  if (shaders.get(\"fragment\") === undefined) {\n    console.error(\"Missing fragment shader\", effect);\n  } else if (mainUvExists && (attributes & EffectAttribute.CONVOLUTION) !== 0) {\n    console.error(\"Effects that transform UV coordinates are incompatible with convolution effects\", effect);\n  } else if (!mainImageExists && !mainUvExists) {\n    console.error(\"The fragment shader contains neither a mainImage nor a mainUv function\", effect);\n  } else {\n    if (mainUvExists) {\n      shaderParts.set(Section.FRAGMENT_MAIN_UV, shaderParts.get(Section.FRAGMENT_MAIN_UV) + \"\\t\" + prefix + \"MainUv(UV);\\n\");\n      transformedUv = true;\n    }\n\n    if (shaders.get(\"vertex\") !== null && shaders.get(\"vertex\").indexOf(\"mainSupport\") >= 0) {\n      let string = \"\\t\" + prefix + \"MainSupport(\"; // Check if the vertex shader expects uv coordinates.\n\n      if (shaders.get(\"vertex\").indexOf(\"uv\") >= 0) {\n        string += \"vUv\";\n      }\n\n      string += \");\\n\";\n      shaderParts.set(Section.VERTEX_MAIN_SUPPORT, shaderParts.get(Section.VERTEX_MAIN_SUPPORT) + string);\n      varyings = varyings.concat(findSubstrings(varyingRegExp, shaders.get(\"vertex\")));\n      names = names.concat(varyings).concat(findSubstrings(functionRegExp, shaders.get(\"vertex\")));\n    } // Assemble all names while ignoring parameters of function-like macros.\n\n\n    names = names.concat(findSubstrings(functionRegExp, shaders.get(\"fragment\"))).concat(Array.from(effect.defines.keys()).map(s => s.replace(/\\([\\w\\s,]*\\)/g, \"\"))).concat(Array.from(effect.uniforms.keys())); // Store prefixed uniforms and macros.\n\n    effect.uniforms.forEach((value, key) => uniforms.set(prefix + key.charAt(0).toUpperCase() + key.slice(1), value));\n    effect.defines.forEach((value, key) => defines.set(prefix + key.charAt(0).toUpperCase() + key.slice(1), value)); // Prefix varyings, functions, uniforms and macros.\n\n    prefixSubstrings(prefix, names, defines);\n    prefixSubstrings(prefix, names, shaders); // Collect unique blend modes.\n\n    blendModes.set(blendMode.blendFunction, blendMode);\n\n    if (mainImageExists) {\n      let string = prefix + \"MainImage(color0, UV, \"; // The effect may sample depth in a different shader.\n\n      if ((attributes & EffectAttribute.DEPTH) !== 0 && shaders.get(\"fragment\").indexOf(\"depth\") >= 0) {\n        string += \"depth, \";\n        readDepth = true;\n      }\n\n      string += \"color1);\\n\\t\"; // Include the blend opacity uniform of this effect.\n\n      const blendOpacity = prefix + \"BlendOpacity\";\n      uniforms.set(blendOpacity, blendMode.opacity); // Blend the result of this effect with the input color.\n\n      string += \"color0 = blend\" + blendMode.getBlendFunction() + \"(color0, color1, \" + blendOpacity + \");\\n\\n\\t\";\n      shaderParts.set(Section.FRAGMENT_MAIN_IMAGE, shaderParts.get(Section.FRAGMENT_MAIN_IMAGE) + string);\n      shaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) + \"uniform float \" + blendOpacity + \";\\n\\n\");\n    } // Include the modified code in the final shader.\n\n\n    shaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) + shaders.get(\"fragment\") + \"\\n\");\n\n    if (shaders.get(\"vertex\") !== null) {\n      shaderParts.set(Section.VERTEX_HEAD, shaderParts.get(Section.VERTEX_HEAD) + shaders.get(\"vertex\") + \"\\n\");\n    }\n  }\n\n  return {\n    varyings,\n    transformedUv,\n    readDepth\n  };\n}\n/**\r\n * An effect pass.\r\n *\r\n * Use this pass to combine {@link Effect} instances.\r\n *\r\n * @implements {EventListener}\r\n */\n\n\nclass EffectPass extends Pass {\n  /**\r\n   * Constructs a new effect pass.\r\n   *\r\n   * The provided effects will be organized and merged for optimal performance.\r\n   *\r\n   * @param {Camera} camera - The main camera. The camera's type and settings will be available to all effects.\r\n   * @param {...Effect} effects - The effects that will be rendered by this pass.\r\n   */\n  constructor(camera, ...effects) {\n    super(\"EffectPass\");\n    this.setFullscreenMaterial(new EffectMaterial(null, null, null, camera));\n    /**\r\n     * The effects, sorted by attribute priority, DESC.\r\n     *\r\n     * @type {Effect[]}\r\n     * @private\r\n     */\n\n    this.effects = effects.sort((a, b) => b.attributes - a.attributes);\n    /**\r\n     * Indicates whether this pass should skip rendering.\r\n     *\r\n     * Effects will still be updated, even if this flag is true.\r\n     *\r\n     * @type {Boolean}\r\n     * @private\r\n     */\n\n    this.skipRendering = false;\n    /**\r\n     * The amount of shader uniforms that this pass uses.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.uniforms = 0;\n    /**\r\n     * The amount of shader varyings that this pass uses.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.varyings = 0;\n    /**\r\n     * A time offset.\r\n     *\r\n     * Elapsed time will start at this value.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.minTime = 1.0;\n    /**\r\n     * The maximum time.\r\n     *\r\n     * If the elapsed time exceeds this value, it will be reset.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.maxTime = Number.POSITIVE_INFINITY;\n  }\n  /**\r\n   * Indicates whether this pass encodes its output when rendering to screen.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get encodeOutput() {\n    return this.getFullscreenMaterial().defines.ENCODE_OUTPUT !== undefined;\n  }\n  /**\r\n   * Enables or disables output encoding.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set encodeOutput(value) {\n    if (this.encodeOutput !== value) {\n      const material = this.getFullscreenMaterial();\n      material.needsUpdate = true;\n\n      if (value) {\n        material.defines.ENCODE_OUTPUT = \"1\";\n      } else {\n        delete material.defines.ENCODE_OUTPUT;\n      }\n    }\n  }\n  /**\r\n   * Indicates whether dithering is enabled.\r\n   *\r\n   * Color quantization reduces banding artifacts but degrades performance.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get dithering() {\n    return this.getFullscreenMaterial().dithering;\n  }\n  /**\r\n   * Enables or disables dithering.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set dithering(value) {\n    const material = this.getFullscreenMaterial();\n\n    if (material.dithering !== value) {\n      material.dithering = value;\n      material.needsUpdate = true;\n    }\n  }\n  /**\r\n   * Compares required resources with device capabilities.\r\n   *\r\n   * @private\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   */\n\n\n  verifyResources(renderer) {\n    const capabilities = renderer.capabilities;\n    let max = Math.min(capabilities.maxFragmentUniforms, capabilities.maxVertexUniforms);\n\n    if (this.uniforms > max) {\n      console.warn(\"The current rendering context doesn't support more than \" + max + \" uniforms, but \" + this.uniforms + \" were defined\");\n    }\n\n    max = capabilities.maxVaryings;\n\n    if (this.varyings > max) {\n      console.warn(\"The current rendering context doesn't support more than \" + max + \" varyings, but \" + this.varyings + \" were defined\");\n    }\n  }\n  /**\r\n   * Updates the compound shader material.\r\n   *\r\n   * @private\r\n   */\n\n\n  updateMaterial() {\n    const blendRegExp = /\\bblend\\b/g;\n    const shaderParts = new Map([[Section.FRAGMENT_HEAD, \"\"], [Section.FRAGMENT_MAIN_UV, \"\"], [Section.FRAGMENT_MAIN_IMAGE, \"\"], [Section.VERTEX_HEAD, \"\"], [Section.VERTEX_MAIN_SUPPORT, \"\"]]);\n    const blendModes = new Map();\n    const defines = new Map();\n    const uniforms = new Map();\n    const extensions = new Set();\n    let id = 0,\n        varyings = 0,\n        attributes = 0;\n    let transformedUv = false;\n    let readDepth = false;\n    let result;\n\n    for (const effect of this.effects) {\n      if (effect.blendMode.getBlendFunction() === BlendFunction.SKIP) {\n        // Check if this effect relies on depth and then continue.\n        attributes |= effect.getAttributes() & EffectAttribute.DEPTH;\n      } else if ((attributes & EffectAttribute.CONVOLUTION) !== 0 && (effect.getAttributes() & EffectAttribute.CONVOLUTION) !== 0) {\n        console.error(\"Convolution effects cannot be merged\", effect);\n      } else {\n        attributes |= effect.getAttributes();\n        result = integrateEffect(\"e\" + id++, effect, shaderParts, blendModes, defines, uniforms, attributes);\n        varyings += result.varyings.length;\n        transformedUv = transformedUv || result.transformedUv;\n        readDepth = readDepth || result.readDepth;\n\n        if (effect.extensions !== null) {\n          // Collect the WebGL extensions that are required by this effect.\n          for (const extension of effect.extensions) {\n            extensions.add(extension);\n          }\n        }\n      }\n    } // Integrate the relevant blend functions.\n\n\n    for (const blendMode of blendModes.values()) {\n      shaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) + blendMode.getShaderCode().replace(blendRegExp, \"blend\" + blendMode.getBlendFunction()) + \"\\n\");\n    } // Check if any effect relies on depth.\n\n\n    if ((attributes & EffectAttribute.DEPTH) !== 0) {\n      // Only read depth if any effect actually uses this information.\n      if (readDepth) {\n        shaderParts.set(Section.FRAGMENT_MAIN_IMAGE, \"float depth = readDepth(UV);\\n\\n\\t\" + shaderParts.get(Section.FRAGMENT_MAIN_IMAGE));\n      } // Only request a depth texture if none has been provided yet.\n\n\n      this.needsDepthTexture = this.getDepthTexture() === null;\n    } else {\n      this.needsDepthTexture = false;\n    } // Check if any effect transforms UVs in the fragment shader.\n\n\n    if (transformedUv) {\n      shaderParts.set(Section.FRAGMENT_MAIN_UV, \"vec2 transformedUv = vUv;\\n\" + shaderParts.get(Section.FRAGMENT_MAIN_UV));\n      defines.set(\"UV\", \"transformedUv\");\n    } else {\n      defines.set(\"UV\", \"vUv\");\n    } // Ensure that leading preprocessor directives start at a new line.\n\n\n    shaderParts.forEach((value, key, map) => map.set(key, value.trim().replace(/^#/, \"\\n#\")));\n    this.uniforms = uniforms.size;\n    this.varyings = varyings;\n    this.skipRendering = id === 0;\n    this.needsSwap = !this.skipRendering;\n    const material = this.getFullscreenMaterial();\n    material.setShaderParts(shaderParts).setDefines(defines).setUniforms(uniforms);\n    material.extensions = {};\n\n    if (extensions.size > 0) {\n      // Enable required WebGL extensions.\n      for (const extension of extensions) {\n        material.extensions[extension] = true;\n      }\n    }\n\n    this.needsUpdate = false;\n  }\n  /**\r\n   * Updates the shader material.\r\n   *\r\n   * Warning: This method triggers a relatively expensive shader recompilation.\r\n   *\r\n   * @param {WebGLRenderer} [renderer] - The renderer.\r\n   */\n\n\n  recompile(renderer) {\n    this.updateMaterial();\n\n    if (renderer !== undefined) {\n      this.verifyResources(renderer);\n    }\n  }\n  /**\r\n   * Returns the current depth texture.\r\n   *\r\n   * @return {Texture} The current depth texture, or null if there is none.\r\n   */\n\n\n  getDepthTexture() {\n    return this.getFullscreenMaterial().uniforms.depthBuffer.value;\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.getFullscreenMaterial();\n    material.uniforms.depthBuffer.value = depthTexture;\n    material.depthPacking = depthPacking;\n    material.needsUpdate = true;\n\n    for (const effect of this.effects) {\n      effect.setDepthTexture(depthTexture, depthPacking);\n    }\n  }\n  /**\r\n   * Renders the effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const material = this.getFullscreenMaterial();\n    const time = material.uniforms.time.value + deltaTime;\n\n    if (this.needsUpdate) {\n      this.recompile(renderer);\n    }\n\n    for (const effect of this.effects) {\n      effect.update(renderer, inputBuffer, deltaTime);\n    }\n\n    if (!this.skipRendering || this.renderToScreen) {\n      material.uniforms.inputBuffer.value = inputBuffer.texture;\n      material.uniforms.time.value = time <= this.maxTime ? time : this.minTime;\n      renderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\n      renderer.render(this.scene, this.camera);\n    }\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.getFullscreenMaterial().setSize(width, height);\n\n    for (const effect of this.effects) {\n      effect.setSize(width, height);\n    }\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    this.capabilities = renderer.capabilities; // Initialize effects before building the shader.\n\n    for (const effect of this.effects) {\n      effect.initialize(renderer, alpha, frameBufferType);\n      effect.addEventListener(\"change\", event => this.handleEvent(event));\n    } // Initialize the fullscreen material.\n\n\n    this.updateMaterial();\n    this.verifyResources(renderer);\n  }\n  /**\r\n   * Deletes disposable objects.\r\n   *\r\n   * This pass will be inoperative after this method was called!\r\n   */\n\n\n  dispose() {\n    super.dispose();\n\n    for (const effect of this.effects) {\n      effect.dispose();\n    }\n  }\n  /**\r\n   * Handles events.\r\n   *\r\n   * @param {Event} event - An event.\r\n   */\n\n\n  handleEvent(event) {\n    switch (event.type) {\n      case \"change\":\n        this.needsUpdate = true;\n        break;\n    }\n  }\n\n}\n/**\r\n * A pass that executes a given function.\r\n */\n\n\nclass LambdaPass extends Pass {\n  /**\r\n   * Constructs a new lambda pass.\r\n   *\r\n   * @param {Function} f - A function.\r\n   */\n  constructor(f) {\n    super(\"LambdaPass\", null, null);\n    this.needsSwap = false;\n    /**\r\n     * A function.\r\n     *\r\n     * @type {Function}\r\n     * @private\r\n     */\n\n    this.f = f;\n  }\n  /**\r\n   * Executes the function.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    this.f();\n  }\n\n}\n/**\r\n * A stencil mask pass.\r\n *\r\n * This pass requires that the input and output buffers have a stencil buffer.\r\n * You can enable the stencil buffer via the {@link EffectComposer} constructor.\r\n */\n\n\nclass MaskPass extends Pass {\n  /**\r\n   * Constructs a new mask pass.\r\n   *\r\n   * @param {Scene} scene - The scene to render.\r\n   * @param {Camera} camera - The camera to use.\r\n   */\n  constructor(scene, camera) {\n    super(\"MaskPass\", scene, camera);\n    this.needsSwap = false;\n    /**\r\n     * A clear pass.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass(false, false, true);\n    /**\r\n     * Inverse flag.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.inverse = false;\n  }\n  /**\r\n   * Indicates whether this pass should clear the stencil buffer.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get clear() {\n    return this.clearPass.enabled;\n  }\n  /**\r\n   * Enables or disables auto clear.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set clear(value) {\n    this.clearPass.enabled = value;\n  }\n  /**\r\n   * Renders the effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const context = renderer.getContext();\n    const buffers = renderer.state.buffers;\n    const scene = this.scene;\n    const camera = this.camera;\n    const clearPass = this.clearPass;\n    const writeValue = this.inverse ? 0 : 1;\n    const clearValue = 1 - writeValue; // Don't update color or depth.\n\n    buffers.color.setMask(false);\n    buffers.depth.setMask(false); // Lock the buffers.\n\n    buffers.color.setLocked(true);\n    buffers.depth.setLocked(true); // Configure the stencil.\n\n    buffers.stencil.setTest(true);\n    buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\n    buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\n    buffers.stencil.setClear(clearValue);\n    buffers.stencil.setLocked(true); // Clear the stencil.\n\n    if (this.clear) {\n      if (this.renderToScreen) {\n        clearPass.render(renderer, null);\n      } else {\n        clearPass.render(renderer, inputBuffer);\n        clearPass.render(renderer, outputBuffer);\n      }\n    } // Draw the mask.\n\n\n    if (this.renderToScreen) {\n      renderer.setRenderTarget(null);\n      renderer.render(scene, camera);\n    } else {\n      renderer.setRenderTarget(inputBuffer);\n      renderer.render(scene, camera);\n      renderer.setRenderTarget(outputBuffer);\n      renderer.render(scene, camera);\n    } // Unlock the buffers.\n\n\n    buffers.color.setLocked(false);\n    buffers.depth.setLocked(false); // Only render where the stencil is set to 1.\n\n    buffers.stencil.setLocked(false);\n    buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff);\n    buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\n    buffers.stencil.setLocked(true);\n  }\n\n}\n/**\r\n * A pass that renders the normals of a given scene.\r\n */\n\n\nclass NormalPass extends Pass {\n  /**\r\n   * Constructs a new normal pass.\r\n   *\r\n   * @param {Scene} scene - The scene to render.\r\n   * @param {Camera} camera - The camera to use to render the scene.\r\n   * @param {Object} [options] - The options.\r\n   * @param {Number} [options.resolutionScale=1.0] - Deprecated. Adjust the height or width instead for consistent results.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   * @param {WebGLRenderTarget} [options.renderTarget] - A custom render target.\r\n   */\n  constructor(scene, camera, {\n    resolutionScale = 1.0,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    renderTarget\n  } = {}) {\n    super(\"NormalPass\");\n    this.needsSwap = false;\n    /**\r\n     * A render pass.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.renderPass = new RenderPass(scene, camera, new MeshNormalMaterial());\n    const clearPass = this.renderPass.getClearPass();\n    clearPass.overrideClearColor = new Color(0x7777ff);\n    clearPass.overrideClearAlpha = 1.0;\n    /**\r\n     * A render target that contains the scene normals.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     */\n\n    this.renderTarget = renderTarget;\n\n    if (this.renderTarget === undefined) {\n      this.renderTarget = new WebGLRenderTarget(1, 1, {\n        minFilter: NearestFilter,\n        magFilter: NearestFilter,\n        format: RGBFormat,\n        stencilBuffer: false\n      });\n      this.renderTarget.texture.name = \"NormalPass.Target\";\n    }\n    /**\r\n     * The desired render resolution.\r\n     *\r\n     * Use {@link Resizer.AUTO_SIZE} for the width or height to automatically\r\n     * calculate it based on its counterpart and the original aspect ratio.\r\n     *\r\n     * @type {Resizer}\r\n     */\n\n\n    this.resolution = new Resizer(this, width, height, resolutionScale);\n  }\n  /**\r\n   * The normal texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTarget.texture;\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolutionScale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolutionScale = scale;\n    this.setSize(this.resolution.base.x, this.resolution.base.y);\n  }\n  /**\r\n   * Renders the scene normals.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    const renderTarget = this.renderToScreen ? null : this.renderTarget;\n    this.renderPass.render(renderer, renderTarget, renderTarget);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    resolution.base.set(width, height);\n    this.renderTarget.setSize(resolution.width, resolution.height);\n  }\n\n}\n/**\r\n * A pass that renders the result from a previous pass to another render target.\r\n */\n\n\nclass SavePass extends Pass {\n  /**\r\n   * Constructs a new save pass.\r\n   *\r\n   * @param {WebGLRenderTarget} [renderTarget] - A render target.\r\n   * @param {Boolean} [resize=true] - Whether the render target should adjust to the size of the input buffer.\r\n   */\n  constructor(renderTarget, resize = true) {\n    super(\"SavePass\");\n    this.setFullscreenMaterial(new CopyMaterial());\n    this.needsSwap = false;\n    /**\r\n     * The render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     */\n\n    this.renderTarget = renderTarget;\n\n    if (renderTarget === undefined) {\n      this.renderTarget = new WebGLRenderTarget(1, 1, {\n        minFilter: LinearFilter,\n        magFilter: LinearFilter,\n        stencilBuffer: false,\n        depthBuffer: false\n      });\n      this.renderTarget.texture.name = \"SavePass.Target\";\n    }\n    /**\r\n     * Indicates whether the render target should be resized automatically.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n\n    this.resize = resize;\n  }\n  /**\r\n   * The saved texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTarget.texture;\n  }\n  /**\r\n   * Saves the input buffer.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    this.getFullscreenMaterial().uniforms.inputBuffer.value = inputBuffer.texture;\n    renderer.setRenderTarget(this.renderToScreen ? null : this.renderTarget);\n    renderer.render(this.scene, this.camera);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    if (this.resize) {\n      const w = Math.max(width, 1);\n      const h = Math.max(height, 1);\n      this.renderTarget.setSize(w, h);\n    }\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - A renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTarget.texture.format = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTarget.texture.type = frameBufferType;\n    }\n  }\n\n}\n/**\r\n * A shader pass.\r\n *\r\n * Renders any shader material as a fullscreen effect.\r\n *\r\n * This pass should not be used to create multiple chained effects. For a more\r\n * efficient solution, please refer to the {@link EffectPass}.\r\n */\n\n\nclass ShaderPass extends Pass {\n  /**\r\n   * Constructs a new shader pass.\r\n   *\r\n   * @param {ShaderMaterial} material - A shader material.\r\n   * @param {String} [input=\"inputBuffer\"] - The name of the input buffer uniform.\r\n   */\n  constructor(material, input = \"inputBuffer\") {\n    super(\"ShaderPass\");\n    this.setFullscreenMaterial(material);\n    /**\r\n     * The input buffer uniform.\r\n     *\r\n     * @type {String}\r\n     * @private\r\n     */\n\n    this.uniform = null;\n    this.setInput(input);\n  }\n  /**\r\n   * Sets the name of the input buffer uniform.\r\n   *\r\n   * Most fullscreen materials modify texels from an input texture. This pass\r\n   * automatically assigns the main input buffer to the uniform identified by\r\n   * the given name.\r\n   *\r\n   * @param {String} input - The name of the input buffer uniform.\r\n   */\n\n\n  setInput(input) {\n    const material = this.getFullscreenMaterial();\n    this.uniform = null;\n\n    if (material !== null) {\n      const uniforms = material.uniforms;\n\n      if (uniforms !== undefined && uniforms[input] !== undefined) {\n        this.uniform = uniforms[input];\n      }\n    }\n  }\n  /**\r\n   * Renders the effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n   */\n\n\n  render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\n    if (this.uniform !== null && inputBuffer !== null) {\n      this.uniform.value = inputBuffer.texture;\n    }\n\n    renderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\n    renderer.render(this.scene, this.camera);\n  }\n\n}\n/**\r\n * The EffectComposer may be used in place of a normal WebGLRenderer.\r\n *\r\n * The auto clear behaviour of the provided renderer will be disabled to prevent\r\n * unnecessary clear operations.\r\n *\r\n * It is common practice to use a {@link RenderPass} as the first pass to\r\n * automatically clear the buffers and render a scene for further processing.\r\n *\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\n\n\nclass EffectComposer {\n  /**\r\n   * Constructs a new effect composer.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer that should be used.\r\n   * @param {Object} [options] - The options.\r\n   * @param {Boolean} [options.depthBuffer=true] - Whether the main render targets should have a depth buffer.\r\n   * @param {Boolean} [options.stencilBuffer=false] - Whether the main render targets should have a stencil buffer.\r\n   * @param {Number} [options.multisampling=0] - The number of samples used for multisample antialiasing. Requires WebGL 2.\r\n   * @param {Boolean} [options.frameBufferType] - The type of the internal frame buffers. It's recommended to use HalfFloatType if possible.\r\n   */\n  constructor(renderer = null, {\n    depthBuffer = true,\n    stencilBuffer = false,\n    multisampling = 0,\n    frameBufferType\n  } = {}) {\n    /**\r\n     * The renderer.\r\n     *\r\n     * @type {WebGLRenderer}\r\n     * @private\r\n     */\n    this.renderer = renderer;\n    /**\r\n     * The input buffer.\r\n     *\r\n     * Reading from and writing to the same render target should be avoided.\r\n     * Therefore, two seperate yet identical buffers are used.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.inputBuffer = null;\n    /**\r\n     * The output buffer.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.outputBuffer = null;\n\n    if (this.renderer !== null) {\n      this.renderer.autoClear = false;\n      this.inputBuffer = this.createBuffer(depthBuffer, stencilBuffer, frameBufferType, multisampling);\n      this.outputBuffer = this.inputBuffer.clone();\n      this.enableExtensions();\n    }\n    /**\r\n     * A copy pass used for copying masked scenes.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n\n    this.copyPass = new ShaderPass(new CopyMaterial());\n    /**\r\n     * A depth texture.\r\n     *\r\n     * @type {DepthTexture}\r\n     * @private\r\n     */\n\n    this.depthTexture = null;\n    /**\r\n     * The passes.\r\n     *\r\n     * @type {Pass[]}\r\n     * @private\r\n     */\n\n    this.passes = [];\n    /**\r\n     * Determines whether the last pass automatically renders to screen.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.autoRenderToScreen = true;\n  }\n  /**\r\n   * The current amount of samples used for multisample antialiasing.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get multisampling() {\n    return this.inputBuffer instanceof WebGLMultisampleRenderTarget ? this.inputBuffer.samples : 0;\n  }\n  /**\r\n   * Sets the amount of MSAA samples.\r\n   *\r\n   * Requires WebGL 2. Set to zero to disable multisampling.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set multisampling(value) {\n    const buffer = this.inputBuffer;\n    const multisampling = this.multisampling;\n\n    if (multisampling > 0 && value > 0) {\n      this.inputBuffer.samples = value;\n      this.outputBuffer.samples = value;\n    } else if (multisampling !== value) {\n      this.inputBuffer.dispose();\n      this.outputBuffer.dispose(); // Enable or disable MSAA.\n\n      this.inputBuffer = this.createBuffer(buffer.depthBuffer, buffer.stencilBuffer, buffer.texture.type, value);\n      this.inputBuffer.depthTexture = this.depthTexture;\n      this.outputBuffer = this.inputBuffer.clone();\n    }\n  }\n  /**\r\n   * Returns the WebGL renderer.\r\n   *\r\n   * You may replace the renderer at any time by using\r\n   * {@link EffectComposer#replaceRenderer}.\r\n   *\r\n   * @return {WebGLRenderer} The renderer.\r\n   */\n\n\n  getRenderer() {\n    return this.renderer;\n  }\n  /**\r\n   * Explicitly enables required WebGL extensions.\r\n   *\r\n   * @private\r\n   */\n\n\n  enableExtensions() {\n    const frameBufferType = this.inputBuffer.texture.type;\n    const capabilities = this.renderer.capabilities;\n    const context = this.renderer.getContext();\n\n    if (frameBufferType !== UnsignedByteType) {\n      if (capabilities.isWebGL2) {\n        context.getExtension(\"EXT_color_buffer_float\");\n      } else {\n        context.getExtension(\"EXT_color_buffer_half_float\");\n      }\n    }\n  }\n  /**\r\n   * Replaces the current renderer with the given one.\r\n   *\r\n   * The auto clear mechanism of the provided renderer will be disabled. If the\r\n   * new render size differs from the previous one, all passes will be updated.\r\n   *\r\n   * By default, the DOM element of the current renderer will automatically be\r\n   * removed from its parent node and the DOM element of the new renderer will\r\n   * take its place.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The new renderer.\r\n   * @param {Boolean} updateDOM - Indicates whether the old canvas should be replaced by the new one in the DOM.\r\n   * @return {WebGLRenderer} The old renderer.\r\n   */\n\n\n  replaceRenderer(renderer, updateDOM = true) {\n    const oldRenderer = this.renderer;\n\n    if (oldRenderer !== null && oldRenderer !== renderer) {\n      const oldSize = oldRenderer.getSize(new Vector2$1());\n      const newSize = renderer.getSize(new Vector2$1());\n      const parent = oldRenderer.domElement.parentNode;\n      this.renderer = renderer;\n      this.renderer.autoClear = false;\n\n      if (!oldSize.equals(newSize)) {\n        this.setSize();\n      }\n\n      if (updateDOM && parent !== null) {\n        parent.removeChild(oldRenderer.domElement);\n        parent.appendChild(renderer.domElement);\n      }\n\n      this.enableExtensions();\n    }\n\n    return oldRenderer;\n  }\n  /**\r\n   * Creates a depth texture attachment that will be provided to all passes.\r\n   *\r\n   * Note: When a shader reads from a depth texture and writes to a render\r\n   * target that uses the same depth texture attachment, the depth information\r\n   * will be lost. This happens even if `depthWrite` is disabled.\r\n   *\r\n   * @private\r\n   * @return {DepthTexture} The depth texture.\r\n   */\n\n\n  createDepthTexture() {\n    const depthTexture = this.depthTexture = new DepthTexture(); // Hack: Make sure the input buffer uses the depth texture.\n\n    this.inputBuffer.depthTexture = depthTexture;\n    this.inputBuffer.dispose();\n\n    if (this.inputBuffer.stencilBuffer) {\n      depthTexture.format = DepthStencilFormat;\n      depthTexture.type = UnsignedInt248Type;\n    } else {\n      depthTexture.type = UnsignedIntType;\n    }\n\n    return depthTexture;\n  }\n  /**\r\n   * Deletes the current depth texture.\r\n   *\r\n   * @private\r\n   */\n\n\n  deleteDepthTexture() {\n    if (this.depthTexture !== null) {\n      this.depthTexture.dispose();\n      this.depthTexture = null; // Update the input buffer.\n\n      this.inputBuffer.depthTexture = null;\n      this.inputBuffer.dispose();\n\n      for (const pass of this.passes) {\n        pass.setDepthTexture(null);\n      }\n    }\n  }\n  /**\r\n   * Creates a new render target by replicating the renderer's canvas.\r\n   *\r\n   * The created render target uses a linear filter for texel minification and\r\n   * magnification. Its render texture format depends on whether the renderer\r\n   * uses the alpha channel. Mipmaps are disabled.\r\n   *\r\n   * Note: The buffer format will also be set to RGBA if the frame buffer type\r\n   * is HalfFloatType because RGB16F buffers are not renderable.\r\n   *\r\n   * @param {Boolean} depthBuffer - Whether the render target should have a depth buffer.\r\n   * @param {Boolean} stencilBuffer - Whether the render target should have a stencil buffer.\r\n   * @param {Number} type - The frame buffer type.\r\n   * @param {Number} multisampling - The number of samples to use for antialiasing.\r\n   * @return {WebGLRenderTarget} A new render target that equals the renderer's canvas.\r\n   */\n\n\n  createBuffer(depthBuffer, stencilBuffer, type, multisampling) {\n    const size = this.renderer.getDrawingBufferSize(new Vector2$1());\n    const alpha = this.renderer.getContext().getContextAttributes().alpha;\n    const options = {\n      format: !alpha && type === UnsignedByteType ? RGBFormat : RGBAFormat,\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer,\n      depthBuffer,\n      type\n    };\n    const renderTarget = multisampling > 0 ? new WebGLMultisampleRenderTarget(size.width, size.height, options) : new WebGLRenderTarget(size.width, size.height, options);\n\n    if (multisampling > 0) {\n      renderTarget.samples = multisampling;\n    }\n\n    renderTarget.texture.name = \"EffectComposer.Buffer\";\n    renderTarget.texture.generateMipmaps = false;\n    return renderTarget;\n  }\n  /**\r\n   * Adds a pass, optionally at a specific index.\r\n   *\r\n   * @param {Pass} pass - A new pass.\r\n   * @param {Number} [index] - An index at which the pass should be inserted.\r\n   */\n\n\n  addPass(pass, index) {\n    const passes = this.passes;\n    const renderer = this.renderer;\n    const alpha = renderer.getContext().getContextAttributes().alpha;\n    const frameBufferType = this.inputBuffer.texture.type;\n    const drawingBufferSize = renderer.getDrawingBufferSize(new Vector2$1());\n    pass.setSize(drawingBufferSize.width, drawingBufferSize.height);\n    pass.initialize(renderer, alpha, frameBufferType);\n\n    if (this.autoRenderToScreen) {\n      if (passes.length > 0) {\n        passes[passes.length - 1].renderToScreen = false;\n      }\n\n      if (pass.renderToScreen) {\n        this.autoRenderToScreen = false;\n      }\n    }\n\n    if (index !== undefined) {\n      passes.splice(index, 0, pass);\n    } else {\n      passes.push(pass);\n    }\n\n    if (this.autoRenderToScreen) {\n      passes[passes.length - 1].renderToScreen = true;\n    }\n\n    if (pass.needsDepthTexture || this.depthTexture !== null) {\n      if (this.depthTexture === null) {\n        const depthTexture = this.createDepthTexture();\n\n        for (pass of passes) {\n          pass.setDepthTexture(depthTexture);\n        }\n      } else {\n        pass.setDepthTexture(this.depthTexture);\n      }\n    }\n  }\n  /**\r\n   * Removes a pass.\r\n   *\r\n   * @param {Pass} pass - The pass.\r\n   */\n\n\n  removePass(pass) {\n    const passes = this.passes;\n    const index = passes.indexOf(pass);\n    const removed = passes.splice(index, 1).length > 0;\n\n    if (removed) {\n      if (this.depthTexture !== null) {\n        // Check if the depth texture is still required.\n        const reducer = (a, b) => a || b.needsDepthTexture;\n\n        const depthTextureRequired = passes.reduce(reducer, false);\n\n        if (!depthTextureRequired) {\n          if (pass.getDepthTexture() === this.depthTexture) {\n            pass.setDepthTexture(null);\n          }\n\n          this.deleteDepthTexture();\n        }\n      }\n\n      if (this.autoRenderToScreen) {\n        // Check if the removed pass was the last one.\n        if (index === passes.length) {\n          pass.renderToScreen = false;\n\n          if (passes.length > 0) {\n            passes[passes.length - 1].renderToScreen = true;\n          }\n        }\n      }\n    }\n  }\n  /**\r\n   * Removes all passes without deleting them.\r\n   */\n\n\n  removeAllPasses() {\n    const passes = this.passes;\n    this.deleteDepthTexture();\n\n    if (passes.length > 0) {\n      if (this.autoRenderToScreen) {\n        passes[passes.length - 1].renderToScreen = false;\n      }\n\n      this.passes = [];\n    }\n  }\n  /**\r\n   * Renders all enabled passes in the order in which they were added.\r\n   *\r\n   * @param {Number} deltaTime - The time since the last frame in seconds.\r\n   */\n\n\n  render(deltaTime) {\n    const renderer = this.renderer;\n    const copyPass = this.copyPass;\n    let inputBuffer = this.inputBuffer;\n    let outputBuffer = this.outputBuffer;\n    let stencilTest = false;\n    let context, stencil, buffer;\n\n    for (const pass of this.passes) {\n      if (pass.enabled) {\n        pass.render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest);\n\n        if (pass.needsSwap) {\n          if (stencilTest) {\n            copyPass.renderToScreen = pass.renderToScreen;\n            context = renderer.getContext();\n            stencil = renderer.state.buffers.stencil; // Preserve the unaffected pixels.\n\n            stencil.setFunc(context.NOTEQUAL, 1, 0xffffffff);\n            copyPass.render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest);\n            stencil.setFunc(context.EQUAL, 1, 0xffffffff);\n          }\n\n          buffer = inputBuffer;\n          inputBuffer = outputBuffer;\n          outputBuffer = buffer;\n        }\n\n        if (pass instanceof MaskPass) {\n          stencilTest = true;\n        } else if (pass instanceof ClearMaskPass) {\n          stencilTest = false;\n        }\n      }\n    }\n  }\n  /**\r\n   * Sets the size of the buffers and the renderer's output canvas.\r\n   *\r\n   * Every pass will be informed of the new size. It's up to each pass how that\r\n   * information is used.\r\n   *\r\n   * If no width or height is specified, the render targets and passes will be\r\n   * updated with the current size of the renderer.\r\n   *\r\n   * @param {Number} [width] - The width.\r\n   * @param {Number} [height] - The height.\r\n   * @param {Boolean} [updateStyle] - Determines whether the style of the canvas should be updated.\r\n   */\n\n\n  setSize(width, height, updateStyle) {\n    const renderer = this.renderer;\n\n    if (width === undefined || height === undefined) {\n      const size = renderer.getSize(new Vector2$1());\n      width = size.width;\n      height = size.height;\n    } else {\n      // Update the logical render size.\n      renderer.setSize(width, height, updateStyle);\n    } // The drawing buffer size takes the device pixel ratio into account.\n\n\n    const drawingBufferSize = renderer.getDrawingBufferSize(new Vector2$1());\n    this.inputBuffer.setSize(drawingBufferSize.width, drawingBufferSize.height);\n    this.outputBuffer.setSize(drawingBufferSize.width, drawingBufferSize.height);\n\n    for (const pass of this.passes) {\n      pass.setSize(drawingBufferSize.width, drawingBufferSize.height);\n    }\n  }\n  /**\r\n   * Resets this composer by deleting all passes and creating new buffers.\r\n   */\n\n\n  reset() {\n    this.dispose();\n    this.autoRenderToScreen = true;\n  }\n  /**\r\n   * Disposes this composer and all passes.\r\n   */\n\n\n  dispose() {\n    for (const pass of this.passes) {\n      pass.dispose();\n    }\n\n    this.passes = [];\n\n    if (this.inputBuffer !== null) {\n      this.inputBuffer.dispose();\n    }\n\n    if (this.outputBuffer !== null) {\n      this.outputBuffer.dispose();\n    }\n\n    this.deleteDepthTexture();\n    this.copyPass.dispose();\n  }\n\n}\n/**\r\n * The initializable contract.\r\n *\r\n * Implemented by objects that can be initialized.\r\n *\r\n * @interface\r\n */\n\n\nclass Initializable {\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - A renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n  initialize(renderer, alpha, frameBufferType) {}\n\n}\n/**\r\n * The Resizable contract.\r\n *\r\n * Implemented by objects that can be resized.\r\n *\r\n * @interface\r\n */\n\n\nclass Resizable {\n  /**\r\n   * Sets the size of this object.\r\n   *\r\n   * @param {Number} width - The new width.\r\n   * @param {Number} height - The new height.\r\n   */\n  setSize(width, height) {}\n\n}\n/**\r\n * An object selection.\r\n *\r\n * Object selections use render layers to facilitate quick and efficient\r\n * visibility changes.\r\n */\n\n\nclass Selection extends Set {\n  /**\r\n   * Constructs a new selection.\r\n   *\r\n   * @param {Iterable<Object3D>} [iterable] - A collection of objects that should be added to this selection.\r\n   * @param {Number} [layer=10] - A dedicated render layer for selected objects.\r\n   */\n  constructor(iterable, layer = 10) {\n    super();\n    /**\r\n     * The current render layer for selected objects.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.currentLayer = layer;\n\n    if (iterable !== undefined) {\n      this.set(iterable);\n    }\n  }\n  /**\r\n   * A dedicated render layer for selected objects.\r\n   *\r\n   * This layer is set to 10 by default. If this collides with your own custom\r\n   * layers, please change it to a free layer before rendering!\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get layer() {\n    return this.currentLayer;\n  }\n  /**\r\n   * Sets the render layer of selected objects.\r\n   *\r\n   * The current selection will be updated accordingly.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set layer(value) {\n    const currentLayer = this.currentLayer;\n\n    for (const object of this) {\n      object.layers.disable(currentLayer);\n      object.layers.enable(value);\n    }\n\n    this.currentLayer = value;\n  }\n  /**\r\n   * Clears this selection.\r\n   *\r\n   * @return {Selection} This selection.\r\n   */\n\n\n  clear() {\n    const layer = this.layer;\n\n    for (const object of this) {\n      object.layers.disable(layer);\n    }\n\n    return super.clear();\n  }\n  /**\r\n   * Clears this selection and adds the given objects.\r\n   *\r\n   * @param {Iterable<Object3D>} objects - The objects that should be selected. This array will be copied.\r\n   * @return {Selection} This selection.\r\n   */\n\n\n  set(objects) {\n    this.clear();\n\n    for (const object of objects) {\n      this.add(object);\n    }\n\n    return this;\n  }\n  /**\r\n   * An alias for {@link has}.\r\n   *\r\n   * @param {Object3D} object - An object.\r\n   * @return {Number} Returns 0 if the given object is currently selected, or -1 otherwise.\r\n   * @deprecated Added for backward compatibility. Use has instead.\r\n   */\n\n\n  indexOf(object) {\n    return this.has(object) ? 0 : -1;\n  }\n  /**\r\n   * Adds an object to this selection.\r\n   *\r\n   * @param {Object3D} object - The object that should be selected.\r\n   * @return {Selection} This selection.\r\n   */\n\n\n  add(object) {\n    object.layers.enable(this.layer);\n    super.add(object);\n    return this;\n  }\n  /**\r\n   * Removes an object from this selection.\r\n   *\r\n   * @param {Object3D} object - The object that should be deselected.\r\n   * @return {Boolean} Returns true if an object has successfully been removed from this selection; otherwise false.\r\n   */\n\n\n  delete(object) {\n    if (this.has(object)) {\n      object.layers.disable(this.layer);\n    }\n\n    return super.delete(object);\n  }\n  /**\r\n   * Sets the visibility of all selected objects.\r\n   *\r\n   * This method enables or disables render layer 0 of all selected objects.\r\n   *\r\n   * @param {Boolean} visible - Whether the selected objects should be visible.\r\n   * @return {Selection} This selection.\r\n   */\n\n\n  setVisible(visible) {\n    for (const object of this) {\n      if (visible) {\n        object.layers.enable(0);\n      } else {\n        object.layers.disable(0);\n      }\n    }\n\n    return this;\n  }\n\n}\n\nvar fragmentShader$f = \"uniform sampler2D texture;uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(texture,uv)*intensity,0.0,1.0);}\";\n/**\r\n * A bloom effect.\r\n *\r\n * This effect uses the fast Kawase convolution technique and a luminance filter\r\n * to blur bright highlights.\r\n */\n\nclass BloomEffect extends Effect {\n  /**\r\n   * Constructs a new bloom effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n   * @param {Number} [options.luminanceThreshold=0.9] - The luminance threshold. Raise this value to mask out darker elements in the scene. Range is [0, 1].\r\n   * @param {Number} [options.luminanceSmoothing=0.025] - Controls the smoothness of the luminance threshold. Range is [0, 1].\r\n   * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n   * @param {Number} [options.intensity=1.0] - The intensity.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   * @param {KernelSize} [options.kernelSize=KernelSize.LARGE] - The blur kernel size.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.SCREEN,\n    luminanceThreshold = 0.9,\n    luminanceSmoothing = 0.025,\n    resolutionScale = 0.5,\n    intensity = 1.0,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    kernelSize = KernelSize.LARGE\n  } = {}) {\n    super(\"BloomEffect\", fragmentShader$f, {\n      blendFunction,\n      uniforms: new Map([[\"texture\", new Uniform(null)], [\"intensity\", new Uniform(intensity)]])\n    });\n    /**\r\n     * A render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTarget = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false\n    });\n    this.renderTarget.texture.name = \"Bloom.Target\";\n    this.renderTarget.texture.generateMipmaps = false;\n    this.uniforms.get(\"texture\").value = this.renderTarget.texture;\n    /**\r\n     * A blur pass.\r\n     *\r\n     * @type {BlurPass}\r\n     */\n\n    this.blurPass = new BlurPass({\n      resolutionScale,\n      width,\n      height,\n      kernelSize\n    });\n    this.blurPass.resolution.resizable = this;\n    /**\r\n     * A luminance shader pass.\r\n     *\r\n     * You may disable this pass to deactivate luminance filtering.\r\n     *\r\n     * @type {ShaderPass}\r\n     */\n\n    this.luminancePass = new ShaderPass(new LuminanceMaterial(true));\n    this.luminanceMaterial.threshold = luminanceThreshold;\n    this.luminanceMaterial.smoothing = luminanceSmoothing;\n  }\n  /**\r\n   * A texture that contains the intermediate result of this effect.\r\n   *\r\n   * This texture will be applied to the scene colors unless the blend function\r\n   * is set to `SKIP`.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTarget.texture;\n  }\n  /**\r\n   * The luminance material.\r\n   *\r\n   * @type {LuminanceMaterial}\r\n   */\n\n\n  get luminanceMaterial() {\n    return this.luminancePass.getFullscreenMaterial();\n  }\n  /**\r\n   * The resolution of this effect.\r\n   *\r\n   * @type {Resizer}\r\n   */\n\n\n  get resolution() {\n    return this.blurPass.resolution;\n  }\n  /**\r\n   * The current width of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  get width() {\n    return this.resolution.width;\n  }\n  /**\r\n   * Sets the render width.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  set width(value) {\n    this.resolution.width = value;\n  }\n  /**\r\n   * The current height of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  get height() {\n    return this.resolution.height;\n  }\n  /**\r\n   * Sets the render height.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  set height(value) {\n    this.resolution.height = value;\n  }\n  /**\r\n   * Indicates whether dithering is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  get dithering() {\n    return this.blurPass.dithering;\n  }\n  /**\r\n   * Enables or disables dithering.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  set dithering(value) {\n    this.blurPass.dithering = value;\n  }\n  /**\r\n   * The blur kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  get kernelSize() {\n    return this.blurPass.kernelSize;\n  }\n  /**\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  set kernelSize(value) {\n    this.blurPass.kernelSize = value;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated Use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\r\n   */\n\n\n  get distinction() {\n    console.warn(this.name, \"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\");\n    return 1.0;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated Use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\r\n   */\n\n\n  set distinction(value) {\n    console.warn(this.name, \"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\");\n  }\n  /**\r\n   * The bloom intensity.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get intensity() {\n    return this.uniforms.get(\"intensity\").value;\n  }\n  /**\r\n   * Sets the bloom intensity.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set intensity(value) {\n    this.uniforms.get(\"intensity\").value = value;\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolution.scale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolution.scale = scale;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const renderTarget = this.renderTarget;\n\n    if (this.luminancePass.enabled) {\n      this.luminancePass.render(renderer, inputBuffer, renderTarget);\n      this.blurPass.render(renderer, renderTarget, renderTarget);\n    } else {\n      this.blurPass.render(renderer, inputBuffer, renderTarget);\n    }\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.blurPass.setSize(width, height);\n    this.renderTarget.setSize(this.resolution.width, this.resolution.height);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    this.blurPass.initialize(renderer, alpha, frameBufferType);\n\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTarget.texture.format = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTarget.texture.type = frameBufferType;\n    }\n  }\n\n}\n\nvar fragmentShader$g = \"uniform float focus;uniform float dof;uniform float aperture;uniform float maxBlur;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec2 aspectCorrection=vec2(1.0,aspect);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nfloat focusNear=clamp(focus-dof,0.0,1.0);float focusFar=clamp(focus+dof,0.0,1.0);float low=step(linearDepth,focusNear);float high=step(focusFar,linearDepth);float factor=(linearDepth-focusNear)*low+(linearDepth-focusFar)*high;vec2 dofBlur=vec2(clamp(factor*aperture,-maxBlur,maxBlur));vec2 dofblur9=dofBlur*0.9;vec2 dofblur7=dofBlur*0.7;vec2 dofblur4=dofBlur*0.4;vec4 color=inputColor;color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur4);outputColor=color/41.0;}\";\n/**\r\n * A depth of field (bokeh) effect.\r\n *\r\n * Original shader code by Martins Upitis:\r\n *  http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html\r\n *\r\n * @deprecated Use DepthOfFieldEffect instead.\r\n */\n\nclass BokehEffect extends Effect {\n  /**\r\n   * Constructs a new bokeh effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.focus=0.5] - The focus distance ratio, ranging from 0.0 to 1.0.\r\n   * @param {Number} [options.dof=0.02] - Depth of field. An area in front of and behind the focal point that still appears sharp.\r\n   * @param {Number} [options.aperture=0.015] - Camera aperture scale. Bigger values for stronger blur and shallower depth of field.\r\n   * @param {Number} [options.maxBlur=1.0] - The maximum blur strength.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    focus = 0.5,\n    dof = 0.02,\n    aperture = 0.015,\n    maxBlur = 1.0\n  } = {}) {\n    super(\"BokehEffect\", fragmentShader$g, {\n      blendFunction,\n      attributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\n      uniforms: new Map([[\"focus\", new Uniform(focus)], [\"dof\", new Uniform(dof)], [\"aperture\", new Uniform(aperture)], [\"maxBlur\", new Uniform(maxBlur)]])\n    });\n  }\n\n}\n\nvar fragmentShader$h = \"uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}\";\n/**\r\n * A brightness/contrast effect.\r\n *\r\n * Reference: https://github.com/evanw/glfx.js\r\n */\n\nclass BrightnessContrastEffect extends Effect {\n  /**\r\n   * Constructs a new brightness/contrast effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.brightness=0.0] - The brightness factor, ranging from -1 to 1, where 0 means no change.\r\n   * @param {Number} [options.contrast=0.0] - The contrast factor, ranging from -1 to 1, where 0 means no change.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    brightness = 0.0,\n    contrast = 0.0\n  } = {}) {\n    super(\"BrightnessContrastEffect\", fragmentShader$h, {\n      blendFunction,\n      uniforms: new Map([[\"brightness\", new Uniform(brightness)], [\"contrast\", new Uniform(contrast)]])\n    });\n  }\n\n}\n\nvar fragmentShader$i = \"void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float sum=inputColor.r+inputColor.g+inputColor.b;outputColor=vec4(vec3(sum/3.0),inputColor.a);}\";\n/**\r\n * A color average effect.\r\n */\n\nclass ColorAverageEffect extends Effect {\n  /**\r\n   * Constructs a new color average effect.\r\n   *\r\n   * @param {BlendFunction} [blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   */\n  constructor(blendFunction = BlendFunction.NORMAL) {\n    super(\"ColorAverageEffect\", fragmentShader$i, {\n      blendFunction\n    });\n  }\n\n}\n\nvar fragmentShader$j = \"uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}\";\n/**\r\n * A color depth effect.\r\n *\r\n * Simulates a hardware limitation to achieve a retro feel.\r\n */\n\nclass ColorDepthEffect extends Effect {\n  /**\r\n   * Constructs a new color depth effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.bits=16] - The color bit depth.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    bits = 16\n  } = {}) {\n    super(\"ColorDepthEffect\", fragmentShader$j, {\n      blendFunction,\n      uniforms: new Map([[\"factor\", new Uniform(1.0)]])\n    });\n    /**\r\n     * The current amount of bits.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.bits = 0;\n    this.setBitDepth(bits);\n  }\n  /**\r\n   * Returns the current color bit depth.\r\n   *\r\n   * @return {Number} The color bit depth.\r\n   */\n\n\n  getBitDepth() {\n    return this.bits;\n  }\n  /**\r\n   * Sets the virtual amount of color bits.\r\n   *\r\n   * Each color channel will use a third of the available bits. The alpha\r\n   * channel remains unaffected.\r\n   *\r\n   * Note that the real color depth will not be altered by this effect.\r\n   *\r\n   * @param {Number} bits - The new color bit depth.\r\n   */\n\n\n  setBitDepth(bits) {\n    this.bits = bits;\n    this.uniforms.get(\"factor\").value = Math.pow(2.0, bits / 3.0);\n  }\n\n}\n\nvar fragmentShader$k = \"varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 color=inputColor;\\n#ifdef ALPHA\\nvec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;color.r=ra.x;color.b=ba.x;color.a=max(max(ra.y,ba.y),inputColor.a);\\n#else\\ncolor.r=texture2D(inputBuffer,vUvR).r;color.b=texture2D(inputBuffer,vUvB).b;\\n#endif\\noutputColor=color;}\";\nvar vertexShader$8 = \"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vUvR=uv+offset;vUvB=uv-offset;}\";\n/**\r\n * A chromatic aberration effect.\r\n */\n\nclass ChromaticAberrationEffect extends Effect {\n  /**\r\n   * Constructs a new chromatic aberration effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Vector2} [options.offset] - The color offset.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    offset = new Vector2$1(0.001, 0.0005)\n  } = {}) {\n    super(\"ChromaticAberrationEffect\", fragmentShader$k, {\n      vertexShader: vertexShader$8,\n      blendFunction,\n      attributes: EffectAttribute.CONVOLUTION,\n      uniforms: new Map([[\"offset\", new Uniform(offset)]])\n    });\n  }\n  /**\r\n   * The color offset.\r\n   *\r\n   * @type {Vector2}\r\n   */\n\n\n  get offset() {\n    return this.uniforms.get(\"offset\").value;\n  }\n  /**\r\n   * @type {Vector2}\r\n   */\n\n\n  set offset(value) {\n    this.uniforms.get(\"offset\").value = value;\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    if (alpha) {\n      this.defines.set(\"ALPHA\", \"1\");\n    } else {\n      this.defines.delete(\"ALPHA\");\n    }\n  }\n\n}\n\nvar fragmentShader$l = \"void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\\n#ifdef INVERTED\\nvec3 color=vec3(1.0-depth);\\n#else\\nvec3 color=vec3(depth);\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n/**\r\n * A depth visualization effect.\r\n *\r\n * Useful for debugging.\r\n */\n\nclass DepthEffect extends Effect {\n  /**\r\n   * Constructs a new depth effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Boolean} [options.inverted=false] - Whether the depth values should be inverted.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    inverted = false\n  } = {}) {\n    super(\"DepthEffect\", fragmentShader$l, {\n      blendFunction,\n      attributes: EffectAttribute.DEPTH\n    });\n    this.inverted = inverted;\n  }\n  /**\r\n   * Indicates whether depth should be inverted.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get inverted() {\n    return this.defines.has(\"INVERTED\");\n  }\n  /**\r\n   * Enables or disables depth inversion.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set inverted(value) {\n    if (this.inverted !== value) {\n      if (value) {\n        this.defines.set(\"INVERTED\", \"1\");\n      } else {\n        this.defines.delete(\"INVERTED\");\n      }\n\n      this.setChanged();\n    }\n  }\n\n}\n\nvar fragmentShader$m = \"uniform sampler2D nearColorBuffer;uniform sampler2D farColorBuffer;uniform sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}\";\n/**\r\n * A depth of field effect.\r\n *\r\n * Based on a graphics study by Adrian CourrÃ¨ges and an article by Steve Avery:\r\n *  https://www.adriancourreges.com/blog/2016/09/09/doom-2016-graphics-study/\r\n *  https://pixelmischiefblog.wordpress.com/2016/11/25/bokeh-depth-of-field/\r\n */\n\nclass DepthOfFieldEffect extends Effect {\n  /**\r\n   * Constructs a new depth of field effect.\r\n   *\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.focusDistance=0.0] - The normalized focus distance. Range is [0.0, 1.0].\r\n   * @param {Number} [options.focalLength=0.05] - The focal length. Range is [0.0, 1.0].\r\n   * @param {Number} [options.bokehScale=1.0] - The scale of the bokeh blur.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   */\n  constructor(camera, {\n    blendFunction = BlendFunction.NORMAL,\n    focusDistance = 0.0,\n    focalLength = 0.1,\n    bokehScale = 1.0,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE\n  } = {}) {\n    super(\"DepthOfFieldEffect\", fragmentShader$m, {\n      blendFunction,\n      attributes: EffectAttribute.DEPTH,\n      uniforms: new Map([[\"nearColorBuffer\", new Uniform(null)], [\"farColorBuffer\", new Uniform(null)], [\"nearCoCBuffer\", new Uniform(null)], [\"scale\", new Uniform(1.0)]])\n    });\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * A render target for intermediate results.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTarget = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false\n    });\n    this.renderTarget.texture.name = \"DoF.Intermediate\";\n    this.renderTarget.texture.generateMipmaps = false;\n    /**\r\n     * A render target for masked background colors (premultiplied with CoC).\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetMasked = this.renderTarget.clone();\n    this.renderTargetMasked.texture.name = \"DoF.Masked.Far\";\n    /**\r\n     * A render target for the blurred foreground colors.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetNear = this.renderTarget.clone();\n    this.renderTargetNear.texture.name = \"DoF.Bokeh.Near\";\n    this.uniforms.get(\"nearColorBuffer\").value = this.renderTargetNear.texture;\n    /**\r\n     * A render target for the blurred background colors.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetFar = this.renderTarget.clone();\n    this.renderTargetFar.texture.name = \"DoF.Bokeh.Far\";\n    this.uniforms.get(\"farColorBuffer\").value = this.renderTargetFar.texture;\n    /**\r\n     * A render target for the circle of confusion.\r\n     *\r\n     * - Negative values are stored in the `RED` channel (foreground).\r\n     * - Positive values are stored in the `GREEN` channel (background).\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetCoC = this.renderTarget.clone();\n    this.renderTargetCoC.texture.format = RGBFormat;\n    this.renderTargetCoC.texture.name = \"DoF.CoC\";\n    /**\r\n     * A render target that stores a blurred copy of the circle of confusion.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetCoCBlurred = this.renderTargetCoC.clone();\n    this.renderTargetCoCBlurred.texture.name = \"DoF.CoC.Blurred\";\n    this.uniforms.get(\"nearCoCBuffer\").value = this.renderTargetCoCBlurred.texture;\n    /**\r\n     * A circle of confusion pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.cocPass = new ShaderPass(new CircleOfConfusionMaterial(camera));\n    const cocMaterial = this.circleOfConfusionMaterial;\n    cocMaterial.uniforms.focusDistance.value = focusDistance;\n    cocMaterial.uniforms.focalLength.value = focalLength;\n    /**\r\n     * This pass blurs the foreground CoC buffer to soften edges.\r\n     *\r\n     * @type {BlurPass}\r\n     */\n\n    this.blurPass = new BlurPass({\n      width,\n      height,\n      kernelSize: KernelSize.MEDIUM\n    });\n    this.blurPass.resolution.resizable = this;\n    /**\r\n     * A mask pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.maskPass = new ShaderPass(new MaskMaterial(this.renderTargetCoC.texture));\n    const maskMaterial = this.maskPass.getFullscreenMaterial();\n    maskMaterial.maskFunction = MaskFunction.MULTIPLY_RGB_SET_ALPHA;\n    maskMaterial.colorChannel = ColorChannel.GREEN;\n    /**\r\n     * A bokeh blur pass for the foreground colors.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.bokehNearBasePass = new ShaderPass(new BokehMaterial(false, true));\n    /**\r\n     * A bokeh fill pass for the foreground colors.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.bokehNearFillPass = new ShaderPass(new BokehMaterial(true, true));\n    /**\r\n     * A bokeh blur pass for the background colors.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.bokehFarBasePass = new ShaderPass(new BokehMaterial(false, false));\n    /**\r\n     * A bokeh fill pass for the background colors.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.bokehFarFillPass = new ShaderPass(new BokehMaterial(true, false));\n    this.bokehScale = bokehScale;\n    /**\r\n     * A target position that should be kept in focus.\r\n     *\r\n     * Set this to `null` to disable auto focus.\r\n     *\r\n     * @type {Vector3}\r\n     */\n\n    this.target = null;\n  }\n  /**\r\n   * The circle of confusion material.\r\n   *\r\n   * @type {CircleOfConfusionMaterial}\r\n   */\n\n\n  get circleOfConfusionMaterial() {\n    return this.cocPass.getFullscreenMaterial();\n  }\n  /**\r\n   * The resolution of this effect.\r\n   *\r\n   * @type {Resizer}\r\n   */\n\n\n  get resolution() {\n    return this.blurPass.resolution;\n  }\n  /**\r\n   * The current bokeh scale.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get bokehScale() {\n    return this.uniforms.get(\"scale\").value;\n  }\n  /**\r\n   * Sets the bokeh scale.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set bokehScale(value) {\n    const passes = [this.bokehNearBasePass, this.bokehNearFillPass, this.bokehFarBasePass, this.bokehFarFillPass];\n    passes.map(p => p.getFullscreenMaterial().uniforms.scale).forEach(u => {\n      u.value = value;\n    });\n    this.maskPass.getFullscreenMaterial().uniforms.strength.value = value;\n    this.uniforms.get(\"scale\").value = value;\n  }\n  /**\r\n   * Calculates the focus distance from the camera to the given position.\r\n   *\r\n   * @param {Vector3} target - The target.\r\n   * @return {Number} The normalized focus distance.\r\n   */\n\n\n  calculateFocusDistance(target) {\n    const camera = this.camera;\n    const viewDistance = camera.far - camera.near;\n    const distance = camera.position.distanceTo(target);\n    return Math.min(Math.max(distance / viewDistance, 0.0), 1.0);\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.circleOfConfusionMaterial;\n    material.uniforms.depthBuffer.value = depthTexture;\n    material.depthPacking = depthPacking;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const renderTarget = this.renderTarget;\n    const renderTargetCoC = this.renderTargetCoC;\n    const renderTargetCoCBlurred = this.renderTargetCoCBlurred;\n    const renderTargetMasked = this.renderTargetMasked;\n    const bokehFarBasePass = this.bokehFarBasePass;\n    const bokehFarFillPass = this.bokehFarFillPass;\n    const farBaseUniforms = bokehFarBasePass.getFullscreenMaterial().uniforms;\n    const farFillUniforms = bokehFarFillPass.getFullscreenMaterial().uniforms;\n    const bokehNearBasePass = this.bokehNearBasePass;\n    const bokehNearFillPass = this.bokehNearFillPass;\n    const nearBaseUniforms = bokehNearBasePass.getFullscreenMaterial().uniforms;\n    const nearFillUniforms = bokehNearFillPass.getFullscreenMaterial().uniforms; // Auto focus.\n\n    if (this.target !== null) {\n      const distance = this.calculateFocusDistance(this.target);\n      this.circleOfConfusionMaterial.uniforms.focusDistance.value = distance;\n    } // Render the CoC and create a blurred version for soft near field blending.\n\n\n    this.cocPass.render(renderer, null, renderTargetCoC);\n    this.blurPass.render(renderer, renderTargetCoC, renderTargetCoCBlurred); // Prevent sharp colors from bleeding onto the background.\n\n    this.maskPass.render(renderer, inputBuffer, renderTargetMasked); // Use the sharp CoC buffer and render the background bokeh.\n\n    farBaseUniforms.cocBuffer.value = farFillUniforms.cocBuffer.value = renderTargetCoC.texture;\n    bokehFarBasePass.render(renderer, renderTargetMasked, renderTarget);\n    bokehFarFillPass.render(renderer, renderTarget, this.renderTargetFar); // Use the blurred CoC buffer and render the foreground bokeh.\n\n    nearBaseUniforms.cocBuffer.value = nearFillUniforms.cocBuffer.value = renderTargetCoCBlurred.texture;\n    bokehNearBasePass.render(renderer, inputBuffer, renderTarget);\n    bokehNearFillPass.render(renderer, renderTarget, this.renderTargetNear);\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    let resizables = [this.cocPass, this.blurPass, this.maskPass, this.bokehNearBasePass, this.bokehNearFillPass, this.bokehFarBasePass, this.bokehFarFillPass]; // These buffers require full resolution to prevent bleeding artifacts.\n\n    resizables.push(this.renderTargetCoC, this.renderTargetMasked);\n    resizables.forEach(r => r.setSize(width, height));\n    const w = resolution.width;\n    const h = resolution.height;\n    resizables = [this.renderTarget, this.renderTargetNear, this.renderTargetFar, this.renderTargetCoCBlurred];\n    resizables.forEach(r => r.setSize(w, h)); // The bokeh blur passes operate on the low resolution buffers.\n\n    const passes = [this.bokehNearBasePass, this.bokehNearFillPass, this.bokehFarBasePass, this.bokehFarFillPass];\n    passes.forEach(p => p.getFullscreenMaterial().setTexelSize(1.0 / w, 1.0 / h));\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    const initializables = [this.cocPass, this.maskPass, this.bokehNearBasePass, this.bokehNearFillPass, this.bokehFarBasePass, this.bokehFarFillPass];\n    initializables.forEach(i => i.initialize(renderer, alpha, frameBufferType)); // The blur pass operates on the CoC buffer.\n\n    this.blurPass.initialize(renderer, alpha, UnsignedByteType);\n\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTargetNear.texture.type = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTarget.texture.type = frameBufferType;\n      this.renderTargetNear.texture.type = frameBufferType;\n      this.renderTargetFar.texture.type = frameBufferType;\n      this.renderTargetMasked.texture.type = frameBufferType;\n    }\n  }\n\n}\n\nvar fragmentShader$n = \"uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}\";\n/**\r\n * A dot screen effect.\r\n */\n\nclass DotScreenEffect extends Effect {\n  /**\r\n   * Constructs a new dot screen effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.angle=1.57] - The angle of the dot pattern.\r\n   * @param {Number} [options.scale=1.0] - The scale of the dot pattern.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    angle = Math.PI * 0.5,\n    scale = 1.0\n  } = {}) {\n    super(\"DotScreenEffect\", fragmentShader$n, {\n      blendFunction,\n      uniforms: new Map([[\"angle\", new Uniform(new Vector2$1())], [\"scale\", new Uniform(scale)]])\n    });\n    this.setAngle(angle);\n  }\n  /**\r\n   * Sets the pattern angle.\r\n   *\r\n   * @param {Number} [angle] - The angle of the dot pattern.\r\n   */\n\n\n  setAngle(angle) {\n    this.uniforms.get(\"angle\").value.set(Math.sin(angle), Math.cos(angle));\n  }\n\n}\n\nvar fragmentShader$o = \"uniform float gamma;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=LinearToGamma(max(inputColor,0.0),gamma);}\";\n/**\r\n * A gamma correction effect.\r\n *\r\n * @deprecated Set WebGLRenderer.outputEncoding to sRGBEncoding or GammaEncoding instead.\r\n */\n\nclass GammaCorrectionEffect extends Effect {\n  /**\r\n   * Constructs a new gamma correction effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.gamma=2.0] - The gamma factor.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    gamma = 2.0\n  } = {}) {\n    super(\"GammaCorrectionEffect\", fragmentShader$o, {\n      blendFunction,\n      uniforms: new Map([[\"gamma\", new Uniform(gamma)]])\n    });\n  }\n\n}\n/**\r\n * Generates noise.\r\n *\r\n * @private\r\n * @param {Number} size - The linear texture size.\r\n * @param {Number} format - The texture format.\r\n * @param {Number} type - The texture type.\r\n * @return {TypedArray} The noise data.\r\n */\n\n\nfunction getNoise(size, format, type) {\n  const channels = new Map([[LuminanceFormat, 1], [RedFormat, 1], [RGFormat, 2], [RGBFormat, 3], [RGBAFormat, 4]]);\n  let data;\n\n  if (!channels.has(format)) {\n    console.error(\"Invalid noise texture format\");\n  }\n\n  if (type === UnsignedByteType) {\n    data = new Uint8Array(size * channels.get(format));\n\n    for (let i = 0, l = data.length; i < l; ++i) {\n      data[i] = Math.random() * 255;\n    }\n  } else {\n    data = new Float32Array(size * channels.get(format));\n\n    for (let i = 0, l = data.length; i < l; ++i) {\n      data[i] = Math.random();\n    }\n  }\n\n  return data;\n}\n/**\r\n * A simple noise texture.\r\n */\n\n\nclass NoiseTexture extends DataTexture {\n  /**\r\n   * Constructs a new noise texture.\r\n   *\r\n   * The texture format can be either `LuminanceFormat`, `RGBFormat` or\r\n   * `RGBAFormat`. Additionally, the formats `RedFormat` and `RGFormat` can be\r\n   * used in a WebGL 2 context.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   * @param {Number} [format=LuminanceFormat] - The texture format.\r\n   * @param {Number} [type=UnsignedByteType] - The texture type.\r\n   */\n  constructor(width, height, format = LuminanceFormat, type = UnsignedByteType) {\n    super(getNoise(width * height, format, type), width, height, format, type);\n  }\n\n}\n\nvar fragmentShader$p = \"uniform sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seed;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seed.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seed.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}vec2 normal=texture2D(perturbationMap,uv*random*random).rg;uv+=normal*seed*(random*0.2);}}\";\n/**\r\n * A label for generated data textures.\r\n *\r\n * @type {String}\r\n * @private\r\n */\n\nconst tag = \"Glitch.Generated\";\n/**\r\n * Returns a random float in the specified range.\r\n *\r\n * @private\r\n * @param {Number} low - The lowest possible value.\r\n * @param {Number} high - The highest possible value.\r\n * @return {Number} The random value.\r\n */\n\nfunction randomFloat(low, high) {\n  return low + Math.random() * (high - low);\n}\n/**\r\n * A glitch effect.\r\n *\r\n * This effect can influence the {@link ChromaticAberrationEffect}.\r\n *\r\n * Reference: https://github.com/staffantan/unityglitch\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\n\n\nclass GlitchEffect extends Effect {\n  /**\r\n   * Constructs a new glitch effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Vector2} [options.chromaticAberrationOffset] - A chromatic aberration offset. If provided, the glitch effect will influence this offset.\r\n   * @param {Vector2} [options.delay] - The minimum and maximum delay between glitch activations in seconds.\r\n   * @param {Vector2} [options.duration] - The minimum and maximum duration of a glitch in seconds.\r\n   * @param {Vector2} [options.strength] - The strength of weak and strong glitches.\r\n   * @param {Texture} [options.perturbationMap] - A perturbation map. If none is provided, a noise texture will be created.\r\n   * @param {Number} [options.dtSize=64] - The size of the generated noise map. Will be ignored if a perturbation map is provided.\r\n   * @param {Number} [options.columns=0.05] - The scale of the blocky glitch columns.\r\n   * @param {Number} [options.ratio=0.85] - The threshold for strong glitches.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    chromaticAberrationOffset = null,\n    delay = new Vector2$1(1.5, 3.5),\n    duration = new Vector2$1(0.6, 1.0),\n    strength = new Vector2$1(0.3, 1.0),\n    columns = 0.05,\n    ratio = 0.85,\n    perturbationMap = null,\n    dtSize = 64\n  } = {}) {\n    super(\"GlitchEffect\", fragmentShader$p, {\n      blendFunction,\n      uniforms: new Map([[\"perturbationMap\", new Uniform(null)], [\"columns\", new Uniform(columns)], [\"active\", new Uniform(false)], [\"random\", new Uniform(1.0)], [\"seed\", new Uniform(new Vector2$1())], [\"distortion\", new Uniform(new Vector2$1())]])\n    });\n    this.setPerturbationMap(perturbationMap === null ? this.generatePerturbationMap(dtSize) : perturbationMap);\n    /**\r\n     * The minimum and maximum delay between glitch activations in seconds.\r\n     *\r\n     * @type {Vector2}\r\n     */\n\n    this.delay = delay;\n    /**\r\n     * The minimum and maximum duration of a glitch in seconds.\r\n     *\r\n     * @type {Vector2}\r\n     */\n\n    this.duration = duration;\n    /**\r\n     * A random glitch break point.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.breakPoint = new Vector2$1(randomFloat(this.delay.x, this.delay.y), randomFloat(this.duration.x, this.duration.y));\n    /**\r\n     * A time accumulator.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.time = 0;\n    /**\r\n     * Random seeds.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.seed = this.uniforms.get(\"seed\").value;\n    /**\r\n     * A distortion vector.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.distortion = this.uniforms.get(\"distortion\").value;\n    /**\r\n     * The effect mode.\r\n     *\r\n     * @type {GlitchMode}\r\n     */\n\n    this.mode = GlitchMode.SPORADIC;\n    /**\r\n     * The strength of weak and strong glitches.\r\n     *\r\n     * @type {Vector2}\r\n     */\n\n    this.strength = strength;\n    /**\r\n     * The threshold for strong glitches, ranging from 0 to 1 where 0 means no\r\n     * weak glitches and 1 means no strong ones. The default ratio of 0.85\r\n     * offers a decent balance.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.ratio = ratio;\n    /**\r\n     * The chromatic aberration offset.\r\n     *\r\n     * @type {Vector2}\r\n     */\n\n    this.chromaticAberrationOffset = chromaticAberrationOffset;\n  }\n  /**\r\n   * Indicates whether the glitch effect is currently active.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get active() {\n    return this.uniforms.get(\"active\").value;\n  }\n  /**\r\n   * Returns the current perturbation map.\r\n   *\r\n   * @return {Texture} The current perturbation map.\r\n   */\n\n\n  getPerturbationMap() {\n    return this.uniforms.get(\"perturbationMap\").value;\n  }\n  /**\r\n   * Replaces the current perturbation map with the given one.\r\n   *\r\n   * The current map will be disposed if it was generated by this effect.\r\n   *\r\n   * @param {Texture} map - The new perturbation map.\r\n   */\n\n\n  setPerturbationMap(map) {\n    const currentMap = this.getPerturbationMap();\n\n    if (currentMap !== null && currentMap.name === tag) {\n      currentMap.dispose();\n    }\n\n    map.minFilter = map.magFilter = NearestFilter;\n    map.wrapS = map.wrapT = RepeatWrapping;\n    map.generateMipmaps = false;\n    this.uniforms.get(\"perturbationMap\").value = map;\n  }\n  /**\r\n   * Generates a perturbation map.\r\n   *\r\n   * @param {Number} [size=64] - The texture size.\r\n   * @return {DataTexture} The perturbation map.\r\n   */\n\n\n  generatePerturbationMap(size = 64) {\n    const map = new NoiseTexture(size, size, RGBFormat);\n    map.name = tag;\n    return map;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const mode = this.mode;\n    const breakPoint = this.breakPoint;\n    const offset = this.chromaticAberrationOffset;\n    const s = this.strength;\n    let time = this.time;\n    let active = false;\n    let r = 0.0,\n        a = 0.0;\n    let trigger;\n\n    if (mode !== GlitchMode.DISABLED) {\n      if (mode === GlitchMode.SPORADIC) {\n        time += deltaTime;\n        trigger = time > breakPoint.x;\n\n        if (time >= breakPoint.x + breakPoint.y) {\n          breakPoint.set(randomFloat(this.delay.x, this.delay.y), randomFloat(this.duration.x, this.duration.y));\n          time = 0;\n        }\n      }\n\n      r = Math.random();\n      this.uniforms.get(\"random\").value = r;\n\n      if (trigger && r > this.ratio || mode === GlitchMode.CONSTANT_WILD) {\n        active = true;\n        r *= s.y * 0.03;\n        a = randomFloat(-Math.PI, Math.PI);\n        this.seed.set(randomFloat(-s.y, s.y), randomFloat(-s.y, s.y));\n        this.distortion.set(randomFloat(0.0, 1.0), randomFloat(0.0, 1.0));\n      } else if (trigger || mode === GlitchMode.CONSTANT_MILD) {\n        active = true;\n        r *= s.x * 0.03;\n        a = randomFloat(-Math.PI, Math.PI);\n        this.seed.set(randomFloat(-s.x, s.x), randomFloat(-s.x, s.x));\n        this.distortion.set(randomFloat(0.0, 1.0), randomFloat(0.0, 1.0));\n      }\n\n      this.time = time;\n    }\n\n    if (offset !== null) {\n      if (active) {\n        offset.set(Math.cos(a), Math.sin(a)).multiplyScalar(r);\n      } else {\n        offset.set(0.0, 0.0);\n      }\n    }\n\n    this.uniforms.get(\"active\").value = active;\n  }\n\n}\n/**\r\n * A glitch mode enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISABLED - No glitches.\r\n * @property {Number} SPORADIC - Sporadic glitches.\r\n * @property {Number} CONSTANT_MILD - Constant mild glitches.\r\n * @property {Number} CONSTANT_WILD - Constant wild glitches.\r\n */\n\n\nconst GlitchMode = {\n  DISABLED: 0,\n  SPORADIC: 1,\n  CONSTANT_MILD: 2,\n  CONSTANT_WILD: 3\n};\nvar fragmentShader$q = \"uniform sampler2D texture;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(texture,uv);}\";\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\n\nconst v = new Vector3();\n/**\r\n * A matrix.\r\n *\r\n * @type {Matrix4}\r\n * @private\r\n */\n\nconst m = new Matrix4();\n/**\r\n * A god rays effect.\r\n */\n\nclass GodRaysEffect extends Effect {\n  /**\r\n   * Constructs a new god rays effect.\r\n   *\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Mesh|Points} lightSource - The light source. Must not write depth and has to be flagged as transparent.\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n   * @param {Number} [options.samples=60.0] - The number of samples per pixel.\r\n   * @param {Number} [options.density=0.96] - The density of the light rays.\r\n   * @param {Number} [options.decay=0.9] - An illumination decay factor.\r\n   * @param {Number} [options.weight=0.4] - A light ray weight factor.\r\n   * @param {Number} [options.exposure=0.6] - A constant attenuation coefficient.\r\n   * @param {Number} [options.clampMax=1.0] - An upper bound for the saturation of the overall effect.\r\n   * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   * @param {KernelSize} [options.kernelSize=KernelSize.SMALL] - The blur kernel size. Has no effect if blur is disabled.\r\n   * @param {Boolean} [options.blur=true] - Whether the god rays should be blurred to reduce artifacts.\r\n   */\n  constructor(camera, lightSource, {\n    blendFunction = BlendFunction.SCREEN,\n    samples = 60.0,\n    density = 0.96,\n    decay = 0.9,\n    weight = 0.4,\n    exposure = 0.6,\n    clampMax = 1.0,\n    resolutionScale = 0.5,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    kernelSize = KernelSize.SMALL,\n    blur = true\n  } = {}) {\n    super(\"GodRaysEffect\", fragmentShader$q, {\n      blendFunction,\n      attributes: EffectAttribute.DEPTH,\n      uniforms: new Map([[\"texture\", new Uniform(null)]])\n    });\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * The light source.\r\n     *\r\n     * @type {Mesh|Points}\r\n     * @private\r\n     */\n\n    this.lightSource = lightSource;\n    this.lightSource.material.depthWrite = false;\n    this.lightSource.material.transparent = true;\n    /**\r\n     * A scene that only contains the light source.\r\n     *\r\n     * @type {Scene}\r\n     * @private\r\n     */\n\n    this.lightScene = new Scene();\n    /**\r\n     * The light position in screen space.\r\n     *\r\n     * @type {Vector3}\r\n     * @private\r\n     */\n\n    this.screenPosition = new Vector2$1();\n    /**\r\n     * A render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetA = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false\n    });\n    this.renderTargetA.texture.name = \"GodRays.Target.A\";\n    /**\r\n     * A render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetB = this.renderTargetA.clone();\n    this.renderTargetB.texture.name = \"GodRays.Target.B\";\n    this.uniforms.get(\"texture\").value = this.renderTargetB.texture;\n    /**\r\n     * A render target for the light scene.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetLight = this.renderTargetA.clone();\n    this.renderTargetLight.texture.name = \"GodRays.Light\";\n    this.renderTargetLight.depthBuffer = true;\n    this.renderTargetLight.depthTexture = new DepthTexture();\n    /**\r\n     * A pass that only renders the light source.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.renderPassLight = new RenderPass(this.lightScene, camera);\n    this.renderPassLight.getClearPass().overrideClearColor = new Color(0x000000);\n    /**\r\n     * A clear pass.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass(true, false, false);\n    this.clearPass.overrideClearColor = new Color(0x000000);\n    /**\r\n     * A blur pass that reduces aliasing artifacts and makes the light softer.\r\n     *\r\n     * Disable this pass to improve performance.\r\n     *\r\n     * @type {BlurPass}\r\n     */\n\n    this.blurPass = new BlurPass({\n      resolutionScale,\n      width,\n      height,\n      kernelSize\n    });\n    this.blurPass.resolution.resizable = this;\n    /**\r\n     * A depth mask pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.depthMaskPass = new ShaderPass((depthTexture => {\n      const material = new DepthMaskMaterial();\n      material.uniforms.depthBuffer1.value = depthTexture;\n      return material;\n    })(this.renderTargetLight.depthTexture));\n    /**\r\n     * A god rays blur pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.godRaysPass = new ShaderPass((() => {\n      const material = new GodRaysMaterial(this.screenPosition);\n      material.uniforms.density.value = density;\n      material.uniforms.decay.value = decay;\n      material.uniforms.weight.value = weight;\n      material.uniforms.exposure.value = exposure;\n      material.uniforms.clampMax.value = clampMax;\n      return material;\n    })());\n    this.samples = samples;\n    this.blur = blur;\n  }\n  /**\r\n   * A texture that contains the intermediate result of this effect.\r\n   *\r\n   * This texture will be applied to the scene colors unless the blend function\r\n   * is set to `SKIP`.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.renderTargetB.texture;\n  }\n  /**\r\n   * The internal god rays material.\r\n   *\r\n   * @type {GodRaysMaterial}\r\n   */\n\n\n  get godRaysMaterial() {\n    return this.godRaysPass.getFullscreenMaterial();\n  }\n  /**\r\n   * The resolution of this effect.\r\n   *\r\n   * @type {Resizer}\r\n   */\n\n\n  get resolution() {\n    return this.blurPass.resolution;\n  }\n  /**\r\n   * The current width of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  get width() {\n    return this.resolution.width;\n  }\n  /**\r\n   * Sets the render width.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  set width(value) {\n    this.resolution.width = value;\n  }\n  /**\r\n   * The current height of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  get height() {\n    return this.resolution.height;\n  }\n  /**\r\n   * Sets the render height.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  set height(value) {\n    this.resolution.height = value;\n  }\n  /**\r\n   * Indicates whether dithering is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  get dithering() {\n    return this.godRaysMaterial.dithering;\n  }\n  /**\r\n   * Enables or disables dithering.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  set dithering(value) {\n    const material = this.godRaysMaterial;\n    material.dithering = value;\n    material.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether the god rays should be blurred to reduce artifacts.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get blur() {\n    return this.blurPass.enabled;\n  }\n  /**\r\n   * @type {Boolean}\r\n   */\n\n\n  set blur(value) {\n    this.blurPass.enabled = value;\n  }\n  /**\r\n   * The blur kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  get kernelSize() {\n    return this.blurPass.kernelSize;\n  }\n  /**\r\n   * Sets the blur kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  set kernelSize(value) {\n    this.blurPass.kernelSize = value;\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolution.scale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolution.scale = scale;\n  }\n  /**\r\n   * The number of samples per pixel.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get samples() {\n    return this.godRaysMaterial.samples;\n  }\n  /**\r\n   * A higher sample count improves quality at the cost of performance.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set samples(value) {\n    this.godRaysMaterial.samples = value;\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.depthMaskPass.getFullscreenMaterial();\n    material.uniforms.depthBuffer0.value = depthTexture;\n    material.defines.DEPTH_PACKING_0 = depthPacking.toFixed(0);\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const lightSource = this.lightSource;\n    const parent = lightSource.parent;\n    const matrixAutoUpdate = lightSource.matrixAutoUpdate;\n    const renderTargetA = this.renderTargetA;\n    const renderTargetLight = this.renderTargetLight; // Enable depth write for the light scene render pass.\n\n    lightSource.material.depthWrite = true; // Update the world matrix.\n\n    lightSource.matrixAutoUpdate = false;\n    lightSource.updateWorldMatrix(true, false);\n\n    if (parent !== null) {\n      if (!matrixAutoUpdate) {\n        // Remember the local transformation to restore it later.\n        m.copy(lightSource.matrix);\n      } // Apply parent transformations.\n\n\n      lightSource.matrix.copy(lightSource.matrixWorld);\n    } // Render the light source and mask it based on depth.\n\n\n    this.lightScene.add(lightSource);\n    this.renderPassLight.render(renderer, renderTargetLight);\n    this.clearPass.render(renderer, renderTargetA);\n    this.depthMaskPass.render(renderer, renderTargetLight, renderTargetA); // Restore the original values.\n\n    lightSource.material.depthWrite = false;\n    lightSource.matrixAutoUpdate = matrixAutoUpdate;\n\n    if (parent !== null) {\n      if (!matrixAutoUpdate) {\n        lightSource.matrix.copy(m);\n      }\n\n      parent.add(lightSource);\n    } // Calculate the screen light position.\n\n\n    v.setFromMatrixPosition(lightSource.matrixWorld).project(this.camera); // Translate to [0.0, 1.0] and clamp to screen with a bias of 1.0.\n\n    this.screenPosition.set(Math.min(Math.max((v.x + 1.0) * 0.5, -1.0), 2.0), Math.min(Math.max((v.y + 1.0) * 0.5, -1.0), 2.0));\n\n    if (this.blur) {\n      // Blur the masked scene to reduce artifacts.\n      this.blurPass.render(renderer, renderTargetA, renderTargetA);\n    } // Blur the masked scene along radial lines towards the light source.\n\n\n    this.godRaysPass.render(renderer, renderTargetA, this.renderTargetB);\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.blurPass.setSize(width, height);\n    this.renderPassLight.setSize(width, height);\n    this.depthMaskPass.setSize(width, height);\n    this.godRaysPass.setSize(width, height);\n    const w = this.resolution.width;\n    const h = this.resolution.height;\n    this.renderTargetA.setSize(w, h);\n    this.renderTargetB.setSize(w, h);\n    this.renderTargetLight.setSize(w, h);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    this.blurPass.initialize(renderer, alpha, frameBufferType);\n    this.renderPassLight.initialize(renderer, alpha, frameBufferType);\n    this.depthMaskPass.initialize(renderer, alpha, frameBufferType);\n    this.godRaysPass.initialize(renderer, alpha, frameBufferType);\n\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTargetA.texture.format = RGBFormat;\n      this.renderTargetB.texture.format = RGBFormat;\n      this.renderTargetLight.texture.format = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTargetA.texture.type = frameBufferType;\n      this.renderTargetB.texture.type = frameBufferType;\n      this.renderTargetLight.texture.type = frameBufferType;\n    }\n  }\n\n}\n\nvar fragmentShader$r = \"uniform vec2 scale;uniform float lineWidth;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float grid=0.5-max(abs(mod(uv.x*scale.x,1.0)-0.5),abs(mod(uv.y*scale.y,1.0)-0.5));outputColor=vec4(vec3(smoothstep(0.0,lineWidth,grid)),inputColor.a);}\";\n/**\r\n * A grid effect.\r\n */\n\nclass GridEffect extends Effect {\n  /**\r\n   * Constructs a new grid effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.OVERLAY] - The blend function of this effect.\r\n   * @param {Number} [options.scale=1.0] - The scale of the grid pattern.\r\n   * @param {Number} [options.lineWidth=0.0] - The line width of the grid pattern.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.OVERLAY,\n    scale = 1.0,\n    lineWidth = 0.0\n  } = {}) {\n    super(\"GridEffect\", fragmentShader$r, {\n      blendFunction,\n      uniforms: new Map([[\"scale\", new Uniform(new Vector2$1())], [\"lineWidth\", new Uniform(lineWidth)]])\n    });\n    /**\r\n     * The original resolution.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.resolution = new Vector2$1();\n    /**\r\n     * The grid scale, relative to the screen height.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.scale = Math.max(scale, 1e-6);\n    /**\r\n     * The grid line width.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.lineWidth = Math.max(lineWidth, 0.0);\n  }\n  /**\r\n   * Returns the current grid scale.\r\n   *\r\n   * @return {Number} The grid scale.\r\n   */\n\n\n  getScale() {\n    return this.scale;\n  }\n  /**\r\n   * Sets the grid scale.\r\n   *\r\n   * @param {Number} scale - The new grid scale.\r\n   */\n\n\n  setScale(scale) {\n    this.scale = scale;\n    this.setSize(this.resolution.x, this.resolution.y);\n  }\n  /**\r\n   * Returns the current grid line width.\r\n   *\r\n   * @return {Number} The grid line width.\r\n   */\n\n\n  getLineWidth() {\n    return this.lineWidth;\n  }\n  /**\r\n   * Sets the grid line width.\r\n   *\r\n   * @param {Number} lineWidth - The new grid line width.\r\n   */\n\n\n  setLineWidth(lineWidth) {\n    this.lineWidth = lineWidth;\n    this.setSize(this.resolution.x, this.resolution.y);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.resolution.set(width, height);\n    const aspect = width / height;\n    const scale = this.scale * (height * 0.125);\n    this.uniforms.get(\"scale\").value.set(aspect * scale, scale);\n    this.uniforms.get(\"lineWidth\").value = scale / height + this.lineWidth;\n  }\n\n}\n\nvar fragmentShader$s = \"uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}\";\n/**\r\n * A hue/saturation effect.\r\n *\r\n * Reference: https://github.com/evanw/glfx.js\r\n */\n\nclass HueSaturationEffect extends Effect {\n  /**\r\n   * Constructs a new hue/saturation effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.hue=0.0] - The hue in radians.\r\n   * @param {Number} [options.saturation=0.0] - The saturation factor, ranging from -1 to 1, where 0 means no change.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    hue = 0.0,\n    saturation = 0.0\n  } = {}) {\n    super(\"HueSaturationEffect\", fragmentShader$s, {\n      blendFunction,\n      uniforms: new Map([[\"hue\", new Uniform(new Vector3())], [\"saturation\", new Uniform(saturation)]])\n    });\n    this.setHue(hue);\n  }\n  /**\r\n   * Sets the hue.\r\n   *\r\n   * @param {Number} hue - The hue in radians.\r\n   */\n\n\n  setHue(hue) {\n    const s = Math.sin(hue),\n          c = Math.cos(hue);\n    this.uniforms.get(\"hue\").value.set(2.0 * c, -Math.sqrt(3.0) * s - c, Math.sqrt(3.0) * s - c).addScalar(1.0).divideScalar(3.0);\n  }\n\n}\n\nvar fragmentShader$t = \"void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\\n#ifdef PREMULTIPLY\\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\\n#else\\noutputColor=vec4(noise,inputColor.a);\\n#endif\\n}\";\n/**\r\n * A noise effect.\r\n */\n\nclass NoiseEffect extends Effect {\n  /**\r\n   * Constructs a new noise effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n   * @param {Boolean} [options.premultiply=false] - Whether the noise should be multiplied with the input color.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.SCREEN,\n    premultiply = false\n  } = {}) {\n    super(\"NoiseEffect\", fragmentShader$t, {\n      blendFunction\n    });\n    this.premultiply = premultiply;\n  }\n  /**\r\n   * Indicates whether the noise should be multiplied with the input color.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get premultiply() {\n    return this.defines.has(\"PREMULTIPLY\");\n  }\n  /**\r\n   * Enables or disables noise premultiplication.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set premultiply(value) {\n    if (this.premultiply !== value) {\n      if (value) {\n        this.defines.set(\"PREMULTIPLY\", \"1\");\n      } else {\n        this.defines.delete(\"PREMULTIPLY\");\n      }\n\n      this.setChanged();\n    }\n  }\n\n}\n\nvar fragmentShader$u = \"uniform sampler2D edgeTexture;uniform sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;\\n#ifdef USE_PATTERN\\nuniform sampler2D patternTexture;varying vec2 vUvPattern;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;\\n#ifndef X_RAY\\nedge.y=0.0;\\n#endif\\nedge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;\\n#ifdef USE_PATTERN\\nvec4 patternColor=texture2D(patternTexture,vUvPattern);\\n#ifdef X_RAY\\nfloat hiddenFactor=0.5;\\n#else\\nfloat hiddenFactor=0.0;\\n#endif\\nvisibilityFactor=(1.0-mask.y>0.0)? 1.0 : hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;\\n#endif\\nfloat alpha=max(max(edge.x,edge.y),visibilityFactor);\\n#ifdef ALPHA\\noutputColor=vec4(color,alpha);\\n#else\\noutputColor=vec4(color,max(alpha,inputColor.a));\\n#endif\\n}\";\nvar vertexShader$9 = \"uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}\";\n/**\r\n * An outline effect.\r\n */\n\nclass OutlineEffect extends Effect {\n  /**\r\n   * Constructs a new outline effect.\r\n   *\r\n   * If you want dark outlines, remember to use an appropriate blend function.\r\n   *\r\n   * @param {Scene} scene - The main scene.\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function.  Set this to `BlendFunction.ALPHA` for dark outlines.\r\n   * @param {Number} [options.patternTexture=null] - A pattern texture.\r\n   * @param {Number} [options.edgeStrength=1.0] - The edge strength.\r\n   * @param {Number} [options.pulseSpeed=0.0] - The pulse speed. A value of zero disables the pulse effect.\r\n   * @param {Number} [options.visibleEdgeColor=0xffffff] - The color of visible edges.\r\n   * @param {Number} [options.hiddenEdgeColor=0x22090a] - The color of hidden edges.\r\n   * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   * @param {KernelSize} [options.kernelSize=KernelSize.VERY_SMALL] - The blur kernel size.\r\n   * @param {Boolean} [options.blur=false] - Whether the outline should be blurred.\r\n   * @param {Boolean} [options.xRay=true] - Whether occluded parts of selected objects should be visible.\r\n   */\n  constructor(scene, camera, {\n    blendFunction = BlendFunction.SCREEN,\n    patternTexture = null,\n    edgeStrength = 1.0,\n    pulseSpeed = 0.0,\n    visibleEdgeColor = 0xffffff,\n    hiddenEdgeColor = 0x22090a,\n    resolutionScale = 0.5,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE,\n    kernelSize = KernelSize.VERY_SMALL,\n    blur = false,\n    xRay = true\n  } = {}) {\n    super(\"OutlineEffect\", fragmentShader$u, {\n      uniforms: new Map([[\"maskTexture\", new Uniform(null)], [\"edgeTexture\", new Uniform(null)], [\"edgeStrength\", new Uniform(edgeStrength)], [\"visibleEdgeColor\", new Uniform(new Color(visibleEdgeColor))], [\"hiddenEdgeColor\", new Uniform(new Color(hiddenEdgeColor))], [\"pulse\", new Uniform(1.0)], [\"patternScale\", new Uniform(1.0)], [\"patternTexture\", new Uniform(null)]])\n    }); // Handle alpha blending.\n\n    this.blendMode.addEventListener(\"change\", event => {\n      if (this.blendMode.getBlendFunction() === BlendFunction.ALPHA) {\n        this.defines.set(\"ALPHA\", \"1\");\n      } else {\n        this.defines.delete(\"ALPHA\");\n      }\n\n      this.setChanged();\n    });\n    this.blendMode.setBlendFunction(blendFunction);\n    this.setPatternTexture(patternTexture);\n    this.xRay = xRay;\n    /**\r\n     * The main scene.\r\n     *\r\n     * @type {Scene}\r\n     * @private\r\n     */\n\n    this.scene = scene;\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * A render target for the outline mask.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetMask = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      format: RGBFormat\n    });\n    this.renderTargetMask.texture.name = \"Outline.Mask\";\n    this.uniforms.get(\"maskTexture\").value = this.renderTargetMask.texture;\n    /**\r\n     * A render target for the edge detection.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetOutline = this.renderTargetMask.clone();\n    this.renderTargetOutline.texture.name = \"Outline.Edges\";\n    this.renderTargetOutline.depthBuffer = false;\n    /**\r\n     * A render target for the blurred outline overlay.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetBlurredOutline = this.renderTargetOutline.clone();\n    this.renderTargetBlurredOutline.texture.name = \"Outline.BlurredEdges\";\n    /**\r\n     * A clear pass.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass();\n    this.clearPass.overrideClearColor = new Color(0x000000);\n    this.clearPass.overrideClearAlpha = 1.0;\n    /**\r\n     * A depth pass.\r\n     *\r\n     * @type {DepthPass}\r\n     * @private\r\n     */\n\n    this.depthPass = new DepthPass(scene, camera);\n    /**\r\n     * A depth comparison mask pass.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.maskPass = new RenderPass(scene, camera, new DepthComparisonMaterial(this.depthPass.texture, camera));\n    const clearPass = this.maskPass.getClearPass();\n    clearPass.overrideClearColor = new Color(0xffffff);\n    clearPass.overrideClearAlpha = 1.0;\n    /**\r\n     * A blur pass.\r\n     *\r\n     * @type {BlurPass}\r\n     */\n\n    this.blurPass = new BlurPass({\n      resolutionScale,\n      width,\n      height,\n      kernelSize\n    });\n    this.blurPass.resolution.resizable = this;\n    this.blur = blur;\n    /**\r\n     * An outline detection pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.outlinePass = new ShaderPass(new OutlineMaterial());\n    this.outlinePass.getFullscreenMaterial().uniforms.inputBuffer.value = this.renderTargetMask.texture;\n    /**\r\n     * The current animation time.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.time = 0.0;\n    /**\r\n     * A selection of objects that will be outlined.\r\n     *\r\n     * @type {Selection}\r\n     */\n\n    this.selection = new Selection();\n    /**\r\n     * The pulse speed. A value of zero disables the pulse effect.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.pulseSpeed = pulseSpeed;\n  }\n  /**\r\n   * The resolution of this effect.\r\n   *\r\n   * @type {Resizer}\r\n   */\n\n\n  get resolution() {\n    return this.blurPass.resolution;\n  }\n  /**\r\n   * The current width of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  get width() {\n    return this.resolution.width;\n  }\n  /**\r\n   * Sets the render width.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.width instead.\r\n   */\n\n\n  set width(value) {\n    this.resolution.width = value;\n  }\n  /**\r\n   * The current height of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  get height() {\n    return this.resolution.height;\n  }\n  /**\r\n   * Sets the render height.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use resolution.height instead.\r\n   */\n\n\n  set height(value) {\n    this.resolution.height = value;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated Use selection.layer instead.\r\n   */\n\n\n  get selectionLayer() {\n    return this.selection.layer;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated Use selection.layer instead.\r\n   */\n\n\n  set selectionLayer(value) {\n    this.selection.layer = value;\n  }\n  /**\r\n   * Indicates whether dithering is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  get dithering() {\n    return this.blurPass.dithering;\n  }\n  /**\r\n   * Enables or disables dithering.\r\n   *\r\n   * @type {Boolean}\r\n   * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n   */\n\n\n  set dithering(value) {\n    this.blurPass.dithering = value;\n  }\n  /**\r\n   * The blur kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  get kernelSize() {\n    return this.blurPass.kernelSize;\n  }\n  /**\r\n   * Sets the kernel size.\r\n   *\r\n   * @type {KernelSize}\r\n   * @deprecated Use blurPass.kernelSize instead.\r\n   */\n\n\n  set kernelSize(value) {\n    this.blurPass.kernelSize = value;\n  }\n  /**\r\n   * Indicates whether the outlines should be blurred.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get blur() {\n    return this.blurPass.enabled;\n  }\n  /**\r\n   * @type {Boolean}\r\n   */\n\n\n  set blur(value) {\n    this.blurPass.enabled = value;\n    this.uniforms.get(\"edgeTexture\").value = value ? this.renderTargetBlurredOutline.texture : this.renderTargetOutline.texture;\n  }\n  /**\r\n   * Indicates whether X-Ray outlines are enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get xRay() {\n    return this.defines.has(\"X_RAY\");\n  }\n  /**\r\n   * Enables or disables X-Ray outlines.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set xRay(value) {\n    if (this.xRay !== value) {\n      if (value) {\n        this.defines.set(\"X_RAY\", \"1\");\n      } else {\n        this.defines.delete(\"X_RAY\");\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Sets the pattern texture.\r\n   *\r\n   * @param {Texture} texture - The new texture.\r\n   */\n\n\n  setPatternTexture(texture) {\n    if (texture !== null) {\n      texture.wrapS = texture.wrapT = RepeatWrapping;\n      this.defines.set(\"USE_PATTERN\", \"1\");\n      this.uniforms.get(\"patternTexture\").value = texture;\n      this.setVertexShader(vertexShader$9);\n    } else {\n      this.defines.delete(\"USE_PATTERN\");\n      this.uniforms.get(\"patternTexture\").value = null;\n      this.setVertexShader(null);\n    }\n\n    this.setChanged();\n  }\n  /**\r\n   * Returns the current resolution scale.\r\n   *\r\n   * @return {Number} The resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  getResolutionScale() {\n    return this.resolution.scale;\n  }\n  /**\r\n   * Sets the resolution scale.\r\n   *\r\n   * @param {Number} scale - The new resolution scale.\r\n   * @deprecated Adjust the fixed resolution width or height instead.\r\n   */\n\n\n  setResolutionScale(scale) {\n    this.resolution.scale = scale;\n  }\n  /**\r\n   * Clears the current selection and selects a list of objects.\r\n   *\r\n   * @param {Object3D[]} objects - The objects that should be outlined. This array will be copied.\r\n   * @return {OutlinePass} This pass.\r\n   * @deprecated Use selection.set instead.\r\n   */\n\n\n  setSelection(objects) {\n    this.selection.set(objects);\n    return this;\n  }\n  /**\r\n   * Clears the list of selected objects.\r\n   *\r\n   * @return {OutlinePass} This pass.\r\n   * @deprecated Use selection.clear instead.\r\n   */\n\n\n  clearSelection() {\n    this.selection.clear();\n    return this;\n  }\n  /**\r\n   * Selects an object.\r\n   *\r\n   * @param {Object3D} object - The object that should be outlined.\r\n   * @return {OutlinePass} This pass.\r\n   * @deprecated Use selection.add instead.\r\n   */\n\n\n  selectObject(object) {\n    this.selection.add(object);\n    return this;\n  }\n  /**\r\n   * Deselects an object.\r\n   *\r\n   * @param {Object3D} object - The object that should no longer be outlined.\r\n   * @return {OutlinePass} This pass.\r\n   * @deprecated Use selection.delete instead.\r\n   */\n\n\n  deselectObject(object) {\n    this.selection.delete(object);\n    return this;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const scene = this.scene;\n    const camera = this.camera;\n    const selection = this.selection;\n    const pulse = this.uniforms.get(\"pulse\");\n    const background = scene.background;\n    const mask = camera.layers.mask;\n\n    if (selection.size > 0) {\n      scene.background = null;\n      pulse.value = 1.0;\n\n      if (this.pulseSpeed > 0.0) {\n        pulse.value = 0.625 + Math.cos(this.time * this.pulseSpeed * 10.0) * 0.375;\n      }\n\n      this.time += deltaTime; // Render a custom depth texture and ignore selected objects.\n\n      selection.setVisible(false);\n      this.depthPass.render(renderer);\n      selection.setVisible(true); // Compare the depth of the selected objects with the depth texture.\n\n      camera.layers.set(selection.layer);\n      this.maskPass.render(renderer, this.renderTargetMask); // Restore the camera layer mask and the scene background.\n\n      camera.layers.mask = mask;\n      scene.background = background; // Detect the outline.\n\n      this.outlinePass.render(renderer, null, this.renderTargetOutline);\n\n      if (this.blur) {\n        this.blurPass.render(renderer, this.renderTargetOutline, this.renderTargetBlurredOutline);\n      }\n    } else if (this.time > 0.0) {\n      this.clearPass.render(renderer, this.renderTargetMask);\n      this.time = 0.0;\n    }\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.blurPass.setSize(width, height);\n    this.renderTargetMask.setSize(width, height);\n    const w = this.resolution.width;\n    const h = this.resolution.height;\n    this.depthPass.setSize(w, h);\n    this.renderTargetOutline.setSize(w, h);\n    this.renderTargetBlurredOutline.setSize(w, h);\n    this.outlinePass.getFullscreenMaterial().setTexelSize(1.0 / w, 1.0 / h);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    // No need for high precision: the blur pass operates on a mask texture.\n    this.blurPass.initialize(renderer, alpha, UnsignedByteType);\n\n    if (frameBufferType !== undefined) {\n      // These passes ignore the buffer type.\n      this.depthPass.initialize(renderer, alpha, frameBufferType);\n      this.maskPass.initialize(renderer, alpha, frameBufferType);\n      this.outlinePass.initialize(renderer, alpha, frameBufferType);\n    }\n  }\n\n}\n\nvar fragmentShader$v = \"uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}\";\n/**\r\n * A pixelation effect.\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\n\nclass PixelationEffect extends Effect {\n  /**\r\n   * Constructs a new pixelation effect.\r\n   *\r\n   * @param {Object} [granularity=30.0] - The pixel granularity.\r\n   */\n  constructor(granularity = 30.0) {\n    super(\"PixelationEffect\", fragmentShader$v, {\n      uniforms: new Map([[\"active\", new Uniform(false)], [\"d\", new Uniform(new Vector2$1())]])\n    });\n    /**\r\n     * The original resolution.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.resolution = new Vector2$1();\n    /**\r\n     * The pixel granularity.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.granularity = granularity;\n  }\n  /**\r\n   * Returns the pixel granularity.\r\n   *\r\n   * @return {Number} The granularity.\r\n   */\n\n\n  getGranularity() {\n    return this.granularity;\n  }\n  /**\r\n   * Sets the pixel granularity.\r\n   *\r\n   * A higher value yields coarser visuals.\r\n   *\r\n   * @param {Number} granularity - The new granularity.\r\n   */\n\n\n  setGranularity(granularity) {\n    granularity = Math.floor(granularity);\n\n    if (granularity % 2 > 0) {\n      granularity += 1;\n    }\n\n    const uniforms = this.uniforms;\n    uniforms.get(\"active\").value = granularity > 0.0;\n    uniforms.get(\"d\").value.set(granularity, granularity).divide(this.resolution);\n    this.granularity = granularity;\n  }\n  /**\r\n   * Updates the granularity.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.resolution.set(width, height);\n    this.setGranularity(this.granularity);\n  }\n\n}\n\nvar fragmentShader$w = \"uniform float focus;uniform float focalLength;uniform float fStop;uniform float maxBlur;uniform float luminanceThreshold;uniform float luminanceGain;uniform float bias;uniform float fringe;\\n#ifdef MANUAL_DOF\\nuniform vec4 dof;\\n#endif\\n#ifdef PENTAGON\\nfloat pentagon(const in vec2 coords){const vec4 HS0=vec4(1.0,0.0,0.0,1.0);const vec4 HS1=vec4(0.309016994,0.951056516,0.0,1.0);const vec4 HS2=vec4(-0.809016994,0.587785252,0.0,1.0);const vec4 HS3=vec4(-0.809016994,-0.587785252,0.0,1.0);const vec4 HS4=vec4(0.309016994,-0.951056516,0.0,1.0);const vec4 HS5=vec4(0.0,0.0,1.0,1.0);const vec4 ONE=vec4(1.0);const float P_FEATHER=0.4;const float N_FEATHER=-P_FEATHER;float inOrOut=-4.0;vec4 P=vec4(coords,vec2(RINGS_FLOAT-1.3));vec4 dist=vec4(dot(P,HS0),dot(P,HS1),dot(P,HS2),dot(P,HS3));dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dot(dist,ONE);dist.x=dot(P,HS4);dist.y=HS5.w-abs(P.z);dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dist.x;return clamp(inOrOut,0.0,1.0);}\\n#endif\\nvec3 processTexel(const in vec2 coords,const in float blur){vec2 scale=texelSize*fringe*blur;vec3 c=vec3(texture2D(inputBuffer,coords+vec2(0.0,1.0)*scale).r,texture2D(inputBuffer,coords+vec2(-0.866,-0.5)*scale).g,texture2D(inputBuffer,coords+vec2(0.866,-0.5)*scale).b);float luminance=linearToRelativeLuminance(c);float threshold=max((luminance-luminanceThreshold)*luminanceGain,0.0);return c+mix(vec3(0.0),c,threshold*blur);}float gather(const in float i,const in float j,const in float ringSamples,const in vec2 uv,const in vec2 blurFactor,const in float blur,inout vec3 color){float step=PI2/ringSamples;vec2 wh=vec2(cos(j*step)*i,sin(j*step)*i);\\n#ifdef PENTAGON\\nfloat p=pentagon(wh);\\n#else\\nfloat p=1.0;\\n#endif\\ncolor+=processTexel(wh*blurFactor+uv,blur)*mix(1.0,i/RINGS_FLOAT,bias)*p;return mix(1.0,i/RINGS_FLOAT,bias)*p;}void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\n#ifdef MANUAL_DOF\\nfloat focalPlane=linearDepth-focus;float farDoF=(focalPlane-dof.z)/dof.w;float nearDoF=(-focalPlane-dof.x)/dof.y;float blur=(focalPlane>0.0)? farDoF : nearDoF;\\n#else\\nconst float CIRCLE_OF_CONFUSION=0.03;float focalPlaneMM=focus*1000.0;float depthMM=linearDepth*1000.0;float focalPlane=(depthMM*focalLength)/(depthMM-focalLength);float farDoF=(focalPlaneMM*focalLength)/(focalPlaneMM-focalLength);float nearDoF=(focalPlaneMM-focalLength)/(focalPlaneMM*fStop*CIRCLE_OF_CONFUSION);float blur=abs(focalPlane-farDoF)*nearDoF;\\n#endif\\nconst int MAX_RING_SAMPLES=RINGS_INT*SAMPLES_INT;blur=clamp(blur,0.0,1.0);vec3 color=inputColor.rgb;if(blur>=0.05){vec2 blurFactor=blur*maxBlur*texelSize;float s=1.0;int ringSamples;for(int i=1;i<=RINGS_INT;i++){ringSamples=i*SAMPLES_INT;for(int j=0;j<MAX_RING_SAMPLES;j++){if(j>=ringSamples){break;}s+=gather(float(i),float(j),float(ringSamples),uv,blurFactor,blur,color);}}color/=s;}\\n#ifdef SHOW_FOCUS\\nfloat edge=0.002*linearDepth;float m=clamp(smoothstep(0.0,edge,blur),0.0,1.0);float e=clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);color=mix(color,vec3(1.0,0.5,0.0),(1.0-m)*0.6);color=mix(color,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n/**\r\n * Depth of Field shader v2.4.\r\n *\r\n * Yields more realistic results but is also more demanding.\r\n *\r\n * Original shader code by Martins Upitis:\r\n *  http://blenderartists.org/forum/showthread.php?237488-GLSL-depth-of-field-with-bokeh-v2-4-(update)\r\n *\r\n * @deprecated Use DepthOfFieldEffect instead.\r\n */\n\nclass RealisticBokehEffect extends Effect {\n  /**\r\n   * Constructs a new bokeh effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.focus=1.0] - The focus distance in world units.\r\n   * @param {Number} [options.focalLength=24.0] - The focal length of the main camera.\r\n   * @param {Number} [options.fStop=0.9] - The ratio of the lens focal length to the diameter of the entrance pupil (aperture).\r\n   * @param {Number} [options.luminanceThreshold=0.5] - A luminance threshold.\r\n   * @param {Number} [options.luminanceGain=2.0] - A luminance gain factor.\r\n   * @param {Number} [options.bias=0.5] - A blur bias.\r\n   * @param {Number} [options.fringe=0.7] - A blur offset.\r\n   * @param {Number} [options.maxBlur=1.0] - The maximum blur strength.\r\n   * @param {Boolean} [options.rings=3] - The number of blur iterations.\r\n   * @param {Boolean} [options.samples=2] - The amount of samples taken per ring.\r\n   * @param {Boolean} [options.showFocus=false] - Whether the focal point should be highlighted. Useful for debugging.\r\n   * @param {Boolean} [options.manualDoF=false] - Enables manual control over the depth of field.\r\n   * @param {Boolean} [options.pentagon=false] - Enables pentagonal blur shapes. Requires a high number of rings and samples.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    focus = 1.0,\n    focalLength = 24.0,\n    fStop = 0.9,\n    luminanceThreshold = 0.5,\n    luminanceGain = 2.0,\n    bias = 0.5,\n    fringe = 0.7,\n    maxBlur = 1.0,\n    rings = 3,\n    samples = 2,\n    showFocus = false,\n    manualDoF = false,\n    pentagon = false\n  } = {}) {\n    super(\"RealisticBokehEffect\", fragmentShader$w, {\n      blendFunction,\n      attributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\n      uniforms: new Map([[\"focus\", new Uniform(focus)], [\"focalLength\", new Uniform(focalLength)], [\"fStop\", new Uniform(fStop)], [\"luminanceThreshold\", new Uniform(luminanceThreshold)], [\"luminanceGain\", new Uniform(luminanceGain)], [\"bias\", new Uniform(bias)], [\"fringe\", new Uniform(fringe)], [\"maxBlur\", new Uniform(maxBlur)], [\"dof\", new Uniform(null)]])\n    });\n    this.rings = rings;\n    this.samples = samples;\n    this.showFocus = showFocus;\n    this.manualDoF = manualDoF;\n    this.pentagon = pentagon;\n  }\n  /**\r\n   * The amount of blur iterations.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get rings() {\n    return Number.parseInt(this.defines.get(\"RINGS_INT\"));\n  }\n  /**\r\n   * Sets the amount of blur iterations.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set rings(value) {\n    const r = Math.floor(value);\n    this.defines.set(\"RINGS_INT\", r.toFixed(0));\n    this.defines.set(\"RINGS_FLOAT\", r.toFixed(1));\n    this.setChanged();\n  }\n  /**\r\n   * The amount of blur samples per ring.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get samples() {\n    return Number.parseInt(this.defines.get(\"SAMPLES_INT\"));\n  }\n  /**\r\n   * Sets the amount of blur samples per ring.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set samples(value) {\n    const s = Math.floor(value);\n    this.defines.set(\"SAMPLES_INT\", s.toFixed(0));\n    this.defines.set(\"SAMPLES_FLOAT\", s.toFixed(1));\n    this.setChanged();\n  }\n  /**\r\n   * Indicates whether the focal point will be highlighted.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get showFocus() {\n    return this.defines.has(\"SHOW_FOCUS\");\n  }\n  /**\r\n   * Enables or disables focal point highlighting.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set showFocus(value) {\n    if (this.showFocus !== value) {\n      if (value) {\n        this.defines.set(\"SHOW_FOCUS\", \"1\");\n      } else {\n        this.defines.delete(\"SHOW_FOCUS\");\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Indicates whether the Depth of Field should be calculated manually.\r\n   *\r\n   * If enabled, the Depth of Field can be adjusted via the `dof` uniform.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get manualDoF() {\n    return this.defines.has(\"MANUAL_DOF\");\n  }\n  /**\r\n   * Enables or disables manual Depth of Field.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set manualDoF(value) {\n    if (this.manualDoF !== value) {\n      if (value) {\n        this.defines.set(\"MANUAL_DOF\", \"1\");\n        this.uniforms.get(\"dof\").value = new Vector4(0.2, 1.0, 0.2, 2.0);\n      } else {\n        this.defines.delete(\"MANUAL_DOF\");\n        this.uniforms.get(\"dof\").value = null;\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Indicates whether the blur shape should be pentagonal.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get pentagon() {\n    return this.defines.has(\"PENTAGON\");\n  }\n  /**\r\n   * Enables or disables pentagonal blur.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set pentagon(value) {\n    if (this.pentagon !== value) {\n      if (value) {\n        this.defines.set(\"PENTAGON\", \"1\");\n      } else {\n        this.defines.delete(\"PENTAGON\");\n      }\n\n      this.setChanged();\n    }\n  }\n\n}\n\nvar fragmentShader$x = \"uniform float count;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 sl=vec2(sin(uv.y*count),cos(uv.y*count));vec3 scanlines=vec3(sl.x,sl.y,sl.x);outputColor=vec4(scanlines,inputColor.a);}\";\n/**\r\n * A scanline effect.\r\n *\r\n * Based on an implementation by Georg 'Leviathan' Steinrohder (CC BY 3.0):\r\n * http://www.truevision3d.com/forums/showcase/staticnoise_colorblackwhite_scanline_shaders-t18698.0.html\r\n */\n\nclass ScanlineEffect extends Effect {\n  /**\r\n   * Constructs a new scanline effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.OVERLAY] - The blend function of this effect.\r\n   * @param {Number} [options.density=1.25] - The scanline density.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.OVERLAY,\n    density = 1.25\n  } = {}) {\n    super(\"ScanlineEffect\", fragmentShader$x, {\n      blendFunction,\n      uniforms: new Map([[\"count\", new Uniform(0.0)]])\n    });\n    /**\r\n     * The original resolution.\r\n     *\r\n     * @type {Vector2}\r\n     * @private\r\n     */\n\n    this.resolution = new Vector2$1();\n    /**\r\n     * The amount of scanlines, relative to the screen height.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.density = density;\n  }\n  /**\r\n   * Returns the current scanline density.\r\n   *\r\n   * @return {Number} The scanline density.\r\n   */\n\n\n  getDensity() {\n    return this.density;\n  }\n  /**\r\n   * Sets the scanline density.\r\n   *\r\n   * @param {Number} density - The new scanline density.\r\n   */\n\n\n  setDensity(density) {\n    this.density = density;\n    this.setSize(this.resolution.x, this.resolution.y);\n  }\n  /**\r\n   * Updates the size of this pass.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.resolution.set(width, height);\n    this.uniforms.get(\"count\").value = Math.round(height * this.density);\n  }\n\n}\n\nvar fragmentShader$y = \"uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}\";\nvar vertexShader$a = \"uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}\";\n/**\r\n * Half PI.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst HALF_PI = Math.PI * 0.5;\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\n\nconst v$1 = new Vector3();\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\n\nconst ab = new Vector3();\n/**\r\n * A shock wave effect.\r\n *\r\n * Based on a Gist by Jean-Philippe Sarda:\r\n *  https://gist.github.com/jpsarda/33cea67a9f2ecb0a0eda\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\n\nclass ShockWaveEffect extends Effect {\n  /**\r\n   * Constructs a new shock wave effect.\r\n   *\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Vector3} [epicenter] - The world position of the shock wave epicenter.\r\n   * @param {Object} [options] - The options.\r\n   * @param {Number} [options.speed=2.0] - The animation speed.\r\n   * @param {Number} [options.maxRadius=1.0] - The extent of the shock wave.\r\n   * @param {Number} [options.waveSize=0.2] - The wave size.\r\n   * @param {Number} [options.amplitude=0.05] - The distortion amplitude.\r\n   */\n  constructor(camera, epicenter = new Vector3(), {\n    speed = 2.0,\n    maxRadius = 1.0,\n    waveSize = 0.2,\n    amplitude = 0.05\n  } = {}) {\n    super(\"ShockWaveEffect\", fragmentShader$y, {\n      vertexShader: vertexShader$a,\n      uniforms: new Map([[\"active\", new Uniform(false)], [\"center\", new Uniform(new Vector2$1(0.5, 0.5))], [\"cameraDistance\", new Uniform(1.0)], [\"size\", new Uniform(1.0)], [\"radius\", new Uniform(-waveSize)], [\"maxRadius\", new Uniform(maxRadius)], [\"waveSize\", new Uniform(waveSize)], [\"amplitude\", new Uniform(amplitude)]])\n    });\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * The epicenter.\r\n     *\r\n     * @type {Vector3}\r\n     * @example shockWavePass.epicenter = myMesh.position;\r\n     */\n\n    this.epicenter = epicenter;\n    /**\r\n     * The object position in screen space.\r\n     *\r\n     * @type {Vector3}\r\n     * @private\r\n     */\n\n    this.screenPosition = this.uniforms.get(\"center\").value;\n    /**\r\n     * The speed of the shock wave animation.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.speed = speed;\n    /**\r\n     * A time accumulator.\r\n     *\r\n     * @type {Number}\r\n     * @private\r\n     */\n\n    this.time = 0.0;\n    /**\r\n     * Indicates whether the shock wave animation is active.\r\n     *\r\n     * @type {Boolean}\r\n     * @private\r\n     */\n\n    this.active = false;\n  }\n  /**\r\n   * Emits the shock wave.\r\n   */\n\n\n  explode() {\n    this.time = 0.0;\n    this.active = true;\n    this.uniforms.get(\"active\").value = true;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [delta] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, delta) {\n    const epicenter = this.epicenter;\n    const camera = this.camera;\n    const uniforms = this.uniforms;\n    const uniformActive = uniforms.get(\"active\");\n\n    if (this.active) {\n      const waveSize = uniforms.get(\"waveSize\").value; // Calculate direction vectors.\n\n      camera.getWorldDirection(v$1);\n      ab.copy(camera.position).sub(epicenter); // Don't render the effect if the object is behind the camera.\n\n      uniformActive.value = v$1.angleTo(ab) > HALF_PI;\n\n      if (uniformActive.value) {\n        // Scale the effect based on distance to the object.\n        uniforms.get(\"cameraDistance\").value = camera.position.distanceTo(epicenter); // Calculate the screen position of the epicenter.\n\n        v$1.copy(epicenter).project(camera);\n        this.screenPosition.set((v$1.x + 1.0) * 0.5, (v$1.y + 1.0) * 0.5);\n      } // Update the shock wave radius based on time.\n\n\n      this.time += delta * this.speed;\n      const radius = this.time - waveSize;\n      uniforms.get(\"radius\").value = radius;\n\n      if (radius >= (uniforms.get(\"maxRadius\").value + waveSize) * 2.0) {\n        this.active = false;\n        uniformActive.value = false;\n      }\n    }\n  }\n\n}\n/**\r\n * A selective bloom effect.\r\n *\r\n * This effect applies bloom only to selected objects by using layers. Make sure\r\n * to enable the selection layer for all relevant lights:\r\n *\r\n * `lights.forEach((l) => l.layers.enable(bloomEffect.selection.layer));`\r\n *\r\n * Attention: If you don't need to limit bloom to a subset of objects, consider\r\n * using the {@link BloomEffect} instead for better performance.\r\n */\n\n\nclass SelectiveBloomEffect extends BloomEffect {\n  /**\r\n   * Constructs a new selective bloom effect.\r\n   *\r\n   * @param {Scene} scene - The main scene.\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Object} [options] - The options. See {@link BloomEffect} for details.\r\n   */\n  constructor(scene, camera, options) {\n    super(options);\n    /**\r\n     * The main scene.\r\n     *\r\n     * @type {Scene}\r\n     * @private\r\n     */\n\n    this.scene = scene;\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * A clear pass.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass(true, true, false);\n    this.clearPass.overrideClearColor = new Color(0x000000);\n    /**\r\n     * A render pass.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.renderPass = new RenderPass(scene, camera);\n    this.renderPass.clear = false;\n    /**\r\n     * A render pass that renders all objects solid black.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.blackoutPass = new RenderPass(scene, camera, new MeshBasicMaterial({\n      color: 0x000000\n    }));\n    this.blackoutPass.clear = false;\n    /**\r\n     * A render pass that only renders the background of the main scene.\r\n     *\r\n     * @type {RenderPass}\r\n     * @private\r\n     */\n\n    this.backgroundPass = (() => {\n      const backgroundScene = new Scene();\n      const pass = new RenderPass(backgroundScene, camera);\n      backgroundScene.background = scene.background;\n      pass.clear = false;\n      return pass;\n    })();\n    /**\r\n     * A render target.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n\n    this.renderTargetSelection = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: true\n    });\n    this.renderTargetSelection.texture.name = \"Bloom.Selection\";\n    this.renderTargetSelection.texture.generateMipmaps = false;\n    /**\r\n     * A selection of objects.\r\n     *\r\n     * @type {Selection}\r\n     */\n\n    this.selection = new Selection();\n    /**\r\n     * Indicates whether the selection should be considered inverted.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.inverted = false;\n  }\n  /**\r\n   * Indicates whether the scene background should be ignored.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get ignoreBackground() {\n    return !this.backgroundPass.enabled;\n  }\n  /**\r\n   * Enables or disables background rendering.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set ignoreBackground(value) {\n    this.backgroundPass.enabled = !value;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const scene = this.scene;\n    const camera = this.camera;\n    const selection = this.selection;\n    const renderTarget = this.renderTargetSelection;\n    const background = scene.background;\n    const mask = camera.layers.mask;\n    this.clearPass.render(renderer, renderTarget);\n\n    if (!this.ignoreBackground) {\n      this.backgroundPass.render(renderer, renderTarget);\n    }\n\n    scene.background = null;\n\n    if (this.inverted) {\n      camera.layers.set(selection.layer);\n      this.blackoutPass.render(renderer, renderTarget);\n      camera.layers.mask = mask;\n      selection.setVisible(false);\n      this.renderPass.render(renderer, renderTarget);\n      selection.setVisible(true);\n    } else {\n      selection.setVisible(false);\n      this.blackoutPass.render(renderer, renderTarget);\n      selection.setVisible(true);\n      camera.layers.set(selection.layer);\n      this.renderPass.render(renderer, renderTarget);\n      camera.layers.mask = mask;\n    }\n\n    scene.background = background;\n    super.update(renderer, renderTarget, deltaTime);\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    super.setSize(width, height);\n    this.backgroundPass.setSize(width, height);\n    this.blackoutPass.setSize(width, height);\n    this.renderPass.setSize(width, height);\n    this.renderTargetSelection.setSize(this.resolution.width, this.resolution.height);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    super.initialize(renderer, alpha, frameBufferType);\n    this.backgroundPass.initialize(renderer, alpha, frameBufferType);\n    this.blackoutPass.initialize(renderer, alpha, frameBufferType);\n    this.renderPass.initialize(renderer, alpha, frameBufferType);\n\n    if (!alpha && frameBufferType === UnsignedByteType) {\n      this.renderTargetSelection.texture.format = RGBFormat;\n    }\n\n    if (frameBufferType !== undefined) {\n      this.renderTargetSelection.texture.type = frameBufferType;\n    }\n  }\n\n}\n\nvar fragmentShader$z = \"uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,vec3(1.0-0.607*intensity,0.769*intensity,0.189*intensity)),dot(inputColor.rgb,vec3(0.349*intensity,1.0-0.314*intensity,0.168*intensity)),dot(inputColor.rgb,vec3(0.272*intensity,0.534*intensity,1.0-0.869*intensity)));outputColor=vec4(color,inputColor.a);}\";\n/**\r\n * A sepia effect.\r\n */\n\nclass SepiaEffect extends Effect {\n  /**\r\n   * Constructs a new sepia effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Number} [options.intensity=1.0] - The intensity of the effect.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    intensity = 1.0\n  } = {}) {\n    super(\"SepiaEffect\", fragmentShader$z, {\n      blendFunction,\n      uniforms: new Map([[\"intensity\", new Uniform(intensity)]])\n    });\n  }\n\n} // Generated with SMAASearchImageData.generate().toCanvas().toDataURL(), cropped, high dynamic range.\n\n\nvar searchImageDataURL = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC\"; // Generated with SMAAAreaImageData.generate().toCanvas().toDataURL().\n\nvar areaImageDataURL = \"data:image/png;base64,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\";\nvar fragmentShader$A = \"uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}\";\nvar vertexShader$b = \"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}\";\n/**\r\n * Subpixel Morphological Antialiasing (SMAA).\r\n *\r\n * https://github.com/iryoku/smaa/releases/tag/v2.8\r\n */\n\nclass SMAAEffect extends Effect {\n  /**\r\n   * Constructs a new SMAA effect.\r\n   *\r\n   * @param {Image} searchImage - The SMAA search image. Preload this image using the {@link SMAAImageLoader}.\r\n   * @param {Image} areaImage - The SMAA area image. Preload this image using the {@link SMAAImageLoader}.\r\n   * @param {SMAAPreset} [preset=SMAAPreset.HIGH] - An SMAA quality preset.\r\n   * @param {EdgeDetectionMode} [edgeDetectionMode=EdgeDetectionMode.COLOR] - The edge detection mode.\r\n   */\n  constructor(searchImage, areaImage, preset = SMAAPreset.HIGH, edgeDetectionMode = EdgeDetectionMode.COLOR) {\n    super(\"SMAAEffect\", fragmentShader$A, {\n      vertexShader: vertexShader$b,\n      blendFunction: BlendFunction.NORMAL,\n      attributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\n      uniforms: new Map([[\"weightMap\", new Uniform(null)]])\n    });\n    /**\r\n     * A render target for the edge detection.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetEdges = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false,\n      format: RGBFormat\n    });\n    this.renderTargetEdges.texture.name = \"SMAA.Edges\";\n    /**\r\n     * A render target for the edge weights.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetWeights = this.renderTargetEdges.clone();\n    this.renderTargetWeights.texture.name = \"SMAA.Weights\";\n    this.renderTargetWeights.texture.format = RGBAFormat;\n    this.uniforms.get(\"weightMap\").value = this.renderTargetWeights.texture;\n    /**\r\n     * A clear pass for the edges buffer.\r\n     *\r\n     * @type {ClearPass}\r\n     * @private\r\n     */\n\n    this.clearPass = new ClearPass(true, false, false);\n    this.clearPass.overrideClearColor = new Color(0x000000);\n    this.clearPass.overrideClearAlpha = 1.0;\n    /**\r\n     * An edge detection pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.edgeDetectionPass = new ShaderPass(new EdgeDetectionMaterial(new Vector2$1(), edgeDetectionMode));\n    /**\r\n     * An SMAA weights pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.weightsPass = new ShaderPass(new SMAAWeightsMaterial());\n    const searchTexture = new Texture(searchImage);\n    searchTexture.name = \"SMAA.Search\";\n    searchTexture.magFilter = NearestFilter;\n    searchTexture.minFilter = NearestFilter;\n    searchTexture.format = RGBAFormat;\n    searchTexture.generateMipmaps = false;\n    searchTexture.needsUpdate = true;\n    searchTexture.flipY = true;\n    const areaTexture = new Texture(areaImage);\n    areaTexture.name = \"SMAA.Area\";\n    areaTexture.minFilter = LinearFilter;\n    areaTexture.format = RGBAFormat;\n    areaTexture.generateMipmaps = false;\n    areaTexture.needsUpdate = true;\n    areaTexture.flipY = false;\n    const weightsMaterial = this.weightsPass.getFullscreenMaterial();\n    weightsMaterial.uniforms.searchTexture.value = searchTexture;\n    weightsMaterial.uniforms.areaTexture.value = areaTexture;\n    this.applyPreset(preset);\n  }\n  /**\r\n   * The internal edge detection material.\r\n   *\r\n   * @type {EdgeDetectionMaterial}\r\n   */\n\n\n  get edgeDetectionMaterial() {\n    return this.edgeDetectionPass.getFullscreenMaterial();\n  }\n  /**\r\n   * The internal edge detection material.\r\n   *\r\n   * @type {EdgeDetectionMaterial}\r\n   * @deprecated Use edgeDetectionMaterial instead.\r\n   */\n\n\n  get colorEdgesMaterial() {\n    return this.edgeDetectionMaterial;\n  }\n  /**\r\n   * The internal edge weights material.\r\n   *\r\n   * @type {SMAAWeightsMaterial}\r\n   */\n\n\n  get weightsMaterial() {\n    return this.weightsPass.getFullscreenMaterial();\n  }\n  /**\r\n   * Sets the edge detection sensitivity.\r\n   *\r\n   * See {@link EdgeDetectionMaterial#setEdgeDetectionThreshold} for more details.\r\n   *\r\n   * @deprecated Use applyPreset or edgeDetectionMaterial instead.\r\n   * @param {Number} threshold - The edge detection sensitivity. Range: [0.05, 0.5].\r\n   */\n\n\n  setEdgeDetectionThreshold(threshold) {\n    this.edgeDetectionPass.getFullscreenMaterial().setEdgeDetectionThreshold(threshold);\n  }\n  /**\r\n   * Sets the maximum amount of horizontal/vertical search steps.\r\n   *\r\n   * See {@link SMAAWeightsMaterial#setOrthogonalSearchSteps} for more details.\r\n   *\r\n   * @deprecated Use applyPreset or weightsMaterial instead.\r\n   * @param {Number} steps - The search steps. Range: [0, 112].\r\n   */\n\n\n  setOrthogonalSearchSteps(steps) {\n    this.weightsPass.getFullscreenMaterial().setOrthogonalSearchSteps(steps);\n  }\n  /**\r\n   * Applies the given quality preset.\r\n   *\r\n   * @param {SMAAPreset} preset - The preset.\r\n   */\n\n\n  applyPreset(preset) {\n    const edgeDetectionMaterial = this.edgeDetectionMaterial;\n    const weightsMaterial = this.weightsMaterial;\n\n    switch (preset) {\n      case SMAAPreset.LOW:\n        edgeDetectionMaterial.setEdgeDetectionThreshold(0.15);\n        weightsMaterial.setOrthogonalSearchSteps(4);\n        weightsMaterial.diagonalDetection = false;\n        weightsMaterial.cornerRounding = false;\n        break;\n\n      case SMAAPreset.MEDIUM:\n        edgeDetectionMaterial.setEdgeDetectionThreshold(0.1);\n        weightsMaterial.setOrthogonalSearchSteps(8);\n        weightsMaterial.diagonalDetection = false;\n        weightsMaterial.cornerRounding = false;\n        break;\n\n      case SMAAPreset.HIGH:\n        edgeDetectionMaterial.setEdgeDetectionThreshold(0.1);\n        weightsMaterial.setOrthogonalSearchSteps(16);\n        weightsMaterial.setDiagonalSearchSteps(8);\n        weightsMaterial.setCornerRounding(25);\n        weightsMaterial.diagonalDetection = true;\n        weightsMaterial.cornerRounding = true;\n        break;\n\n      case SMAAPreset.ULTRA:\n        edgeDetectionMaterial.setEdgeDetectionThreshold(0.05);\n        weightsMaterial.setOrthogonalSearchSteps(32);\n        weightsMaterial.setDiagonalSearchSteps(16);\n        weightsMaterial.setCornerRounding(25);\n        weightsMaterial.diagonalDetection = true;\n        weightsMaterial.cornerRounding = true;\n        break;\n    }\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.edgeDetectionMaterial;\n    material.uniforms.depthBuffer.value = depthTexture;\n    material.depthPacking = depthPacking;\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    this.clearPass.render(renderer, this.renderTargetEdges);\n    this.edgeDetectionPass.render(renderer, inputBuffer, this.renderTargetEdges);\n    this.weightsPass.render(renderer, this.renderTargetEdges, this.renderTargetWeights);\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const edgeDetectionMaterial = this.edgeDetectionPass.getFullscreenMaterial();\n    const weightsMaterial = this.weightsPass.getFullscreenMaterial();\n    this.renderTargetEdges.setSize(width, height);\n    this.renderTargetWeights.setSize(width, height);\n    weightsMaterial.uniforms.resolution.value.set(width, height);\n    weightsMaterial.uniforms.texelSize.value.set(1.0 / width, 1.0 / height);\n    edgeDetectionMaterial.uniforms.texelSize.value.copy(weightsMaterial.uniforms.texelSize.value);\n  }\n  /**\r\n   * Deletes internal render targets and textures.\r\n   */\n\n\n  dispose() {\n    const uniforms = this.weightsPass.getFullscreenMaterial().uniforms;\n    uniforms.searchTexture.value.dispose();\n    uniforms.areaTexture.value.dispose();\n    super.dispose();\n  }\n  /**\r\n   * The SMAA search image, encoded as a base64 data URL.\r\n   *\r\n   * Use this image data to create an Image instance and use it together with\r\n   * the area image to create an {@link SMAAEffect}.\r\n   *\r\n   * @type {String}\r\n   * @deprecated Use SMAAImageLoader instead.\r\n   * @example\r\n   * const searchImage = new Image();\r\n   * searchImage.addEventListener(\"load\", progress);\r\n   * searchImage.src = SMAAEffect.searchImageDataURL;\r\n   */\n\n\n  static get searchImageDataURL() {\n    return searchImageDataURL;\n  }\n  /**\r\n   * The SMAA area image, encoded as a base64 data URL.\r\n   *\r\n   * Use this image data to create an Image instance and use it together with\r\n   * the search image to create an {@link SMAAEffect}.\r\n   *\r\n   * @type {String}\r\n   * @deprecated Use SMAAImageLoader instead.\r\n   * @example\r\n   * const areaImage = new Image();\r\n   * areaImage.addEventListener(\"load\", progress);\r\n   * areaImage.src = SMAAEffect.areaImageDataURL;\r\n   */\n\n\n  static get areaImageDataURL() {\n    return areaImageDataURL;\n  }\n\n}\n/**\r\n * An enumeration of SMAA presets.\r\n *\r\n * @type {Object}\r\n * @property {Number} LOW - Results in around 60% of the maximum quality.\r\n * @property {Number} MEDIUM - Results in around 80% of the maximum quality.\r\n * @property {Number} HIGH - Results in around 95% of the maximum quality.\r\n * @property {Number} ULTRA - Results in around 99% of the maximum quality.\r\n */\n\n\nconst SMAAPreset = {\n  LOW: 0,\n  MEDIUM: 1,\n  HIGH: 2,\n  ULTRA: 3\n};\nvar fragmentShader$B = \"uniform sampler2D aoBuffer;uniform float luminanceInfluence;\\n#ifdef DEPTH_AWARE_UPSAMPLING\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D normalDepthBuffer;\\n#else\\nuniform mediump sampler2D normalDepthBuffer;\\n#endif\\n#endif\\n#ifdef COLORIZE\\nuniform vec3 color;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){float aoLinear=texture2D(aoBuffer,uv).r;\\n#if defined(DEPTH_AWARE_UPSAMPLING) && __VERSION__ == 300\\nvec4 normalDepth[4]=vec4[](textureOffset(normalDepthBuffer,uv,ivec2(0,0)),textureOffset(normalDepthBuffer,uv,ivec2(0,1)),textureOffset(normalDepthBuffer,uv,ivec2(1,0)),textureOffset(normalDepthBuffer,uv,ivec2(1,1)));float dot01=dot(normalDepth[0].rgb,normalDepth[1].rgb);float dot02=dot(normalDepth[0].rgb,normalDepth[2].rgb);float dot03=dot(normalDepth[0].rgb,normalDepth[3].rgb);float minDot=min(dot01,min(dot02,dot03));float s=step(THRESHOLD,minDot);float smallestDistance=1.0;int index;for(int i=0;i<4;++i){float distance=abs(depth-normalDepth[i].a);if(distance<smallestDistance){smallestDistance=distance;index=i;}}ivec2 offsets[4]=ivec2[](ivec2(0,0),ivec2(0,1),ivec2(1,0),ivec2(1,1));ivec2 coord=ivec2(uv*vec2(textureSize(aoBuffer,0)))+offsets[index];float aoNearest=texelFetch(aoBuffer,coord,0).r;float ao=mix(aoNearest,aoLinear,s);\\n#else\\nfloat ao=aoLinear;\\n#endif\\nfloat l=linearToRelativeLuminance(inputColor.rgb);ao=mix(ao,1.0,l*luminanceInfluence);\\n#ifdef COLORIZE\\noutputColor=vec4(1.0-(1.0-ao)*(1.0-color),inputColor.a);\\n#else\\noutputColor=vec4(vec3(ao),inputColor.a);\\n#endif\\n}\";\n/**\r\n * The size of the generated noise texture.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst NOISE_TEXTURE_SIZE = 64;\n/**\r\n * A Screen Space Ambient Occlusion (SSAO) effect.\r\n *\r\n * For high quality visuals use two SSAO effect instances in a row with\r\n * different radii, one for rough AO and one for fine details.\r\n *\r\n * This effect supports depth-aware upsampling and should be rendered at a lower\r\n * resolution. The resolution should match that of the downsampled normals and\r\n * depth. If you intend to render SSAO at full resolution, do not provide a\r\n * downsampled `normalDepthBuffer` and make sure to disable\r\n * `depthAwareUpsampling`.\r\n *\r\n * It's recommended to specify a relative render resolution using the\r\n * `resolutionScale` constructor parameter to avoid undesired sampling patterns.\r\n *\r\n * Based on \"Scalable Ambient Obscurance\" by Morgan McGuire et al. and\r\n * \"Depth-aware upsampling experiments\" by Eleni Maria Stea:\r\n * https://research.nvidia.com/publication/scalable-ambient-obscurance\r\n * https://eleni.mutantstargoat.com/hikiko/on-depth-aware-upsampling\r\n */\n\nclass SSAOEffect extends Effect {\n  /**\r\n   * Constructs a new SSAO effect.\r\n   *\r\n   * @todo Move normalBuffer to options.\r\n   * @param {Camera} camera - The main camera.\r\n   * @param {Texture} normalBuffer - A texture that contains the scene normals. May be null if a normalDepthBuffer is provided. See {@link NormalPass}.\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.MULTIPLY] - The blend function of this effect.\r\n   * @param {Boolean} [options.distanceScaling=true] - Enables or disables distance-based radius scaling.\r\n   * @param {Boolean} [options.depthAwareUpsampling=true] - Enables or disables depth-aware upsampling. Has no effect if WebGL 2 is not supported.\r\n   * @param {Texture} [options.normalDepthBuffer=null] - A texture that contains downsampled scene normals and depth. See {@link DepthDownsamplingPass}.\r\n   * @param {Number} [options.samples=9] - The amount of samples per pixel. Should not be a multiple of the ring count.\r\n   * @param {Number} [options.rings=7] - The amount of spiral turns in the occlusion sampling pattern. Should be a prime number.\r\n   * @param {Number} [options.distanceThreshold=0.97] - A global distance threshold at which the occlusion effect starts to fade out. Range [0.0, 1.0].\r\n   * @param {Number} [options.distanceFalloff=0.03] - The distance falloff. Influences the smoothness of the overall occlusion cutoff. Range [0.0, 1.0].\r\n   * @param {Number} [options.rangeThreshold=0.0005] - A local occlusion range threshold at which the occlusion starts to fade out. Range [0.0, 1.0].\r\n   * @param {Number} [options.rangeFalloff=0.001] - The occlusion range falloff. Influences the smoothness of the proximity cutoff. Range [0.0, 1.0].\r\n   * @param {Number} [options.minRadiusScale=0.33] - The minimum radius scale. Has no effect if distance scaling is disabled.\r\n   * @param {Number} [options.luminanceInfluence=0.7] - Determines how much the luminance of the scene influences the ambient occlusion.\r\n   * @param {Number} [options.radius=0.1825] - The occlusion sampling radius, expressed as a resolution independent scale. Range [1e-6, 1.0].\r\n   * @param {Number} [options.intensity=1.0] - The intensity of the ambient occlusion.\r\n   * @param {Number} [options.bias=0.025] - An occlusion bias. Eliminates artifacts caused by depth discontinuities.\r\n   * @param {Number} [options.fade=0.01] - Influences the smoothness of the shadows. A lower value results in higher contrast.\r\n   * @param {Color} [options.color=null] - The color of the ambient occlusion.\r\n   * @param {Number} [options.resolutionScale=1.0] - The resolution scale.\r\n   * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n   * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n   */\n  constructor(camera, normalBuffer, {\n    blendFunction = BlendFunction.MULTIPLY,\n    distanceScaling = true,\n    depthAwareUpsampling = true,\n    normalDepthBuffer = null,\n    samples = 9,\n    rings = 7,\n    distanceThreshold = 0.97,\n    distanceFalloff = 0.03,\n    rangeThreshold = 0.0005,\n    rangeFalloff = 0.001,\n    minRadiusScale = 0.33,\n    luminanceInfluence = 0.7,\n    radius = 0.1825,\n    intensity = 1.0,\n    bias = 0.025,\n    fade = 0.01,\n    color = null,\n    resolutionScale = 1.0,\n    width = Resizer.AUTO_SIZE,\n    height = Resizer.AUTO_SIZE\n  } = {}) {\n    super(\"SSAOEffect\", fragmentShader$B, {\n      blendFunction,\n      attributes: EffectAttribute.DEPTH,\n      uniforms: new Map([[\"aoBuffer\", new Uniform(null)], [\"normalDepthBuffer\", new Uniform(null)], [\"luminanceInfluence\", new Uniform(luminanceInfluence)], [\"color\", new Uniform(null)], [\"scale\", new Uniform(0.0)] // Unused.\n      ])\n    });\n    /**\r\n     * A render target for the ambient occlusion shadows.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetAO = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false,\n      format: RGBFormat\n    });\n    this.renderTargetAO.texture.name = \"AO.Target\";\n    this.renderTargetAO.texture.generateMipmaps = false;\n    this.uniforms.get(\"aoBuffer\").value = this.renderTargetAO.texture;\n    /**\r\n     * The resolution of this effect.\r\n     *\r\n     * @type {Resizer}\r\n     */\n\n    this.resolution = new Resizer(this, width, height, resolutionScale);\n    /**\r\n     * The current radius relative to the render height.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.r = 1.0;\n    /**\r\n     * The main camera.\r\n     *\r\n     * @type {Camera}\r\n     * @private\r\n     */\n\n    this.camera = camera;\n    /**\r\n     * An SSAO pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.ssaoPass = new ShaderPass((() => {\n      const noiseTexture = new NoiseTexture(NOISE_TEXTURE_SIZE, NOISE_TEXTURE_SIZE);\n      noiseTexture.wrapS = noiseTexture.wrapT = RepeatWrapping;\n      const material = new SSAOMaterial(camera);\n      material.uniforms.noiseTexture.value = noiseTexture;\n      material.uniforms.intensity.value = intensity;\n      material.uniforms.minRadiusScale.value = minRadiusScale;\n      material.uniforms.fade.value = fade;\n      material.uniforms.bias.value = bias;\n\n      if (normalDepthBuffer !== null) {\n        material.uniforms.normalDepthBuffer.value = normalDepthBuffer;\n        material.defines.NORMAL_DEPTH = \"1\";\n\n        if (depthAwareUpsampling) {\n          this.depthAwareUpsampling = depthAwareUpsampling;\n          this.uniforms.get(\"normalDepthBuffer\").value = normalDepthBuffer;\n          this.defines.set(\"THRESHOLD\", \"0.997\");\n        }\n      } else {\n        material.uniforms.normalBuffer.value = normalBuffer;\n      }\n\n      return material;\n    })());\n    this.distanceScaling = distanceScaling;\n    this.samples = samples;\n    this.rings = rings;\n    this.color = color; // @todo Special case treatment added for backwards-compatibility.\n\n    this.radius = radius > 1.0 ? radius / 100.0 : radius;\n    this.setDistanceCutoff(distanceThreshold, distanceFalloff);\n    this.setProximityCutoff(rangeThreshold, rangeFalloff);\n  }\n  /**\r\n   * The SSAO material.\r\n   *\r\n   * @type {SSAOMaterial}\r\n   */\n\n\n  get ssaoMaterial() {\n    return this.ssaoPass.getFullscreenMaterial();\n  }\n  /**\r\n   * The amount of occlusion samples per pixel.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get samples() {\n    return Number(this.ssaoMaterial.defines.SAMPLES_INT);\n  }\n  /**\r\n   * Sets the amount of occlusion samples per pixel.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set samples(value) {\n    const material = this.ssaoMaterial;\n    material.defines.SAMPLES_INT = value.toFixed(0);\n    material.defines.SAMPLES_FLOAT = value.toFixed(1);\n    material.needsUpdate = true;\n  }\n  /**\r\n   * The amount of spiral turns in the occlusion sampling pattern.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get rings() {\n    return Number(this.ssaoMaterial.defines.SPIRAL_TURNS);\n  }\n  /**\r\n   * Sets the amount of spiral turns in the occlusion sampling pattern.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set rings(value) {\n    const material = this.ssaoMaterial;\n    material.defines.SPIRAL_TURNS = value.toFixed(1);\n    material.needsUpdate = true;\n  }\n  /**\r\n   * The occlusion sampling radius.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get radius() {\n    return this.r;\n  }\n  /**\r\n   * Sets the occlusion sampling radius. Range [1e-6, 1.0].\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set radius(value) {\n    this.r = Math.min(Math.max(value, 1e-6), 1.0);\n    const radius = this.r * this.resolution.height;\n    const material = this.ssaoMaterial;\n    material.defines.RADIUS = radius.toFixed(11);\n    material.defines.RADIUS_SQ = (radius * radius).toFixed(11);\n    material.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether depth-aware upsampling is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get depthAwareUpsampling() {\n    return this.defines.has(\"DEPTH_AWARE_UPSAMPLING\");\n  }\n  /**\r\n   * Enables or disables depth-aware upsampling.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set depthAwareUpsampling(value) {\n    if (this.depthAwareUpsampling !== value) {\n      if (value) {\n        this.defines.set(\"DEPTH_AWARE_UPSAMPLING\", \"1\");\n      } else {\n        this.defines.delete(\"DEPTH_AWARE_UPSAMPLING\");\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Indicates whether distance-based radius scaling is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get distanceScaling() {\n    return this.ssaoMaterial.defines.DISTANCE_SCALING !== undefined;\n  }\n  /**\r\n   * Enables or disables distance-based radius scaling.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set distanceScaling(value) {\n    if (this.distanceScaling !== value) {\n      const material = this.ssaoMaterial;\n\n      if (value) {\n        material.defines.DISTANCE_SCALING = \"1\";\n      } else {\n        delete material.defines.DISTANCE_SCALING;\n      }\n\n      material.needsUpdate = true;\n    }\n  }\n  /**\r\n   * The color of the ambient occlusion.\r\n   *\r\n   * @type {Color}\r\n   */\n\n\n  get color() {\n    return this.uniforms.get(\"color\").value;\n  }\n  /**\r\n   * Sets the color of the ambient occlusion.\r\n   *\r\n   * Set to `null` to disable colorization.\r\n   *\r\n   * @type {Color}\r\n   */\n\n\n  set color(value) {\n    const uniforms = this.uniforms;\n    const defines = this.defines;\n\n    if (value !== null) {\n      if (defines.has(\"COLORIZE\")) {\n        uniforms.get(\"color\").value.set(value);\n      } else {\n        defines.set(\"COLORIZE\", \"1\");\n        uniforms.get(\"color\").value = new Color(value);\n        this.setChanged();\n      }\n    } else if (defines.has(\"COLORIZE\")) {\n      defines.delete(\"COLORIZE\");\n      uniforms.get(\"color\").value = null;\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Sets the occlusion distance cutoff.\r\n   *\r\n   * @param {Number} threshold - The distance threshold. Range [0.0, 1.0].\r\n   * @param {Number} falloff - The falloff. Range [0.0, 1.0].\r\n   */\n\n\n  setDistanceCutoff(threshold, falloff) {\n    this.ssaoMaterial.uniforms.distanceCutoff.value.set(Math.min(Math.max(threshold, 0.0), 1.0), Math.min(Math.max(threshold + falloff, 0.0), 1.0));\n  }\n  /**\r\n   * Sets the occlusion proximity cutoff.\r\n   *\r\n   * @param {Number} threshold - The range threshold. Range [0.0, 1.0].\r\n   * @param {Number} falloff - The falloff. Range [0.0, 1.0].\r\n   */\n\n\n  setProximityCutoff(threshold, falloff) {\n    this.ssaoMaterial.uniforms.proximityCutoff.value.set(Math.min(Math.max(threshold, 0.0), 1.0), Math.min(Math.max(threshold + falloff, 0.0), 1.0));\n  }\n  /**\r\n   * Sets the depth texture.\r\n   *\r\n   * @param {Texture} depthTexture - A depth texture.\r\n   * @param {Number} [depthPacking=0] - The depth packing.\r\n   */\n\n\n  setDepthTexture(depthTexture, depthPacking = 0) {\n    const material = this.ssaoMaterial;\n\n    if (material.defines.NORMAL_DEPTH === undefined) {\n      material.uniforms.normalDepthBuffer.value = depthTexture;\n      material.depthPacking = depthPacking;\n    }\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    this.ssaoPass.render(renderer, null, this.renderTargetAO);\n  }\n  /**\r\n   * Updates the camera projection matrix uniforms and the size of internal\r\n   * render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    const resolution = this.resolution;\n    resolution.base.set(width, height);\n    const w = resolution.width;\n    const h = resolution.height;\n    this.renderTargetAO.setSize(w, h);\n    this.ssaoMaterial.setTexelSize(1.0 / w, 1.0 / h);\n    const camera = this.camera;\n    const uniforms = this.ssaoMaterial.uniforms;\n    uniforms.noiseScale.value.set(w, h).divideScalar(NOISE_TEXTURE_SIZE);\n    uniforms.inverseProjectionMatrix.value.getInverse(camera.projectionMatrix);\n    uniforms.projectionMatrix.value.copy(camera.projectionMatrix); // Update the absolute radius.\n\n    this.radius = this.r;\n  }\n\n}\n\nvar fragmentShader$C = \"uniform sampler2D texture;\\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\\nvarying vec2 vUv2;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){\\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\\nvec4 texel=texelToLinear(texture2D(texture,vUv2));\\n#else\\nvec4 texel=texelToLinear(texture2D(texture,uv));\\n#endif\\noutputColor=TEXEL;}\";\nvar vertexShader$c = \"#ifdef ASPECT_CORRECTION\\nuniform float scale;\\n#else\\nuniform mat3 uvTransform;\\n#endif\\nvarying vec2 vUv2;void mainSupport(const in vec2 uv){\\n#ifdef ASPECT_CORRECTION\\nvUv2=uv*vec2(aspect,1.0)*scale;\\n#else\\nvUv2=(uvTransform*vec3(uv,1.0)).xy;\\n#endif\\n}\";\n/**\r\n * A texture effect.\r\n */\n\nclass TextureEffect extends Effect {\n  /**\r\n   * Constructs a new texture effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Texture} [options.texture] - A texture.\r\n   * @param {Boolean} [options.aspectCorrection=false] - Deprecated. Enable uvTransform instead and adjust the texture's offset, repeat and center.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    texture = null,\n    aspectCorrection = false\n  } = {}) {\n    super(\"TextureEffect\", fragmentShader$C, {\n      blendFunction,\n      defines: new Map([[\"TEXEL\", \"texel\"]]),\n      uniforms: new Map([[\"texture\", new Uniform(null)], [\"scale\", new Uniform(1.0)], [\"uvTransform\", new Uniform(null)]])\n    });\n    this.texture = texture;\n    this.aspectCorrection = aspectCorrection;\n  }\n  /**\r\n   * The texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  get texture() {\n    return this.uniforms.get(\"texture\").value;\n  }\n  /**\r\n   * Sets the texture.\r\n   *\r\n   * @type {Texture}\r\n   */\n\n\n  set texture(value) {\n    const currentTexture = this.texture;\n\n    if (currentTexture !== value) {\n      const previousEncoding = currentTexture !== null ? currentTexture.encoding : null;\n      this.uniforms.get(\"texture\").value = value;\n\n      if (value !== null) {\n        if (value.encoding === sRGBEncoding) {\n          this.defines.set(\"texelToLinear(texel)\", \"sRGBToLinear(texel)\");\n        } else if (value.encoding === LinearEncoding) {\n          this.defines.set(\"texelToLinear(texel)\", \"texel\");\n        } else {\n          console.log(\"Unsupported encoding: \" + value.encoding);\n        }\n\n        if (previousEncoding !== value.encoding) {\n          this.setChanged();\n        }\n      }\n    }\n  }\n  /**\r\n   * Indicates whether aspect correction is enabled.\r\n   *\r\n   * If enabled, the texture can be scaled using the `scale` uniform.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use uvTransform instead for full control over the texture coordinates.\r\n   */\n\n\n  get aspectCorrection() {\n    return this.defines.has(\"ASPECT_CORRECTION\");\n  }\n  /**\r\n   * Enables or disables aspect correction.\r\n   *\r\n   * @type {Number}\r\n   * @deprecated Use uvTransform instead for full control over the texture coordinates.\r\n   */\n\n\n  set aspectCorrection(value) {\n    if (this.aspectCorrection !== value) {\n      if (value) {\n        if (this.uvTransform) {\n          this.uvTransform = false;\n        }\n\n        this.defines.set(\"ASPECT_CORRECTION\", \"1\");\n        this.setVertexShader(vertexShader$c);\n      } else {\n        this.defines.delete(\"ASPECT_CORRECTION\");\n        this.setVertexShader(null);\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Indicates whether the texture UV coordinates will be transformed using the\r\n   * transformation matrix of the texture.\r\n   *\r\n   * Cannot be used if aspect correction is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get uvTransform() {\n    return this.defines.has(\"UV_TRANSFORM\");\n  }\n  /**\r\n   * Enables or disables texture UV transformation.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set uvTransform(value) {\n    if (this.uvTransform !== value) {\n      if (value) {\n        if (this.aspectCorrection) {\n          this.aspectCorrection = false;\n        }\n\n        this.defines.set(\"UV_TRANSFORM\", \"1\");\n        this.uniforms.get(\"uvTransform\").value = new Matrix3();\n        this.setVertexShader(vertexShader$c);\n      } else {\n        this.defines.delete(\"UV_TRANSFORM\");\n        this.uniforms.get(\"uvTransform\").value = null;\n        this.setVertexShader(null);\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * Sets the swizzles that will be applied to the `r`, `g`, `b`, and `a`\r\n   * components of a texel before it is written to the output color.\r\n   *\r\n   * @param {ColorChannel} r - The swizzle for the `r` component.\r\n   * @param {ColorChannel} [g=r] - The swizzle for the `g` component.\r\n   * @param {ColorChannel} [b=r] - The swizzle for the `b` component.\r\n   * @param {ColorChannel} [a=r] - The swizzle for the `a` component.\r\n   */\n\n\n  setTextureSwizzleRGBA(r, g = r, b = r, a = r) {\n    const rgba = \"rgba\";\n    let swizzle = \"\";\n\n    if (r !== ColorChannel.RED || g !== ColorChannel.GREEN || b !== ColorChannel.BLUE || a !== ColorChannel.ALPHA) {\n      swizzle = [\".\", rgba[r], rgba[g], rgba[b], rgba[a]].join(\"\");\n    }\n\n    this.defines.set(\"TEXEL\", \"texel\" + swizzle);\n    this.setChanged();\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    const texture = this.uniforms.get(\"texture\").value;\n\n    if (this.uvTransform && texture.matrixAutoUpdate) {\n      texture.updateMatrix();\n      this.uniforms.get(\"uvTransform\").value.copy(texture.matrix);\n    }\n  }\n\n}\n\nvar fragmentShader$D = \"uniform sampler2D luminanceMap;uniform float middleGrey;uniform float maxLuminance;uniform float averageLuminance;vec3 toneMap(vec3 c){\\n#ifdef ADAPTED_LUMINANCE\\nfloat lumAvg=texture2D(luminanceMap,vec2(0.5)).r;\\n#else\\nfloat lumAvg=averageLuminance;\\n#endif\\nfloat lumPixel=linearToRelativeLuminance(c);float lumScaled=(lumPixel*middleGrey)/lumAvg;float lumCompressed=(lumScaled*(1.0+(lumScaled/(maxLuminance*maxLuminance))))/(1.0+lumScaled);return lumCompressed*c;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(toneMap(inputColor.rgb),inputColor.a);}\";\n/**\r\n * A tone mapping effect that supports adaptive luminosity.\r\n *\r\n * If adaptivity is enabled, this effect generates a texture that represents the\r\n * luminosity of the current scene and adjusts it over time to simulate the\r\n * optic nerve responding to the amount of light it is receiving.\r\n *\r\n * Reference:\r\n *  GDC2007 - Wolfgang Engel, Post-Processing Pipeline\r\n *  http://perso.univ-lyon1.fr/jean-claude.iehl/Public/educ/GAMA/2007/gdc07/Post-Processing_Pipeline.pdf\r\n */\n\nclass ToneMappingEffect extends Effect {\n  /**\r\n   * Constructs a new tone mapping effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Boolean} [options.adaptive=true] - Whether the tone mapping should use an adaptive luminance map.\r\n   * @param {Number} [options.resolution=256] - The render texture resolution of the luminance map.\r\n   * @param {Number} [options.middleGrey=0.6] - The middle grey factor.\r\n   * @param {Number} [options.maxLuminance=16.0] - The maximum luminance.\r\n   * @param {Number} [options.averageLuminance=1.0] - The average luminance.\r\n   * @param {Number} [options.adaptationRate=1.0] - The luminance adaptation rate.\r\n   */\n  constructor({\n    blendFunction = BlendFunction.NORMAL,\n    adaptive = true,\n    resolution = 256,\n    middleGrey = 0.6,\n    maxLuminance = 16.0,\n    averageLuminance = 1.0,\n    adaptationRate = 2.0\n  } = {}) {\n    super(\"ToneMappingEffect\", fragmentShader$D, {\n      blendFunction,\n      uniforms: new Map([[\"luminanceMap\", new Uniform(null)], [\"middleGrey\", new Uniform(middleGrey)], [\"maxLuminance\", new Uniform(maxLuminance)], [\"averageLuminance\", new Uniform(averageLuminance)]])\n    });\n    /**\r\n     * The render target for the current luminance.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     * @todo Remove LinearMipMapLinearFilter in next major release.\r\n     */\n\n    this.renderTargetLuminance = new WebGLRenderTarget(1, 1, {\n      minFilter: LinearMipmapLinearFilter !== undefined ? LinearMipmapLinearFilter : LinearMipMapLinearFilter,\n      magFilter: LinearFilter,\n      stencilBuffer: false,\n      depthBuffer: false,\n      format: RGBFormat\n    });\n    this.renderTargetLuminance.texture.name = \"ToneMapping.Luminance\";\n    this.renderTargetLuminance.texture.generateMipmaps = true;\n    /**\r\n     * The render target for adapted luminance.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetAdapted = this.renderTargetLuminance.clone();\n    this.renderTargetAdapted.texture.name = \"ToneMapping.AdaptedLuminance\";\n    this.renderTargetAdapted.texture.generateMipmaps = false;\n    this.renderTargetAdapted.texture.minFilter = LinearFilter;\n    /**\r\n     * A render target that holds a copy of the adapted luminance.\r\n     *\r\n     * @type {WebGLRenderTarget}\r\n     * @private\r\n     */\n\n    this.renderTargetPrevious = this.renderTargetAdapted.clone();\n    this.renderTargetPrevious.texture.name = \"ToneMapping.PreviousLuminance\";\n    /**\r\n     * A save pass.\r\n     *\r\n     * @type {SavePass}\r\n     * @private\r\n     */\n\n    this.savePass = new SavePass(this.renderTargetPrevious, false);\n    /**\r\n     * A luminance shader pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.luminancePass = new ShaderPass(new LuminanceMaterial());\n    const luminanceMaterial = this.luminancePass.getFullscreenMaterial();\n    luminanceMaterial.useThreshold = false;\n    /**\r\n     * An adaptive luminance shader pass.\r\n     *\r\n     * @type {ShaderPass}\r\n     * @private\r\n     */\n\n    this.adaptiveLuminancePass = new ShaderPass(new AdaptiveLuminanceMaterial());\n    const uniforms = this.adaptiveLuminancePass.getFullscreenMaterial().uniforms;\n    uniforms.previousLuminanceBuffer.value = this.renderTargetPrevious.texture;\n    uniforms.currentLuminanceBuffer.value = this.renderTargetLuminance.texture;\n    this.adaptationRate = adaptationRate;\n    this.resolution = resolution;\n    this.adaptive = adaptive;\n  }\n  /**\r\n   * The resolution of the render targets.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get resolution() {\n    return this.renderTargetLuminance.width;\n  }\n  /**\r\n   * Sets the resolution of the internal render targets.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  set resolution(value) {\n    // Round the given value to the next power of two.\n    const exponent = Math.max(0, Math.ceil(Math.log2(value)));\n    const size = Math.pow(2, exponent);\n    this.renderTargetLuminance.setSize(size, size);\n    this.renderTargetPrevious.setSize(size, size);\n    this.renderTargetAdapted.setSize(size, size);\n    const material = this.adaptiveLuminancePass.getFullscreenMaterial();\n    material.defines.MIP_LEVEL_1X1 = exponent.toFixed(1);\n    material.needsUpdate = true;\n  }\n  /**\r\n   * Indicates whether this pass uses adaptive luminance.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get adaptive() {\n    return this.defines.has(\"ADAPTED_LUMINANCE\");\n  }\n  /**\r\n   * Enables or disables adaptive luminance.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set adaptive(value) {\n    if (this.adaptive !== value) {\n      if (value) {\n        this.defines.set(\"ADAPTED_LUMINANCE\", \"1\");\n        this.uniforms.get(\"luminanceMap\").value = this.renderTargetAdapted.texture;\n      } else {\n        this.defines.delete(\"ADAPTED_LUMINANCE\");\n        this.uniforms.get(\"luminanceMap\").value = null;\n      }\n\n      this.setChanged();\n    }\n  }\n  /**\r\n   * The luminance adaptation rate.\r\n   *\r\n   * @type {Number}\r\n   */\n\n\n  get adaptationRate() {\n    return this.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value;\n  }\n  /**\r\n   * @type {Number}\r\n   */\n\n\n  set adaptationRate(value) {\n    this.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value = value;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated\r\n   */\n\n\n  get distinction() {\n    console.warn(this.name, \"The distinction field has been removed.\");\n    return 1.0;\n  }\n  /**\r\n   * @type {Number}\r\n   * @deprecated\r\n   */\n\n\n  set distinction(value) {\n    console.warn(this.name, \"The distinction field has been removed.\");\n  }\n  /**\r\n   * Updates this effect.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n   * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n   */\n\n\n  update(renderer, inputBuffer, deltaTime) {\n    if (this.adaptive) {\n      // Render the luminance of the current scene into a mipmap render target.\n      this.luminancePass.render(renderer, inputBuffer, this.renderTargetLuminance); // Use the frame delta to adapt the luminance over time.\n\n      const uniforms = this.adaptiveLuminancePass.getFullscreenMaterial().uniforms;\n      uniforms.deltaTime.value = deltaTime;\n      this.adaptiveLuminancePass.render(renderer, null, this.renderTargetAdapted); // Save the adapted luminance for the next frame.\n\n      this.savePass.render(renderer, this.renderTargetAdapted);\n    }\n  }\n  /**\r\n   * Updates the size of internal render targets.\r\n   *\r\n   * @param {Number} width - The width.\r\n   * @param {Number} height - The height.\r\n   */\n\n\n  setSize(width, height) {\n    this.savePass.setSize(width, height);\n  }\n  /**\r\n   * Performs initialization tasks.\r\n   *\r\n   * @param {WebGLRenderer} renderer - The renderer.\r\n   * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n   * @param {Number} frameBufferType - The type of the main frame buffers.\r\n   */\n\n\n  initialize(renderer, alpha, frameBufferType) {\n    const clearPass = new ClearPass(true, false, false);\n    clearPass.overrideClearColor = new Color(0x7fffff);\n    clearPass.render(renderer, this.renderTargetPrevious);\n    clearPass.dispose();\n  }\n\n}\n\nvar fragmentShader$E = \"uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\\n#ifdef ESKIL\\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\\n#else\\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n/**\r\n * A vignette effect.\r\n */\n\nclass VignetteEffect extends Effect {\n  /**\r\n   * Constructs a new vignette effect.\r\n   *\r\n   * @param {Object} [options] - The options.\r\n   * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n   * @param {Boolean} [options.eskil=false] - Enables Eskil's vignette technique.\r\n   * @param {Number} [options.offset=0.5] - The vignette offset.\r\n   * @param {Number} [options.darkness=0.5] - The vignette darkness.\r\n   */\n  constructor(options = {}) {\n    const settings = Object.assign({\n      blendFunction: BlendFunction.NORMAL,\n      eskil: false,\n      offset: 0.5,\n      darkness: 0.5\n    }, options);\n    super(\"VignetteEffect\", fragmentShader$E, {\n      blendFunction: settings.blendFunction,\n      uniforms: new Map([[\"offset\", new Uniform(settings.offset)], [\"darkness\", new Uniform(settings.darkness)]])\n    });\n    this.eskil = settings.eskil;\n  }\n  /**\r\n   * Indicates whether Eskil's vignette technique is enabled.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  get eskil() {\n    return this.defines.has(\"ESKIL\");\n  }\n  /**\r\n   * Enables or disables Eskil's vignette technique.\r\n   *\r\n   * @type {Boolean}\r\n   */\n\n\n  set eskil(value) {\n    if (this.eskil !== value) {\n      if (value) {\n        this.defines.set(\"ESKIL\", \"1\");\n      } else {\n        this.defines.delete(\"ESKIL\");\n      }\n\n      this.setChanged();\n    }\n  }\n\n}\n/**\r\n * Creates a new canvas from raw image data.\r\n *\r\n * @private\r\n * @param {Number} width - The image width.\r\n * @param {Number} height - The image height.\r\n * @param {Uint8ClampedArray} data - The image data.\r\n * @return {Canvas} The canvas.\r\n */\n\n\nfunction createCanvas(width, height, data) {\n  const canvas = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"canvas\");\n  const context = canvas.getContext(\"2d\");\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(data);\n  canvas.width = width;\n  canvas.height = height;\n  context.putImageData(imageData, 0, 0);\n  return canvas;\n}\n/**\r\n * A container for raw image data.\r\n */\n\n\nclass RawImageData {\n  /**\r\n   * Constructs a new image data container.\r\n   *\r\n   * @param {Number} [width=0] - The width of the image.\r\n   * @param {Number} [height=0] - The height of the image.\r\n   * @param {Uint8ClampedArray} [data=null] - The image data.\r\n   */\n  constructor(width = 0, height = 0, data = null) {\n    /**\r\n     * The width of the image.\r\n     *\r\n     * @type {Number}\r\n     */\n    this.width = width;\n    /**\r\n     * The height of the image.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.height = height;\n    /**\r\n     * The image data.\r\n     *\r\n     * @type {Uint8ClampedArray}\r\n     */\n\n    this.data = data;\n  }\n  /**\r\n   * Creates a canvas from this image data.\r\n   *\r\n   * @return {Canvas} The canvas or null if it couldn't be created.\r\n   */\n\n\n  toCanvas() {\n    return typeof document === \"undefined\" ? null : createCanvas(this.width, this.height, this.data);\n  }\n  /**\r\n   * Creates a new image data container.\r\n   *\r\n   * @param {Object} data - Raw image data.\r\n   * @return {RawImageData} The image data.\r\n   */\n\n\n  static from(data) {\n    return new RawImageData(data.width, data.height, data.data);\n  }\n\n}\n/**\r\n * A 2D vector.\r\n *\r\n * @private\r\n */\n\n\nclass Vector2 {\n  /**\r\n   * Constructs a new vector.\r\n   *\r\n   * @param {Number} [x=0] - The initial x value.\r\n   * @param {Number} [y=0] - The initial y value.\r\n   */\n  constructor(x = 0, y = 0) {\n    /**\r\n     * The X component.\r\n     *\r\n     * @type {Number}\r\n     */\n    this.x = x;\n    /**\r\n     * The Y component.\r\n     *\r\n     * @type {Number}\r\n     */\n\n    this.y = y;\n  }\n  /**\r\n   * Sets the components of this vector.\r\n   *\r\n   * @param {Number} x - The new x value.\r\n   * @param {Number} y - The new y value.\r\n   * @return {Vector2} This vector.\r\n   */\n\n\n  set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n  /**\r\n   * Checks if the given vector equals this vector.\r\n   *\r\n   * @param {Vector2} v - A vector.\r\n   * @return {Boolean} Whether this vector equals the given one.\r\n   */\n\n\n  equals(v) {\n    return this === v || this.x === v.x && this.y === v.y;\n  }\n\n}\n/**\r\n * A 2D box.\r\n *\r\n * @private\r\n */\n\n\nclass Box2 {\n  /**\r\n   * Constructs a new box.\r\n   */\n  constructor() {\n    this.min = new Vector2();\n    this.max = new Vector2();\n  }\n\n}\n/**\r\n * A box.\r\n *\r\n * @type {Box2}\r\n * @private\r\n */\n\n\nconst b0 = new Box2();\n/**\r\n * A box.\r\n *\r\n * @type {Box2}\r\n * @private\r\n */\n\nconst b1 = new Box2();\n/**\r\n * The orthogonal texture size.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst ORTHOGONAL_SIZE = 16;\n/**\r\n * The diagonal texture size.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst DIAGONAL_SIZE = 20;\n/**\r\n * The number of samples for calculating areas in the diagonal textures.\r\n * Diagonal areas are calculated using brute force sampling.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst DIAGONAL_SAMPLES = 30;\n/**\r\n * The maximum distance for smoothing U-shapes.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\n\nconst SMOOTH_MAX_DISTANCE = 32;\n/**\r\n * Subsampling offsets for orthogonal areas.\r\n *\r\n * @type {Float32Array}\r\n * @private\r\n */\n\nconst orthogonalSubsamplingOffsets = new Float32Array([0.0, -0.25, 0.25, -0.125, 0.125, -0.375, 0.375]);\n/**\r\n * Subsampling offset pairs for diagonal areas.\r\n *\r\n * @type {Float32Array[]}\r\n * @private\r\n */\n\nconst diagonalSubsamplingOffsets = [new Float32Array([0.0, 0.0]), new Float32Array([0.25, -0.25]), new Float32Array([-0.25, 0.25]), new Float32Array([0.125, -0.125]), new Float32Array([-0.125, 0.125])];\n/**\r\n * Orthogonal pattern positioning coordinates.\r\n *\r\n * Used for placing each pattern subtexture into a specific spot.\r\n *\r\n * @type {Uint8Array[]}\r\n * @private\r\n */\n\nconst orthogonalEdges = [new Uint8Array([0, 0]), new Uint8Array([3, 0]), new Uint8Array([0, 3]), new Uint8Array([3, 3]), new Uint8Array([1, 0]), new Uint8Array([4, 0]), new Uint8Array([1, 3]), new Uint8Array([4, 3]), new Uint8Array([0, 1]), new Uint8Array([3, 1]), new Uint8Array([0, 4]), new Uint8Array([3, 4]), new Uint8Array([1, 1]), new Uint8Array([4, 1]), new Uint8Array([1, 4]), new Uint8Array([4, 4])];\n/**\r\n * Diagonal pattern positioning coordinates.\r\n *\r\n * Used for placing each pattern subtexture into a specific spot.\r\n *\r\n * @type {Uint8Array[]}\r\n * @private\r\n */\n\nconst diagonalEdges = [new Uint8Array([0, 0]), new Uint8Array([1, 0]), new Uint8Array([0, 2]), new Uint8Array([1, 2]), new Uint8Array([2, 0]), new Uint8Array([3, 0]), new Uint8Array([2, 2]), new Uint8Array([3, 2]), new Uint8Array([0, 1]), new Uint8Array([1, 1]), new Uint8Array([0, 3]), new Uint8Array([1, 3]), new Uint8Array([2, 1]), new Uint8Array([3, 1]), new Uint8Array([2, 3]), new Uint8Array([3, 3])];\n/**\r\n * Linearly interpolates between two values.\r\n *\r\n * @private\r\n * @param {Number} a - The initial value.\r\n * @param {Number} b - The target value.\r\n * @param {Number} p - The interpolation value.\r\n * @return {Number} The interpolated value.\r\n */\n\nfunction lerp(a, b, p) {\n  return a + (b - a) * p;\n}\n/**\r\n * Clamps a value to the range [0, 1].\r\n *\r\n * @private\r\n * @param {Number} a - The value.\r\n * @return {Number} The saturated value.\r\n */\n\n\nfunction saturate(a) {\n  return Math.min(Math.max(a, 0.0), 1.0);\n}\n/**\r\n * A smoothing function for small U-patterns.\r\n *\r\n * @private\r\n * @param {Number} d - A smoothing factor.\r\n * @param {Box2} b - The area that should be smoothed.\r\n * @return {Box2} The smoothed area.\r\n */\n\n\nfunction smoothArea(d, b) {\n  const a1 = b.min;\n  const a2 = b.max;\n  const b1X = Math.sqrt(a1.x * 2.0) * 0.5;\n  const b1Y = Math.sqrt(a1.y * 2.0) * 0.5;\n  const b2X = Math.sqrt(a2.x * 2.0) * 0.5;\n  const b2Y = Math.sqrt(a2.y * 2.0) * 0.5;\n  const p = saturate(d / SMOOTH_MAX_DISTANCE);\n  a1.set(lerp(b1X, a1.x, p), lerp(b1Y, a1.y, p));\n  a2.set(lerp(b2X, a2.x, p), lerp(b2Y, a2.y, p));\n  return b;\n}\n/**\r\n * Calculates the area under the line p1 -> p2, for the pixels (x, x + 1).\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The starting point of the line.\r\n * @param {Vector2} p2 - The ending point of the line.\r\n * @param {Number} x - The pixel index.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The area.\r\n */\n\n\nfunction calculateOrthogonalArea(p1, p2, x, result) {\n  const dX = p2.x - p1.x;\n  const dY = p2.y - p1.y;\n  const x1 = x;\n  const x2 = x + 1.0;\n  const y1 = p1.y + dY * (x1 - p1.x) / dX;\n  const y2 = p1.y + dY * (x2 - p1.x) / dX;\n  let a, a1, a2, t; // Check if x is inside the area.\n\n  if (x1 >= p1.x && x1 < p2.x || x2 > p1.x && x2 <= p2.x) {\n    // Check if this is a trapezoid.\n    if (Math.sign(y1) === Math.sign(y2) || Math.abs(y1) < 1e-4 || Math.abs(y2) < 1e-4) {\n      a = (y1 + y2) / 2.0;\n\n      if (a < 0.0) {\n        result.set(Math.abs(a), 0.0);\n      } else {\n        result.set(0.0, Math.abs(a));\n      }\n    } else {\n      // Two triangles.\n      t = -p1.y * dX / dY + p1.x;\n      a1 = t > p1.x ? y1 * (t - Math.trunc(t)) / 2.0 : 0.0;\n      a2 = t < p2.x ? y2 * (1.0 - (t - Math.trunc(t))) / 2.0 : 0.0;\n      a = Math.abs(a1) > Math.abs(a2) ? a1 : -a2;\n\n      if (a < 0.0) {\n        result.set(Math.abs(a1), Math.abs(a2));\n      } else {\n        result.set(Math.abs(a2), Math.abs(a1));\n      }\n    }\n  } else {\n    result.set(0, 0);\n  }\n\n  return result;\n}\n/**\r\n * Calculates the area for a given pattern and distances to the left and to the\r\n * right, biased by an offset.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Number} left - The left distance.\r\n * @param {Number} right - The right distance.\r\n * @param {Number} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The orthogonal area.\r\n */\n\n\nfunction calculateOrthogonalAreaForPattern(pattern, left, right, offset, result) {\n  const p1 = b0.min;\n  const p2 = b0.max;\n  const a1 = b1.min;\n  const a2 = b1.max;\n  const a = b1;\n  /* o1           |\r\n   *      .-------Â´\r\n   * o2   |\r\n   *\r\n   *      <---d--->\r\n   */\n\n  const o1 = 0.5 + offset;\n  const o2 = 0.5 + offset - 1.0;\n  const d = left + right + 1;\n\n  switch (pattern) {\n    case 0:\n      {\n        //    ------\n        result.set(0, 0);\n        break;\n      }\n\n    case 1:\n      {\n        /*   .------\r\n         *   |\r\n         *\r\n         * The offset is only applied to L patterns in the crossing edge side to\r\n         * make it converge with the unfiltered pattern 0.\r\n         * The pattern 0 must not be filtered to avoid artifacts.\r\n         */\n        if (left <= right) {\n          calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, result);\n        } else {\n          result.set(0, 0);\n        }\n\n        break;\n      }\n\n    case 2:\n      {\n        /*    ------.\r\n         *          |\r\n         */\n        if (left >= right) {\n          calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, result);\n        } else {\n          result.set(0, 0);\n        }\n\n        break;\n      }\n\n    case 3:\n      {\n        /*   .------.\r\n         *   |      |\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, a1);\n        calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, a2);\n        smoothArea(d, a);\n        result.set(a1.x + a2.x, a1.y + a2.y);\n        break;\n      }\n\n    case 4:\n      {\n        /*   |\r\n         *   `------\r\n         */\n        if (left <= right) {\n          calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, result);\n        } else {\n          result.set(0, 0);\n        }\n\n        break;\n      }\n\n    case 5:\n      {\n        /*   |\r\n         *   +------\r\n         *   |\r\n         */\n        result.set(0, 0);\n        break;\n      }\n\n    case 6:\n      {\n        /*   |\r\n         *   `------.\r\n         *          |\r\n         *\r\n         * A problem of not offseting L patterns (see above) is that for certain\r\n         * max search distances, the pixels in the center of a Z pattern will\r\n         * detect the full Z pattern, while the pixels in the sides will detect an\r\n         * L pattern. To avoid discontinuities, the full offsetted Z\r\n         * revectorization is blended with partially offsetted L patterns.\r\n         */\n        if (Math.abs(offset) > 0.0) {\n          calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, a1);\n          calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, a2);\n          calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, result);\n          a2.set(a2.x + result.x, a2.y + result.y);\n          result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        } else {\n          calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\n        }\n\n        break;\n      }\n\n    case 7:\n      {\n        /*   |\r\n         *   +------.\r\n         *   |      |\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\n        break;\n      }\n\n    case 8:\n      {\n        /*          |\r\n         *    ------Â´\r\n         */\n        if (left >= right) {\n          calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, result);\n        } else {\n          result.set(0, 0);\n        }\n\n        break;\n      }\n\n    case 9:\n      {\n        /*          |\r\n         *   .------Â´\r\n         *   |\r\n         */\n        if (Math.abs(offset) > 0.0) {\n          calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, a1);\n          calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, a2);\n          calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, result);\n          a2.set(a2.x + result.x, a2.y + result.y);\n          result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        } else {\n          calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\n        }\n\n        break;\n      }\n\n    case 10:\n      {\n        /*          |\r\n         *    ------+\r\n         *          |\r\n         */\n        result.set(0, 0);\n        break;\n      }\n\n    case 11:\n      {\n        /*          |\r\n         *   .------+\r\n         *   |      |\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\n        break;\n      }\n\n    case 12:\n      {\n        /*   |      |\r\n         *   `------Â´\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, a1);\n        calculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, a2);\n        smoothArea(d, a);\n        result.set(a1.x + a2.x, a1.y + a2.y);\n        break;\n      }\n\n    case 13:\n      {\n        /*   |      |\r\n         *   +------Â´\r\n         *   |\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\n        break;\n      }\n\n    case 14:\n      {\n        /*   |      |\r\n         *   `------+\r\n         *          |\r\n         */\n        calculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\n        break;\n      }\n\n    case 15:\n      {\n        /*   |      |\r\n         *   +------+\r\n         *   |      |\r\n         */\n        result.set(0, 0);\n        break;\n      }\n  }\n\n  return result;\n}\n/**\r\n * Determines whether the given pixel is inside the specified area.\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Vector2} x - The X-coordinates.\r\n * @param {Vector2} y - The Y-coordinates.\r\n * @return {Vector2} Whether the pixel lies inside the area.\r\n */\n\n\nfunction isInsideArea(p1, p2, x, y) {\n  let result = p1.equals(p2);\n\n  if (!result) {\n    let xm = (p1.x + p2.x) / 2.0;\n    let ym = (p1.y + p2.y) / 2.0;\n    let a = p2.y - p1.y;\n    let b = p1.x - p2.x;\n    let c = a * (x - xm) + b * (y - ym);\n    result = c > 0.0;\n  }\n\n  return result;\n}\n/**\r\n * Calculates the area under the line p1 -> p2 for the pixel p using brute force\r\n * sampling.\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Number} pX - The X-coordinates.\r\n * @param {Number} pY - The Y-coordinates.\r\n * @return {Number} The amount of pixels inside the area relative to the total amount of sampled pixels.\r\n */\n\n\nfunction calculateDiagonalAreaForPixel(p1, p2, pX, pY) {\n  let a;\n  let x, y;\n  let offsetX, offsetY;\n\n  for (a = 0, y = 0; y < DIAGONAL_SAMPLES; ++y) {\n    for (x = 0; x < DIAGONAL_SAMPLES; ++x) {\n      offsetX = x / (DIAGONAL_SAMPLES - 1.0);\n      offsetY = y / (DIAGONAL_SAMPLES - 1.0);\n\n      if (isInsideArea(p1, p2, pX + offsetX, pY + offsetY)) {\n        ++a;\n      }\n    }\n  }\n\n  return a / (DIAGONAL_SAMPLES * DIAGONAL_SAMPLES);\n}\n/**\r\n * Calculates the area under the line p1 -> p2. This includes the pixel and its\r\n * opposite.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Number} left - The left distance.\r\n * @param {Float32Array} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The area.\r\n */\n\n\nfunction calculateDiagonalArea(pattern, p1, p2, left, offset, result) {\n  const e = diagonalEdges[pattern];\n  const e1 = e[0];\n  const e2 = e[1];\n\n  if (e1 > 0) {\n    p1.x += offset[0];\n    p1.y += offset[1];\n  }\n\n  if (e2 > 0) {\n    p2.x += offset[0];\n    p2.y += offset[1];\n  }\n\n  return result.set(1.0 - calculateDiagonalAreaForPixel(p1, p2, 1.0 + left, 0.0 + left), calculateDiagonalAreaForPixel(p1, p2, 1.0 + left, 1.0 + left));\n}\n/**\r\n * Calculates the area for a given pattern and distances to the left and to the\r\n * right, biased by an offset.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Number} left - The left distance.\r\n * @param {Number} right - The right distance.\r\n * @param {Float32Array} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The orthogonal area.\r\n */\n\n\nfunction calculateDiagonalAreaForPattern(pattern, left, right, offset, result) {\n  const p1 = b0.min;\n  const p2 = b0.max;\n  const a1 = b1.min;\n  const a2 = b1.max;\n  const d = left + right + 1;\n  /* There is some Black Magic involved in the diagonal area calculations.\r\n   *\r\n   * Unlike orthogonal patterns, the \"null\" pattern (one without crossing edges)\r\n   * must be filtered, and the ends of both the \"null\" and L patterns are not\r\n   * known: L and U patterns have different endings, and the adjacent pattern is\r\n   * unknown. Therefore, a blend of both possibilities is computed.\r\n   */\n\n  switch (pattern) {\n    case 0:\n      {\n        /*         .-Â´\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   Â´\r\n         */\n        // First possibility.\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1); // Second possibility.\n\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2); // Blend both possibilities together.\n\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 1:\n      {\n        /*         .-Â´\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 2:\n      {\n        /*         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 3:\n      {\n        /*\r\n         *         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, result);\n        break;\n      }\n\n    case 4:\n      {\n        /*         .-Â´\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * ----Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 5:\n      {\n        /*         .-Â´\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * --.-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 6:\n      {\n        /*         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * ----Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, result);\n        break;\n      }\n\n    case 7:\n      {\n        /*         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * --.-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 8:\n      {\n        /*         |\r\n         *         |\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 9:\n      {\n        /*         |\r\n         *         |\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, result);\n        break;\n      }\n\n    case 10:\n      {\n        /*         |\r\n         *         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 11:\n      {\n        /*         |\r\n         *         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         *   .-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 12:\n      {\n        /*         |\r\n         *         |\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * ----Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, result);\n        break;\n      }\n\n    case 13:\n      {\n        /*         |\r\n         *         |\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * --.-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 14:\n      {\n        /*         |\r\n         *         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * ----Â´\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n\n    case 15:\n      {\n        /*         |\r\n         *         .----\r\n         *       .-Â´\r\n         *     .-Â´\r\n         * --.-Â´\r\n         *   |\r\n         *   |\r\n         */\n        calculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\n        calculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\n        result.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\n        break;\n      }\n  }\n\n  return result;\n}\n/**\r\n * Calculates orthogonal or diagonal patterns for a given offset.\r\n *\r\n * @private\r\n * @param {RawImageData[]} patterns - The patterns to assemble.\r\n * @param {Number|Float32Array} offset - A pattern offset. Diagonal offsets are pairs.\r\n * @param {Boolean} orthogonal - Whether the patterns are orthogonal or diagonal.\r\n */\n\n\nfunction generatePatterns(patterns, offset, orthogonal) {\n  const result = new Vector2();\n  let i, l;\n  let x, y;\n  let c;\n  let pattern;\n  let data, size;\n\n  for (i = 0, l = patterns.length; i < l; ++i) {\n    pattern = patterns[i];\n    data = pattern.data;\n    size = pattern.width;\n\n    for (y = 0; y < size; ++y) {\n      for (x = 0; x < size; ++x) {\n        if (orthogonal) {\n          calculateOrthogonalAreaForPattern(i, x, y, offset, result);\n        } else {\n          calculateDiagonalAreaForPattern(i, x, y, offset, result);\n        }\n\n        c = (y * size + x) * 2;\n        data[c] = result.x * 255;\n        data[c + 1] = result.y * 255;\n      }\n    }\n  }\n}\n/**\r\n * Assembles orthogonal or diagonal patterns into the final area image.\r\n *\r\n * @private\r\n * @param {Vector2} base - A base position.\r\n * @param {RawImageData[]} patterns - The patterns to assemble.\r\n * @param {Uint8Array[]} edges - Edge coordinate pairs, used for positioning.\r\n * @param {Number} size - The pattern size.\r\n * @param {Boolean} orthogonal - Whether the patterns are orthogonal or diagonal.\r\n * @param {RawImageData} target - The target image data.\r\n */\n\n\nfunction assemble(base, patterns, edges, size, orthogonal, target) {\n  const p = new Vector2();\n  const dstData = target.data;\n  const dstWidth = target.width;\n  let i, l;\n  let x, y;\n  let c, d;\n  let edge;\n  let pattern;\n  let srcData, srcWidth;\n\n  for (i = 0, l = patterns.length; i < l; ++i) {\n    edge = edges[i];\n    pattern = patterns[i];\n    srcData = pattern.data;\n    srcWidth = pattern.width;\n\n    for (y = 0; y < size; ++y) {\n      for (x = 0; x < size; ++x) {\n        p.set(edge[0] * size + base.x + x, edge[1] * size + base.y + y);\n        c = (p.y * dstWidth + p.x) * 4;\n        /* The texture coordinates of orthogonal patterns are compressed\r\n        quadratically to reach longer distances for a given texture size. */\n\n        d = orthogonal ? (y * y * srcWidth + x * x) * 2 : (y * srcWidth + x) * 2;\n        dstData[c] = srcData[d];\n        dstData[c + 1] = srcData[d + 1];\n        dstData[c + 2] = 0;\n        dstData[c + 3] = 255;\n      }\n    }\n  }\n}\n/**\r\n * SMAA area image data.\r\n *\r\n * This texture allows to obtain the area for a certain pattern and distances\r\n * to the left and to the right of the identified line.\r\n *\r\n * Based on the official python scripts:\r\n *  https://github.com/iryoku/smaa/tree/master/Scripts\r\n */\n\n\nclass SMAAAreaImageData {\n  /**\r\n   * Creates a new area image.\r\n   *\r\n   * @return {RawImageData} The generated image data.\r\n   */\n  static generate() {\n    const width = 2 * 5 * ORTHOGONAL_SIZE;\n    const height = orthogonalSubsamplingOffsets.length * 5 * ORTHOGONAL_SIZE;\n    const data = new Uint8ClampedArray(width * height * 4);\n    const result = new RawImageData(width, height, data);\n    const orthogonalPatternSize = Math.pow(ORTHOGONAL_SIZE - 1, 2) + 1;\n    const diagonalPatternSize = DIAGONAL_SIZE;\n    const orthogonalPatterns = [];\n    const diagonalPatterns = [];\n    const base = new Vector2();\n    let i, l; // Prepare 16 image data sets for the orthogonal and diagonal subtextures.\n\n    for (i = 0; i < 16; ++i) {\n      orthogonalPatterns.push(new RawImageData(orthogonalPatternSize, orthogonalPatternSize, new Uint8ClampedArray(orthogonalPatternSize * orthogonalPatternSize * 2), 2));\n      diagonalPatterns.push(new RawImageData(diagonalPatternSize, diagonalPatternSize, new Uint8ClampedArray(diagonalPatternSize * diagonalPatternSize * 2), 2));\n    }\n\n    for (i = 0, l = orthogonalSubsamplingOffsets.length; i < l; ++i) {\n      // Generate 16 orthogonal patterns for each offset.\n      generatePatterns(orthogonalPatterns, orthogonalSubsamplingOffsets[i], true); // Assemble the orthogonal patterns and place them on the left side.\n\n      base.set(0, 5 * ORTHOGONAL_SIZE * i);\n      assemble(base, orthogonalPatterns, orthogonalEdges, ORTHOGONAL_SIZE, true, result);\n    }\n\n    for (i = 0, l = diagonalSubsamplingOffsets.length; i < l; ++i) {\n      // Generate 16 diagonal patterns for each offset.\n      generatePatterns(diagonalPatterns, diagonalSubsamplingOffsets[i], false); // Assemble the diagonal patterns and place them on the right side.\n\n      base.set(5 * ORTHOGONAL_SIZE, 4 * DIAGONAL_SIZE * i);\n      assemble(base, diagonalPatterns, diagonalEdges, DIAGONAL_SIZE, false, result);\n    }\n\n    return result;\n  }\n\n}\n/**\r\n * This dictionary returns which edges are active for a certain bilinear fetch:\r\n * it's the reverse lookup of the bilinear function.\r\n *\r\n * @type {Map}\r\n * @private\r\n */\n\n\nconst edges = new Map([[bilinear([0, 0, 0, 0]), [0, 0, 0, 0]], [bilinear([0, 0, 0, 1]), [0, 0, 0, 1]], [bilinear([0, 0, 1, 0]), [0, 0, 1, 0]], [bilinear([0, 0, 1, 1]), [0, 0, 1, 1]], [bilinear([0, 1, 0, 0]), [0, 1, 0, 0]], [bilinear([0, 1, 0, 1]), [0, 1, 0, 1]], [bilinear([0, 1, 1, 0]), [0, 1, 1, 0]], [bilinear([0, 1, 1, 1]), [0, 1, 1, 1]], [bilinear([1, 0, 0, 0]), [1, 0, 0, 0]], [bilinear([1, 0, 0, 1]), [1, 0, 0, 1]], [bilinear([1, 0, 1, 0]), [1, 0, 1, 0]], [bilinear([1, 0, 1, 1]), [1, 0, 1, 1]], [bilinear([1, 1, 0, 0]), [1, 1, 0, 0]], [bilinear([1, 1, 0, 1]), [1, 1, 0, 1]], [bilinear([1, 1, 1, 0]), [1, 1, 1, 0]], [bilinear([1, 1, 1, 1]), [1, 1, 1, 1]]]);\n/**\r\n * Linearly interpolates between two values.\r\n *\r\n * @private\r\n * @param {Number} a - The initial value.\r\n * @param {Number} b - The target value.\r\n * @param {Number} p - The interpolation value.\r\n * @return {Number} The interpolated value.\r\n */\n\nfunction lerp$1(a, b, p) {\n  return a + (b - a) * p;\n}\n/**\r\n * Calculates the bilinear fetch for a certain edge combination.\r\n *\r\n *     e[0]       e[1]\r\n *\r\n *              x <-------- Sample Position: (-0.25, -0.125)\r\n *     e[2]       e[3] <--- Current Pixel [3]: (0.0, 0.0)\r\n *\r\n * @private\r\n * @param {Number[]} e - The edge combination.\r\n * @return {Number} The interpolated value.\r\n */\n\n\nfunction bilinear(e) {\n  const a = lerp$1(e[0], e[1], 1.0 - 0.25);\n  const b = lerp$1(e[2], e[3], 1.0 - 0.25);\n  return lerp$1(a, b, 1.0 - 0.125);\n}\n/**\r\n * Computes the delta distance to add in the last step of searches to the left.\r\n *\r\n * @private\r\n * @param {Number[]} left - The left edge combination.\r\n * @param {Number[]} top - The top edge combination.\r\n * @return {Number} The left delta distance.\r\n */\n\n\nfunction deltaLeft(left, top) {\n  let d = 0; // If there is an edge, continue.\n\n  if (top[3] === 1) {\n    d += 1;\n  }\n  /* If an edge was previously found, there is another edge and there are no\r\n  crossing edges, continue. */\n\n\n  if (d === 1 && top[2] === 1 && left[1] !== 1 && left[3] !== 1) {\n    d += 1;\n  }\n\n  return d;\n}\n/**\r\n * Computes the delta distance to add in the last step of searches to the right.\r\n *\r\n * @private\r\n * @param {Number[]} left - The left edge combination.\r\n * @param {Number[]} top - The top edge combination.\r\n * @return {Number} The right delta distance.\r\n */\n\n\nfunction deltaRight(left, top) {\n  let d = 0; // If there is an edge, and no crossing edges, continue.\n\n  if (top[3] === 1 && left[1] !== 1 && left[3] !== 1) {\n    d += 1;\n  }\n  /* If an edge was previously found, there is another edge and there are no\r\n  crossing edges, continue. */\n\n\n  if (d === 1 && top[2] === 1 && left[0] !== 1 && left[2] !== 1) {\n    d += 1;\n  }\n\n  return d;\n}\n/**\r\n * SMAA search image data.\r\n *\r\n * This image stores information about how many pixels the line search\r\n * algorithm must advance in the last step.\r\n *\r\n * Based on the official python scripts:\r\n *  https://github.com/iryoku/smaa/tree/master/Scripts\r\n */\n\n\nclass SMAASearchImageData {\n  /**\r\n   * Creates a new search image.\r\n   *\r\n   * @return {RawImageData} The generated image data.\r\n   */\n  static generate() {\n    const width = 66;\n    const height = 33;\n    const halfWidth = width / 2;\n    const croppedWidth = 64;\n    const croppedHeight = 16;\n    const data = new Uint8ClampedArray(width * height);\n    const croppedData = new Uint8ClampedArray(croppedWidth * croppedHeight * 4);\n    let x, y;\n    let s, t, i;\n    let e1, e2; // Calculate delta distances.\n\n    for (y = 0; y < height; ++y) {\n      for (x = 0; x < width; ++x) {\n        s = 0.03125 * x;\n        t = 0.03125 * y;\n\n        if (edges.has(s) && edges.has(t)) {\n          e1 = edges.get(s);\n          e2 = edges.get(t);\n          i = y * width + x; // Maximize the dynamic range to help the compression.\n\n          data[i] = 127 * deltaLeft(e1, e2);\n          data[i + halfWidth] = 127 * deltaRight(e1, e2);\n        }\n      }\n    } // Crop the result to powers-of-two to make it BC4-friendly.\n\n\n    for (i = 0, y = height - croppedHeight; y < height; ++y) {\n      for (x = 0; x < croppedWidth; ++x, i += 4) {\n        croppedData[i] = data[y * width + x];\n        croppedData[i + 3] = 255;\n      }\n    }\n\n    return new RawImageData(croppedWidth, croppedHeight, croppedData);\n  }\n\n}\n\nvar workerProgram = \"!function(){\\\"use strict\\\";function e(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\\\"value\\\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}var n=function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e(this,t),this.width=a,this.height=n,this.data=s}return a(t,[{key:\\\"toCanvas\\\",value:function(){return\\\"undefined\\\"==typeof document?null:(e=this.width,t=this.height,a=this.data,n=document.createElementNS(\\\"http://www.w3.org/1999/xhtml\\\",\\\"canvas\\\"),s=n.getContext(\\\"2d\\\"),(r=s.createImageData(e,t)).data.set(a),n.width=e,n.height=t,s.putImageData(r,0,0),n);var e,t,a,n,s,r}}],[{key:\\\"from\\\",value:function(e){return new t(e.width,e.height,e.data)}}]),t}(),s=function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,t),this.x=a,this.y=n}return a(t,[{key:\\\"set\\\",value:function(e,t){return this.x=e,this.y=t,this}},{key:\\\"equals\\\",value:function(e){return this===e||this.x===e.x&&this.y===e.y}}]),t}(),r=function t(){e(this,t),this.min=new s,this.max=new s},i=new r,y=new r,c=16,u=30,h=new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),o=[new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125])],w=[new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4])],x=[new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3])];function f(e,t,a){return e+(t-e)*a}function l(e,t){var a,n=t.min,s=t.max,r=.5*Math.sqrt(2*n.x),i=.5*Math.sqrt(2*n.y),y=.5*Math.sqrt(2*s.x),c=.5*Math.sqrt(2*s.y),u=(a=e/32,Math.min(Math.max(a,0),1));return n.set(f(r,n.x,u),f(i,n.y,u)),s.set(f(y,s.x,u),f(c,s.y,u)),t}function b(e,t,a,n){var s,r,i,y,c=t.x-e.x,u=t.y-e.y,h=a,o=a+1,w=e.y+u*(h-e.x)/c,x=e.y+u*(o-e.x)/c;return h>=e.x&&h<t.x||o>e.x&&o<=t.x?Math.sign(w)===Math.sign(x)||Math.abs(w)<1e-4||Math.abs(x)<1e-4?(s=(w+x)/2)<0?n.set(Math.abs(s),0):n.set(0,Math.abs(s)):(r=(y=-e.y*c/u+e.x)>e.x?w*(y-Math.trunc(y))/2:0,i=y<t.x?x*(1-(y-Math.trunc(y)))/2:0,(s=Math.abs(r)>Math.abs(i)?r:-i)<0?n.set(Math.abs(r),Math.abs(i)):n.set(Math.abs(i),Math.abs(r))):n.set(0,0),n}function A(e,t,a,n,s){var r=i.min,c=i.max,u=y.min,h=y.max,o=y,w=.5+n,x=.5+n-1,f=t+a+1;switch(e){case 0:s.set(0,0);break;case 1:t<=a?b(r.set(0,x),c.set(f/2,0),t,s):s.set(0,0);break;case 2:t>=a?b(r.set(f/2,0),c.set(f,x),t,s):s.set(0,0);break;case 3:b(r.set(0,x),c.set(f/2,0),t,u),b(r.set(f/2,0),c.set(f,x),t,h),l(f,o),s.set(u.x+h.x,u.y+h.y);break;case 4:t<=a?b(r.set(0,w),c.set(f/2,0),t,s):s.set(0,0);break;case 5:s.set(0,0);break;case 6:Math.abs(n)>0?(b(r.set(0,w),c.set(f,x),t,u),b(r.set(0,w),c.set(f/2,0),t,h),b(r.set(f/2,0),c.set(f,x),t,s),h.set(h.x+s.x,h.y+s.y),s.set((u.x+h.x)/2,(u.y+h.y)/2)):b(r.set(0,w),c.set(f,x),t,s);break;case 7:b(r.set(0,w),c.set(f,x),t,s);break;case 8:t>=a?b(r.set(f/2,0),c.set(f,w),t,s):s.set(0,0);break;case 9:Math.abs(n)>0?(b(r.set(0,x),c.set(f,w),t,u),b(r.set(0,x),c.set(f/2,0),t,h),b(r.set(f/2,0),c.set(f,w),t,s),h.set(h.x+s.x,h.y+s.y),s.set((u.x+h.x)/2,(u.y+h.y)/2)):b(r.set(0,x),c.set(f,w),t,s);break;case 10:s.set(0,0);break;case 11:b(r.set(0,x),c.set(f,w),t,s);break;case 12:b(r.set(0,w),c.set(f/2,0),t,u),b(r.set(f/2,0),c.set(f,w),t,h),l(f,o),s.set(u.x+h.x,u.y+h.y);break;case 13:b(r.set(0,x),c.set(f,w),t,s);break;case 14:b(r.set(0,w),c.set(f,x),t,s);break;case 15:s.set(0,0)}return s}function v(e,t,a,n){var s=e.equals(t);if(!s){var r=(e.x+t.x)/2,i=(e.y+t.y)/2;s=(t.y-e.y)*(a-r)+(e.x-t.x)*(n-i)>0}return s}function k(e,t,a,n){var s,r,i;for(s=0,i=0;i<u;++i)for(r=0;r<u;++r)v(e,t,a+r/29,n+i/29)&&++s;return s/900}function U(e,t,a,n,s,r){var i=x[e],y=i[0],c=i[1];return y>0&&(t.x+=s[0],t.y+=s[1]),c>0&&(a.x+=s[0],a.y+=s[1]),r.set(1-k(t,a,1+n,0+n),k(t,a,1+n,1+n))}function d(e,t,a,n,s){var r=i.min,c=i.max,u=y.min,h=y.max,o=t+a+1;switch(e){case 0:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 1:U(e,r.set(1,0),c.set(0+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 2:U(e,r.set(0,0),c.set(1+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 3:U(e,r.set(1,0),c.set(1+o,0+o),t,n,s);break;case 4:U(e,r.set(1,1),c.set(0+o,0+o),t,n,u),U(e,r.set(1,1),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 5:U(e,r.set(1,1),c.set(0+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 6:U(e,r.set(1,1),c.set(1+o,0+o),t,n,s);break;case 7:U(e,r.set(1,1),c.set(1+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 8:U(e,r.set(0,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,1+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 9:U(e,r.set(1,0),c.set(1+o,1+o),t,n,s);break;case 10:U(e,r.set(0,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 11:U(e,r.set(1,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 12:U(e,r.set(1,1),c.set(1+o,1+o),t,n,s);break;case 13:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,1+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 14:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,1),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 15:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2)}return s}function g(e,t,a){var n,r,i,y,c,u,h,o,w=new s;for(n=0,r=e.length;n<r;++n)for(h=(u=e[n]).data,o=u.width,y=0;y<o;++y)for(i=0;i<o;++i)a?A(n,i,y,t,w):d(n,i,y,t,w),h[c=2*(y*o+i)]=255*w.x,h[c+1]=255*w.y}function m(e,t,a,n,r,i){var y,c,u,h,o,w,x,f,l,b,A=new s,v=i.data,k=i.width;for(y=0,c=t.length;y<c;++y)for(x=a[y],l=(f=t[y]).data,b=f.width,h=0;h<n;++h)for(u=0;u<n;++u)A.set(x[0]*n+e.x+u,x[1]*n+e.y+h),w=r?2*(h*h*b+u*u):2*(h*b+u),v[o=4*(A.y*k+A.x)]=l[w],v[o+1]=l[w+1],v[o+2]=0,v[o+3]=255}var M=function(){function t(){e(this,t)}return a(t,null,[{key:\\\"generate\\\",value:function(){var e,t,a=5*h.length*c,r=new Uint8ClampedArray(160*a*4),i=new n(160,a,r),y=Math.pow(15,2)+1,u=[],f=[],l=new s;for(e=0;e<16;++e)u.push(new n(y,y,new Uint8ClampedArray(y*y*2),2)),f.push(new n(20,20,new Uint8ClampedArray(800),2));for(e=0,t=h.length;e<t;++e)g(u,h[e],!0),l.set(0,80*e),m(l,u,w,c,!0,i);for(e=0,t=o.length;e<t;++e)g(f,o[e],!1),l.set(80,80*e),m(l,f,x,20,!1,i);return i}}]),t}(),p=new Map([[q([0,0,0,0]),[0,0,0,0]],[q([0,0,0,1]),[0,0,0,1]],[q([0,0,1,0]),[0,0,1,0]],[q([0,0,1,1]),[0,0,1,1]],[q([0,1,0,0]),[0,1,0,0]],[q([0,1,0,1]),[0,1,0,1]],[q([0,1,1,0]),[0,1,1,0]],[q([0,1,1,1]),[0,1,1,1]],[q([1,0,0,0]),[1,0,0,0]],[q([1,0,0,1]),[1,0,0,1]],[q([1,0,1,0]),[1,0,1,0]],[q([1,0,1,1]),[1,0,1,1]],[q([1,1,0,0]),[1,1,0,0]],[q([1,1,0,1]),[1,1,0,1]],[q([1,1,1,0]),[1,1,1,0]],[q([1,1,1,1]),[1,1,1,1]]]);function C(e,t,a){return e+(t-e)*a}function q(e){var t=C(e[0],e[1],.75),a=C(e[2],e[3],.75);return C(t,a,.875)}function F(e,t){var a=0;return 1===t[3]&&1!==e[1]&&1!==e[3]&&(a+=1),1===a&&1===t[2]&&1!==e[0]&&1!==e[2]&&(a+=1),a}var D=function(){function t(){e(this,t)}return a(t,null,[{key:\\\"generate\\\",value:function(){var e,t,a,s,r,i,y,c,u,h,o=new Uint8ClampedArray(2178),w=new Uint8ClampedArray(4096);for(t=0;t<33;++t)for(e=0;e<66;++e)a=.03125*e,s=.03125*t,p.has(a)&&p.has(s)&&(i=p.get(a),y=p.get(s),o[r=66*t+e]=127*(c=i,h=void 0,h=0,1===(u=y)[3]&&(h+=1),1===h&&1===u[2]&&1!==c[1]&&1!==c[3]&&(h+=1),h),o[r+33]=127*F(i,y));for(r=0,t=17;t<33;++t)for(e=0;e<64;++e,r+=4)w[r]=o[66*t+e],w[r+3]=255;return new n(64,16,w)}}]),t}();self.addEventListener(\\\"message\\\",(function(e){var t=M.generate(),a=D.generate();postMessage({areaImageData:t,searchImageData:a},[t.data.buffer,a.data.buffer]),close()}))}();\\n\";\n/**\r\n * Generates the SMAA data images.\r\n *\r\n * @private\r\n * @param {Boolean} [disableCache=false] - Determines whether the generated image data should be cached.\r\n * @return {Promise} A promise that returns the search image and area image as a data URL pair.\r\n */\n\nfunction generate(disableCache = false) {\n  const workerURL = URL.createObjectURL(new Blob([workerProgram], {\n    type: \"text/javascript\"\n  }));\n  const worker = new Worker(workerURL);\n  return new Promise((resolve, reject) => {\n    worker.addEventListener(\"error\", event => reject(event.error));\n    worker.addEventListener(\"message\", event => {\n      const searchImageData = RawImageData.from(event.data.searchImageData);\n      const areaImageData = RawImageData.from(event.data.areaImageData);\n      const urls = [searchImageData.toCanvas().toDataURL(), areaImageData.toCanvas().toDataURL()];\n\n      if (!disableCache && window.localStorage !== undefined) {\n        localStorage.setItem(\"smaa-search\", urls[0]);\n        localStorage.setItem(\"smaa-area\", urls[1]);\n      }\n\n      URL.revokeObjectURL(workerURL);\n      resolve(urls);\n    });\n    worker.postMessage(null);\n  });\n}\n/**\r\n * An SMAA image loader.\r\n *\r\n * This loader uses a worker thread to generate the search and area images. The\r\n * Generated data URLs will be cached using localStorage, if available. To\r\n * disable caching, please refer to {@link SMAAImageLoader.disableCache}.\r\n *\r\n * @experimental Added for testing, API might change in patch or minor releases. Requires three >= r108.\r\n */\n\n\nclass SMAAImageLoader extends Loader {\n  /**\r\n   * Constructs a new SMAA image loader.\r\n   *\r\n   * @param {LoadingManager} [manager] - A loading manager.\r\n   */\n  constructor(manager) {\n    super(manager);\n    /**\r\n     * Indicates whether data image caching is disabled.\r\n     *\r\n     * @type {Boolean}\r\n     */\n\n    this.disableCache = false;\n  }\n  /**\r\n   * Loads the SMAA data images.\r\n   *\r\n   * @param {Function} [onLoad] - A function to call when the loading process is done.\r\n   * @param {Function} [onError] - A function to call when an error occurs.\r\n   * @return {Promise<Image[]>} A promise that returns the search image and area image as a pair.\r\n   */\n\n\n  load(onLoad = () => {}, onError = () => {}) {\n    // Conform to the signature (url, onLoad, onProgress, onError).\n    if (arguments.length === 4) {\n      onLoad = arguments[1];\n      onError = arguments[3];\n    } else if (arguments.length === 3 || typeof arguments[0] !== \"function\") {\n      onLoad = arguments[1];\n\n      onError = () => {};\n    }\n\n    const externalManager = this.manager;\n    const internalManager = new LoadingManager();\n    externalManager.itemStart(\"smaa-search\");\n    externalManager.itemStart(\"smaa-area\");\n    internalManager.itemStart(\"smaa-search\");\n    internalManager.itemStart(\"smaa-area\");\n    return new Promise((resolve, reject) => {\n      const cachedURLs = !this.disableCache && window.localStorage !== undefined ? [localStorage.getItem(\"smaa-search\"), localStorage.getItem(\"smaa-area\")] : [null, null];\n      const promise = cachedURLs[0] !== null && cachedURLs[1] !== null ? Promise.resolve(cachedURLs) : generate(this.disableCache);\n      promise.then(urls => {\n        const result = [new Image(), new Image()];\n\n        internalManager.onLoad = () => {\n          onLoad(result);\n          resolve(result);\n        };\n\n        result[0].addEventListener(\"load\", () => {\n          externalManager.itemEnd(\"smaa-search\");\n          internalManager.itemEnd(\"smaa-search\");\n        });\n        result[1].addEventListener(\"load\", () => {\n          externalManager.itemEnd(\"smaa-area\");\n          internalManager.itemEnd(\"smaa-area\");\n        });\n        result[0].src = urls[0];\n        result[1].src = urls[1];\n      }).catch(error => {\n        externalManager.itemError(\"smaa-search\");\n        externalManager.itemError(\"smaa-area\");\n        onError(error);\n        reject(error);\n      });\n    });\n  }\n\n}\n\nexport { AdaptiveLuminanceMaterial, BlendFunction, BlendMode, BloomEffect, BlurPass, BokehEffect, BokehMaterial, BrightnessContrastEffect, ChromaticAberrationEffect, CircleOfConfusionMaterial, ClearMaskPass, ClearPass, ColorAverageEffect, ColorChannel, ColorDepthEffect, ColorEdgesMaterial, ConvolutionMaterial, CopyMaterial, DepthComparisonMaterial, DepthDownsamplingMaterial, DepthDownsamplingPass, DepthEffect, DepthMaskMaterial, DepthOfFieldEffect, DepthPass, Disposable, DotScreenEffect, EdgeDetectionMaterial, EdgeDetectionMode, Effect, EffectAttribute, EffectComposer, EffectMaterial, EffectPass, GammaCorrectionEffect, GlitchEffect, GlitchMode, GodRaysEffect, GodRaysMaterial, GridEffect, HueSaturationEffect, Initializable, KernelSize, LambdaPass, LuminanceMaterial, MaskFunction, MaskMaterial, MaskPass, NoiseEffect, NoiseTexture, NormalPass, OutlineEdgesMaterial, OutlineEffect, OutlineMaterial, OverrideMaterialManager, Pass, PixelationEffect, PredicationMode, RawImageData, RealisticBokehEffect, RenderPass, Resizable, Resizer, SMAAAreaImageData, SMAAEffect, SMAAImageLoader, SMAAPreset, SMAASearchImageData, SMAAWeightsMaterial, SSAOEffect, SSAOMaterial, SavePass, ScanlineEffect, Section, Selection, SelectiveBloomEffect, SepiaEffect, ShaderPass, ShockWaveEffect, TextureEffect, ToneMappingEffect, VignetteEffect, WebGLExtension };","map":{"version":3,"sources":["/Users/sangjunerhee/Downloads/Threejs-CarFactory/node_modules/postprocessing/build/postprocessing.esm.js"],"names":["ShaderMaterial","Uniform","Vector2","Vector2$1","Vector4","PerspectiveCamera","Matrix4","Camera","Scene","Mesh","BufferGeometry","BufferAttribute","WebGLRenderTarget","LinearFilter","UnsignedByteType","RGBFormat","Color","MeshDepthMaterial","RGBADepthPacking","NearestFilter","FloatType","EventDispatcher","MeshNormalMaterial","WebGLMultisampleRenderTarget","DepthTexture","DepthStencilFormat","UnsignedInt248Type","UnsignedIntType","RGBAFormat","DataTexture","LuminanceFormat","RedFormat","RGFormat","RepeatWrapping","Vector3","MeshBasicMaterial","Texture","sRGBEncoding","LinearEncoding","Matrix3","LinearMipmapLinearFilter","LinearMipMapLinearFilter","Loader","LoadingManager","ColorChannel","RED","GREEN","BLUE","ALPHA","Disposable","dispose","fragmentShader","vertexShader","AdaptiveLuminanceMaterial","constructor","type","defines","MIP_LEVEL_1X1","uniforms","previousLuminanceBuffer","currentLuminanceBuffer","minLuminance","deltaTime","tau","depthWrite","depthTest","toneMapped","fragmentShader$1","BokehMaterial","fill","foreground","PASS","kernel64","kernel16","inputBuffer","cocBuffer","texelSize","scale","FOREGROUND","generateKernel","GOLDEN_ANGLE","points64","Float32Array","points16","i64","i16","i","theta","r","Math","sqrt","u","cos","v","sin","push","value","setTexelSize","x","y","set","fragmentShader$2","CircleOfConfusionMaterial","camera","DEPTH_PACKING","depthBuffer","focusDistance","focalLength","cameraNear","cameraFar","adoptCameraSettings","depthPacking","Number","toFixed","needsUpdate","near","far","PERSPECTIVE_CAMERA","fragmentShader$3","vertexShader$1","ColorEdgesMaterial","EDGE_DETECTION_MODE","LOCAL_CONTRAST_ADAPTATION_FACTOR","EDGE_THRESHOLD","setLocalContrastAdaptationFactor","factor","setEdgeDetectionThreshold","threshold","t","min","max","fragmentShader$4","vertexShader$2","ConvolutionMaterial","halfTexelSize","kernel","kernelSize","KernelSize","LARGE","getKernel","kernelPresets","multiplyScalar","VERY_SMALL","SMALL","MEDIUM","VERY_LARGE","HUGE","fragmentShader$5","CopyMaterial","opacity","fragmentShader$6","vertexShader$3","DepthComparisonMaterial","depthTexture","morphTargets","skinning","fragmentShader$7","vertexShader$4","DepthDownsamplingMaterial","normalBuffer","fragmentShader$8","DepthMaskMaterial","DEPTH_PACKING_0","DEPTH_PACKING_1","depthBuffer0","depthBuffer1","EdgeDetectionMaterial","mode","EdgeDetectionMode","COLOR","DEPTH_THRESHOLD","PREDICATION_MODE","PREDICATION_THRESHOLD","PREDICATION_SCALE","PREDICATION_STRENGTH","predicationBuffer","setEdgeDetectionMode","setPredicationMode","setPredicationBuffer","setPredicationThreshold","setPredicationScale","setPredicationStrength","strength","DEPTH","LUMA","PredicationMode","DISABLED","CUSTOM","fragmentTemplate","vertexTemplate","EffectMaterial","shaderParts","dithering","ENCODE_OUTPUT","resolution","aspect","time","setShaderParts","setDefines","setUniforms","replace","Section","FRAGMENT_HEAD","get","FRAGMENT_MAIN_UV","FRAGMENT_MAIN_IMAGE","VERTEX_HEAD","VERTEX_MAIN_SUPPORT","entry","entries","setSize","width","height","w","h","fragmentShader$9","GodRaysMaterial","lightPosition","SAMPLES_INT","SAMPLES_FLOAT","density","decay","weight","exposure","clampMax","samples","s","floor","fragmentShader$a","LuminanceMaterial","colorOutput","luminanceRange","useRange","smoothing","range","useThreshold","THRESHOLD","undefined","setColorOutputEnabled","enabled","RANGE","setLuminanceRangeEnabled","fragmentShader$b","MaskMaterial","maskTexture","colorChannel","maskFunction","MaskFunction","DISCARD","COLOR_CHANNEL","MASK_FUNCTION","inverted","INVERTED","MULTIPLY","MULTIPLY_RGB_SET_ALPHA","fragmentShader$c","vertexShader$5","OutlineMaterial","OutlineEdgesMaterial","fragmentShader$d","vertexShader$6","SMAAWeightsMaterial","MAX_SEARCH_STEPS_INT","MAX_SEARCH_STEPS_FLOAT","MAX_SEARCH_STEPS_DIAG_INT","MAX_SEARCH_STEPS_DIAG_FLOAT","CORNER_ROUNDING","CORNER_ROUNDING_NORM","AREATEX_MAX_DISTANCE","AREATEX_MAX_DISTANCE_DIAG","AREATEX_PIXEL_SIZE","AREATEX_SUBTEX_SIZE","SEARCHTEX_SIZE","SEARCHTEX_PACKED_SIZE","areaTexture","searchTexture","setOrthogonalSearchSteps","steps","setDiagonalSearchSteps","setCornerRounding","rounding","diagonalDetection","DISABLE_DIAG_DETECTION","cornerRounding","DISABLE_CORNER_DETECTION","fragmentShader$e","vertexShader$7","SSAOMaterial","SPIRAL_TURNS","RADIUS","RADIUS_SQ","DISTANCE_SCALING","normalDepthBuffer","noiseTexture","inverseProjectionMatrix","projectionMatrix","distanceCutoff","proximityCutoff","noiseScale","minRadiusScale","intensity","fade","bias","AUTO_SIZE","Resizer","resizable","base","target","result","round","dummyCamera","geometry","getFullscreenTriangle","vertices","uvs","setAttribute","addAttribute","Pass","name","scene","screen","rtt","needsSwap","needsDepthTexture","renderToScreen","material","getFullscreenMaterial","setFullscreenMaterial","frustumCulled","add","getDepthTexture","setDepthTexture","render","renderer","outputBuffer","stencilTest","Error","initialize","alpha","frameBufferType","key","Object","keys","property","BlurPass","resolutionScale","renderTargetA","minFilter","magFilter","stencilBuffer","texture","renderTargetB","clone","convolutionMaterial","ditheredConvolutionMaterial","getResolutionScale","setResolutionScale","lastRT","destRT","l","length","setRenderTarget","format","ClearMaskPass","stencil","state","buffers","setLocked","setTest","color","ClearPass","depth","overrideClearColor","overrideClearAlpha","clearAlpha","getClearAlpha","hasOverrideClearColor","hasOverrideClearAlpha","copy","getClearColor","setClearColor","setClearAlpha","clear","workaroundEnabled","OverrideMaterialManager","originalMaterials","Map","materialInstanced","materialSkinning","setMaterial","disposeMaterials","assign","shadowMapEnabled","shadowMap","meshCount","traverse","node","isMesh","isInstancedMesh","isSkinnedMesh","size","overrideMaterial","RenderPass","clearPass","overrideMaterialManager","manager","getClearPass","background","renderTarget","DepthPass","renderPass","DepthDownsamplingPass","DOWNSAMPLE_NORMALS","generateMipmaps","capabilities","isWebGL2","console","error","BlendFunction","SKIP","ADD","AVERAGE","COLOR_BURN","COLOR_DODGE","DARKEN","DIFFERENCE","EXCLUSION","LIGHTEN","DIVIDE","NEGATION","NORMAL","OVERLAY","REFLECT","SCREEN","SOFT_LIGHT","SUBTRACT","addBlendFunction","alphaBlendFunction","averageBlendFunction","colorBurnBlendFunction","colorDodgeBlendFunction","darkenBlendFunction","differenceBlendFunction","exclusionBlendFunction","lightenBlendFunction","multiplyBlendFunction","divideBlendFunction","negationBlendFunction","normalBlendFunction","overlayBlendFunction","reflectBlendFunction","screenBlendFunction","softLightBlendFunction","subtractBlendFunction","blendFunctions","BlendMode","blendFunction","getBlendFunction","setBlendFunction","dispatchEvent","getShaderCode","Effect","attributes","EffectAttribute","NONE","extensions","blendMode","addEventListener","event","setChanged","getAttributes","setAttributes","getFragmentShader","setFragmentShader","getVertexShader","setVertexShader","update","CONVOLUTION","WebGLExtension","DERIVATIVES","FRAG_DEPTH","DRAW_BUFFERS","SHADER_TEXTURE_LOD","findSubstrings","regExp","string","substrings","exec","prefixSubstrings","prefix","strings","prefixed","substring","charAt","toUpperCase","slice","RegExp","integrateEffect","effect","blendModes","functionRegExp","varyingRegExp","shaders","mainImageExists","indexOf","mainUvExists","varyings","names","transformedUv","readDepth","concat","Array","from","map","forEach","blendOpacity","EffectPass","effects","sort","a","b","skipRendering","minTime","maxTime","POSITIVE_INFINITY","encodeOutput","verifyResources","maxFragmentUniforms","maxVertexUniforms","warn","maxVaryings","updateMaterial","blendRegExp","Set","id","extension","values","trim","recompile","handleEvent","LambdaPass","f","MaskPass","inverse","context","getContext","writeValue","clearValue","setMask","setOp","REPLACE","setFunc","ALWAYS","setClear","EQUAL","KEEP","NormalPass","SavePass","resize","ShaderPass","input","uniform","setInput","EffectComposer","multisampling","autoClear","createBuffer","enableExtensions","copyPass","passes","autoRenderToScreen","buffer","getRenderer","getExtension","replaceRenderer","updateDOM","oldRenderer","oldSize","getSize","newSize","parent","domElement","parentNode","equals","removeChild","appendChild","createDepthTexture","deleteDepthTexture","pass","getDrawingBufferSize","getContextAttributes","options","addPass","index","drawingBufferSize","splice","removePass","removed","reducer","depthTextureRequired","reduce","removeAllPasses","NOTEQUAL","updateStyle","reset","Initializable","Resizable","Selection","iterable","layer","currentLayer","object","layers","disable","enable","objects","has","delete","setVisible","visible","fragmentShader$f","BloomEffect","luminanceThreshold","luminanceSmoothing","blurPass","luminancePass","luminanceMaterial","distinction","fragmentShader$g","BokehEffect","focus","dof","aperture","maxBlur","fragmentShader$h","BrightnessContrastEffect","brightness","contrast","fragmentShader$i","ColorAverageEffect","fragmentShader$j","ColorDepthEffect","bits","setBitDepth","getBitDepth","pow","fragmentShader$k","vertexShader$8","ChromaticAberrationEffect","offset","fragmentShader$l","DepthEffect","fragmentShader$m","DepthOfFieldEffect","bokehScale","renderTargetMasked","renderTargetNear","renderTargetFar","renderTargetCoC","renderTargetCoCBlurred","cocPass","cocMaterial","circleOfConfusionMaterial","maskPass","maskMaterial","bokehNearBasePass","bokehNearFillPass","bokehFarBasePass","bokehFarFillPass","p","calculateFocusDistance","viewDistance","distance","position","distanceTo","farBaseUniforms","farFillUniforms","nearBaseUniforms","nearFillUniforms","resizables","initializables","fragmentShader$n","DotScreenEffect","angle","PI","setAngle","fragmentShader$o","GammaCorrectionEffect","gamma","getNoise","channels","data","Uint8Array","random","NoiseTexture","fragmentShader$p","tag","randomFloat","low","high","GlitchEffect","chromaticAberrationOffset","delay","duration","columns","ratio","perturbationMap","dtSize","setPerturbationMap","generatePerturbationMap","breakPoint","seed","distortion","GlitchMode","SPORADIC","active","getPerturbationMap","currentMap","wrapS","wrapT","trigger","CONSTANT_WILD","CONSTANT_MILD","fragmentShader$q","m","GodRaysEffect","lightSource","blur","transparent","lightScene","screenPosition","renderTargetLight","renderPassLight","depthMaskPass","godRaysPass","godRaysMaterial","matrixAutoUpdate","updateWorldMatrix","matrix","matrixWorld","setFromMatrixPosition","project","fragmentShader$r","GridEffect","lineWidth","getScale","setScale","getLineWidth","setLineWidth","fragmentShader$s","HueSaturationEffect","hue","saturation","setHue","c","addScalar","divideScalar","fragmentShader$t","NoiseEffect","premultiply","fragmentShader$u","vertexShader$9","OutlineEffect","patternTexture","edgeStrength","pulseSpeed","visibleEdgeColor","hiddenEdgeColor","xRay","setPatternTexture","renderTargetMask","renderTargetOutline","renderTargetBlurredOutline","depthPass","outlinePass","selection","selectionLayer","setSelection","clearSelection","selectObject","deselectObject","pulse","mask","fragmentShader$v","PixelationEffect","granularity","getGranularity","setGranularity","divide","fragmentShader$w","RealisticBokehEffect","fStop","luminanceGain","fringe","rings","showFocus","manualDoF","pentagon","parseInt","fragmentShader$x","ScanlineEffect","getDensity","setDensity","fragmentShader$y","vertexShader$a","HALF_PI","v$1","ab","ShockWaveEffect","epicenter","speed","maxRadius","waveSize","amplitude","explode","delta","uniformActive","getWorldDirection","sub","angleTo","radius","SelectiveBloomEffect","blackoutPass","backgroundPass","backgroundScene","renderTargetSelection","ignoreBackground","fragmentShader$z","SepiaEffect","searchImageDataURL","areaImageDataURL","fragmentShader$A","vertexShader$b","SMAAEffect","searchImage","areaImage","preset","SMAAPreset","HIGH","edgeDetectionMode","renderTargetEdges","renderTargetWeights","edgeDetectionPass","weightsPass","flipY","weightsMaterial","applyPreset","edgeDetectionMaterial","colorEdgesMaterial","LOW","ULTRA","fragmentShader$B","NOISE_TEXTURE_SIZE","SSAOEffect","distanceScaling","depthAwareUpsampling","distanceThreshold","distanceFalloff","rangeThreshold","rangeFalloff","luminanceInfluence","renderTargetAO","ssaoPass","NORMAL_DEPTH","setDistanceCutoff","setProximityCutoff","ssaoMaterial","falloff","getInverse","fragmentShader$C","vertexShader$c","TextureEffect","aspectCorrection","currentTexture","previousEncoding","encoding","log","uvTransform","setTextureSwizzleRGBA","g","rgba","swizzle","join","updateMatrix","fragmentShader$D","ToneMappingEffect","adaptive","middleGrey","maxLuminance","averageLuminance","adaptationRate","renderTargetLuminance","renderTargetAdapted","renderTargetPrevious","savePass","adaptiveLuminancePass","exponent","ceil","log2","fragmentShader$E","VignetteEffect","settings","eskil","darkness","createCanvas","canvas","document","createElementNS","imageData","createImageData","putImageData","RawImageData","toCanvas","Box2","b0","b1","ORTHOGONAL_SIZE","DIAGONAL_SIZE","DIAGONAL_SAMPLES","SMOOTH_MAX_DISTANCE","orthogonalSubsamplingOffsets","diagonalSubsamplingOffsets","orthogonalEdges","diagonalEdges","lerp","saturate","smoothArea","d","a1","a2","b1X","b1Y","b2X","b2Y","calculateOrthogonalArea","p1","p2","dX","dY","x1","x2","y1","y2","sign","abs","trunc","calculateOrthogonalAreaForPattern","pattern","left","right","o1","o2","isInsideArea","xm","ym","calculateDiagonalAreaForPixel","pX","pY","offsetX","offsetY","calculateDiagonalArea","e","e1","e2","calculateDiagonalAreaForPattern","generatePatterns","patterns","orthogonal","assemble","edges","dstData","dstWidth","edge","srcData","srcWidth","SMAAAreaImageData","generate","Uint8ClampedArray","orthogonalPatternSize","diagonalPatternSize","orthogonalPatterns","diagonalPatterns","bilinear","lerp$1","deltaLeft","top","deltaRight","SMAASearchImageData","halfWidth","croppedWidth","croppedHeight","croppedData","workerProgram","disableCache","workerURL","URL","createObjectURL","Blob","worker","Worker","Promise","resolve","reject","searchImageData","areaImageData","urls","toDataURL","window","localStorage","setItem","revokeObjectURL","postMessage","SMAAImageLoader","load","onLoad","onError","arguments","externalManager","internalManager","itemStart","cachedURLs","getItem","promise","then","Image","itemEnd","src","catch","itemError"],"mappings":"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","sourcesContent":["/**\n * postprocessing v6.18.0 build Mon Nov 02 2020\n * https://github.com/vanruesc/postprocessing\n * Copyright 2020 Raoul van RÃ¼schen\n * @license Zlib\n */\nimport { ShaderMaterial, Uniform, Vector2 as Vector2$1, Vector4, PerspectiveCamera, Matrix4, Camera, Scene, Mesh, BufferGeometry, BufferAttribute, WebGLRenderTarget, LinearFilter, UnsignedByteType, RGBFormat, Color, MeshDepthMaterial, RGBADepthPacking, NearestFilter, FloatType, EventDispatcher, MeshNormalMaterial, WebGLMultisampleRenderTarget, DepthTexture, DepthStencilFormat, UnsignedInt248Type, UnsignedIntType, RGBAFormat, DataTexture, LuminanceFormat, RedFormat, RGFormat, RepeatWrapping, Vector3, MeshBasicMaterial, Texture, sRGBEncoding, LinearEncoding, Matrix3, LinearMipmapLinearFilter, LinearMipMapLinearFilter, Loader, LoadingManager } from 'three';\n\n/**\r\n * A color channel enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} RED - Red.\r\n * @property {Number} GREEN - Green.\r\n * @property {Number} BLUE - Blue.\r\n * @property {Number} ALPHA - Alpha.\r\n */\r\n\r\nconst ColorChannel = {\r\n\r\n\tRED: 0,\r\n\tGREEN: 1,\r\n\tBLUE: 2,\r\n\tALPHA: 3\r\n\r\n};\n\n/**\r\n * The Disposable contract.\r\n *\r\n * Implemented by objects that can free internal resources.\r\n *\r\n * @interface\r\n */\r\n\r\nclass Disposable {\r\n\r\n\t/**\r\n\t * Frees internal resources.\r\n\t */\r\n\r\n\tdispose() {}\r\n\r\n}\n\nvar fragmentShader = \"uniform sampler2D previousLuminanceBuffer;uniform sampler2D currentLuminanceBuffer;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float previousLuminance=texture2D(previousLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;float currentLuminance=texture2D(currentLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;previousLuminance=max(minLuminance,previousLuminance);currentLuminance=max(minLuminance,currentLuminance);float adaptedLum=previousLuminance+(currentLuminance-previousLuminance)*(1.0-exp(-deltaTime*tau));gl_FragColor.r=adaptedLum;}\";\n\nvar vertexShader = \"varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * An adaptive luminance shader material.\r\n */\r\n\r\nclass AdaptiveLuminanceMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new adaptive luminance material.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"AdaptiveLuminanceMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tMIP_LEVEL_1X1: \"0.0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tpreviousLuminanceBuffer: new Uniform(null),\r\n\t\t\t\tcurrentLuminanceBuffer: new Uniform(null),\r\n\t\t\t\tminLuminance: new Uniform(0.01),\r\n\t\t\t\tdeltaTime: new Uniform(0.0),\r\n\t\t\t\ttau: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$1 = \"uniform sampler2D inputBuffer;uniform sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;\\n#if PASS == 1\\nuniform vec4 kernel64[32];\\n#else\\nuniform vec4 kernel16[8];\\n#endif\\nvarying vec2 vUv;void main(){\\n#ifdef FOREGROUND\\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\\n#else\\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\\n#endif\\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\\n#ifdef FOREGROUND\\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\\n#else\\nvec2 step=texelSize*CoC;\\n#endif\\n#if PASS == 1\\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;\\n#else\\nvec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;\\n#endif\\n}}\";\n\n/**\r\n * A bokeh blur material.\r\n *\r\n * This material should be applied twice in a row, with `fill` mode enabled for\r\n * the second pass.\r\n *\r\n * Enabling the `foreground` option causes the shader to combine the near and\r\n * far CoC values around foreground objects.\r\n */\r\n\r\nclass BokehMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new bokeh material.\r\n\t *\r\n\t * @param {Boolean} [fill=false] - Enables or disables the bokeh highlight fill mode.\r\n\t * @param {Boolean} [foreground=false] - Determines whether this material will be applied to foreground colors.\r\n\t */\r\n\r\n\tconstructor(fill = false, foreground = false) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"BokehMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tPASS: fill ? \"2\" : \"1\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tkernel64: new Uniform(null),\r\n\t\t\t\tkernel16: new Uniform(null),\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tcocBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1()),\r\n\t\t\t\tscale: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$1,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tif(foreground) {\r\n\r\n\t\t\tthis.defines.FOREGROUND = \"1\";\r\n\r\n\t\t}\r\n\r\n\t\tthis.generateKernel();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Generates the blur kernels.\r\n\t *\r\n\t * @private\r\n\t */\r\n\r\n\tgenerateKernel() {\r\n\r\n\t\tconst GOLDEN_ANGLE = 2.39996323;\r\n\t\tconst points64 = new Float32Array(128);\r\n\t\tconst points16 = new Float32Array(32);\r\n\r\n\t\tlet i64 = 0, i16 = 0;\r\n\r\n\t\tfor(let i = 0; i < 80; ++i) {\r\n\r\n\t\t\tconst theta = i * GOLDEN_ANGLE;\r\n\t\t\tconst r = Math.sqrt(i) / Math.sqrt(80);\r\n\t\t\tconst u = r * Math.cos(theta), v = r * Math.sin(theta);\r\n\r\n\t\t\tif(i % 5 === 0) {\r\n\r\n\t\t\t\tpoints16[i16++] = u;\r\n\t\t\t\tpoints16[i16++] = v;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tpoints64[i64++] = u;\r\n\t\t\t\tpoints64[i64++] = v;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Pack points into vec4 instances to reduce the uniform count.\r\n\t\tconst kernel64 = [];\r\n\t\tconst kernel16 = [];\r\n\r\n\t\tfor(let i = 0; i < 128;) {\r\n\r\n\t\t\tkernel64.push(new Vector4(\r\n\t\t\t\tpoints64[i++], points64[i++],\r\n\t\t\t\tpoints64[i++], points64[i++]\r\n\t\t\t));\r\n\r\n\t\t}\r\n\r\n\t\tfor(let i = 0; i < 32;) {\r\n\r\n\t\t\tkernel16.push(new Vector4(\r\n\t\t\t\tpoints16[i++], points16[i++],\r\n\t\t\t\tpoints16[i++], points16[i++]\r\n\t\t\t));\r\n\r\n\t\t}\r\n\r\n\t\tthis.uniforms.kernel64.value = kernel64;\r\n\t\tthis.uniforms.kernel16.value = kernel16;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texel size.\r\n\t *\r\n\t * @param {Number} x - The texel width.\r\n\t * @param {Number} y - The texel height.\r\n\t */\r\n\r\n\tsetTexelSize(x, y) {\r\n\r\n\t\tthis.uniforms.texelSize.value.set(x, y);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$2 = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform float focusDistance;uniform float focalLength;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}void main(){float depth=readDepth(vUv);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focalLength,abs(signedDistance));gl_FragColor.rg=vec2(step(signedDistance,0.0)*magnitude,step(0.0,signedDistance)*magnitude);}\";\n\n/**\r\n * A CoC shader material.\r\n */\r\n\r\nclass CircleOfConfusionMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new CoC material.\r\n\t *\r\n\t * @param {Camera} camera - A camera.\r\n\t */\r\n\r\n\tconstructor(camera) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"CircleOfConfusionMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tDEPTH_PACKING: \"0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tdepthBuffer: new Uniform(null),\r\n\t\t\t\tfocusDistance: new Uniform(0.0),\r\n\t\t\t\tfocalLength: new Uniform(0.0),\r\n\t\t\t\tcameraNear: new Uniform(0.3),\r\n\t\t\t\tcameraFar: new Uniform(1000)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$2,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.adoptCameraSettings(camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget depthPacking() {\r\n\r\n\t\treturn Number(this.defines.DEPTH_PACKING);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset depthPacking(value) {\r\n\r\n\t\tthis.defines.DEPTH_PACKING = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adopts the settings of the given camera.\r\n\t *\r\n\t * @param {Camera} [camera=null] - A camera.\r\n\t */\r\n\r\n\tadoptCameraSettings(camera = null) {\r\n\r\n\t\tif(camera !== null) {\r\n\r\n\t\t\tthis.uniforms.cameraNear.value = camera.near;\r\n\t\t\tthis.uniforms.cameraFar.value = camera.far;\r\n\r\n\t\t\tif(camera instanceof PerspectiveCamera) {\r\n\r\n\t\t\t\tthis.defines.PERSPECTIVE_CAMERA = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete this.defines.PERSPECTIVE_CAMERA;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$3 = \"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\\n#if EDGE_DETECTION_MODE != 0\\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\\n#endif\\n#if EDGE_DETECTION_MODE == 1\\n#include <common>\\n#endif\\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nfloat readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\\n#elif PREDICATION_MODE == 2\\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\\n#endif\\n#if PREDICATION_MODE != 0\\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\\n#endif\\n#if EDGE_DETECTION_MODE != 0\\nuniform sampler2D inputBuffer;\\n#endif\\nvoid main(){\\n#if EDGE_DETECTION_MODE == 0\\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\\n#elif PREDICATION_MODE != 0\\nvec2 threshold=calculatePredicatedThreshold();\\n#else\\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\\n#endif\\n#if EDGE_DETECTION_MODE == 0\\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\\n#elif EDGE_DETECTION_MODE == 1\\nfloat l=linearToRelativeLuminance(texture2D(inputBuffer,vUv).rgb);float lLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv0).rgb);float lTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=linearToRelativeLuminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=linearToRelativeLuminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\\n#elif EDGE_DETECTION_MODE == 2\\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\\n#endif\\n}\";\n\nvar vertexShader$1 = \"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\\n#if EDGE_DETECTION_MODE != 0\\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\\n#endif\\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\\n#if EDGE_DETECTION_MODE != 0\\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\\n#endif\\ngl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * A material that detects edges in a color texture.\r\n *\r\n * @deprecated Use EdgeDetectionMaterial instead.\r\n */\r\n\r\nclass ColorEdgesMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new color edges material.\r\n\t *\r\n\t * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n\t */\r\n\r\n\tconstructor(texelSize = new Vector2$1()) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"ColorEdgesMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tEDGE_DETECTION_MODE: \"2\",\r\n\t\t\t\tLOCAL_CONTRAST_ADAPTATION_FACTOR: \"2.0\",\r\n\t\t\t\tEDGE_THRESHOLD: \"0.1\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(texelSize)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$3,\r\n\t\t\tvertexShader: vertexShader$1,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the local contrast adaptation factor.\r\n\t *\r\n\t * If there is a neighbor edge that has _factor_ times bigger contrast than\r\n\t * the current edge, the edge will be discarded.\r\n\t *\r\n\t * This allows to eliminate spurious crossing edges and is based on the fact\r\n\t * that if there is too much contrast in a direction, the perceptual contrast\r\n\t * in the other neighbors will be hidden.\r\n\t *\r\n\t * @param {Number} factor - The local contrast adaptation factor. Default is 2.0.\r\n\t */\r\n\r\n\tsetLocalContrastAdaptationFactor(factor) {\r\n\r\n\t\tthis.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR = factor.toFixed(\"2\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the edge detection sensitivity.\r\n\t *\r\n\t * A lower value results in more edges being detected at the expense of\r\n\t * performance.\r\n\t *\r\n\t * 0.1 is a reasonable value, and allows to catch most visible edges.\r\n\t * 0.05 is a rather overkill value, that allows to catch 'em all.\r\n\t *\r\n\t * If temporal supersampling is used, 0.2 could be a reasonable value, as low\r\n\t * contrast edges are properly filtered by just 2x.\r\n\t *\r\n\t * @param {Number} threshold - The edge detection sensitivity. Range: [0.05, 0.5].\r\n\t */\r\n\r\n\tsetEdgeDetectionThreshold(threshold) {\r\n\r\n\t\tconst t = Math.min(Math.max(threshold, 0.05), 0.5);\r\n\t\tthis.defines.EDGE_THRESHOLD = t.toFixed(\"2\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$4 = \"#include <common>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\\n#include <dithering_fragment>\\n}\";\n\nvar vertexShader$2 = \"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;/*Packing multiple texture coordinates into one varying and using a swizzle toextract them in the fragment shader still causes a dependent texture read.*/varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * An optimised convolution shader material.\r\n *\r\n * This material supports dithering.\r\n *\r\n * Based on the GDC2003 Presentation by Masaki Kawase, Bunkasha Games:\r\n *  Frame Buffer Postprocessing Effects in DOUBLE-S.T.E.A.L (Wreckless)\r\n * and an article by Filip Strugar, Intel:\r\n *  An investigation of fast real-time GPU-based image blur algorithms\r\n *\r\n * Further modified according to Apple's\r\n * [Best Practices for Shaders](https://goo.gl/lmRoM5).\r\n *\r\n * @todo Remove dithering code from fragment shader.\r\n */\r\n\r\nclass ConvolutionMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new convolution material.\r\n\t *\r\n\t * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n\t */\r\n\r\n\tconstructor(texelSize = new Vector2$1()) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"ConvolutionMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1()),\r\n\t\t\t\thalfTexelSize: new Uniform(new Vector2$1()),\r\n\t\t\t\tkernel: new Uniform(0.0),\r\n\t\t\t\tscale: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$4,\r\n\t\t\tvertexShader: vertexShader$2,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.setTexelSize(texelSize.x, texelSize.y);\r\n\r\n\t\t/**\r\n\t\t * The current kernel size.\r\n\t\t *\r\n\t\t * @type {KernelSize}\r\n\t\t */\r\n\r\n\t\tthis.kernelSize = KernelSize.LARGE;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the kernel.\r\n\t *\r\n\t * @return {Float32Array} The kernel.\r\n\t */\r\n\r\n\tgetKernel() {\r\n\r\n\t\treturn kernelPresets[this.kernelSize];\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texel size.\r\n\t *\r\n\t * @param {Number} x - The texel width.\r\n\t * @param {Number} y - The texel height.\r\n\t */\r\n\r\n\tsetTexelSize(x, y) {\r\n\r\n\t\tthis.uniforms.texelSize.value.set(x, y);\r\n\t\tthis.uniforms.halfTexelSize.value.set(x, y).multiplyScalar(0.5);\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * The Kawase blur kernel presets.\r\n *\r\n * @type {Float32Array[]}\r\n * @private\r\n */\r\n\r\nconst kernelPresets = [\r\n\tnew Float32Array([0.0, 0.0]),\r\n\tnew Float32Array([0.0, 1.0, 1.0]),\r\n\tnew Float32Array([0.0, 1.0, 1.0, 2.0]),\r\n\tnew Float32Array([0.0, 1.0, 2.0, 2.0, 3.0]),\r\n\tnew Float32Array([0.0, 1.0, 2.0, 3.0, 4.0, 4.0, 5.0]),\r\n\tnew Float32Array([0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 7.0, 8.0, 9.0, 10.0])\r\n];\r\n\r\n/**\r\n * A kernel size enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} VERY_SMALL - A very small kernel that matches a 7x7 Gauss blur kernel.\r\n * @property {Number} SMALL - A small kernel that matches a 15x15 Gauss blur kernel.\r\n * @property {Number} MEDIUM - A medium sized kernel that matches a 23x23 Gauss blur kernel.\r\n * @property {Number} LARGE - A large kernel that matches a 35x35 Gauss blur kernel.\r\n * @property {Number} VERY_LARGE - A very large kernel that matches a 63x63 Gauss blur kernel.\r\n * @property {Number} HUGE - A huge kernel that matches a 127x127 Gauss blur kernel.\r\n */\r\n\r\nconst KernelSize = {\r\n\r\n\tVERY_SMALL: 0,\r\n\tSMALL: 1,\r\n\tMEDIUM: 2,\r\n\tLARGE: 3,\r\n\tVERY_LARGE: 4,\r\n\tHUGE: 5\r\n\r\n};\n\nvar fragmentShader$5 = \"uniform sampler2D inputBuffer;uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\\n#include <encodings_fragment>\\n}\";\n\n/**\r\n * A simple copy shader material.\r\n */\r\n\r\nclass CopyMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new copy material.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"CopyMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\topacity: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$5,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$6 = \"#include <packing>\\n#include <clipping_planes_pars_fragment>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform float cameraNear;uniform float cameraFar;varying float vViewZ;varying vec4 vProjTexCoord;void main(){\\n#include <clipping_planes_fragment>\\nvec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);float fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\\n#else\\nfloat viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);\\n#endif\\nfloat depthTest=(-vViewZ>-viewZ)? 1.0 : 0.0;gl_FragColor.rg=vec2(0.0,depthTest);}\";\n\nvar vertexShader$3 = \"#include <common>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying float vViewZ;varying vec4 vProjTexCoord;void main(){\\n#include <skinbase_vertex>\\n#include <begin_vertex>\\n#include <morphtarget_vertex>\\n#include <skinning_vertex>\\n#include <project_vertex>\\nvViewZ=mvPosition.z;vProjTexCoord=gl_Position;\\n#include <clipping_planes_vertex>\\n}\";\n\n/**\r\n * A depth comparison shader material.\r\n */\r\n\r\nclass DepthComparisonMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new depth comparison material.\r\n\t *\r\n\t * @param {Texture} [depthTexture=null] - A depth texture.\r\n\t * @param {PerspectiveCamera} [camera] - A camera.\r\n\t */\r\n\r\n\tconstructor(depthTexture = null, camera) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"DepthComparisonMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tdepthBuffer: new Uniform(depthTexture),\r\n\t\t\t\tcameraNear: new Uniform(0.3),\r\n\t\t\t\tcameraFar: new Uniform(1000)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$6,\r\n\t\t\tvertexShader: vertexShader$3,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false,\r\n\r\n\t\t\tmorphTargets: true,\r\n\t\t\tskinning: true\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.adoptCameraSettings(camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adopts the settings of the given camera.\r\n\t *\r\n\t * @param {Camera} [camera=null] - A camera.\r\n\t */\r\n\r\n\tadoptCameraSettings(camera = null) {\r\n\r\n\t\tif(camera !== null) {\r\n\r\n\t\t\tthis.uniforms.cameraNear.value = camera.near;\r\n\t\t\tthis.uniforms.cameraFar.value = camera.far;\r\n\r\n\t\t\tif(camera instanceof PerspectiveCamera) {\r\n\r\n\t\t\t\tthis.defines.PERSPECTIVE_CAMERA = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete this.defines.PERSPECTIVE_CAMERA;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$7 = \"#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\n#ifdef DOWNSAMPLE_NORMALS\\nuniform sampler2D normalBuffer;\\n#endif\\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}/***Returns the index of the most representative depth in the 2x2 neighborhood.*/int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])/4.0;float distances[4]=float[](abs(c-samples[0]),abs(c-samples[1]),abs(c-samples[2]),abs(c-samples[3]));float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4]=float[](readDepth(vUv0),readDepth(vUv1),readDepth(vUv2),readDepth(vUv3));int index=findBestDepth(d);\\n#ifdef DOWNSAMPLE_NORMALS\\nvec2 uvs[4]=vec2[](vUv0,vUv1,vUv2,vUv3);vec3 n=texture2D(normalBuffer,uvs[index]).rgb;\\n#else\\nvec3 n=vec3(0.0);\\n#endif\\ngl_FragColor=vec4(n,d[index]);}\";\n\nvar vertexShader$4 = \"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * A depth downsampling shader material.\r\n *\r\n * Based on an article by Eleni Maria Stea:\r\n * https://eleni.mutantstargoat.com/hikiko/depth-aware-upsampling-6\r\n */\r\n\r\nclass DepthDownsamplingMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new depth downsampling material.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"DepthDownsamplingMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tDEPTH_PACKING: \"0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tdepthBuffer: new Uniform(null),\r\n\t\t\t\tnormalBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1())\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$7,\r\n\t\t\tvertexShader: vertexShader$4,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The depth packing of the source depth buffer.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget depthPacking() {\r\n\r\n\t\treturn Number(this.defines.DEPTH_PACKING);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset depthPacking(value) {\r\n\r\n\t\tthis.defines.DEPTH_PACKING = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texel size.\r\n\t *\r\n\t * @param {Number} x - The texel width.\r\n\t * @param {Number} y - The texel height.\r\n\t */\r\n\r\n\tsetTexelSize(x, y) {\r\n\r\n\t\tthis.uniforms.texelSize.value.set(x, y);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$8 = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer0;uniform highp sampler2D depthBuffer1;\\n#else\\nuniform mediump sampler2D depthBuffer0;uniform mediump sampler2D depthBuffer1;\\n#endif\\nuniform sampler2D inputBuffer;varying vec2 vUv;void main(){\\n#if DEPTH_PACKING_0 == 3201\\nfloat d0=unpackRGBAToDepth(texture2D(depthBuffer0,vUv));\\n#else\\nfloat d0=texture2D(depthBuffer0,vUv).r;\\n#endif\\n#if DEPTH_PACKING_1 == 3201\\nfloat d1=unpackRGBAToDepth(texture2D(depthBuffer1,vUv));\\n#else\\nfloat d1=texture2D(depthBuffer1,vUv).r;\\n#endif\\nif(d0<d1){discard;}gl_FragColor=texture2D(inputBuffer,vUv);}\";\n\n/**\r\n * A depth mask shader material.\r\n *\r\n * This material masks a color buffer by comparing two depth textures.\r\n */\r\n\r\nclass DepthMaskMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new depth mask material.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"DepthMaskMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tDEPTH_PACKING_0: \"0\",\r\n\t\t\t\tDEPTH_PACKING_1: \"0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tdepthBuffer0: new Uniform(null),\r\n\t\t\t\tdepthBuffer1: new Uniform(null),\r\n\t\t\t\tinputBuffer: new Uniform(null)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$8,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * An edge detection material.\r\n *\r\n * Mainly used for Subpixel Morphological Antialiasing.\r\n */\r\n\r\nclass EdgeDetectionMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new edge detection material.\r\n\t *\r\n\t * @param {Vector2} [texelSize] - The screen texel size.\r\n\t * @param {EdgeDetectionMode} [mode=EdgeDetectionMode.COLOR] - The edge detection mode.\r\n\t * @todo Remove texelSize parameter.\r\n\t */\r\n\r\n\tconstructor(texelSize = new Vector2$1(), mode = EdgeDetectionMode.COLOR) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"EdgeDetectionMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tLOCAL_CONTRAST_ADAPTATION_FACTOR: \"2.0\",\r\n\t\t\t\tEDGE_THRESHOLD: \"0.1\",\r\n\t\t\t\tDEPTH_THRESHOLD: \"0.01\",\r\n\t\t\t\tPREDICATION_MODE: \"0\",\r\n\t\t\t\tPREDICATION_THRESHOLD: \"0.01\",\r\n\t\t\t\tPREDICATION_SCALE: \"2.0\",\r\n\t\t\t\tPREDICATION_STRENGTH: \"1.0\",\r\n\t\t\t\tDEPTH_PACKING: \"0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tdepthBuffer: new Uniform(null),\r\n\t\t\t\tpredicationBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(texelSize)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$3,\r\n\t\t\tvertexShader: vertexShader$1,\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.setEdgeDetectionMode(mode);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget depthPacking() {\r\n\r\n\t\treturn Number(this.defines.DEPTH_PACKING);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset depthPacking(value) {\r\n\r\n\t\tthis.defines.DEPTH_PACKING = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the edge detection mode.\r\n\t *\r\n\t * @param {EdgeDetectionMode} mode - The edge detection mode.\r\n\t */\r\n\r\n\tsetEdgeDetectionMode(mode) {\r\n\r\n\t\tthis.defines.EDGE_DETECTION_MODE = mode.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the local contrast adaptation factor. Has no effect if the edge\r\n\t * detection mode is set to DEPTH.\r\n\t *\r\n\t * If there is a neighbor edge that has _factor_ times bigger contrast than\r\n\t * the current edge, the edge will be discarded.\r\n\t *\r\n\t * This allows to eliminate spurious crossing edges and is based on the fact\r\n\t * that if there is too much contrast in a direction, the perceptual contrast\r\n\t * in the other neighbors will be hidden.\r\n\t *\r\n\t * @param {Number} factor - The local contrast adaptation factor. Default is 2.0.\r\n\t */\r\n\r\n\tsetLocalContrastAdaptationFactor(factor) {\r\n\r\n\t\tthis.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR = factor.toFixed(\"6\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the edge detection sensitivity.\r\n\t *\r\n\t * A lower value results in more edges being detected at the expense of\r\n\t * performance.\r\n\t *\r\n\t * For luma- and chroma-based edge detection, 0.1 is a reasonable value and\r\n\t * allows to catch most visible edges. 0.05 is a rather overkill value that\r\n\t * allows to catch 'em all. Darker scenes may require an even lower threshold.\r\n\t *\r\n\t * If depth-based edge detection is used, the threshold will depend on the\r\n\t * scene depth.\r\n\t *\r\n\t * @param {Number} threshold - The edge detection sensitivity. Range: [0.0, 0.5].\r\n\t */\r\n\r\n\tsetEdgeDetectionThreshold(threshold) {\r\n\r\n\t\tthis.defines.EDGE_THRESHOLD = threshold.toFixed(\"6\");\r\n\t\tthis.defines.DEPTH_THRESHOLD = (threshold * 0.1).toFixed(\"6\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the predication mode.\r\n\t *\r\n\t * Predicated thresholding allows to better preserve texture details and to\r\n\t * improve edge detection using an additional buffer such as a light\r\n\t * accumulation or depth buffer.\r\n\t *\r\n\t * @param {PredicationMode} mode - The predication mode.\r\n\t */\r\n\r\n\tsetPredicationMode(mode) {\r\n\r\n\t\tthis.defines.PREDICATION_MODE = mode.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a custom predication buffer.\r\n\t *\r\n\t * @param {Texture} predicationBuffer - The predication buffer.\r\n\t */\r\n\r\n\tsetPredicationBuffer(predicationBuffer) {\r\n\r\n\t\tthis.uniforms.predicationBuffer.value = predicationBuffer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the predication threshold.\r\n\t *\r\n\t * @param {Number} threshold - The threshold.\r\n\t */\r\n\r\n\tsetPredicationThreshold(threshold) {\r\n\r\n\t\tthis.defines.PREDICATION_THRESHOLD = threshold.toFixed(\"6\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the predication scale.\r\n\t *\r\n\t * Determines how much the edge detection threshold should be scaled when\r\n\t * using predication.\r\n\t *\r\n\t * @param {Number} scale - The scale. Range: [1.0, 5.0].\r\n\t */\r\n\r\n\tsetPredicationScale(scale) {\r\n\r\n\t\tthis.defines.PREDICATION_SCALE = scale.toFixed(\"6\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the predication strength.\r\n\t *\r\n\t * Determines how much the edge detection threshold should be decreased\r\n\t * locally when using predication.\r\n\t *\r\n\t * @param {Number} strength - The strength. Range: [0.0, 1.0].\r\n\t */\r\n\r\n\tsetPredicationStrength(strength) {\r\n\r\n\t\tthis.defines.PREDICATION_STRENGTH = strength.toFixed(\"6\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An enumeration of edge detection modes.\r\n *\r\n * @type {Object}\r\n * @property {Number} DEPTH - Depth-based edge detection.\r\n * @property {Number} LUMA - Luminance-based edge detection.\r\n * @property {Number} COLOR - Chroma-based edge detection.\r\n */\r\n\r\nconst EdgeDetectionMode = {\r\n\r\n\tDEPTH: 0,\r\n\tLUMA: 1,\r\n\tCOLOR: 2\r\n\r\n};\r\n\r\n/**\r\n * An enumeration of predication modes.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISABLED - No predicated thresholding.\r\n * @property {Number} DEPTH - Depth-based predicated thresholding.\r\n * @property {Number} CUSTOM - Predicated thresholding using a custom buffer.\r\n */\r\n\r\nconst PredicationMode = {\r\n\r\n\tDISABLED: 0,\r\n\tDEPTH: 1,\r\n\tCUSTOM: 2\r\n\r\n};\n\nvar fragmentTemplate = \"#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D depthBuffer;\\n#else\\nuniform mediump sampler2D depthBuffer;\\n#endif\\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\\n#else\\nreturn texture2D(depthBuffer,uv).r;\\n#endif\\n}float getViewZ(const in float depth){\\n#ifdef PERSPECTIVE_CAMERA\\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\\n#else\\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\\n#endif\\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\\n#ifdef ENCODE_OUTPUT\\n#include <encodings_fragment>\\n#endif\\n#include <dithering_fragment>\\n}\";\n\nvar vertexTemplate = \"uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * An effect material for compound shaders.\r\n *\r\n * This material supports dithering.\r\n *\r\n * @implements {Resizable}\r\n */\r\n\r\nclass EffectMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new effect material.\r\n\t *\r\n\t * @param {Map<String, String>} [shaderParts=null] - A collection of shader snippets. See {@link Section}.\r\n\t * @param {Map<String, String>} [defines=null] - A collection of preprocessor macro definitions.\r\n\t * @param {Map<String, Uniform>} [uniforms=null] - A collection of uniforms.\r\n\t * @param {Camera} [camera] - A camera.\r\n\t * @param {Boolean} [dithering=false] - Whether dithering should be enabled.\r\n\t */\r\n\r\n\tconstructor(shaderParts = null, defines = null, uniforms = null, camera, dithering = false) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"EffectMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tDEPTH_PACKING: \"0\",\r\n\t\t\t\tENCODE_OUTPUT: \"1\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tdepthBuffer: new Uniform(null),\r\n\t\t\t\tresolution: new Uniform(new Vector2$1()),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1()),\r\n\t\t\t\tcameraNear: new Uniform(0.3),\r\n\t\t\t\tcameraFar: new Uniform(1000.0),\r\n\t\t\t\taspect: new Uniform(1.0),\r\n\t\t\t\ttime: new Uniform(0.0)\r\n\t\t\t},\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdithering\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tif(shaderParts !== null) {\r\n\r\n\t\t\tthis.setShaderParts(shaderParts);\r\n\r\n\t\t}\r\n\r\n\t\tif(defines !== null) {\r\n\r\n\t\t\tthis.setDefines(defines);\r\n\r\n\t\t}\r\n\r\n\t\tif(uniforms !== null) {\r\n\r\n\t\t\tthis.setUniforms(uniforms);\r\n\r\n\t\t}\r\n\r\n\t\tthis.adoptCameraSettings(camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget depthPacking() {\r\n\r\n\t\treturn Number(this.defines.DEPTH_PACKING);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth packing.\r\n\t *\r\n\t * Use `BasicDepthPacking` or `RGBADepthPacking` if your depth texture\r\n\t * contains packed depth.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset depthPacking(value) {\r\n\r\n\t\tthis.defines.DEPTH_PACKING = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the shader parts.\r\n\t *\r\n\t * @param {Map<String, String>} shaderParts - A collection of shader snippets. See {@link Section}.\r\n\t * @return {EffectMaterial} This material.\r\n\t */\r\n\r\n\tsetShaderParts(shaderParts) {\r\n\r\n\t\tthis.fragmentShader = fragmentTemplate\r\n\t\t\t.replace(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD))\r\n\t\t\t.replace(Section.FRAGMENT_MAIN_UV, shaderParts.get(Section.FRAGMENT_MAIN_UV))\r\n\t\t\t.replace(Section.FRAGMENT_MAIN_IMAGE, shaderParts.get(Section.FRAGMENT_MAIN_IMAGE));\r\n\r\n\t\tthis.vertexShader = vertexTemplate\r\n\t\t\t.replace(Section.VERTEX_HEAD, shaderParts.get(Section.VERTEX_HEAD))\r\n\t\t\t.replace(Section.VERTEX_MAIN_SUPPORT, shaderParts.get(Section.VERTEX_MAIN_SUPPORT));\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the shader macros.\r\n\t *\r\n\t * @param {Map<String, String>} defines - A collection of preprocessor macro definitions.\r\n\t * @return {EffectMaterial} This material.\r\n\t */\r\n\r\n\tsetDefines(defines) {\r\n\r\n\t\tfor(const entry of defines.entries()) {\r\n\r\n\t\t\tthis.defines[entry[0]] = entry[1];\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the shader uniforms.\r\n\t *\r\n\t * @param {Map<String, Uniform>} uniforms - A collection of uniforms.\r\n\t * @return {EffectMaterial} This material.\r\n\t */\r\n\r\n\tsetUniforms(uniforms) {\r\n\r\n\t\tfor(const entry of uniforms.entries()) {\r\n\r\n\t\t\tthis.uniforms[entry[0]] = entry[1];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adopts the settings of the given camera.\r\n\t *\r\n\t * @param {Camera} [camera=null] - A camera.\r\n\t */\r\n\r\n\tadoptCameraSettings(camera = null) {\r\n\r\n\t\tif(camera !== null) {\r\n\r\n\t\t\tthis.uniforms.cameraNear.value = camera.near;\r\n\t\t\tthis.uniforms.cameraFar.value = camera.far;\r\n\r\n\t\t\tif(camera instanceof PerspectiveCamera) {\r\n\r\n\t\t\t\tthis.defines.PERSPECTIVE_CAMERA = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete this.defines.PERSPECTIVE_CAMERA;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst w = Math.max(width, 1);\r\n\t\tconst h = Math.max(height, 1);\r\n\r\n\t\tthis.uniforms.resolution.value.set(w, h);\r\n\t\tthis.uniforms.texelSize.value.set(1.0 / w, 1.0 / h);\r\n\t\tthis.uniforms.aspect.value = w / h;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An enumeration of shader code placeholders used by the {@link EffectPass}.\r\n *\r\n * @type {Object}\r\n * @property {String} FRAGMENT_HEAD - A placeholder for function and variable declarations inside the fragment shader.\r\n * @property {String} FRAGMENT_MAIN_UV - A placeholder for UV transformations inside the fragment shader.\r\n * @property {String} FRAGMENT_MAIN_IMAGE - A placeholder for color calculations inside the fragment shader.\r\n * @property {String} VERTEX_HEAD - A placeholder for function and variable declarations inside the vertex shader.\r\n * @property {String} VERTEX_MAIN_SUPPORT - A placeholder for supporting calculations inside the vertex shader.\r\n */\r\n\r\nconst Section = {\r\n\r\n\tFRAGMENT_HEAD: \"FRAGMENT_HEAD\",\r\n\tFRAGMENT_MAIN_UV: \"FRAGMENT_MAIN_UV\",\r\n\tFRAGMENT_MAIN_IMAGE: \"FRAGMENT_MAIN_IMAGE\",\r\n\tVERTEX_HEAD: \"VERTEX_HEAD\",\r\n\tVERTEX_MAIN_SUPPORT: \"VERTEX_MAIN_SUPPORT\"\r\n\r\n};\n\nvar fragmentShader$9 = \"#include <common>\\n#include <dithering_pars_fragment>\\nuniform sampler2D inputBuffer;uniform vec2 lightPosition;uniform float exposure;uniform float decay;uniform float density;uniform float weight;uniform float clampMax;varying vec2 vUv;void main(){vec2 coord=vUv;vec2 delta=lightPosition-coord;delta*=1.0/SAMPLES_FLOAT*density;float illuminationDecay=1.0;vec4 color=vec4(0.0);/*Estimate the probability of occlusion at each pixel by summing samplesalong a ray to the light position.*/for(int i=0;i<SAMPLES_INT;++i){coord+=delta;vec4 texel=texture2D(inputBuffer,coord);texel*=illuminationDecay*weight;color+=texel;illuminationDecay*=decay;}gl_FragColor=clamp(color*exposure,0.0,clampMax);\\n#include <dithering_fragment>\\n}\";\n\n/**\r\n * A crepuscular rays shader material.\r\n *\r\n * This material supports dithering.\r\n *\r\n * References:\r\n *\r\n * Thibaut Despoulain, 2012:\r\n *  [(WebGL) Volumetric Light Approximation in Three.js](\r\n *  http://bkcore.com/blog/3d/webgl-three-js-volumetric-light-godrays.html)\r\n *\r\n * Nvidia, GPU Gems 3, 2008:\r\n *  [Chapter 13. Volumetric Light Scattering as a Post-Process](\r\n *  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch13.html)\r\n *\r\n * @todo Remove dithering code from fragment shader.\r\n */\r\n\r\nclass GodRaysMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new god rays material.\r\n\t *\r\n\t * @param {Vector2} lightPosition - The light position in screen space.\r\n\t */\r\n\r\n\tconstructor(lightPosition) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"GodRaysMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tSAMPLES_INT: \"60\",\r\n\t\t\t\tSAMPLES_FLOAT: \"60.0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tlightPosition: new Uniform(lightPosition),\r\n\t\t\t\tdensity: new Uniform(1.0),\r\n\t\t\t\tdecay: new Uniform(1.0),\r\n\t\t\t\tweight: new Uniform(1.0),\r\n\t\t\t\texposure: new Uniform(1.0),\r\n\t\t\t\tclampMax: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$9,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The amount of samples per pixel.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget samples() {\r\n\r\n\t\treturn Number(this.defines.SAMPLES_INT);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of samples per pixel.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset samples(value) {\r\n\r\n\t\tconst s = Math.floor(value);\r\n\r\n\t\tthis.defines.SAMPLES_INT = s.toFixed(0);\r\n\t\tthis.defines.SAMPLES_FLOAT = s.toFixed(1);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$a = \"#include <common>\\nuniform sampler2D inputBuffer;\\n#ifdef RANGE\\nuniform vec2 range;\\n#elif defined(THRESHOLD)\\nuniform float threshold;uniform float smoothing;\\n#endif\\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);\\n#ifdef RANGE\\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\\n#elif defined(THRESHOLD)\\nl=smoothstep(threshold,threshold+smoothing,l);\\n#endif\\n#ifdef COLOR\\ngl_FragColor=vec4(texel.rgb*l,l);\\n#else\\ngl_FragColor=vec4(l);\\n#endif\\n}\";\n\n/**\r\n * A luminance shader material.\r\n *\r\n * This shader produces a greyscale luminance map that describes the absolute\r\n * amount of light emitted by a scene. It can also be configured to output\r\n * colours that are scaled with their respective luminance value. Additionally,\r\n * a range may be provided to mask out undesired texels.\r\n *\r\n * The alpha channel always contains the luminance value.\r\n *\r\n * On luminance coefficients:\r\n *  http://www.poynton.com/notes/colour_and_gamma/ColorFAQ.html#RTFToC9\r\n *\r\n * Coefficients for different colour spaces:\r\n *  https://hsto.org/getpro/habr/post_images/2ab/69d/084/2ab69d084f9a597e032624bcd74d57a7.png\r\n *\r\n * Luminance range reference:\r\n *  https://cycling74.com/2007/05/23/your-first-shader/#.Vty9FfkrL4Z\r\n */\r\n\r\nclass LuminanceMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new luminance material.\r\n\t *\r\n\t * @param {Boolean} [colorOutput=false] - Defines whether the shader should output colors scaled with their luminance value.\r\n\t * @param {Vector2} [luminanceRange] - If provided, the shader will mask out texels that aren't in the specified luminance range.\r\n\t */\r\n\r\n\tconstructor(colorOutput = false, luminanceRange = null) {\r\n\r\n\t\tconst useRange = (luminanceRange !== null);\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"LuminanceMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tthreshold: new Uniform(0.0),\r\n\t\t\t\tsmoothing: new Uniform(1.0),\r\n\t\t\t\trange: new Uniform(useRange ? luminanceRange : new Vector2$1())\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$a,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.colorOutput = colorOutput;\r\n\t\tthis.useThreshold = true;\r\n\t\tthis.useRange = useRange;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The luminance threshold.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget threshold() {\r\n\r\n\t\treturn this.uniforms.threshold.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the luminance threshold.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset threshold(value) {\r\n\r\n\t\tthis.uniforms.threshold.value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The luminance threshold smoothing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget smoothing() {\r\n\r\n\t\treturn this.uniforms.smoothing.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the luminance threshold smoothing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset smoothing(value) {\r\n\r\n\t\tthis.uniforms.smoothing.value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the luminance threshold is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget useThreshold() {\r\n\r\n\t\treturn (this.defines.THRESHOLD !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables the luminance threshold.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset useThreshold(value) {\r\n\r\n\t\tif(value) {\r\n\r\n\t\t\tthis.defines.THRESHOLD = \"1\";\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdelete this.defines.THRESHOLD;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether color output is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget colorOutput() {\r\n\r\n\t\treturn (this.defines.COLOR !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables color output.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset colorOutput(value) {\r\n\r\n\t\tif(value) {\r\n\r\n\t\t\tthis.defines.COLOR = \"1\";\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdelete this.defines.COLOR;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables color output.\r\n\t *\r\n\t * @deprecated Use colorOutput instead.\r\n\t * @param {Boolean} enabled - Whether color output should be enabled.\r\n\t */\r\n\r\n\tsetColorOutputEnabled(enabled) {\r\n\r\n\t\tthis.colorOutput = enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether luminance masking is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget useRange() {\r\n\r\n\t\treturn (this.defines.RANGE !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables luminance masking.\r\n\t *\r\n\t * If enabled, the threshold will be ignored.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset useRange(value) {\r\n\r\n\t\tif(value) {\r\n\r\n\t\t\tthis.defines.RANGE = \"1\";\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdelete this.defines.RANGE;\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether luminance masking is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Use useRange instead.\r\n\t */\r\n\r\n\tget luminanceRange() {\r\n\r\n\t\treturn this.useRange;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables luminance masking.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Use useRange instead.\r\n\t */\r\n\r\n\tset luminanceRange(value) {\r\n\r\n\t\tthis.useRange = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables the luminance mask.\r\n\t *\r\n\t * @deprecated Use luminanceRange instead.\r\n\t * @param {Boolean} enabled - Whether the luminance mask should be enabled.\r\n\t */\r\n\r\n\tsetLuminanceRangeEnabled(enabled) {\r\n\r\n\t\tthis.useRange = enabled;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$b = \"uniform sampler2D maskTexture;uniform sampler2D inputBuffer;\\n#if MASK_FUNCTION != 0\\nuniform float strength;\\n#endif\\nvarying vec2 vUv;void main(){\\n#if COLOR_CHANNEL == 0\\nfloat mask=texture2D(maskTexture,vUv).r;\\n#elif COLOR_CHANNEL == 1\\nfloat mask=texture2D(maskTexture,vUv).g;\\n#elif COLOR_CHANNEL == 2\\nfloat mask=texture2D(maskTexture,vUv).b;\\n#else\\nfloat mask=texture2D(maskTexture,vUv).a;\\n#endif\\n#if MASK_FUNCTION == 0\\n#ifdef INVERTED\\nif(mask>0.0){discard;}\\n#else\\nif(mask==0.0){discard;}\\n#endif\\n#else\\nmask=clamp(mask*strength,0.0,1.0);\\n#ifdef INVERTED\\nmask=(1.0-mask);\\n#endif\\n#if MASK_FUNCTION == 1\\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\\n#else\\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\\n#endif\\n#endif\\n}\";\n\n/**\r\n * A mask shader material.\r\n *\r\n * This material applies a mask texture to a buffer.\r\n */\r\n\r\nclass MaskMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new mask material.\r\n\t *\r\n\t * @param {Texture} [maskTexture] - The mask texture.\r\n\t */\r\n\r\n\tconstructor(maskTexture = null) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"MaskMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tmaskTexture: new Uniform(maskTexture),\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tstrength: new Uniform(1.0)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$b,\r\n\t\t\tvertexShader,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.colorChannel = ColorChannel.RED;\r\n\t\tthis.maskFunction = MaskFunction.DISCARD;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the mask texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tset maskTexture(value) {\r\n\r\n\t\tthis.uniforms.maskTexture.value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the color channel to use for masking.\r\n\t *\r\n\t * The default channel is `RED`.\r\n\t *\r\n\t * @type {ColorChannel}\r\n\t */\r\n\r\n\tset colorChannel(value) {\r\n\r\n\t\tthis.defines.COLOR_CHANNEL = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the masking technique.\r\n\t *\r\n\t * The default function is `DISCARD`.\r\n\t *\r\n\t * @type {MaskFunction}\r\n\t */\r\n\r\n\tset maskFunction(value) {\r\n\r\n\t\tthis.defines.MASK_FUNCTION = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the masking is inverted.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget inverted() {\r\n\r\n\t\treturn (this.defines.INVERTED !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Determines whether the masking should be inverted.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset inverted(value) {\r\n\r\n\t\tif(this.inverted && !value) {\r\n\r\n\t\t\tdelete this.defines.INVERTED;\r\n\r\n\t\t} else if(value) {\r\n\r\n\t\t\tthis.defines.INVERTED = \"1\";\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current mask strength.\r\n\t *\r\n\t * Individual mask values will be clamped to [0.0, 1.0].\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget strength() {\r\n\r\n\t\treturn this.uniforms.strength.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the strength of the mask.\r\n\t *\r\n\t * Has no effect when the mask function is set to `DISCARD`.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset strength(value) {\r\n\r\n\t\tthis.uniforms.strength.value = value;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * A mask function enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISCARD - Discards elements when the respective mask value is zero.\r\n * @property {Number} MULTIPLY - Multiplies the input buffer with the mask texture.\r\n * @property {Number} MULTIPLY_RGB_SET_ALPHA - Multiplies the input RGB values with the mask and sets alpha to the mask value.\r\n */\r\n\r\nconst MaskFunction = {\r\n\r\n\tDISCARD: 0,\r\n\tMULTIPLY: 1,\r\n\tMULTIPLY_RGB_SET_ALPHA: 2\r\n\r\n};\n\nvar fragmentShader$c = \"uniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)? vec2(d,0.0): vec2(0.0,d);}\";\n\nvar vertexShader$5 = \"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * An outline shader material.\r\n */\r\n\r\nclass OutlineMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new outline material.\r\n\t *\r\n\t * @param {Vector2} [texelSize] - The screen texel size.\r\n\t */\r\n\r\n\tconstructor(texelSize = new Vector2$1()) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"OutlineMaterial\",\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1())\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$c,\r\n\t\t\tvertexShader: vertexShader$5,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.setTexelSize(texelSize.x, texelSize.y);\r\n\r\n\t\t// @todo Added for backward compatibility.\r\n\t\tthis.uniforms.maskTexture = this.uniforms.inputBuffer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texel size.\r\n\t *\r\n\t * @param {Number} x - The texel width.\r\n\t * @param {Number} y - The texel height.\r\n\t */\r\n\r\n\tsetTexelSize(x, y) {\r\n\r\n\t\tthis.uniforms.texelSize.value.set(x, y);\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An outline shader material.\r\n *\r\n * @deprecated Use OutlineMaterial instead.\r\n */\r\n\r\nconst OutlineEdgesMaterial = OutlineMaterial;\n\nvar fragmentShader$d = \"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\\n#if __VERSION__ < 300\\n#define round(v) floor(v + 0.5)\\n#endif\\nuniform sampler2D inputBuffer;uniform sampler2D areaTexture;uniform sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}/***Allows to decode two binary values from a bilinear-filtered access.**Bilinear access for fetching 'e' have a 0.25 offset,and we are interested*in the R and G edges:**+---G---+-------+*|x o R   x|*+-------+-------+**Then,if one of these edge is enabled:*Red:(0.75*X+0.25*1)=>0.25 or 1.0*Green:(0.75*1+0.25*X)=>0.75 or 1.0**This function will unpack the values(mad+mul+round):*wolframalpha.com: round(x*abs(5*x-5*0.75))plot 0 to 1*/vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}/***Diagonal pattern searches.*/vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}/***Calculates the area corresponding to a certain diagonal distance and crossing*edges 'e'.*/vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}/***Searches for diagonal patterns and returns the corresponding weights.*/vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}/***Determines how much length should be added in the last step of the searches.**Takes the bilinearly interpolated edge(see @PSEUDO_GATHER4),and adds 0,1*or 2 depending on which edges and crossing edges are active.*/float searchLength(const in vec2 e,const in float offset){/*The texture is flipped vertically,with left and right cases taking halfof the space horizontally.*/vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}/***Horizontal search for the second pass.*/float searchXLeft(in vec2 texCoord,const in float end){/*@PSEUDO_GATHER4This texCoord has been offset by(-0.25,-0.125)in the vertex shader tosample between edges,thus fetching four edges in a row.Sampling with different offsets in each direction allows to disambiguatewhich edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}/***Vertical search for the second pass.*/float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}/***Determines the areas at each side of the current edge.*/vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}/***Corner detection.*/void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\\n#if !defined(DISABLE_CORNER_DETECTION)\\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\\n#endif\\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\\n#if !defined(DISABLE_CORNER_DETECTION)\\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\\n#endif\\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\\n#if !defined(DISABLE_DIAG_DETECTION)\\n/*Diagonals have both north and west edges,so searching for them in one ofthe boundaries is enough.*/weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\\n#endif\\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;/*Now fetch the left crossing edges,two at a time using bilinearfiltering. Sampling at-0.25(see @CROSSING_OFFSET)enables to discern whatvalue each edge has.*/float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;/*Translate distances to pixel units for better interleave arithmetic andmemory accesses.*/d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\\n#if !defined(DISABLE_DIAG_DETECTION)\\n}else{e.r=0.0;}\\n#endif\\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}\";\n\nvar vertexShader$6 = \"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * Subpixel Morphological Antialiasing.\r\n *\r\n * This material computes weights for detected edges.\r\n */\r\n\r\nclass SMAAWeightsMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new SMAA weights material.\r\n\t *\r\n\t * @param {Vector2} [texelSize] - The absolute screen texel size.\r\n\t * @param {Vector2} [resolution] - The resolution.\r\n\t */\r\n\r\n\tconstructor(texelSize = new Vector2$1(), resolution = new Vector2$1()) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"SMAAWeightsMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\r\n\t\t\t\t// Configurable settings:\r\n\t\t\t\tMAX_SEARCH_STEPS_INT: \"16\",\r\n\t\t\t\tMAX_SEARCH_STEPS_FLOAT: \"16.0\",\r\n\t\t\t\tMAX_SEARCH_STEPS_DIAG_INT: \"8\",\r\n\t\t\t\tMAX_SEARCH_STEPS_DIAG_FLOAT: \"8.0\",\r\n\t\t\t\tCORNER_ROUNDING: \"25\",\r\n\t\t\t\tCORNER_ROUNDING_NORM: \"0.25\",\r\n\r\n\t\t\t\t// Non-configurable settings:\r\n\t\t\t\tAREATEX_MAX_DISTANCE: \"16.0\",\r\n\t\t\t\tAREATEX_MAX_DISTANCE_DIAG: \"20.0\",\r\n\t\t\t\tAREATEX_PIXEL_SIZE: \"(1.0 / vec2(160.0, 560.0))\",\r\n\t\t\t\tAREATEX_SUBTEX_SIZE: \"(1.0 / 7.0)\",\r\n\t\t\t\tSEARCHTEX_SIZE: \"vec2(66.0, 33.0)\",\r\n\t\t\t\tSEARCHTEX_PACKED_SIZE: \"vec2(64.0, 16.0)\"\r\n\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tinputBuffer: new Uniform(null),\r\n\t\t\t\tareaTexture: new Uniform(null),\r\n\t\t\t\tsearchTexture: new Uniform(null),\r\n\t\t\t\ttexelSize: new Uniform(texelSize),\r\n\t\t\t\tresolution: new Uniform(resolution)\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$d,\r\n\t\t\tvertexShader: vertexShader$6,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the maximum amount of steps performed in the horizontal/vertical\r\n\t * pattern searches, at each side of the pixel.\r\n\t *\r\n\t * In number of pixels, it's actually the double. So the maximum line length\r\n\t * perfectly handled by, for example 16, is 64 (perfectly means that longer\r\n\t * lines won't look as good, but are still antialiased).\r\n\t *\r\n\t * @param {Number} steps - The search steps. Range: [0, 112].\r\n\t */\r\n\r\n\tsetOrthogonalSearchSteps(steps) {\r\n\r\n\t\tconst s = Math.min(Math.max(steps, 0), 112);\r\n\r\n\t\tthis.defines.MAX_SEARCH_STEPS_INT = s.toFixed(\"0\");\r\n\t\tthis.defines.MAX_SEARCH_STEPS_FLOAT = s.toFixed(\"1\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Specifies the maximum steps performed in the diagonal pattern searches, at\r\n\t * each side of the pixel. This search jumps one pixel at time.\r\n\t *\r\n\t * On high-end machines this search is cheap (between 0.8x and 0.9x slower for\r\n\t * 16 steps), but it can have a significant impact on older machines.\r\n\t *\r\n\t * @param {Number} steps - The search steps. Range: [0, 20].\r\n\t */\r\n\r\n\tsetDiagonalSearchSteps(steps) {\r\n\r\n\t\tconst s = Math.min(Math.max(steps, 0), 20);\r\n\r\n\t\tthis.defines.MAX_SEARCH_STEPS_DIAG_INT = s.toFixed(\"0\");\r\n\t\tthis.defines.MAX_SEARCH_STEPS_DIAG_FLOAT = s.toFixed(\"1\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Specifies how much sharp corners will be rounded.\r\n\t *\r\n\t * @param {Number} rounding - The corner rounding amount. Range: [0, 100].\r\n\t */\r\n\r\n\tsetCornerRounding(rounding) {\r\n\r\n\t\tconst r = Math.min(Math.max(rounding, 0), 100);\r\n\r\n\t\tthis.defines.CORNER_ROUNDING = r.toFixed(\"4\");\r\n\t\tthis.defines.CORNER_ROUNDING_NORM = (r / 100.0).toFixed(\"4\");\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether diagonal pattern detection is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget diagonalDetection() {\r\n\r\n\t\treturn (this.defines.DISABLE_DIAG_DETECTION === undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables diagonal pattern detection.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset diagonalDetection(value) {\r\n\r\n\t\tif(value) {\r\n\r\n\t\t\tdelete this.defines.DISABLE_DIAG_DETECTION;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.defines.DISABLE_DIAG_DETECTION = \"1\";\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether corner rounding is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget cornerRounding() {\r\n\r\n\t\treturn (this.defines.DISABLE_CORNER_DETECTION === undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables corner rounding.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset cornerRounding(value) {\r\n\r\n\t\tif(value) {\r\n\r\n\t\t\tdelete this.defines.DISABLE_CORNER_DETECTION;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.defines.DISABLE_CORNER_DETECTION = \"1\";\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$e = \"#include <common>\\n#include <packing>\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D normalDepthBuffer;\\n#else\\nuniform mediump sampler2D normalDepthBuffer;\\n#endif\\n#ifndef NORMAL_DEPTH\\nuniform sampler2D normalBuffer;float readDepth(const in vec2 uv){\\n#if DEPTH_PACKING == 3201\\nreturn unpackRGBAToDepth(texture2D(normalDepthBuffer,uv));\\n#else\\nreturn texture2D(normalDepthBuffer,uv).r;\\n#endif\\n}\\n#endif\\nuniform sampler2D noiseTexture;uniform mat4 inverseProjectionMatrix;uniform mat4 projectionMatrix;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float minRadiusScale;uniform float intensity;uniform float fade;uniform float bias;uniform vec2 distanceCutoff;uniform vec2 proximityCutoff;varying vec2 vUv;varying vec2 vUv2;float getViewZ(const in float depth){\\n#ifdef PERSPECTIVE_CAMERA\\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\\n#else\\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\\n#endif\\n}vec3 getViewPosition(const in vec2 screenPosition,const in float depth,const in float viewZ){float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];vec4 clipPosition=vec4((vec3(screenPosition,depth)-0.5)*2.0,1.0);clipPosition*=clipW;return(inverseProjectionMatrix*clipPosition).xyz;}float getAmbientOcclusion(const in vec3 p,const in vec3 n,const in float depth,const in vec2 uv){\\n#ifdef DISTANCE_SCALING\\nfloat radiusScale=1.0-smoothstep(0.0,distanceCutoff.y,depth);radiusScale=radiusScale*(1.0-minRadiusScale)+minRadiusScale;float radius=RADIUS*radiusScale;\\n#else\\nfloat radius=RADIUS;\\n#endif\\nfloat noise=texture2D(noiseTexture,vUv2).r;float baseAngle=noise*PI2;float invSamples=1.0/SAMPLES_FLOAT;float rings=SPIRAL_TURNS*PI2;float occlusion=0.0;int taps=0;for(int i=0;i<SAMPLES_INT;++i){float alpha=(float(i)+0.5)*invSamples;float angle=alpha*rings+baseAngle;vec2 coord=alpha*radius*vec2(cos(angle),sin(angle))*texelSize+uv;if(coord.s<0.0||coord.s>1.0||coord.t<0.0||coord.t>1.0){continue;}\\n#ifdef NORMAL_DEPTH\\nfloat sampleDepth=texture2D(normalDepthBuffer,coord).a;\\n#else\\nfloat sampleDepth=readDepth(coord);\\n#endif\\nfloat viewZ=getViewZ(sampleDepth);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat linearSampleDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearSampleDepth=sampleDepth;\\n#endif\\nfloat proximity=abs(depth-linearSampleDepth);if(proximity<proximityCutoff.y){float falloff=1.0-smoothstep(proximityCutoff.x,proximityCutoff.y,proximity);vec3 Q=getViewPosition(coord,sampleDepth,viewZ);vec3 v=Q-p;float vv=dot(v,v);float vn=dot(v,n)-bias;float f=max(RADIUS_SQ-vv,0.0)/RADIUS_SQ;occlusion+=(f*f*f*max(vn/(fade+vv),0.0))*falloff;}++taps;}return occlusion/(4.0*max(float(taps),1.0));}void main(){\\n#ifdef NORMAL_DEPTH\\nvec4 normalDepth=texture2D(normalDepthBuffer,vUv);\\n#else\\nvec4 normalDepth=vec4(texture2D(normalBuffer,vUv).rgb,readDepth(vUv));\\n#endif\\nfloat ao=1.0;float depth=normalDepth.a;float viewZ=getViewZ(depth);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nif(linearDepth<distanceCutoff.y){vec3 viewPosition=getViewPosition(vUv,depth,viewZ);vec3 viewNormal=unpackRGBToNormal(normalDepth.rgb);ao-=getAmbientOcclusion(viewPosition,viewNormal,linearDepth,vUv);float d=smoothstep(distanceCutoff.x,distanceCutoff.y,linearDepth);ao=mix(ao,1.0,d);ao=clamp(pow(ao,abs(intensity)),0.0,1.0);}gl_FragColor.r=ao;}\";\n\nvar vertexShader$7 = \"uniform vec2 noiseScale;varying vec2 vUv;varying vec2 vUv2;void main(){vUv=position.xy*0.5+0.5;vUv2=vUv*noiseScale;gl_Position=vec4(position.xy,1.0,1.0);}\";\n\n/**\r\n * A Screen Space Ambient Occlusion (SSAO) shader material.\r\n */\r\n\r\nclass SSAOMaterial extends ShaderMaterial {\r\n\r\n\t/**\r\n\t * Constructs a new SSAO material.\r\n\t *\r\n\t * @param {Camera} camera - A camera.\r\n\t */\r\n\r\n\tconstructor(camera) {\r\n\r\n\t\tsuper({\r\n\r\n\t\t\ttype: \"SSAOMaterial\",\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tSAMPLES_INT: \"0\",\r\n\t\t\t\tSAMPLES_FLOAT: \"0.0\",\r\n\t\t\t\tSPIRAL_TURNS: \"0.0\",\r\n\t\t\t\tRADIUS: \"1.0\",\r\n\t\t\t\tRADIUS_SQ: \"1.0\",\r\n\t\t\t\tDISTANCE_SCALING: \"1\",\r\n\t\t\t\tDEPTH_PACKING: \"0\"\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\r\n\t\t\t\tnormalBuffer: new Uniform(null),\r\n\t\t\t\tnormalDepthBuffer: new Uniform(null),\r\n\t\t\t\tnoiseTexture: new Uniform(null),\r\n\r\n\t\t\t\tinverseProjectionMatrix: new Uniform(new Matrix4()),\r\n\t\t\t\tprojectionMatrix: new Uniform(new Matrix4()),\r\n\t\t\t\ttexelSize: new Uniform(new Vector2$1()),\r\n\t\t\t\tcameraNear: new Uniform(0.0),\r\n\t\t\t\tcameraFar: new Uniform(0.0),\r\n\r\n\t\t\t\tdistanceCutoff: new Uniform(new Vector2$1()),\r\n\t\t\t\tproximityCutoff: new Uniform(new Vector2$1()),\r\n\t\t\t\tnoiseScale: new Uniform(new Vector2$1()),\r\n\t\t\t\tminRadiusScale: new Uniform(0.33),\r\n\t\t\t\tintensity: new Uniform(1.0),\r\n\t\t\t\tfade: new Uniform(0.01),\r\n\t\t\t\tbias: new Uniform(0.0)\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfragmentShader: fragmentShader$e,\r\n\t\t\tvertexShader: vertexShader$7,\r\n\r\n\t\t\tdepthWrite: false,\r\n\t\t\tdepthTest: false\r\n\r\n\t\t});\r\n\r\n\t\t/** @ignore */\r\n\t\tthis.toneMapped = false;\r\n\r\n\t\tthis.adoptCameraSettings(camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The depth packing of the source depth buffer.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget depthPacking() {\r\n\r\n\t\treturn Number(this.defines.DEPTH_PACKING);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth packing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset depthPacking(value) {\r\n\r\n\t\tthis.defines.DEPTH_PACKING = value.toFixed(0);\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texel size.\r\n\t *\r\n\t * @param {Number} x - The texel width.\r\n\t * @param {Number} y - The texel height.\r\n\t */\r\n\r\n\tsetTexelSize(x, y) {\r\n\r\n\t\tthis.uniforms.texelSize.value.set(x, y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adopts the settings of the given camera.\r\n\t *\r\n\t * @param {Camera} [camera=null] - A camera.\r\n\t */\r\n\r\n\tadoptCameraSettings(camera = null) {\r\n\r\n\t\tif(camera !== null) {\r\n\r\n\t\t\tconst uniforms = this.uniforms;\r\n\r\n\t\t\tuniforms.cameraNear.value = camera.near;\r\n\t\t\tuniforms.cameraFar.value = camera.far;\r\n\r\n\t\t\tif(camera instanceof PerspectiveCamera) {\r\n\r\n\t\t\t\tthis.defines.PERSPECTIVE_CAMERA = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete this.defines.PERSPECTIVE_CAMERA;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * An auto sizing constant.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst AUTO_SIZE = -1;\r\n\r\n/**\r\n * A resizer that can be used to store a base and a target resolution.\r\n *\r\n * The attached resizeable will be updated with the base resolution when the\r\n * target resolution changes. The new calculated resolution can then be\r\n * retrieved via {@link Resizer.width} and {@link Resizer.height}.\r\n */\r\n\r\nclass Resizer {\r\n\r\n\t/**\r\n\t * Constructs a new resizer.\r\n\t *\r\n\t * @param {Resizable} resizeable - A resizable object.\r\n\t * @param {Number} [width=Resizer.AUTO_SIZE] - The width.\r\n\t * @param {Number} [height=Resizer.AUTO_SIZE] - The height.\r\n\t * @param {Number} [scale=1.0] - An alternative resolution scale.\r\n\t */\r\n\r\n\tconstructor(resizable, width = AUTO_SIZE, height = AUTO_SIZE, scale = 1.0) {\r\n\r\n\t\t/**\r\n\t\t * A resizable object.\r\n\t\t *\r\n\t\t * @type {Resizable}\r\n\t\t */\r\n\r\n\t\tthis.resizable = resizable;\r\n\r\n\t\t/**\r\n\t\t * The base size.\r\n\t\t *\r\n\t\t * This size will be passed to the resizable object every time the target\r\n\t\t * width, height or scale is changed.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t */\r\n\r\n\t\tthis.base = new Vector2$1(1, 1);\r\n\r\n\t\t/**\r\n\t\t * The target size.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.target = new Vector2$1(width, height);\r\n\r\n\t\t/**\r\n\t\t * A scale.\r\n\t\t *\r\n\t\t * If both the width and the height are set to {@link Resizer.AUTO_SIZE},\r\n\t\t * they will be scaled uniformly using this scalar.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.s = scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current resolution scale.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget scale() {\r\n\r\n\t\treturn this.s;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * Also sets the width and height to {@link Resizer.AUTO_SIZE}.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset scale(value) {\r\n\r\n\t\tthis.s = value;\r\n\r\n\t\tthis.target.x = AUTO_SIZE;\r\n\t\tthis.target.y = AUTO_SIZE;\r\n\r\n\t\tthis.resizable.setSize(this.base.x, this.base.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The calculated width.\r\n\t *\r\n\t * If both the width and the height are set to {@link Resizer.AUTO_SIZE}, the\r\n\t * base width will be returned.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget width() {\r\n\r\n\t\tconst base = this.base;\r\n\t\tconst target = this.target;\r\n\r\n\t\tlet result;\r\n\r\n\t\tif(target.x !== AUTO_SIZE) {\r\n\r\n\t\t\tresult = target.x;\r\n\r\n\t\t} else if(target.y !== AUTO_SIZE) {\r\n\r\n\t\t\tresult = Math.round(target.y * (base.x / base.y));\r\n\r\n\t\t} else {\r\n\r\n\t\t\tresult = Math.round(base.x * this.s);\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the target width.\r\n\t *\r\n\t * Use {@link Resizer.AUTO_SIZE} to automatically calculate the width based\r\n\t * on the height and the original aspect ratio.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset width(value) {\r\n\r\n\t\tthis.target.x = value;\r\n\t\tthis.resizable.setSize(this.base.x, this.base.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The calculated height.\r\n\t *\r\n\t * If both the width and the height are set to {@link Resizer.AUTO_SIZE}, the\r\n\t * base height will be returned.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget height() {\r\n\r\n\t\tconst base = this.base;\r\n\t\tconst target = this.target;\r\n\r\n\t\tlet result;\r\n\r\n\t\tif(target.y !== AUTO_SIZE) {\r\n\r\n\t\t\tresult = target.y;\r\n\r\n\t\t} else if(target.x !== AUTO_SIZE) {\r\n\r\n\t\t\tresult = Math.round(target.x / (base.x / base.y));\r\n\r\n\t\t} else {\r\n\r\n\t\t\tresult = Math.round(base.y * this.s);\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the target height.\r\n\t *\r\n\t * Use {@link Resizer.AUTO_SIZE} to automatically calculate the height based\r\n\t * on the width and the original aspect ratio.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset height(value) {\r\n\r\n\t\tthis.target.y = value;\r\n\t\tthis.resizable.setSize(this.base.x, this.base.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * An auto sizing constant.\r\n\t *\r\n\t * Can be used to automatically calculate the width or height based on the\r\n\t * original aspect ratio.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tstatic get AUTO_SIZE() {\r\n\r\n\t\treturn AUTO_SIZE;\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A dummy camera\r\n *\r\n * @type {Camera}\r\n * @private\r\n */\r\n\r\nconst dummyCamera = new Camera();\r\n\r\n/**\r\n * Shared fullscreen geometry.\r\n *\r\n * @type {BufferGeometry}\r\n * @private\r\n */\r\n\r\nlet geometry = null;\r\n\r\n/**\r\n * Returns a shared fullscreen triangle.\r\n *\r\n * The size of the screen is 2x2 units (NDC). A triangle that fills the screen\r\n * needs to be 4 units wide and 4 units tall.\r\n *\r\n * @private\r\n * @return {BufferGeometry} The fullscreen geometry.\r\n */\r\n\r\nfunction getFullscreenTriangle() {\r\n\r\n\tif(geometry === null) {\r\n\r\n\t\tconst vertices = new Float32Array([-1, -1, 0, 3, -1, 0, -1, 3, 0]);\r\n\t\tconst uvs = new Float32Array([0, 0, 2, 0, 0, 2]);\r\n\t\tgeometry = new BufferGeometry();\r\n\r\n\t\t// Added for backward compatibility (setAttribute was added in three r110).\r\n\t\tif(geometry.setAttribute !== undefined) {\r\n\r\n\t\t\tgeometry.setAttribute(\"position\", new BufferAttribute(vertices, 3));\r\n\t\t\tgeometry.setAttribute(\"uv\", new BufferAttribute(uvs, 2));\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgeometry.addAttribute(\"position\", new BufferAttribute(vertices, 3));\r\n\t\t\tgeometry.addAttribute(\"uv\", new BufferAttribute(uvs, 2));\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn geometry;\r\n\r\n}\r\n\r\n/**\r\n * An abstract pass.\r\n *\r\n * Passes that do not rely on the depth buffer should explicitly disable the\r\n * depth test and depth write flags of their fullscreen shader material.\r\n *\r\n * Fullscreen passes use a shared fullscreen triangle:\r\n * https://michaldrobot.com/2014/04/01/gcn-execution-patterns-in-full-screen-passes/\r\n *\r\n * @implements {Initializable}\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\r\n\r\nclass Pass {\r\n\r\n\t/**\r\n\t * Constructs a new pass.\r\n\t *\r\n\t * @param {String} [name] - The name of this pass. Does not have to be unique.\r\n\t * @param {Scene} [scene] - The scene to render. The default scene contains a single mesh that fills the screen.\r\n\t * @param {Camera} [camera] - A camera. Fullscreen effect passes don't require a camera.\r\n\t */\r\n\r\n\tconstructor(name = \"Pass\", scene = new Scene(), camera = dummyCamera) {\r\n\r\n\t\t/**\r\n\t\t * The name of this pass.\r\n\t\t *\r\n\t\t * @type {String}\r\n\t\t */\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\t/**\r\n\t\t * The scene to render.\r\n\t\t *\r\n\t\t * @type {Scene}\r\n\t\t * @protected\r\n\t\t */\r\n\r\n\t\tthis.scene = scene;\r\n\r\n\t\t/**\r\n\t\t * The camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @protected\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * A mesh that fills the screen.\r\n\t\t *\r\n\t\t * @type {Mesh}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.screen = null;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether this pass should render to texture.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.rtt = true;\r\n\r\n\t\t/**\r\n\t\t * Only relevant for subclassing.\r\n\t\t *\r\n\t\t * Indicates whether the {@link EffectComposer} should swap the frame\r\n\t\t * buffers after this pass has finished rendering.\r\n\t\t *\r\n\t\t * Set this to `false` if this pass doesn't render to the output buffer or\r\n\t\t * the screen. Otherwise, the contents of the input buffer will be lost.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.needsSwap = true;\r\n\r\n\t\t/**\r\n\t\t * Only relevant for subclassing.\r\n\t\t *\r\n\t\t * Indicates whether the {@link EffectComposer} should prepare a depth\r\n\t\t * texture for this pass.\r\n\t\t *\r\n\t\t * Set this to `true` if this pass relies on depth information from a\r\n\t\t * preceding {@link RenderPass}.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.needsDepthTexture = false;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether this pass should be executed.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.enabled = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether this pass should render to screen.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget renderToScreen() {\r\n\r\n\t\treturn !this.rtt;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render to screen flag.\r\n\t *\r\n\t * If the flag is changed to a different value, the fullscreen material will\r\n\t * be updated as well.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset renderToScreen(value) {\r\n\r\n\t\tif(this.rtt === value) {\r\n\r\n\t\t\tconst material = this.getFullscreenMaterial();\r\n\r\n\t\t\tif(material !== null) {\r\n\r\n\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.rtt = !value;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current fullscreen material.\r\n\t *\r\n\t * @return {Material} The current fullscreen material, or null if there is none.\r\n\t */\r\n\r\n\tgetFullscreenMaterial() {\r\n\r\n\t\treturn (this.screen !== null) ? this.screen.material : null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the fullscreen material.\r\n\t *\r\n\t * The material will be assigned to a mesh that fills the screen. The mesh\r\n\t * will be created once a material is assigned via this method.\r\n\t *\r\n\t * @protected\r\n\t * @param {Material} material - A fullscreen material.\r\n\t */\r\n\r\n\tsetFullscreenMaterial(material) {\r\n\r\n\t\tlet screen = this.screen;\r\n\r\n\t\tif(screen !== null) {\r\n\r\n\t\t\tscreen.material = material;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tscreen = new Mesh(getFullscreenTriangle(), material);\r\n\t\t\tscreen.frustumCulled = false;\r\n\r\n\t\t\tif(this.scene === null) {\r\n\r\n\t\t\t\tthis.scene = new Scene();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.scene.add(screen);\r\n\t\t\tthis.screen = screen;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current depth texture.\r\n\t *\r\n\t * @return {Texture} The current depth texture, or null if there is none.\r\n\t */\r\n\r\n\tgetDepthTexture() {\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * This method will be called automatically by the {@link EffectComposer}.\r\n\t *\r\n\t * You may override this method if your pass relies on the depth information\r\n\t * of a preceding {@link RenderPass}.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {}\r\n\r\n\t/**\r\n\t * Renders the effect.\r\n\t *\r\n\t * This is an abstract method that must be overridden.\r\n\t *\r\n\t * @abstract\r\n\t * @throws {Error} An error is thrown if the method is not overridden.\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tthrow new Error(\"Render method not implemented!\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this pass with the renderer's size.\r\n\t *\r\n\t * You may override this method in case you want to be informed about the size\r\n\t * of the main frame buffer.\r\n\t *\r\n\t * The {@link EffectComposer} calls this method before this pass is\r\n\t * initialized and every time its own size is updated.\r\n\t *\r\n\t * @param {Number} width - The renderer's width.\r\n\t * @param {Number} height - The renderer's height.\r\n\t * @example this.myRenderTarget.setSize(width, height);\r\n\t */\r\n\r\n\tsetSize(width, height) {}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * By overriding this method you gain access to the renderer. You'll also be\r\n\t * able to configure your custom render targets to use the appropriate format\r\n\t * (RGB or RGBA).\r\n\t *\r\n\t * The provided renderer can be used to warm up special off-screen render\r\n\t * targets by performing a preliminary render operation.\r\n\t *\r\n\t * The {@link EffectComposer} calls this method when this pass is added to its\r\n\t * queue, but not before its size has been set.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t * @example if(!alpha && frameBufferType === UnsignedByteType) { this.myRenderTarget.texture.format = RGBFormat; }\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {}\r\n\r\n\t/**\r\n\t * Performs a shallow search for disposable properties and deletes them. The\r\n\t * pass will be inoperative after this method was called!\r\n\t *\r\n\t * The {@link EffectComposer} calls this method when it is being destroyed.\r\n\t * You may, however, use it independently to free memory when you are certain\r\n\t * that you don't need this pass anymore.\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\r\n\t\tif(material !== null) {\r\n\r\n\t\t\tmaterial.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tfor(const key of Object.keys(this)) {\r\n\r\n\t\t\tconst property = this[key];\r\n\r\n\t\t\tif(property !== null && typeof property.dispose === \"function\") {\r\n\r\n\t\t\t\tif(property instanceof Scene) {\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/** @ignore */\r\n\t\t\t\tthis[key].dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * An efficient, incremental blur pass.\r\n */\r\n\r\nclass BlurPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new blur pass.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Number} [options.resolutionScale=0.5] - Deprecated. Adjust the height or width instead for consistent results.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The blur render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The blur render height.\r\n\t * @param {KernelSize} [options.kernelSize=KernelSize.LARGE] - The blur kernel size.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tresolutionScale = 0.5,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\tkernelSize = KernelSize.LARGE\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"BlurPass\");\r\n\r\n\t\t/**\r\n\t\t * A render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetA = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false\r\n\t\t});\r\n\r\n\t\tthis.renderTargetA.texture.name = \"Blur.Target.A\";\r\n\r\n\t\t/**\r\n\t\t * A second render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetB = this.renderTargetA.clone();\r\n\t\tthis.renderTargetB.texture.name = \"Blur.Target.B\";\r\n\r\n\t\t/**\r\n\t\t * The render resolution.\r\n\t\t *\r\n\t\t * It's recommended to set the height or the width to an absolute value for\r\n\t\t * consistent results across different devices and resolutions.\r\n\t\t *\r\n\t\t * @type {Resizer}\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Resizer(this, width, height, resolutionScale);\r\n\r\n\t\t/**\r\n\t\t * A convolution shader material.\r\n\t\t *\r\n\t\t * @type {ConvolutionMaterial}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.convolutionMaterial = new ConvolutionMaterial();\r\n\r\n\t\t/**\r\n\t\t * A convolution shader material that uses dithering.\r\n\t\t *\r\n\t\t * @type {ConvolutionMaterial}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.ditheredConvolutionMaterial = new ConvolutionMaterial();\r\n\t\tthis.ditheredConvolutionMaterial.dithering = true;\r\n\r\n\t\t/**\r\n\t\t * Whether the blurred result should also be dithered using noise.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t\t */\r\n\r\n\t\tthis.dithering = false;\r\n\r\n\t\tthis.kernelSize = kernelSize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current width of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.resolution.width;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render width.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tset width(value) {\r\n\r\n\t\tthis.resolution.width = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current height of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.resolution.height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render height.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tset height(value) {\r\n\r\n\t\tthis.resolution.height = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current blur scale.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget scale() {\r\n\r\n\t\treturn this.convolutionMaterial.uniforms.scale.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the blur scale.\r\n\t *\r\n\t * This value influences the overall blur strength and should not be greater\r\n\t * than 1. For larger blurs please increase the {@link kernelSize}!\r\n\t *\r\n\t * Note that the blur strength is closely tied to the resolution. For a smooth\r\n\t * transition from no blur to full blur, set the width or the height to a high\r\n\t * enough value.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset scale(value) {\r\n\r\n\t\tthis.convolutionMaterial.uniforms.scale.value = value;\r\n\t\tthis.ditheredConvolutionMaterial.uniforms.scale.value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t */\r\n\r\n\tget kernelSize() {\r\n\r\n\t\treturn this.convolutionMaterial.kernelSize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the kernel size.\r\n\t *\r\n\t * Larger kernels require more processing power but scale well with larger\r\n\t * render resolutions.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t */\r\n\r\n\tset kernelSize(value) {\r\n\r\n\t\tthis.convolutionMaterial.kernelSize = value;\r\n\t\tthis.ditheredConvolutionMaterial.kernelSize = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolution.scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolution.scale = scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Blurs the input buffer and writes the result to the output buffer. The\r\n\t * input buffer remains intact, unless it's also the output buffer.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst scene = this.scene;\r\n\t\tconst camera = this.camera;\r\n\r\n\t\tconst renderTargetA = this.renderTargetA;\r\n\t\tconst renderTargetB = this.renderTargetB;\r\n\r\n\t\tlet material = this.convolutionMaterial;\r\n\t\tlet uniforms = material.uniforms;\r\n\t\tconst kernel = material.getKernel();\r\n\r\n\t\tlet lastRT = inputBuffer;\r\n\t\tlet destRT;\r\n\t\tlet i, l;\r\n\r\n\t\tthis.setFullscreenMaterial(material);\r\n\r\n\t\t// Apply the multi-pass blur.\r\n\t\tfor(i = 0, l = kernel.length - 1; i < l; ++i) {\r\n\r\n\t\t\t// Alternate between targets.\r\n\t\t\tdestRT = ((i & 1) === 0) ? renderTargetA : renderTargetB;\r\n\r\n\t\t\tuniforms.kernel.value = kernel[i];\r\n\t\t\tuniforms.inputBuffer.value = lastRT.texture;\r\n\t\t\trenderer.setRenderTarget(destRT);\r\n\t\t\trenderer.render(scene, camera);\r\n\r\n\t\t\tlastRT = destRT;\r\n\r\n\t\t}\r\n\r\n\t\tif(this.dithering) {\r\n\r\n\t\t\tmaterial = this.ditheredConvolutionMaterial;\r\n\t\t\tuniforms = material.uniforms;\r\n\t\t\tthis.setFullscreenMaterial(material);\r\n\r\n\t\t}\r\n\r\n\t\tuniforms.kernel.value = kernel[i];\r\n\t\tuniforms.inputBuffer.value = lastRT.texture;\r\n\t\trenderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\r\n\t\trenderer.render(scene, camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\t\tresolution.base.set(width, height);\r\n\r\n\t\tconst w = resolution.width;\r\n\t\tconst h = resolution.height;\r\n\r\n\t\tthis.renderTargetA.setSize(w, h);\r\n\t\tthis.renderTargetB.setSize(w, h);\r\n\r\n\t\tthis.convolutionMaterial.setTexelSize(1.0 / w, 1.0 / h);\r\n\t\tthis.ditheredConvolutionMaterial.setTexelSize(1.0 / w, 1.0 / h);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTargetA.texture.format = RGBFormat;\r\n\t\t\tthis.renderTargetB.texture.format = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTargetA.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetB.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * An auto sizing flag.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use {@link Resizer.AUTO_SIZE} instead.\r\n\t */\r\n\r\n\tstatic get AUTO_SIZE() {\r\n\r\n\t\treturn Resizer.AUTO_SIZE;\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that disables the stencil test.\r\n */\r\n\r\nclass ClearMaskPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new clear mask pass.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper(\"ClearMaskPass\", null, null);\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Disables the global stencil test.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst stencil = renderer.state.buffers.stencil;\r\n\r\n\t\tstencil.setLocked(false);\r\n\t\tstencil.setTest(false);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * Stores the original clear color of the renderer.\r\n *\r\n * @type {Color}\r\n * @private\r\n */\r\n\r\nconst color = new Color();\r\n\r\n/**\r\n * A pass that clears the input buffer or the screen.\r\n */\r\n\r\nclass ClearPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new clear pass.\r\n\t *\r\n\t * @param {Boolean} [color=true] - Determines whether the color buffer should be cleared.\r\n\t * @param {Boolean} [depth=true] - Determines whether the depth buffer should be cleared.\r\n\t * @param {Boolean} [stencil=false] - Determines whether the stencil buffer should be cleared.\r\n\t */\r\n\r\n\tconstructor(color = true, depth = true, stencil = false) {\r\n\r\n\t\tsuper(\"ClearPass\", null, null);\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the color buffer should be cleared.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the depth buffer should be cleared.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.depth = depth;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the stencil buffer should be cleared.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.stencil = stencil;\r\n\r\n\t\t/**\r\n\t\t * An override clear color.\r\n\t\t *\r\n\t\t * The default value is null.\r\n\t\t *\r\n\t\t * @type {Color}\r\n\t\t */\r\n\r\n\t\tthis.overrideClearColor = null;\r\n\r\n\t\t/**\r\n\t\t * An override clear alpha.\r\n\t\t *\r\n\t\t * The default value is -1.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.overrideClearAlpha = -1.0;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the input buffer or the screen.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst overrideClearColor = this.overrideClearColor;\r\n\t\tconst overrideClearAlpha = this.overrideClearAlpha;\r\n\t\tconst clearAlpha = renderer.getClearAlpha();\r\n\r\n\t\tconst hasOverrideClearColor = (overrideClearColor !== null);\r\n\t\tconst hasOverrideClearAlpha = (overrideClearAlpha >= 0.0);\r\n\r\n\t\tif(hasOverrideClearColor) {\r\n\r\n\t\t\tcolor.copy(renderer.getClearColor());\r\n\t\t\trenderer.setClearColor(overrideClearColor, hasOverrideClearAlpha ?\r\n\t\t\t\toverrideClearAlpha : clearAlpha);\r\n\r\n\t\t} else if(hasOverrideClearAlpha) {\r\n\r\n\t\t\trenderer.setClearAlpha(overrideClearAlpha);\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setRenderTarget(this.renderToScreen ? null : inputBuffer);\r\n\t\trenderer.clear(this.color, this.depth, this.stencil);\r\n\r\n\t\tif(hasOverrideClearColor) {\r\n\r\n\t\t\trenderer.setClearColor(color, clearAlpha);\r\n\r\n\t\t} else if(hasOverrideClearAlpha) {\r\n\r\n\t\t\trenderer.setClearAlpha(clearAlpha);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A flag that indicates whether the override material workaround is enabled.\r\n *\r\n * @type {Boolean}\r\n * @private\r\n */\r\n\r\nlet workaroundEnabled = false;\r\n\r\n/**\r\n * An override material manager.\r\n *\r\n * Includes a workaround that fixes override materials for skinned meshes and\r\n * instancing. Doesn't fix uniforms such as normal maps and displacement maps.\r\n * Using the workaround may have a negative impact on performance if the scene\r\n * contains a lot of meshes.\r\n *\r\n * @implements {Disposable}\r\n */\r\n\r\nclass OverrideMaterialManager {\r\n\r\n\t/**\r\n\t * Constructs a new override material manager.\r\n\t *\r\n\t * @param {Material} [material=null] - An override material.\r\n\t */\r\n\r\n\tconstructor(material = null) {\r\n\r\n\t\t/**\r\n\t\t * Keeps track of original materials.\r\n\t\t *\r\n\t\t * @type {Map<Object3D, Material>}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.originalMaterials = new Map();\r\n\r\n\t\t/**\r\n\t\t * The override material.\r\n\t\t *\r\n\t\t * @type {Material}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.material = null;\r\n\r\n\t\t/**\r\n\t\t * A clone of the override material.\r\n\t\t *\r\n\t\t * @type {Material}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.materialInstanced = null;\r\n\r\n\t\t/**\r\n\t\t * A clone of the override material.\r\n\t\t *\r\n\t\t * @type {Material}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.materialSkinning = null;\r\n\r\n\t\tthis.setMaterial(material);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the override material.\r\n\t *\r\n\t * @param {Material} material - The material.\r\n\t */\r\n\r\n\tsetMaterial(material) {\r\n\r\n\t\tthis.disposeMaterials();\r\n\r\n\t\tif(material !== null) {\r\n\r\n\t\t\tthis.material = material;\r\n\r\n\t\t\tthis.materialInstanced = material.clone();\r\n\t\t\tthis.materialInstanced.uniforms = Object.assign({}, material.uniforms);\r\n\r\n\t\t\tthis.materialSkinning = material.clone();\r\n\t\t\tthis.materialSkinning.uniforms = Object.assign({}, material.uniforms);\r\n\t\t\tthis.materialSkinning.skinning = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the scene with the override material.\r\n\t *\r\n\t * @private\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Scene} scene - A scene.\r\n\t * @param {Camera} camera - A camera.\r\n\t */\r\n\r\n\trender(renderer, scene, camera) {\r\n\r\n\t\tconst material = this.material;\r\n\t\tconst materialSkinning = this.materialSkinning;\r\n\t\tconst materialInstanced = this.materialInstanced;\r\n\t\tconst originalMaterials = this.originalMaterials;\r\n\r\n\t\t// Ignore shadows.\r\n\t\tconst shadowMapEnabled = renderer.shadowMap.enabled;\r\n\t\trenderer.shadowMap.enabled = false;\r\n\r\n\t\tif(workaroundEnabled) {\r\n\r\n\t\t\tlet meshCount = 0;\r\n\r\n\t\t\t// Replace materials of all meshes with the correct override materials.\r\n\t\t\tscene.traverse((node) => {\r\n\r\n\t\t\t\tif(node.isMesh) {\r\n\r\n\t\t\t\t\toriginalMaterials.set(node, node.material);\r\n\r\n\t\t\t\t\tif(node.isInstancedMesh) {\r\n\r\n\t\t\t\t\t\tnode.material = materialInstanced;\r\n\r\n\t\t\t\t\t} else if(node.isSkinnedMesh) {\r\n\r\n\t\t\t\t\t\tnode.material = materialSkinning;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tnode.material = material;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t++meshCount;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\trenderer.render(scene, camera);\r\n\r\n\t\t\tfor(const entry of originalMaterials) {\r\n\r\n\t\t\t\tentry[0].material = entry[1];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif(meshCount !== originalMaterials.size) {\r\n\r\n\t\t\t\toriginalMaterials.clear();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst overrideMaterial = scene.overrideMaterial;\r\n\t\t\tscene.overrideMaterial = material;\r\n\t\t\trenderer.render(scene, camera);\r\n\t\t\tscene.overrideMaterial = overrideMaterial;\r\n\r\n\t\t}\r\n\r\n\t\trenderer.shadowMap.enabled = shadowMapEnabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes cloned override materials.\r\n\t *\r\n\t * @private\r\n\t */\r\n\r\n\tdisposeMaterials() {\r\n\r\n\t\tif(this.materialInstanced !== null) {\r\n\r\n\t\t\tthis.materialInstanced.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tif(this.materialSkinning !== null) {\r\n\r\n\t\t\tthis.materialSkinning.dispose();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs cleanup tasks.\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tthis.originalMaterials.clear();\r\n\t\tthis.disposeMaterials();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the override material workaround is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tstatic get workaroundEnabled() {\r\n\r\n\t\treturn workaroundEnabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables the override material workaround globally.\r\n\t *\r\n\t * This only affects post processing passes and effects.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tstatic set workaroundEnabled(value) {\r\n\r\n\t\tworkaroundEnabled = value;\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that renders a given scene into the input buffer or to screen.\r\n *\r\n * This pass uses a {@link ClearPass} to clear the target buffer.\r\n */\r\n\r\nclass RenderPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new render pass.\r\n\t *\r\n\t * @param {Scene} scene - The scene to render.\r\n\t * @param {Camera} camera - The camera to use to render the scene.\r\n\t * @param {Material} [overrideMaterial=null] - An override material.\r\n\t */\r\n\r\n\tconstructor(scene, camera, overrideMaterial = null) {\r\n\r\n\t\tsuper(\"RenderPass\", scene, camera);\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * A clear pass.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass();\r\n\r\n\t\t/**\r\n\t\t * An override material manager.\r\n\t\t *\r\n\t\t * @type {OverrideMaterialManager}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.overrideMaterialManager = (overrideMaterial === null) ? null :\r\n\t\t\tnew OverrideMaterialManager(overrideMaterial);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether this pass should render to screen.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget renderToScreen() {\r\n\r\n\t\treturn super.renderToScreen;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render to screen flag.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset renderToScreen(value) {\r\n\r\n\t\tsuper.renderToScreen = value;\r\n\t\tthis.clearPass.renderToScreen = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current override material.\r\n\t *\r\n\t * @type {Material}\r\n\t */\r\n\r\n\tget overrideMaterial() {\r\n\r\n\t\tconst manager = this.overrideMaterialManager;\r\n\r\n\t\treturn (manager !== null) ? manager.material : null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the override material.\r\n\t *\r\n\t * @type {Material}\r\n\t */\r\n\r\n\tset overrideMaterial(value) {\r\n\r\n\t\tconst manager = this.overrideMaterialManager;\r\n\r\n\t\tif(value !== null) {\r\n\r\n\t\t\tif(manager !== null) {\r\n\r\n\t\t\t\tmanager.setMaterial(value);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.overrideMaterialManager = new OverrideMaterialManager(value);\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if(manager !== null) {\r\n\r\n\t\t\tmanager.dispose();\r\n\t\t\tthis.overrideMaterialManager = null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the target buffer should be cleared before rendering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget clear() {\r\n\r\n\t\treturn this.clearPass.enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables auto clear.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset clear(value) {\r\n\r\n\t\tthis.clearPass.enabled = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the clear pass.\r\n\t *\r\n\t * @return {ClearPass} The clear pass.\r\n\t */\r\n\r\n\tgetClearPass() {\r\n\r\n\t\treturn this.clearPass;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the scene.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst scene = this.scene;\r\n\t\tconst camera = this.camera;\r\n\t\tconst background = scene.background;\r\n\t\tconst renderTarget = this.renderToScreen ? null : inputBuffer;\r\n\r\n\t\tif(this.clear) {\r\n\r\n\t\t\tif(this.clearPass.overrideClearColor !== null) {\r\n\r\n\t\t\t\t// This clear color is important! Ignore the scene background.\r\n\t\t\t\tscene.background = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.clearPass.render(renderer, inputBuffer);\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setRenderTarget(renderTarget);\r\n\r\n\t\tif(this.overrideMaterialManager !== null) {\r\n\r\n\t\t\tthis.overrideMaterialManager.render(renderer, scene, camera);\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.render(scene, camera);\r\n\r\n\t\t}\r\n\r\n\t\tif(scene.background !== background) {\r\n\r\n\t\t\t// Restore the background.\r\n\t\t\tscene.background = background;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that renders the depth of a given scene into a color buffer.\r\n */\r\n\r\nclass DepthPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new depth pass.\r\n\t *\r\n\t * @param {Scene} scene - The scene to render.\r\n\t * @param {Camera} camera - The camera to use to render the scene.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Number} [options.resolutionScale=1.0] - Deprecated. Adjust the height or width instead for consistent results.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t * @param {WebGLRenderTarget} [options.renderTarget] - A custom render target.\r\n\t */\r\n\r\n\tconstructor(scene, camera, {\r\n\t\tresolutionScale = 1.0,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\trenderTarget\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"DepthPass\");\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * A render pass.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderPass = new RenderPass(scene, camera, new MeshDepthMaterial({\r\n\t\t\tdepthPacking: RGBADepthPacking\r\n\t\t}));\r\n\r\n\t\tconst clearPass = this.renderPass.getClearPass();\r\n\t\tclearPass.overrideClearColor = new Color(0xffffff);\r\n\t\tclearPass.overrideClearAlpha = 1.0;\r\n\r\n\t\t/**\r\n\t\t * A render target that contains the scene depth.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = renderTarget;\r\n\r\n\t\tif(this.renderTarget === undefined) {\r\n\r\n\t\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\t\tminFilter: NearestFilter,\r\n\t\t\t\tmagFilter: NearestFilter,\r\n\t\t\t\tstencilBuffer: false\r\n\t\t\t});\r\n\r\n\t\t\tthis.renderTarget.texture.name = \"DepthPass.Target\";\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * The desired render resolution.\r\n\t\t *\r\n\t\t * Use {@link Resizer.AUTO_SIZE} for the width or height to automatically\r\n\t\t * calculate it based on its counterpart and the original aspect ratio.\r\n\t\t *\r\n\t\t * @type {Resizer}\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Resizer(this, width, height, resolutionScale);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The depth texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTarget.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolutionScale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolutionScale = scale;\r\n\t\tthis.setSize(this.resolution.base.x, this.resolution.base.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the scene depth.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst renderTarget = this.renderToScreen ? null : this.renderTarget;\r\n\t\tthis.renderPass.render(renderer, renderTarget);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\t\tresolution.base.set(width, height);\r\n\r\n\t\tthis.renderTarget.setSize(resolution.width, resolution.height);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that downsamples the scene depth by picking the most representative\r\n * depth in 2x2 texel neighborhoods. If a normal buffer is provided, the\r\n * corresponding normals will be stored as well.\r\n *\r\n * Attention: This pass requires WebGL 2.\r\n */\r\n\r\nclass DepthDownsamplingPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new depth downsampling pass.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Texture} [options.normalBuffer=null] - A texture that contains view space normals. See {@link NormalPass}.\r\n\t * @param {Number} [options.resolutionScale=0.5] - The resolution scale.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tnormalBuffer = null,\r\n\t\tresolutionScale = 0.5,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"DepthDownsamplingPass\");\r\n\r\n\t\tthis.setFullscreenMaterial(new DepthDownsamplingMaterial());\r\n\t\tthis.needsDepthTexture = true;\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\tif(normalBuffer !== null) {\r\n\r\n\t\t\tconst material = this.getFullscreenMaterial();\r\n\t\t\tmaterial.uniforms.normalBuffer.value = normalBuffer;\r\n\t\t\tmaterial.defines.DOWNSAMPLE_NORMALS = \"1\";\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * A render target that contains the downsampled normals and depth.\r\n\t\t *\r\n\t\t * Normals are stored as RGB and depth is stored as alpha.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: NearestFilter,\r\n\t\t\tmagFilter: NearestFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false,\r\n\t\t\ttype: FloatType\r\n\t\t});\r\n\r\n\t\tthis.renderTarget.texture.name = \"DepthDownsamplingPass.Target\";\r\n\t\tthis.renderTarget.texture.generateMipmaps = false;\r\n\r\n\t\t/**\r\n\t\t * The resolution of this effect.\r\n\t\t *\r\n\t\t * @type {Resizer}\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Resizer(this, width, height);\r\n\t\tthis.resolution.scale = resolutionScale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The normal(RGB) + depth(A) texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTarget.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\t\tmaterial.uniforms.depthBuffer.value = depthTexture;\r\n\t\tmaterial.depthPacking = depthPacking;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Downsamples depth and scene normals.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\trenderer.setRenderTarget(this.renderToScreen ? null : this.renderTarget);\r\n\t\trenderer.render(this.scene, this.camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\t\tresolution.base.set(width, height);\r\n\r\n\t\t// Use the full resolution to calculate the depth/normal buffer texel size.\r\n\t\tthis.getFullscreenMaterial().setTexelSize(1.0 / width, 1.0 / height);\r\n\r\n\t\tthis.renderTarget.setSize(resolution.width, resolution.height);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tif(!renderer.capabilities.isWebGL2) {\r\n\r\n\t\t\tconsole.error(\"The DepthDownsamplingPass requires WebGL 2\");\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A blend function enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} SKIP - No blending. The effect will not be included in the final shader.\r\n * @property {Number} ADD - Additive blending. Fast, but may produce washed out results.\r\n * @property {Number} ALPHA - Alpha blending. Blends based on the alpha value of the new color.\r\n * @property {Number} AVERAGE - Average blending.\r\n * @property {Number} COLOR_BURN - Color burn.\r\n * @property {Number} COLOR_DODGE - Color dodge.\r\n * @property {Number} DARKEN - Prioritize darker colors.\r\n * @property {Number} DIFFERENCE - Color difference.\r\n * @property {Number} EXCLUSION - Color exclusion.\r\n * @property {Number} LIGHTEN - Prioritize lighter colors.\r\n * @property {Number} MULTIPLY - Color multiplication.\r\n * @property {Number} DIVIDE - Color division.\r\n * @property {Number} NEGATION - Color negation.\r\n * @property {Number} NORMAL - Normal blending. The new color overwrites the old one.\r\n * @property {Number} OVERLAY - Color overlay.\r\n * @property {Number} REFLECT - Color reflection.\r\n * @property {Number} SCREEN - Screen blending. The two colors are effectively projected on a white screen simultaneously.\r\n * @property {Number} SOFT_LIGHT - Soft light blending.\r\n * @property {Number} SUBTRACT - Color subtraction.\r\n */\r\n\r\nconst BlendFunction = {\r\n\r\n\tSKIP: 0,\r\n\tADD: 1,\r\n\tALPHA: 2,\r\n\tAVERAGE: 3,\r\n\tCOLOR_BURN: 4,\r\n\tCOLOR_DODGE: 5,\r\n\tDARKEN: 6,\r\n\tDIFFERENCE: 7,\r\n\tEXCLUSION: 8,\r\n\tLIGHTEN: 9,\r\n\tMULTIPLY: 10,\r\n\tDIVIDE: 11,\r\n\tNEGATION: 12,\r\n\tNORMAL: 13,\r\n\tOVERLAY: 14,\r\n\tREFLECT: 15,\r\n\tSCREEN: 16,\r\n\tSOFT_LIGHT: 17,\r\n\tSUBTRACT: 18\r\n\r\n};\n\nvar addBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}\";\n\nvar alphaBlendFunction = \"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}\";\n\nvar averageBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}\";\n\nvar colorBurnBlendFunction = \"float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar colorDodgeBlendFunction = \"float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar darkenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}\";\n\nvar differenceBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}\";\n\nvar exclusionBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}\";\n\nvar lightenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}\";\n\nvar multiplyBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}\";\n\nvar divideBlendFunction = \"float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar negationBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}\";\n\nvar normalBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}\";\n\nvar overlayBlendFunction = \"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar reflectBlendFunction = \"float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar screenBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}\";\n\nvar softLightBlendFunction = \"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}\";\n\nvar subtractBlendFunction = \"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}\";\n\n/**\r\n * A blend function shader code catalogue.\r\n *\r\n * @type {Map<BlendFunction, String>}\r\n * @private\r\n */\r\n\r\nconst blendFunctions = new Map([\r\n\t[BlendFunction.SKIP, null],\r\n\t[BlendFunction.ADD, addBlendFunction],\r\n\t[BlendFunction.ALPHA, alphaBlendFunction],\r\n\t[BlendFunction.AVERAGE, averageBlendFunction],\r\n\t[BlendFunction.COLOR_BURN, colorBurnBlendFunction],\r\n\t[BlendFunction.COLOR_DODGE, colorDodgeBlendFunction],\r\n\t[BlendFunction.DARKEN, darkenBlendFunction],\r\n\t[BlendFunction.DIFFERENCE, differenceBlendFunction],\r\n\t[BlendFunction.EXCLUSION, exclusionBlendFunction],\r\n\t[BlendFunction.LIGHTEN, lightenBlendFunction],\r\n\t[BlendFunction.MULTIPLY, multiplyBlendFunction],\r\n\t[BlendFunction.DIVIDE, divideBlendFunction],\r\n\t[BlendFunction.NEGATION, negationBlendFunction],\r\n\t[BlendFunction.NORMAL, normalBlendFunction],\r\n\t[BlendFunction.OVERLAY, overlayBlendFunction],\r\n\t[BlendFunction.REFLECT, reflectBlendFunction],\r\n\t[BlendFunction.SCREEN, screenBlendFunction],\r\n\t[BlendFunction.SOFT_LIGHT, softLightBlendFunction],\r\n\t[BlendFunction.SUBTRACT, subtractBlendFunction]\r\n]);\r\n\r\n/**\r\n * A blend mode.\r\n */\r\n\r\nclass BlendMode extends EventDispatcher {\r\n\r\n\t/**\r\n\t * Constructs a new blend mode.\r\n\t *\r\n\t * @param {BlendFunction} blendFunction - The blend function to use.\r\n\t * @param {Number} opacity - The opacity of the color that will be blended with the base color.\r\n\t */\r\n\r\n\tconstructor(blendFunction, opacity = 1.0) {\r\n\r\n\t\tsuper();\r\n\r\n\t\t/**\r\n\t\t * The blend function.\r\n\t\t *\r\n\t\t * @type {BlendFunction}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.blendFunction = blendFunction;\r\n\r\n\t\t/**\r\n\t\t * The opacity of the color that will be blended with the base color.\r\n\t\t *\r\n\t\t * @type {Uniform}\r\n\t\t */\r\n\r\n\t\tthis.opacity = new Uniform(opacity);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the blend function.\r\n\t *\r\n\t * @return {BlendFunction} The blend function.\r\n\t */\r\n\r\n\tgetBlendFunction() {\r\n\r\n\t\treturn this.blendFunction;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the blend function.\r\n\t *\r\n\t * @param {BlendFunction} blendFunction - The blend function.\r\n\t */\r\n\r\n\tsetBlendFunction(blendFunction) {\r\n\r\n\t\tthis.blendFunction = blendFunction;\r\n\t\tthis.dispatchEvent({ type: \"change\" });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the blend function shader code.\r\n\t *\r\n\t * @return {String} The blend function shader code.\r\n\t */\r\n\r\n\tgetShaderCode() {\r\n\r\n\t\treturn blendFunctions.get(this.blendFunction);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * An abstract effect.\r\n *\r\n * Effects can be combined using the {@link EffectPass}.\r\n *\r\n * @implements {Initializable}\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\r\n\r\nclass Effect extends EventDispatcher {\r\n\r\n\t/**\r\n\t * Constructs a new effect.\r\n\t *\r\n\t * @param {String} name - The name of this effect. Doesn't have to be unique.\r\n\t * @param {String} fragmentShader - The fragment shader. This shader is required.\r\n\t * @param {Object} [options] - Additional options.\r\n\t * @param {EffectAttribute} [options.attributes=EffectAttribute.NONE] - The effect attributes that determine the execution priority and resource requirements.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n\t * @param {Map<String, String>} [options.defines] - Custom preprocessor macro definitions. Keys are names and values are code.\r\n\t * @param {Map<String, Uniform>} [options.uniforms] - Custom shader uniforms. Keys are names and values are uniforms.\r\n\t * @param {Set<WebGLExtension>} [options.extensions] - WebGL extensions.\r\n\t * @param {String} [options.vertexShader=null] - The vertex shader. Most effects don't need one.\r\n\t */\r\n\r\n\tconstructor(name, fragmentShader, {\r\n\t\tattributes = EffectAttribute.NONE,\r\n\t\tblendFunction = BlendFunction.SCREEN,\r\n\t\tdefines = new Map(),\r\n\t\tuniforms = new Map(),\r\n\t\textensions = null,\r\n\t\tvertexShader = null\r\n\t} = {}) {\r\n\r\n\t\tsuper();\r\n\r\n\t\t/**\r\n\t\t * The name of this effect.\r\n\t\t *\r\n\t\t * @type {String}\r\n\t\t */\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\t/**\r\n\t\t * The effect attributes.\r\n\t\t *\r\n\t\t * @type {EffectAttribute}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.attributes = attributes;\r\n\r\n\t\t/**\r\n\t\t * The fragment shader.\r\n\t\t *\r\n\t\t * @type {String}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.fragmentShader = fragmentShader;\r\n\r\n\t\t/**\r\n\t\t * The vertex shader.\r\n\t\t *\r\n\t\t * @type {String}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.vertexShader = vertexShader;\r\n\r\n\t\t/**\r\n\t\t * Preprocessor macro definitions.\r\n\t\t *\r\n\t\t * Call {@link Effect.setChanged} after changing macro definitions.\r\n\t\t *\r\n\t\t * @type {Map<String, String>}\r\n\t\t */\r\n\r\n\t\tthis.defines = defines;\r\n\r\n\t\t/**\r\n\t\t * Shader uniforms.\r\n\t\t *\r\n\t\t * You may freely modify the values of these uniforms at runtime. However,\r\n\t\t * uniforms should not be removed or added after the effect was created.\r\n\t\t *\r\n\t\t * Call {@link Effect.setChanged} after adding or removing uniforms.\r\n\t\t *\r\n\t\t * @type {Map<String, Uniform>}\r\n\t\t */\r\n\r\n\t\tthis.uniforms = uniforms;\r\n\r\n\t\t/**\r\n\t\t * WebGL extensions that are required by this effect.\r\n\t\t *\r\n\t\t * Call {@link Effect.setChanged} after adding or removing extensions.\r\n\t\t *\r\n\t\t * @type {Set<WebGLExtension>}\r\n\t\t */\r\n\r\n\t\tthis.extensions = extensions;\r\n\r\n\t\t/**\r\n\t\t * The blend mode of this effect.\r\n\t\t *\r\n\t\t * The result of this effect will be blended with the result of the previous\r\n\t\t * effect using this blend mode.\r\n\t\t *\r\n\t\t * @type {BlendMode}\r\n\t\t */\r\n\r\n\t\tthis.blendMode = new BlendMode(blendFunction);\r\n\t\tthis.blendMode.addEventListener(\"change\", (event) => this.setChanged());\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Informs the associated {@link EffectPass} that this effect has changed in\r\n\t * a way that requires a shader recompilation.\r\n\t *\r\n\t * Call this method after changing macro definitions or extensions and after\r\n\t * adding or removing uniforms.\r\n\t *\r\n\t * @protected\r\n\t */\r\n\r\n\tsetChanged() {\r\n\r\n\t\tthis.dispatchEvent({ type: \"change\" });\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the effect attributes.\r\n\t *\r\n\t * @return {EffectAttribute} The attributes.\r\n\t */\r\n\r\n\tgetAttributes() {\r\n\r\n\t\treturn this.attributes;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the effect attributes.\r\n\t *\r\n\t * Effects that have the same attributes will be executed in the order in\r\n\t * which they were registered. Some attributes imply a higher priority.\r\n\t *\r\n\t * @protected\r\n\t * @param {EffectAttribute} attributes - The attributes.\r\n\t */\r\n\r\n\tsetAttributes(attributes) {\r\n\r\n\t\tthis.attributes = attributes;\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the fragment shader.\r\n\t *\r\n\t * @return {String} The fragment shader.\r\n\t */\r\n\r\n\tgetFragmentShader() {\r\n\r\n\t\treturn this.fragmentShader;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the fragment shader.\r\n\t *\r\n\t * @protected\r\n\t * @param {String} fragmentShader - The fragment shader.\r\n\t */\r\n\r\n\tsetFragmentShader(fragmentShader) {\r\n\r\n\t\tthis.fragmentShader = fragmentShader;\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the vertex shader.\r\n\t *\r\n\t * @return {String} The vertex shader.\r\n\t */\r\n\r\n\tgetVertexShader() {\r\n\r\n\t\treturn this.vertexShader;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the vertex shader.\r\n\t *\r\n\t * @protected\r\n\t * @param {String} vertexShader - The vertex shader.\r\n\t */\r\n\r\n\tsetVertexShader(vertexShader) {\r\n\r\n\t\tthis.vertexShader = vertexShader;\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * You may override this method if your effect requires direct access to the\r\n\t * depth texture that is bound to the associated {@link EffectPass}.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {}\r\n\r\n\t/**\r\n\t * Updates the effect by performing supporting operations.\r\n\t *\r\n\t * This method is called by the {@link EffectPass} right before the main\r\n\t * fullscreen render operation, even if the blend function is set to `SKIP`.\r\n\t *\r\n\t * You may override this method if you need to render additional off-screen\r\n\t * textures or update custom uniforms.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {}\r\n\r\n\t/**\r\n\t * Updates the size of this effect.\r\n\t *\r\n\t * You may override this method in case you want to be informed about the main\r\n\t * render size.\r\n\t *\r\n\t * The {@link EffectPass} calls this method before this effect is initialized\r\n\t * and every time its own size is updated.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t * @example this.myRenderTarget.setSize(width, height);\r\n\t */\r\n\r\n\tsetSize(width, height) {}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * By overriding this method you gain access to the renderer. You'll also be\r\n\t * able to configure your custom render targets to use the appropriate format\r\n\t * (RGB or RGBA).\r\n\t *\r\n\t * The provided renderer can be used to warm up special off-screen render\r\n\t * targets by performing a preliminary render operation.\r\n\t *\r\n\t * The {@link EffectPass} calls this method during its own initialization\r\n\t * which happens after the size has been set.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t * @example if(!alpha && frameBufferType === UnsignedByteType) { this.myRenderTarget.texture.format = RGBFormat; }\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {}\r\n\r\n\t/**\r\n\t * Performs a shallow search for properties that define a dispose method and\r\n\t * deletes them. The effect will be inoperative after this method was called!\r\n\t *\r\n\t * The {@link EffectPass} calls this method when it is being destroyed. Do not\r\n\t * call this method directly.\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tfor(const key of Object.keys(this)) {\r\n\r\n\t\t\tconst property = this[key];\r\n\r\n\t\t\tif(property !== null && typeof property.dispose === \"function\") {\r\n\r\n\t\t\t\tif(property instanceof Scene) {\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/** @ignore */\r\n\t\t\t\tthis[key].dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An enumeration of effect attributes.\r\n *\r\n * Attributes can be concatenated using the bitwise OR operator.\r\n *\r\n * @type {Object}\r\n * @property {Number} NONE - No attributes. Most effects don't need to specify any attributes.\r\n * @property {Number} DEPTH - Describes effects that require a depth texture.\r\n * @property {Number} CONVOLUTION - Describes effects that fetch additional samples from the input buffer. There cannot be more than one effect with this attribute per {@link EffectPass}.\r\n * @example const attributes = EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH;\r\n */\r\n\r\nconst EffectAttribute = {\r\n\r\n\tNONE: 0,\r\n\tDEPTH: 1,\r\n\tCONVOLUTION: 2\r\n\r\n};\r\n\r\n/**\r\n * An enumeration of WebGL extensions.\r\n *\r\n * @type {Object}\r\n * @property {String} DERIVATIVES - Enables derivatives by adding the functions dFdx, dFdy and fwidth.\r\n * @property {String} FRAG_DEPTH - Enables gl_FragDepthEXT to set a depth value of a fragment from within the fragment shader.\r\n * @property {String} DRAW_BUFFERS - Enables multiple render targets (MRT) support.\r\n * @property {String} SHADER_TEXTURE_LOD - Enables explicit control of texture LOD.\r\n */\r\n\r\nconst WebGLExtension = {\r\n\r\n\tDERIVATIVES: \"derivatives\",\r\n\tFRAG_DEPTH: \"fragDepth\",\r\n\tDRAW_BUFFERS: \"drawBuffers\",\r\n\tSHADER_TEXTURE_LOD: \"shaderTextureLOD\"\r\n\r\n};\n\n/**\r\n * Finds and collects substrings that match the given regular expression.\r\n *\r\n * @private\r\n * @param {RegExp} regExp - A regular expression.\r\n * @param {String} string - A string.\r\n * @return {String[]} The matching substrings.\r\n */\r\n\r\nfunction findSubstrings(regExp, string) {\r\n\r\n\tconst substrings = [];\r\n\tlet result;\r\n\r\n\twhile((result = regExp.exec(string)) !== null) {\r\n\r\n\t\tsubstrings.push(result[1]);\r\n\r\n\t}\r\n\r\n\treturn substrings;\r\n\r\n}\r\n\r\n/**\r\n * Prefixes substrings within the given strings.\r\n *\r\n * @private\r\n * @param {String} prefix - A prefix.\r\n * @param {String[]} substrings - The substrings.\r\n * @param {Map<String, String>} strings - A collection of named strings.\r\n */\r\n\r\nfunction prefixSubstrings(prefix, substrings, strings) {\r\n\r\n\tlet prefixed, regExp;\r\n\r\n\tfor(const substring of substrings) {\r\n\r\n\t\tprefixed = \"$1\" + prefix + substring.charAt(0).toUpperCase() + substring.slice(1);\r\n\t\tregExp = new RegExp(\"([^\\\\.])(\\\\b\" + substring + \"\\\\b)\", \"g\");\r\n\r\n\t\tfor(const entry of strings.entries()) {\r\n\r\n\t\t\tif(entry[1] !== null) {\r\n\r\n\t\t\t\tstrings.set(entry[0], entry[1].replace(regExp, prefixed));\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Integrates the given effect.\r\n *\r\n * @private\r\n * @param {String} prefix - A prefix.\r\n * @param {Effect} effect - An effect.\r\n * @param {Map<String, String>} shaderParts - The shader parts.\r\n * @param {Map<BlendFunction, BlendMode>} blendModes - The blend modes.\r\n * @param {Map<String, String>} defines - The macro definitions.\r\n * @param {Map<String, Uniform>} uniforms - The uniforms.\r\n * @param {EffectAttribute} attributes - The global, collective attributes.\r\n * @return {Object} The results.\r\n * @property {String[]} varyings - The varyings used by the given effect.\r\n * @property {Boolean} transformedUv - Indicates whether the effect transforms UV coordinates in the fragment shader.\r\n * @property {Boolean} readDepth - Indicates whether the effect actually uses depth in the fragment shader.\r\n */\r\n\r\nfunction integrateEffect(prefix, effect, shaderParts, blendModes, defines, uniforms, attributes) {\r\n\r\n\tconst functionRegExp = /(?:\\w+\\s+(\\w+)\\([\\w\\s,]*\\)\\s*{[^}]+})/g;\r\n\tconst varyingRegExp = /(?:varying\\s+\\w+\\s+(\\w*))/g;\r\n\r\n\tconst blendMode = effect.blendMode;\r\n\tconst shaders = new Map([\r\n\t\t[\"fragment\", effect.getFragmentShader()],\r\n\t\t[\"vertex\", effect.getVertexShader()]\r\n\t]);\r\n\r\n\tconst mainImageExists = (shaders.get(\"fragment\") !== undefined && shaders.get(\"fragment\").indexOf(\"mainImage\") >= 0);\r\n\tconst mainUvExists = (shaders.get(\"fragment\") !== undefined && shaders.get(\"fragment\").indexOf(\"mainUv\") >= 0);\r\n\r\n\tlet varyings = [], names = [];\r\n\tlet transformedUv = false;\r\n\tlet readDepth = false;\r\n\r\n\tif(shaders.get(\"fragment\") === undefined) {\r\n\r\n\t\tconsole.error(\"Missing fragment shader\", effect);\r\n\r\n\t} else if(mainUvExists && (attributes & EffectAttribute.CONVOLUTION) !== 0) {\r\n\r\n\t\tconsole.error(\"Effects that transform UV coordinates are incompatible with convolution effects\", effect);\r\n\r\n\t} else if(!mainImageExists && !mainUvExists) {\r\n\r\n\t\tconsole.error(\"The fragment shader contains neither a mainImage nor a mainUv function\", effect);\r\n\r\n\t} else {\r\n\r\n\t\tif(mainUvExists) {\r\n\r\n\t\t\tshaderParts.set(Section.FRAGMENT_MAIN_UV, shaderParts.get(Section.FRAGMENT_MAIN_UV) +\r\n\t\t\t\t\"\\t\" + prefix + \"MainUv(UV);\\n\");\r\n\r\n\t\t\ttransformedUv = true;\r\n\r\n\t\t}\r\n\r\n\t\tif(shaders.get(\"vertex\") !== null && shaders.get(\"vertex\").indexOf(\"mainSupport\") >= 0) {\r\n\r\n\t\t\tlet string = \"\\t\" + prefix + \"MainSupport(\";\r\n\r\n\t\t\t// Check if the vertex shader expects uv coordinates.\r\n\t\t\tif(shaders.get(\"vertex\").indexOf(\"uv\") >= 0) {\r\n\r\n\t\t\t\tstring += \"vUv\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstring += \");\\n\";\r\n\r\n\t\t\tshaderParts.set(Section.VERTEX_MAIN_SUPPORT,\r\n\t\t\t\tshaderParts.get(Section.VERTEX_MAIN_SUPPORT) + string);\r\n\r\n\t\t\tvaryings = varyings.concat(findSubstrings(varyingRegExp, shaders.get(\"vertex\")));\r\n\t\t\tnames = names.concat(varyings).concat(findSubstrings(functionRegExp, shaders.get(\"vertex\")));\r\n\r\n\t\t}\r\n\r\n\t\t// Assemble all names while ignoring parameters of function-like macros.\r\n\t\tnames = names.concat(findSubstrings(functionRegExp, shaders.get(\"fragment\")))\r\n\t\t\t.concat(Array.from(effect.defines.keys()).map((s) => s.replace(/\\([\\w\\s,]*\\)/g, \"\")))\r\n\t\t\t.concat(Array.from(effect.uniforms.keys()));\r\n\r\n\t\t// Store prefixed uniforms and macros.\r\n\t\teffect.uniforms.forEach((value, key) => uniforms.set(prefix + key.charAt(0).toUpperCase() + key.slice(1), value));\r\n\t\teffect.defines.forEach((value, key) => defines.set(prefix + key.charAt(0).toUpperCase() + key.slice(1), value));\r\n\r\n\t\t// Prefix varyings, functions, uniforms and macros.\r\n\t\tprefixSubstrings(prefix, names, defines);\r\n\t\tprefixSubstrings(prefix, names, shaders);\r\n\r\n\t\t// Collect unique blend modes.\r\n\t\tblendModes.set(blendMode.blendFunction, blendMode);\r\n\r\n\t\tif(mainImageExists) {\r\n\r\n\t\t\tlet string = prefix + \"MainImage(color0, UV, \";\r\n\r\n\t\t\t// The effect may sample depth in a different shader.\r\n\t\t\tif((attributes & EffectAttribute.DEPTH) !== 0 && shaders.get(\"fragment\").indexOf(\"depth\") >= 0) {\r\n\r\n\t\t\t\tstring += \"depth, \";\r\n\t\t\t\treadDepth = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstring += \"color1);\\n\\t\";\r\n\r\n\t\t\t// Include the blend opacity uniform of this effect.\r\n\t\t\tconst blendOpacity = prefix + \"BlendOpacity\";\r\n\t\t\tuniforms.set(blendOpacity, blendMode.opacity);\r\n\r\n\t\t\t// Blend the result of this effect with the input color.\r\n\t\t\tstring += \"color0 = blend\" + blendMode.getBlendFunction() +\r\n\t\t\t\t\"(color0, color1, \" + blendOpacity + \");\\n\\n\\t\";\r\n\r\n\t\t\tshaderParts.set(Section.FRAGMENT_MAIN_IMAGE,\r\n\t\t\t\tshaderParts.get(Section.FRAGMENT_MAIN_IMAGE) + string);\r\n\r\n\t\t\tshaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) +\r\n\t\t\t\t\"uniform float \" + blendOpacity + \";\\n\\n\");\r\n\r\n\t\t}\r\n\r\n\t\t// Include the modified code in the final shader.\r\n\t\tshaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) +\r\n\t\t\tshaders.get(\"fragment\") + \"\\n\");\r\n\r\n\t\tif(shaders.get(\"vertex\") !== null) {\r\n\r\n\t\t\tshaderParts.set(Section.VERTEX_HEAD, shaderParts.get(Section.VERTEX_HEAD) +\r\n\t\t\t\tshaders.get(\"vertex\") + \"\\n\");\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn { varyings, transformedUv, readDepth };\r\n\r\n}\r\n\r\n/**\r\n * An effect pass.\r\n *\r\n * Use this pass to combine {@link Effect} instances.\r\n *\r\n * @implements {EventListener}\r\n */\r\n\r\nclass EffectPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new effect pass.\r\n\t *\r\n\t * The provided effects will be organized and merged for optimal performance.\r\n\t *\r\n\t * @param {Camera} camera - The main camera. The camera's type and settings will be available to all effects.\r\n\t * @param {...Effect} effects - The effects that will be rendered by this pass.\r\n\t */\r\n\r\n\tconstructor(camera, ...effects) {\r\n\r\n\t\tsuper(\"EffectPass\");\r\n\r\n\t\tthis.setFullscreenMaterial(new EffectMaterial(null, null, null, camera));\r\n\r\n\t\t/**\r\n\t\t * The effects, sorted by attribute priority, DESC.\r\n\t\t *\r\n\t\t * @type {Effect[]}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.effects = effects.sort((a, b) => (b.attributes - a.attributes));\r\n\r\n\t\t/**\r\n\t\t * Indicates whether this pass should skip rendering.\r\n\t\t *\r\n\t\t * Effects will still be updated, even if this flag is true.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.skipRendering = false;\r\n\r\n\t\t/**\r\n\t\t * The amount of shader uniforms that this pass uses.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.uniforms = 0;\r\n\r\n\t\t/**\r\n\t\t * The amount of shader varyings that this pass uses.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.varyings = 0;\r\n\r\n\t\t/**\r\n\t\t * A time offset.\r\n\t\t *\r\n\t\t * Elapsed time will start at this value.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.minTime = 1.0;\r\n\r\n\t\t/**\r\n\t\t * The maximum time.\r\n\t\t *\r\n\t\t * If the elapsed time exceeds this value, it will be reset.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.maxTime = Number.POSITIVE_INFINITY;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether this pass encodes its output when rendering to screen.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget encodeOutput() {\r\n\r\n\t\treturn (this.getFullscreenMaterial().defines.ENCODE_OUTPUT !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables output encoding.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset encodeOutput(value) {\r\n\r\n\t\tif(this.encodeOutput !== value) {\r\n\r\n\t\t\tconst material = this.getFullscreenMaterial();\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tmaterial.defines.ENCODE_OUTPUT = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete material.defines.ENCODE_OUTPUT;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether dithering is enabled.\r\n\t *\r\n\t * Color quantization reduces banding artifacts but degrades performance.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget dithering() {\r\n\r\n\t\treturn this.getFullscreenMaterial().dithering;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables dithering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset dithering(value) {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\r\n\t\tif(material.dithering !== value) {\r\n\r\n\t\t\tmaterial.dithering = value;\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Compares required resources with device capabilities.\r\n\t *\r\n\t * @private\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t */\r\n\r\n\tverifyResources(renderer) {\r\n\r\n\t\tconst capabilities = renderer.capabilities;\r\n\t\tlet max = Math.min(capabilities.maxFragmentUniforms, capabilities.maxVertexUniforms);\r\n\r\n\t\tif(this.uniforms > max) {\r\n\r\n\t\t\tconsole.warn(\"The current rendering context doesn't support more than \" +\r\n\t\t\t\tmax + \" uniforms, but \" + this.uniforms + \" were defined\");\r\n\r\n\t\t}\r\n\r\n\t\tmax = capabilities.maxVaryings;\r\n\r\n\t\tif(this.varyings > max) {\r\n\r\n\t\t\tconsole.warn(\"The current rendering context doesn't support more than \" +\r\n\t\t\t\tmax + \" varyings, but \" + this.varyings + \" were defined\");\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the compound shader material.\r\n\t *\r\n\t * @private\r\n\t */\r\n\r\n\tupdateMaterial() {\r\n\r\n\t\tconst blendRegExp = /\\bblend\\b/g;\r\n\r\n\t\tconst shaderParts = new Map([\r\n\t\t\t[Section.FRAGMENT_HEAD, \"\"],\r\n\t\t\t[Section.FRAGMENT_MAIN_UV, \"\"],\r\n\t\t\t[Section.FRAGMENT_MAIN_IMAGE, \"\"],\r\n\t\t\t[Section.VERTEX_HEAD, \"\"],\r\n\t\t\t[Section.VERTEX_MAIN_SUPPORT, \"\"]\r\n\t\t]);\r\n\r\n\t\tconst blendModes = new Map();\r\n\t\tconst defines = new Map();\r\n\t\tconst uniforms = new Map();\r\n\t\tconst extensions = new Set();\r\n\r\n\t\tlet id = 0, varyings = 0, attributes = 0;\r\n\t\tlet transformedUv = false;\r\n\t\tlet readDepth = false;\r\n\t\tlet result;\r\n\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\tif(effect.blendMode.getBlendFunction() === BlendFunction.SKIP) {\r\n\r\n\t\t\t\t// Check if this effect relies on depth and then continue.\r\n\t\t\t\tattributes |= (effect.getAttributes() & EffectAttribute.DEPTH);\r\n\r\n\t\t\t} else if((attributes & EffectAttribute.CONVOLUTION) !== 0 &&\r\n\t\t\t\t(effect.getAttributes() & EffectAttribute.CONVOLUTION) !== 0) {\r\n\r\n\t\t\t\tconsole.error(\"Convolution effects cannot be merged\", effect);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tattributes |= effect.getAttributes();\r\n\r\n\t\t\t\tresult = integrateEffect((\"e\" + id++), effect, shaderParts, blendModes, defines, uniforms, attributes);\r\n\r\n\t\t\t\tvaryings += result.varyings.length;\r\n\t\t\t\ttransformedUv = transformedUv || result.transformedUv;\r\n\t\t\t\treadDepth = readDepth || result.readDepth;\r\n\r\n\t\t\t\tif(effect.extensions !== null) {\r\n\r\n\t\t\t\t\t// Collect the WebGL extensions that are required by this effect.\r\n\t\t\t\t\tfor(const extension of effect.extensions) {\r\n\r\n\t\t\t\t\t\textensions.add(extension);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Integrate the relevant blend functions.\r\n\t\tfor(const blendMode of blendModes.values()) {\r\n\r\n\t\t\tshaderParts.set(Section.FRAGMENT_HEAD, shaderParts.get(Section.FRAGMENT_HEAD) +\r\n\t\t\t\tblendMode.getShaderCode().replace(blendRegExp, \"blend\" + blendMode.getBlendFunction()) + \"\\n\");\r\n\r\n\t\t}\r\n\r\n\t\t// Check if any effect relies on depth.\r\n\t\tif((attributes & EffectAttribute.DEPTH) !== 0) {\r\n\r\n\t\t\t// Only read depth if any effect actually uses this information.\r\n\t\t\tif(readDepth) {\r\n\r\n\t\t\t\tshaderParts.set(Section.FRAGMENT_MAIN_IMAGE, \"float depth = readDepth(UV);\\n\\n\\t\" +\r\n\t\t\t\t\tshaderParts.get(Section.FRAGMENT_MAIN_IMAGE));\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Only request a depth texture if none has been provided yet.\r\n\t\t\tthis.needsDepthTexture = (this.getDepthTexture() === null);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.needsDepthTexture = false;\r\n\r\n\t\t}\r\n\r\n\t\t// Check if any effect transforms UVs in the fragment shader.\r\n\t\tif(transformedUv) {\r\n\r\n\t\t\tshaderParts.set(Section.FRAGMENT_MAIN_UV, \"vec2 transformedUv = vUv;\\n\" +\r\n\t\t\t\tshaderParts.get(Section.FRAGMENT_MAIN_UV));\r\n\r\n\t\t\tdefines.set(\"UV\", \"transformedUv\");\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdefines.set(\"UV\", \"vUv\");\r\n\r\n\t\t}\r\n\r\n\t\t// Ensure that leading preprocessor directives start at a new line.\r\n\t\tshaderParts.forEach((value, key, map) => map.set(key, value.trim().replace(/^#/, \"\\n#\")));\r\n\r\n\t\tthis.uniforms = uniforms.size;\r\n\t\tthis.varyings = varyings;\r\n\r\n\t\tthis.skipRendering = (id === 0);\r\n\t\tthis.needsSwap = !this.skipRendering;\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\t\tmaterial.setShaderParts(shaderParts).setDefines(defines).setUniforms(uniforms);\r\n\t\tmaterial.extensions = {};\r\n\r\n\t\tif(extensions.size > 0) {\r\n\r\n\t\t\t// Enable required WebGL extensions.\r\n\t\t\tfor(const extension of extensions) {\r\n\r\n\t\t\t\tmaterial.extensions[extension] = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the shader material.\r\n\t *\r\n\t * Warning: This method triggers a relatively expensive shader recompilation.\r\n\t *\r\n\t * @param {WebGLRenderer} [renderer] - The renderer.\r\n\t */\r\n\r\n\trecompile(renderer) {\r\n\r\n\t\tthis.updateMaterial();\r\n\r\n\t\tif(renderer !== undefined) {\r\n\r\n\t\t\tthis.verifyResources(renderer);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current depth texture.\r\n\t *\r\n\t * @return {Texture} The current depth texture, or null if there is none.\r\n\t */\r\n\r\n\tgetDepthTexture() {\r\n\r\n\t\treturn this.getFullscreenMaterial().uniforms.depthBuffer.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\t\tmaterial.uniforms.depthBuffer.value = depthTexture;\r\n\t\tmaterial.depthPacking = depthPacking;\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\teffect.setDepthTexture(depthTexture, depthPacking);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\t\tconst time = material.uniforms.time.value + deltaTime;\r\n\r\n\t\tif(this.needsUpdate) {\r\n\r\n\t\t\tthis.recompile(renderer);\r\n\r\n\t\t}\r\n\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\teffect.update(renderer, inputBuffer, deltaTime);\r\n\r\n\t\t}\r\n\r\n\t\tif(!this.skipRendering || this.renderToScreen) {\r\n\r\n\t\t\tmaterial.uniforms.inputBuffer.value = inputBuffer.texture;\r\n\t\t\tmaterial.uniforms.time.value = (time <= this.maxTime) ? time : this.minTime;\r\n\t\t\trenderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\r\n\t\t\trenderer.render(this.scene, this.camera);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.getFullscreenMaterial().setSize(width, height);\r\n\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\teffect.setSize(width, height);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tthis.capabilities = renderer.capabilities;\r\n\r\n\t\t// Initialize effects before building the shader.\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\teffect.initialize(renderer, alpha, frameBufferType);\r\n\t\t\teffect.addEventListener(\"change\", (event) => this.handleEvent(event));\r\n\r\n\t\t}\r\n\r\n\t\t// Initialize the fullscreen material.\r\n\t\tthis.updateMaterial();\r\n\t\tthis.verifyResources(renderer);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes disposable objects.\r\n\t *\r\n\t * This pass will be inoperative after this method was called!\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tsuper.dispose();\r\n\r\n\t\tfor(const effect of this.effects) {\r\n\r\n\t\t\teffect.dispose();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handles events.\r\n\t *\r\n\t * @param {Event} event - An event.\r\n\t */\r\n\r\n\thandleEvent(event) {\r\n\r\n\t\tswitch(event.type) {\r\n\r\n\t\t\tcase \"change\":\r\n\t\t\t\tthis.needsUpdate = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that executes a given function.\r\n */\r\n\r\nclass LambdaPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new lambda pass.\r\n\t *\r\n\t * @param {Function} f - A function.\r\n\t */\r\n\r\n\tconstructor(f) {\r\n\r\n\t\tsuper(\"LambdaPass\", null, null);\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * A function.\r\n\t\t *\r\n\t\t * @type {Function}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.f = f;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Executes the function.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tthis.f();\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A stencil mask pass.\r\n *\r\n * This pass requires that the input and output buffers have a stencil buffer.\r\n * You can enable the stencil buffer via the {@link EffectComposer} constructor.\r\n */\r\n\r\nclass MaskPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new mask pass.\r\n\t *\r\n\t * @param {Scene} scene - The scene to render.\r\n\t * @param {Camera} camera - The camera to use.\r\n\t */\r\n\r\n\tconstructor(scene, camera) {\r\n\r\n\t\tsuper(\"MaskPass\", scene, camera);\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * A clear pass.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass(false, false, true);\r\n\r\n\t\t/**\r\n\t\t * Inverse flag.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.inverse = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether this pass should clear the stencil buffer.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget clear() {\r\n\r\n\t\treturn this.clearPass.enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables auto clear.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset clear(value) {\r\n\r\n\t\tthis.clearPass.enabled = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst context = renderer.getContext();\r\n\t\tconst buffers = renderer.state.buffers;\r\n\r\n\t\tconst scene = this.scene;\r\n\t\tconst camera = this.camera;\r\n\t\tconst clearPass = this.clearPass;\r\n\r\n\t\tconst writeValue = this.inverse ? 0 : 1;\r\n\t\tconst clearValue = 1 - writeValue;\r\n\r\n\t\t// Don't update color or depth.\r\n\t\tbuffers.color.setMask(false);\r\n\t\tbuffers.depth.setMask(false);\r\n\r\n\t\t// Lock the buffers.\r\n\t\tbuffers.color.setLocked(true);\r\n\t\tbuffers.depth.setLocked(true);\r\n\r\n\t\t// Configure the stencil.\r\n\t\tbuffers.stencil.setTest(true);\r\n\t\tbuffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\r\n\t\tbuffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\r\n\t\tbuffers.stencil.setClear(clearValue);\r\n\t\tbuffers.stencil.setLocked(true);\r\n\r\n\t\t// Clear the stencil.\r\n\t\tif(this.clear) {\r\n\r\n\t\t\tif(this.renderToScreen) {\r\n\r\n\t\t\t\tclearPass.render(renderer, null);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tclearPass.render(renderer, inputBuffer);\r\n\t\t\t\tclearPass.render(renderer, outputBuffer);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Draw the mask.\r\n\t\tif(this.renderToScreen) {\r\n\r\n\t\t\trenderer.setRenderTarget(null);\r\n\t\t\trenderer.render(scene, camera);\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.setRenderTarget(inputBuffer);\r\n\t\t\trenderer.render(scene, camera);\r\n\t\t\trenderer.setRenderTarget(outputBuffer);\r\n\t\t\trenderer.render(scene, camera);\r\n\r\n\t\t}\r\n\r\n\t\t// Unlock the buffers.\r\n\t\tbuffers.color.setLocked(false);\r\n\t\tbuffers.depth.setLocked(false);\r\n\r\n\t\t// Only render where the stencil is set to 1.\r\n\t\tbuffers.stencil.setLocked(false);\r\n\t\tbuffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff);\r\n\t\tbuffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\r\n\t\tbuffers.stencil.setLocked(true);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that renders the normals of a given scene.\r\n */\r\n\r\nclass NormalPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new normal pass.\r\n\t *\r\n\t * @param {Scene} scene - The scene to render.\r\n\t * @param {Camera} camera - The camera to use to render the scene.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Number} [options.resolutionScale=1.0] - Deprecated. Adjust the height or width instead for consistent results.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t * @param {WebGLRenderTarget} [options.renderTarget] - A custom render target.\r\n\t */\r\n\r\n\tconstructor(scene, camera, {\r\n\t\tresolutionScale = 1.0,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\trenderTarget\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"NormalPass\");\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * A render pass.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderPass = new RenderPass(scene, camera, new MeshNormalMaterial());\r\n\r\n\t\tconst clearPass = this.renderPass.getClearPass();\r\n\t\tclearPass.overrideClearColor = new Color(0x7777ff);\r\n\t\tclearPass.overrideClearAlpha = 1.0;\r\n\r\n\t\t/**\r\n\t\t * A render target that contains the scene normals.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = renderTarget;\r\n\r\n\t\tif(this.renderTarget === undefined) {\r\n\r\n\t\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\t\tminFilter: NearestFilter,\r\n\t\t\t\tmagFilter: NearestFilter,\r\n\t\t\t\tformat: RGBFormat,\r\n\t\t\t\tstencilBuffer: false\r\n\t\t\t});\r\n\r\n\t\t\tthis.renderTarget.texture.name = \"NormalPass.Target\";\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * The desired render resolution.\r\n\t\t *\r\n\t\t * Use {@link Resizer.AUTO_SIZE} for the width or height to automatically\r\n\t\t * calculate it based on its counterpart and the original aspect ratio.\r\n\t\t *\r\n\t\t * @type {Resizer}\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Resizer(this, width, height, resolutionScale);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The normal texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTarget.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolutionScale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolutionScale = scale;\r\n\t\tthis.setSize(this.resolution.base.x, this.resolution.base.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the scene normals.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tconst renderTarget = this.renderToScreen ? null : this.renderTarget;\r\n\t\tthis.renderPass.render(renderer, renderTarget, renderTarget);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\t\tresolution.base.set(width, height);\r\n\r\n\t\tthis.renderTarget.setSize(resolution.width, resolution.height);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A pass that renders the result from a previous pass to another render target.\r\n */\r\n\r\nclass SavePass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new save pass.\r\n\t *\r\n\t * @param {WebGLRenderTarget} [renderTarget] - A render target.\r\n\t * @param {Boolean} [resize=true] - Whether the render target should adjust to the size of the input buffer.\r\n\t */\r\n\r\n\tconstructor(renderTarget, resize = true) {\r\n\r\n\t\tsuper(\"SavePass\");\r\n\r\n\t\tthis.setFullscreenMaterial(new CopyMaterial());\r\n\r\n\t\tthis.needsSwap = false;\r\n\r\n\t\t/**\r\n\t\t * The render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = renderTarget;\r\n\r\n\t\tif(renderTarget === undefined) {\r\n\r\n\t\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\t\tminFilter: LinearFilter,\r\n\t\t\t\tmagFilter: LinearFilter,\r\n\t\t\t\tstencilBuffer: false,\r\n\t\t\t\tdepthBuffer: false\r\n\t\t\t});\r\n\r\n\t\t\tthis.renderTarget.texture.name = \"SavePass.Target\";\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the render target should be resized automatically.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.resize = resize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The saved texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTarget.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Saves the input buffer.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tthis.getFullscreenMaterial().uniforms.inputBuffer.value = inputBuffer.texture;\r\n\r\n\t\trenderer.setRenderTarget(this.renderToScreen ? null : this.renderTarget);\r\n\t\trenderer.render(this.scene, this.camera);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tif(this.resize) {\r\n\r\n\t\t\tconst w = Math.max(width, 1);\r\n\t\t\tconst h = Math.max(height, 1);\r\n\r\n\t\t\tthis.renderTarget.setSize(w, h);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - A renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTarget.texture.format = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTarget.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A shader pass.\r\n *\r\n * Renders any shader material as a fullscreen effect.\r\n *\r\n * This pass should not be used to create multiple chained effects. For a more\r\n * efficient solution, please refer to the {@link EffectPass}.\r\n */\r\n\r\nclass ShaderPass extends Pass {\r\n\r\n\t/**\r\n\t * Constructs a new shader pass.\r\n\t *\r\n\t * @param {ShaderMaterial} material - A shader material.\r\n\t * @param {String} [input=\"inputBuffer\"] - The name of the input buffer uniform.\r\n\t */\r\n\r\n\tconstructor(material, input = \"inputBuffer\") {\r\n\r\n\t\tsuper(\"ShaderPass\");\r\n\r\n\t\tthis.setFullscreenMaterial(material);\r\n\r\n\t\t/**\r\n\t\t * The input buffer uniform.\r\n\t\t *\r\n\t\t * @type {String}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.uniform = null;\r\n\t\tthis.setInput(input);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the name of the input buffer uniform.\r\n\t *\r\n\t * Most fullscreen materials modify texels from an input texture. This pass\r\n\t * automatically assigns the main input buffer to the uniform identified by\r\n\t * the given name.\r\n\t *\r\n\t * @param {String} input - The name of the input buffer uniform.\r\n\t */\r\n\r\n\tsetInput(input) {\r\n\r\n\t\tconst material = this.getFullscreenMaterial();\r\n\r\n\t\tthis.uniform = null;\r\n\r\n\t\tif(material !== null) {\r\n\r\n\t\t\tconst uniforms = material.uniforms;\r\n\r\n\t\t\tif(uniforms !== undefined && uniforms[input] !== undefined) {\r\n\r\n\t\t\t\tthis.uniform = uniforms[input];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders the effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {WebGLRenderTarget} outputBuffer - A frame buffer that serves as the output render target unless this pass renders to screen.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t * @param {Boolean} [stencilTest] - Indicates whether a stencil mask is active.\r\n\t */\r\n\r\n\trender(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest) {\r\n\r\n\t\tif(this.uniform !== null && inputBuffer !== null) {\r\n\r\n\t\t\tthis.uniform.value = inputBuffer.texture;\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setRenderTarget(this.renderToScreen ? null : outputBuffer);\r\n\t\trenderer.render(this.scene, this.camera);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * The EffectComposer may be used in place of a normal WebGLRenderer.\r\n *\r\n * The auto clear behaviour of the provided renderer will be disabled to prevent\r\n * unnecessary clear operations.\r\n *\r\n * It is common practice to use a {@link RenderPass} as the first pass to\r\n * automatically clear the buffers and render a scene for further processing.\r\n *\r\n * @implements {Resizable}\r\n * @implements {Disposable}\r\n */\r\n\r\nclass EffectComposer {\r\n\r\n\t/**\r\n\t * Constructs a new effect composer.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer that should be used.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Boolean} [options.depthBuffer=true] - Whether the main render targets should have a depth buffer.\r\n\t * @param {Boolean} [options.stencilBuffer=false] - Whether the main render targets should have a stencil buffer.\r\n\t * @param {Number} [options.multisampling=0] - The number of samples used for multisample antialiasing. Requires WebGL 2.\r\n\t * @param {Boolean} [options.frameBufferType] - The type of the internal frame buffers. It's recommended to use HalfFloatType if possible.\r\n\t */\r\n\r\n\tconstructor(renderer = null, {\r\n\t\tdepthBuffer = true,\r\n\t\tstencilBuffer = false,\r\n\t\tmultisampling = 0,\r\n\t\tframeBufferType\r\n\t} = {}) {\r\n\r\n\t\t/**\r\n\t\t * The renderer.\r\n\t\t *\r\n\t\t * @type {WebGLRenderer}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderer = renderer;\r\n\r\n\t\t/**\r\n\t\t * The input buffer.\r\n\t\t *\r\n\t\t * Reading from and writing to the same render target should be avoided.\r\n\t\t * Therefore, two seperate yet identical buffers are used.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.inputBuffer = null;\r\n\r\n\t\t/**\r\n\t\t * The output buffer.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.outputBuffer = null;\r\n\r\n\t\tif(this.renderer !== null) {\r\n\r\n\t\t\tthis.renderer.autoClear = false;\r\n\t\t\tthis.inputBuffer = this.createBuffer(depthBuffer, stencilBuffer, frameBufferType, multisampling);\r\n\t\t\tthis.outputBuffer = this.inputBuffer.clone();\r\n\t\t\tthis.enableExtensions();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * A copy pass used for copying masked scenes.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.copyPass = new ShaderPass(new CopyMaterial());\r\n\r\n\t\t/**\r\n\t\t * A depth texture.\r\n\t\t *\r\n\t\t * @type {DepthTexture}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.depthTexture = null;\r\n\r\n\t\t/**\r\n\t\t * The passes.\r\n\t\t *\r\n\t\t * @type {Pass[]}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.passes = [];\r\n\r\n\t\t/**\r\n\t\t * Determines whether the last pass automatically renders to screen.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.autoRenderToScreen = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current amount of samples used for multisample antialiasing.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget multisampling() {\r\n\r\n\t\treturn (this.inputBuffer instanceof WebGLMultisampleRenderTarget) ?\r\n\t\t\tthis.inputBuffer.samples : 0;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of MSAA samples.\r\n\t *\r\n\t * Requires WebGL 2. Set to zero to disable multisampling.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset multisampling(value) {\r\n\r\n\t\tconst buffer = this.inputBuffer;\r\n\t\tconst multisampling = this.multisampling;\r\n\r\n\t\tif(multisampling > 0 && value > 0) {\r\n\r\n\t\t\tthis.inputBuffer.samples = value;\r\n\t\t\tthis.outputBuffer.samples = value;\r\n\r\n\t\t} else if(multisampling !== value) {\r\n\r\n\t\t\tthis.inputBuffer.dispose();\r\n\t\t\tthis.outputBuffer.dispose();\r\n\r\n\t\t\t// Enable or disable MSAA.\r\n\t\t\tthis.inputBuffer = this.createBuffer(\r\n\t\t\t\tbuffer.depthBuffer,\r\n\t\t\t\tbuffer.stencilBuffer,\r\n\t\t\t\tbuffer.texture.type,\r\n\t\t\t\tvalue\r\n\t\t\t);\r\n\r\n\t\t\tthis.inputBuffer.depthTexture = this.depthTexture;\r\n\t\t\tthis.outputBuffer = this.inputBuffer.clone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the WebGL renderer.\r\n\t *\r\n\t * You may replace the renderer at any time by using\r\n\t * {@link EffectComposer#replaceRenderer}.\r\n\t *\r\n\t * @return {WebGLRenderer} The renderer.\r\n\t */\r\n\r\n\tgetRenderer() {\r\n\r\n\t\treturn this.renderer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Explicitly enables required WebGL extensions.\r\n\t *\r\n\t * @private\r\n\t */\r\n\r\n\tenableExtensions() {\r\n\r\n\t\tconst frameBufferType = this.inputBuffer.texture.type;\r\n\t\tconst capabilities = this.renderer.capabilities;\r\n\t\tconst context = this.renderer.getContext();\r\n\r\n\t\tif(frameBufferType !== UnsignedByteType) {\r\n\r\n\t\t\tif(capabilities.isWebGL2) {\r\n\r\n\t\t\t\tcontext.getExtension(\"EXT_color_buffer_float\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcontext.getExtension(\"EXT_color_buffer_half_float\");\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Replaces the current renderer with the given one.\r\n\t *\r\n\t * The auto clear mechanism of the provided renderer will be disabled. If the\r\n\t * new render size differs from the previous one, all passes will be updated.\r\n\t *\r\n\t * By default, the DOM element of the current renderer will automatically be\r\n\t * removed from its parent node and the DOM element of the new renderer will\r\n\t * take its place.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The new renderer.\r\n\t * @param {Boolean} updateDOM - Indicates whether the old canvas should be replaced by the new one in the DOM.\r\n\t * @return {WebGLRenderer} The old renderer.\r\n\t */\r\n\r\n\treplaceRenderer(renderer, updateDOM = true) {\r\n\r\n\t\tconst oldRenderer = this.renderer;\r\n\r\n\t\tif(oldRenderer !== null && oldRenderer !== renderer) {\r\n\r\n\t\t\tconst oldSize = oldRenderer.getSize(new Vector2$1());\r\n\t\t\tconst newSize = renderer.getSize(new Vector2$1());\r\n\t\t\tconst parent = oldRenderer.domElement.parentNode;\r\n\r\n\t\t\tthis.renderer = renderer;\r\n\t\t\tthis.renderer.autoClear = false;\r\n\r\n\t\t\tif(!oldSize.equals(newSize)) {\r\n\r\n\t\t\t\tthis.setSize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif(updateDOM && parent !== null) {\r\n\r\n\t\t\t\tparent.removeChild(oldRenderer.domElement);\r\n\t\t\t\tparent.appendChild(renderer.domElement);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.enableExtensions();\r\n\r\n\t\t}\r\n\r\n\t\treturn oldRenderer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a depth texture attachment that will be provided to all passes.\r\n\t *\r\n\t * Note: When a shader reads from a depth texture and writes to a render\r\n\t * target that uses the same depth texture attachment, the depth information\r\n\t * will be lost. This happens even if `depthWrite` is disabled.\r\n\t *\r\n\t * @private\r\n\t * @return {DepthTexture} The depth texture.\r\n\t */\r\n\r\n\tcreateDepthTexture() {\r\n\r\n\t\tconst depthTexture = this.depthTexture = new DepthTexture();\r\n\r\n\t\t// Hack: Make sure the input buffer uses the depth texture.\r\n\t\tthis.inputBuffer.depthTexture = depthTexture;\r\n\t\tthis.inputBuffer.dispose();\r\n\r\n\t\tif(this.inputBuffer.stencilBuffer) {\r\n\r\n\t\t\tdepthTexture.format = DepthStencilFormat;\r\n\t\t\tdepthTexture.type = UnsignedInt248Type;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdepthTexture.type = UnsignedIntType;\r\n\r\n\t\t}\r\n\r\n\t\treturn depthTexture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes the current depth texture.\r\n\t *\r\n\t * @private\r\n\t */\r\n\r\n\tdeleteDepthTexture() {\r\n\r\n\t\tif(this.depthTexture !== null) {\r\n\r\n\t\t\tthis.depthTexture.dispose();\r\n\t\t\tthis.depthTexture = null;\r\n\r\n\t\t\t// Update the input buffer.\r\n\t\t\tthis.inputBuffer.depthTexture = null;\r\n\t\t\tthis.inputBuffer.dispose();\r\n\r\n\t\t\tfor(const pass of this.passes) {\r\n\r\n\t\t\t\tpass.setDepthTexture(null);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new render target by replicating the renderer's canvas.\r\n\t *\r\n\t * The created render target uses a linear filter for texel minification and\r\n\t * magnification. Its render texture format depends on whether the renderer\r\n\t * uses the alpha channel. Mipmaps are disabled.\r\n\t *\r\n\t * Note: The buffer format will also be set to RGBA if the frame buffer type\r\n\t * is HalfFloatType because RGB16F buffers are not renderable.\r\n\t *\r\n\t * @param {Boolean} depthBuffer - Whether the render target should have a depth buffer.\r\n\t * @param {Boolean} stencilBuffer - Whether the render target should have a stencil buffer.\r\n\t * @param {Number} type - The frame buffer type.\r\n\t * @param {Number} multisampling - The number of samples to use for antialiasing.\r\n\t * @return {WebGLRenderTarget} A new render target that equals the renderer's canvas.\r\n\t */\r\n\r\n\tcreateBuffer(depthBuffer, stencilBuffer, type, multisampling) {\r\n\r\n\t\tconst size = this.renderer.getDrawingBufferSize(new Vector2$1());\r\n\t\tconst alpha = this.renderer.getContext().getContextAttributes().alpha;\r\n\r\n\t\tconst options = {\r\n\t\t\tformat: (!alpha && type === UnsignedByteType) ? RGBFormat : RGBAFormat,\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer,\r\n\t\t\tdepthBuffer,\r\n\t\t\ttype\r\n\t\t};\r\n\r\n\t\tconst renderTarget = (multisampling > 0) ?\r\n\t\t\tnew WebGLMultisampleRenderTarget(size.width, size.height, options) :\r\n\t\t\tnew WebGLRenderTarget(size.width, size.height, options);\r\n\r\n\t\tif(multisampling > 0) {\r\n\r\n\t\t\trenderTarget.samples = multisampling;\r\n\r\n\t\t}\r\n\r\n\t\trenderTarget.texture.name = \"EffectComposer.Buffer\";\r\n\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\treturn renderTarget;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a pass, optionally at a specific index.\r\n\t *\r\n\t * @param {Pass} pass - A new pass.\r\n\t * @param {Number} [index] - An index at which the pass should be inserted.\r\n\t */\r\n\r\n\taddPass(pass, index) {\r\n\r\n\t\tconst passes = this.passes;\r\n\t\tconst renderer = this.renderer;\r\n\t\tconst alpha = renderer.getContext().getContextAttributes().alpha;\r\n\t\tconst frameBufferType = this.inputBuffer.texture.type;\r\n\t\tconst drawingBufferSize = renderer.getDrawingBufferSize(new Vector2$1());\r\n\r\n\t\tpass.setSize(drawingBufferSize.width, drawingBufferSize.height);\r\n\t\tpass.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\tif(this.autoRenderToScreen) {\r\n\r\n\t\t\tif(passes.length > 0) {\r\n\r\n\t\t\t\tpasses[passes.length - 1].renderToScreen = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif(pass.renderToScreen) {\r\n\r\n\t\t\t\tthis.autoRenderToScreen = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif(index !== undefined) {\r\n\r\n\t\t\tpasses.splice(index, 0, pass);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpasses.push(pass);\r\n\r\n\t\t}\r\n\r\n\t\tif(this.autoRenderToScreen) {\r\n\r\n\t\t\tpasses[passes.length - 1].renderToScreen = true;\r\n\r\n\t\t}\r\n\r\n\t\tif(pass.needsDepthTexture || this.depthTexture !== null) {\r\n\r\n\t\t\tif(this.depthTexture === null) {\r\n\r\n\t\t\t\tconst depthTexture = this.createDepthTexture();\r\n\r\n\t\t\t\tfor(pass of passes) {\r\n\r\n\t\t\t\t\tpass.setDepthTexture(depthTexture);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tpass.setDepthTexture(this.depthTexture);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Removes a pass.\r\n\t *\r\n\t * @param {Pass} pass - The pass.\r\n\t */\r\n\r\n\tremovePass(pass) {\r\n\r\n\t\tconst passes = this.passes;\r\n\t\tconst index = passes.indexOf(pass);\r\n\t\tconst removed = (passes.splice(index, 1).length > 0);\r\n\r\n\t\tif(removed) {\r\n\r\n\t\t\tif(this.depthTexture !== null) {\r\n\r\n\t\t\t\t// Check if the depth texture is still required.\r\n\t\t\t\tconst reducer = (a, b) => (a || b.needsDepthTexture);\r\n\t\t\t\tconst depthTextureRequired = passes.reduce(reducer, false);\r\n\r\n\t\t\t\tif(!depthTextureRequired) {\r\n\r\n\t\t\t\t\tif(pass.getDepthTexture() === this.depthTexture) {\r\n\r\n\t\t\t\t\t\tpass.setDepthTexture(null);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.deleteDepthTexture();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif(this.autoRenderToScreen) {\r\n\r\n\t\t\t\t// Check if the removed pass was the last one.\r\n\t\t\t\tif(index === passes.length) {\r\n\r\n\t\t\t\t\tpass.renderToScreen = false;\r\n\r\n\t\t\t\t\tif(passes.length > 0) {\r\n\r\n\t\t\t\t\t\tpasses[passes.length - 1].renderToScreen = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Removes all passes without deleting them.\r\n\t */\r\n\r\n\tremoveAllPasses() {\r\n\r\n\t\tconst passes = this.passes;\r\n\r\n\t\tthis.deleteDepthTexture();\r\n\r\n\t\tif(passes.length > 0) {\r\n\r\n\t\t\tif(this.autoRenderToScreen) {\r\n\r\n\t\t\t\tpasses[passes.length - 1].renderToScreen = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.passes = [];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Renders all enabled passes in the order in which they were added.\r\n\t *\r\n\t * @param {Number} deltaTime - The time since the last frame in seconds.\r\n\t */\r\n\r\n\trender(deltaTime) {\r\n\r\n\t\tconst renderer = this.renderer;\r\n\t\tconst copyPass = this.copyPass;\r\n\r\n\t\tlet inputBuffer = this.inputBuffer;\r\n\t\tlet outputBuffer = this.outputBuffer;\r\n\r\n\t\tlet stencilTest = false;\r\n\t\tlet context, stencil, buffer;\r\n\r\n\t\tfor(const pass of this.passes) {\r\n\r\n\t\t\tif(pass.enabled) {\r\n\r\n\t\t\t\tpass.render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest);\r\n\r\n\t\t\t\tif(pass.needsSwap) {\r\n\r\n\t\t\t\t\tif(stencilTest) {\r\n\r\n\t\t\t\t\t\tcopyPass.renderToScreen = pass.renderToScreen;\r\n\t\t\t\t\t\tcontext = renderer.getContext();\r\n\t\t\t\t\t\tstencil = renderer.state.buffers.stencil;\r\n\r\n\t\t\t\t\t\t// Preserve the unaffected pixels.\r\n\t\t\t\t\t\tstencil.setFunc(context.NOTEQUAL, 1, 0xffffffff);\r\n\t\t\t\t\t\tcopyPass.render(renderer, inputBuffer, outputBuffer, deltaTime, stencilTest);\r\n\t\t\t\t\t\tstencil.setFunc(context.EQUAL, 1, 0xffffffff);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbuffer = inputBuffer;\r\n\t\t\t\t\tinputBuffer = outputBuffer;\r\n\t\t\t\t\toutputBuffer = buffer;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(pass instanceof MaskPass) {\r\n\r\n\t\t\t\t\tstencilTest = true;\r\n\r\n\t\t\t\t} else if(pass instanceof ClearMaskPass) {\r\n\r\n\t\t\t\t\tstencilTest = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the size of the buffers and the renderer's output canvas.\r\n\t *\r\n\t * Every pass will be informed of the new size. It's up to each pass how that\r\n\t * information is used.\r\n\t *\r\n\t * If no width or height is specified, the render targets and passes will be\r\n\t * updated with the current size of the renderer.\r\n\t *\r\n\t * @param {Number} [width] - The width.\r\n\t * @param {Number} [height] - The height.\r\n\t * @param {Boolean} [updateStyle] - Determines whether the style of the canvas should be updated.\r\n\t */\r\n\r\n\tsetSize(width, height, updateStyle) {\r\n\r\n\t\tconst renderer = this.renderer;\r\n\r\n\t\tif(width === undefined || height === undefined) {\r\n\r\n\t\t\tconst size = renderer.getSize(new Vector2$1());\r\n\t\t\twidth = size.width; height = size.height;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Update the logical render size.\r\n\t\t\trenderer.setSize(width, height, updateStyle);\r\n\r\n\t\t}\r\n\r\n\t\t// The drawing buffer size takes the device pixel ratio into account.\r\n\t\tconst drawingBufferSize = renderer.getDrawingBufferSize(new Vector2$1());\r\n\r\n\t\tthis.inputBuffer.setSize(drawingBufferSize.width, drawingBufferSize.height);\r\n\t\tthis.outputBuffer.setSize(drawingBufferSize.width, drawingBufferSize.height);\r\n\r\n\t\tfor(const pass of this.passes) {\r\n\r\n\t\t\tpass.setSize(drawingBufferSize.width, drawingBufferSize.height);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Resets this composer by deleting all passes and creating new buffers.\r\n\t */\r\n\r\n\treset() {\r\n\r\n\t\tthis.dispose();\r\n\t\tthis.autoRenderToScreen = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes this composer and all passes.\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tfor(const pass of this.passes) {\r\n\r\n\t\t\tpass.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tthis.passes = [];\r\n\r\n\t\tif(this.inputBuffer !== null) {\r\n\r\n\t\t\tthis.inputBuffer.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tif(this.outputBuffer !== null) {\r\n\r\n\t\t\tthis.outputBuffer.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tthis.deleteDepthTexture();\r\n\t\tthis.copyPass.dispose();\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * The initializable contract.\r\n *\r\n * Implemented by objects that can be initialized.\r\n *\r\n * @interface\r\n */\r\n\r\nclass Initializable {\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - A renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {}\r\n\r\n}\n\n/**\r\n * The Resizable contract.\r\n *\r\n * Implemented by objects that can be resized.\r\n *\r\n * @interface\r\n */\r\n\r\nclass Resizable {\r\n\r\n\t/**\r\n\t * Sets the size of this object.\r\n\t *\r\n\t * @param {Number} width - The new width.\r\n\t * @param {Number} height - The new height.\r\n\t */\r\n\r\n\tsetSize(width, height) {}\r\n\r\n}\n\n/**\r\n * An object selection.\r\n *\r\n * Object selections use render layers to facilitate quick and efficient\r\n * visibility changes.\r\n */\r\n\r\nclass Selection extends Set {\r\n\r\n\t/**\r\n\t * Constructs a new selection.\r\n\t *\r\n\t * @param {Iterable<Object3D>} [iterable] - A collection of objects that should be added to this selection.\r\n\t * @param {Number} [layer=10] - A dedicated render layer for selected objects.\r\n\t */\r\n\r\n\tconstructor(iterable, layer = 10) {\r\n\r\n\t\tsuper();\r\n\r\n\t\t/**\r\n\t\t * The current render layer for selected objects.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.currentLayer = layer;\r\n\r\n\t\tif(iterable !== undefined) {\r\n\r\n\t\t\tthis.set(iterable);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * A dedicated render layer for selected objects.\r\n\t *\r\n\t * This layer is set to 10 by default. If this collides with your own custom\r\n\t * layers, please change it to a free layer before rendering!\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget layer() {\r\n\r\n\t\treturn this.currentLayer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render layer of selected objects.\r\n\t *\r\n\t * The current selection will be updated accordingly.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset layer(value) {\r\n\r\n\t\tconst currentLayer = this.currentLayer;\r\n\r\n\t\tfor(const object of this) {\r\n\r\n\t\t\tobject.layers.disable(currentLayer);\r\n\t\t\tobject.layers.enable(value);\r\n\r\n\t\t}\r\n\r\n\t\tthis.currentLayer = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clears this selection.\r\n\t *\r\n\t * @return {Selection} This selection.\r\n\t */\r\n\r\n\tclear() {\r\n\r\n\t\tconst layer = this.layer;\r\n\r\n\t\tfor(const object of this) {\r\n\r\n\t\t\tobject.layers.disable(layer);\r\n\r\n\t\t}\r\n\r\n\t\treturn super.clear();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clears this selection and adds the given objects.\r\n\t *\r\n\t * @param {Iterable<Object3D>} objects - The objects that should be selected. This array will be copied.\r\n\t * @return {Selection} This selection.\r\n\t */\r\n\r\n\tset(objects) {\r\n\r\n\t\tthis.clear();\r\n\r\n\t\tfor(const object of objects) {\r\n\r\n\t\t\tthis.add(object);\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * An alias for {@link has}.\r\n\t *\r\n\t * @param {Object3D} object - An object.\r\n\t * @return {Number} Returns 0 if the given object is currently selected, or -1 otherwise.\r\n\t * @deprecated Added for backward compatibility. Use has instead.\r\n\t */\r\n\r\n\tindexOf(object) {\r\n\r\n\t\treturn this.has(object) ? 0 : -1;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Adds an object to this selection.\r\n\t *\r\n\t * @param {Object3D} object - The object that should be selected.\r\n\t * @return {Selection} This selection.\r\n\t */\r\n\r\n\tadd(object) {\r\n\r\n\t\tobject.layers.enable(this.layer);\r\n\t\tsuper.add(object);\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Removes an object from this selection.\r\n\t *\r\n\t * @param {Object3D} object - The object that should be deselected.\r\n\t * @return {Boolean} Returns true if an object has successfully been removed from this selection; otherwise false.\r\n\t */\r\n\r\n\tdelete(object) {\r\n\r\n\t\tif(this.has(object)) {\r\n\r\n\t\t\tobject.layers.disable(this.layer);\r\n\r\n\t\t}\r\n\r\n\t\treturn super.delete(object);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the visibility of all selected objects.\r\n\t *\r\n\t * This method enables or disables render layer 0 of all selected objects.\r\n\t *\r\n\t * @param {Boolean} visible - Whether the selected objects should be visible.\r\n\t * @return {Selection} This selection.\r\n\t */\r\n\r\n\tsetVisible(visible) {\r\n\r\n\t\tfor(const object of this) {\r\n\r\n\t\t\tif(visible) {\r\n\r\n\t\t\t\tobject.layers.enable(0);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tobject.layers.disable(0);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$f = \"uniform sampler2D texture;uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(texture,uv)*intensity,0.0,1.0);}\";\n\n/**\r\n * A bloom effect.\r\n *\r\n * This effect uses the fast Kawase convolution technique and a luminance filter\r\n * to blur bright highlights.\r\n */\r\n\r\nclass BloomEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new bloom effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n\t * @param {Number} [options.luminanceThreshold=0.9] - The luminance threshold. Raise this value to mask out darker elements in the scene. Range is [0, 1].\r\n\t * @param {Number} [options.luminanceSmoothing=0.025] - Controls the smoothness of the luminance threshold. Range is [0, 1].\r\n\t * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n\t * @param {Number} [options.intensity=1.0] - The intensity.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t * @param {KernelSize} [options.kernelSize=KernelSize.LARGE] - The blur kernel size.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tblendFunction = BlendFunction.SCREEN,\r\n\t\tluminanceThreshold = 0.9,\r\n\t\tluminanceSmoothing = 0.025,\r\n\t\tresolutionScale = 0.5,\r\n\t\tintensity = 1.0,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\tkernelSize = KernelSize.LARGE\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"BloomEffect\", fragmentShader$f, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"texture\", new Uniform(null)],\r\n\t\t\t\t[\"intensity\", new Uniform(intensity)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * A render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false\r\n\t\t});\r\n\r\n\t\tthis.renderTarget.texture.name = \"Bloom.Target\";\r\n\t\tthis.renderTarget.texture.generateMipmaps = false;\r\n\r\n\t\tthis.uniforms.get(\"texture\").value = this.renderTarget.texture;\r\n\r\n\t\t/**\r\n\t\t * A blur pass.\r\n\t\t *\r\n\t\t * @type {BlurPass}\r\n\t\t */\r\n\r\n\t\tthis.blurPass = new BlurPass({ resolutionScale, width, height, kernelSize });\r\n\t\tthis.blurPass.resolution.resizable = this;\r\n\r\n\t\t/**\r\n\t\t * A luminance shader pass.\r\n\t\t *\r\n\t\t * You may disable this pass to deactivate luminance filtering.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t */\r\n\r\n\t\tthis.luminancePass = new ShaderPass(new LuminanceMaterial(true));\r\n\r\n\t\tthis.luminanceMaterial.threshold = luminanceThreshold;\r\n\t\tthis.luminanceMaterial.smoothing = luminanceSmoothing;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * A texture that contains the intermediate result of this effect.\r\n\t *\r\n\t * This texture will be applied to the scene colors unless the blend function\r\n\t * is set to `SKIP`.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTarget.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The luminance material.\r\n\t *\r\n\t * @type {LuminanceMaterial}\r\n\t */\r\n\r\n\tget luminanceMaterial() {\r\n\r\n\t\treturn this.luminancePass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The resolution of this effect.\r\n\t *\r\n\t * @type {Resizer}\r\n\t */\r\n\r\n\tget resolution() {\r\n\r\n\t\treturn this.blurPass.resolution;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current width of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.resolution.width;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render width.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tset width(value) {\r\n\r\n\t\tthis.resolution.width = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current height of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.resolution.height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render height.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tset height(value) {\r\n\r\n\t\tthis.resolution.height = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether dithering is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tget dithering() {\r\n\r\n\t\treturn this.blurPass.dithering;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables dithering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tset dithering(value) {\r\n\r\n\t\tthis.blurPass.dithering = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The blur kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tget kernelSize() {\r\n\r\n\t\treturn this.blurPass.kernelSize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tset kernelSize(value) {\r\n\r\n\t\tthis.blurPass.kernelSize = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated Use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\r\n\t */\r\n\r\n\tget distinction() {\r\n\r\n\t\tconsole.warn(this.name, \"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\");\r\n\r\n\t\treturn 1.0;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated Use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\r\n\t */\r\n\r\n\tset distinction(value) {\r\n\r\n\t\tconsole.warn(this.name, \"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The bloom intensity.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget intensity() {\r\n\r\n\t\treturn this.uniforms.get(\"intensity\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the bloom intensity.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset intensity(value) {\r\n\r\n\t\tthis.uniforms.get(\"intensity\").value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolution.scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolution.scale = scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst renderTarget = this.renderTarget;\r\n\r\n\t\tif(this.luminancePass.enabled) {\r\n\r\n\t\t\tthis.luminancePass.render(renderer, inputBuffer, renderTarget);\r\n\t\t\tthis.blurPass.render(renderer, renderTarget, renderTarget);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.blurPass.render(renderer, inputBuffer, renderTarget);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.blurPass.setSize(width, height);\r\n\t\tthis.renderTarget.setSize(this.resolution.width, this.resolution.height);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tthis.blurPass.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTarget.texture.format = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTarget.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$g = \"uniform float focus;uniform float dof;uniform float aperture;uniform float maxBlur;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec2 aspectCorrection=vec2(1.0,aspect);\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\nfloat focusNear=clamp(focus-dof,0.0,1.0);float focusFar=clamp(focus+dof,0.0,1.0);float low=step(linearDepth,focusNear);float high=step(focusFar,linearDepth);float factor=(linearDepth-focusNear)*low+(linearDepth-focusFar)*high;vec2 dofBlur=vec2(clamp(factor*aperture,-maxBlur,maxBlur));vec2 dofblur9=dofBlur*0.9;vec2 dofblur7=dofBlur*0.7;vec2 dofblur4=dofBlur*0.4;vec4 color=inputColor;color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur4);outputColor=color/41.0;}\";\n\n/**\r\n * A depth of field (bokeh) effect.\r\n *\r\n * Original shader code by Martins Upitis:\r\n *  http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html\r\n *\r\n * @deprecated Use DepthOfFieldEffect instead.\r\n */\r\n\r\nclass BokehEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new bokeh effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.focus=0.5] - The focus distance ratio, ranging from 0.0 to 1.0.\r\n\t * @param {Number} [options.dof=0.02] - Depth of field. An area in front of and behind the focal point that still appears sharp.\r\n\t * @param {Number} [options.aperture=0.015] - Camera aperture scale. Bigger values for stronger blur and shallower depth of field.\r\n\t * @param {Number} [options.maxBlur=1.0] - The maximum blur strength.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, focus = 0.5, dof = 0.02, aperture = 0.015, maxBlur = 1.0 } = {}) {\r\n\r\n\t\tsuper(\"BokehEffect\", fragmentShader$g, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"focus\", new Uniform(focus)],\r\n\t\t\t\t[\"dof\", new Uniform(dof)],\r\n\t\t\t\t[\"aperture\", new Uniform(aperture)],\r\n\t\t\t\t[\"maxBlur\", new Uniform(maxBlur)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$h = \"uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}\";\n\n/**\r\n * A brightness/contrast effect.\r\n *\r\n * Reference: https://github.com/evanw/glfx.js\r\n */\r\n\r\nclass BrightnessContrastEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new brightness/contrast effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.brightness=0.0] - The brightness factor, ranging from -1 to 1, where 0 means no change.\r\n\t * @param {Number} [options.contrast=0.0] - The contrast factor, ranging from -1 to 1, where 0 means no change.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, brightness = 0.0, contrast = 0.0 } = {}) {\r\n\r\n\t\tsuper(\"BrightnessContrastEffect\", fragmentShader$h, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"brightness\", new Uniform(brightness)],\r\n\t\t\t\t[\"contrast\", new Uniform(contrast)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$i = \"void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float sum=inputColor.r+inputColor.g+inputColor.b;outputColor=vec4(vec3(sum/3.0),inputColor.a);}\";\n\n/**\r\n * A color average effect.\r\n */\r\n\r\nclass ColorAverageEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new color average effect.\r\n\t *\r\n\t * @param {BlendFunction} [blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t */\r\n\r\n\tconstructor(blendFunction = BlendFunction.NORMAL) {\r\n\r\n\t\tsuper(\"ColorAverageEffect\", fragmentShader$i, { blendFunction });\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$j = \"uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}\";\n\n/**\r\n * A color depth effect.\r\n *\r\n * Simulates a hardware limitation to achieve a retro feel.\r\n */\r\n\r\nclass ColorDepthEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new color depth effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.bits=16] - The color bit depth.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, bits = 16 } = {}) {\r\n\r\n\t\tsuper(\"ColorDepthEffect\", fragmentShader$j, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"factor\", new Uniform(1.0)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The current amount of bits.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.bits = 0;\r\n\r\n\t\tthis.setBitDepth(bits);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current color bit depth.\r\n\t *\r\n\t * @return {Number} The color bit depth.\r\n\t */\r\n\r\n\tgetBitDepth() {\r\n\r\n\t\treturn this.bits;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the virtual amount of color bits.\r\n\t *\r\n\t * Each color channel will use a third of the available bits. The alpha\r\n\t * channel remains unaffected.\r\n\t *\r\n\t * Note that the real color depth will not be altered by this effect.\r\n\t *\r\n\t * @param {Number} bits - The new color bit depth.\r\n\t */\r\n\r\n\tsetBitDepth(bits) {\r\n\r\n\t\tthis.bits = bits;\r\n\t\tthis.uniforms.get(\"factor\").value = Math.pow(2.0, bits / 3.0);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$k = \"varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 color=inputColor;\\n#ifdef ALPHA\\nvec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;color.r=ra.x;color.b=ba.x;color.a=max(max(ra.y,ba.y),inputColor.a);\\n#else\\ncolor.r=texture2D(inputBuffer,vUvR).r;color.b=texture2D(inputBuffer,vUvB).b;\\n#endif\\noutputColor=color;}\";\n\nvar vertexShader$8 = \"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vUvR=uv+offset;vUvB=uv-offset;}\";\n\n/**\r\n * A chromatic aberration effect.\r\n */\r\n\r\nclass ChromaticAberrationEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new chromatic aberration effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Vector2} [options.offset] - The color offset.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, offset = new Vector2$1(0.001, 0.0005) } = {}) {\r\n\r\n\t\tsuper(\"ChromaticAberrationEffect\", fragmentShader$k, {\r\n\r\n\t\t\tvertexShader: vertexShader$8,\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.CONVOLUTION,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"offset\", new Uniform(offset)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The color offset.\r\n\t *\r\n\t * @type {Vector2}\r\n\t */\r\n\r\n\tget offset() {\r\n\r\n\t\treturn this.uniforms.get(\"offset\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Vector2}\r\n\t */\r\n\r\n\tset offset(value) {\r\n\r\n\t\tthis.uniforms.get(\"offset\").value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tif(alpha) {\r\n\r\n\t\t\tthis.defines.set(\"ALPHA\", \"1\");\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.defines.delete(\"ALPHA\");\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$l = \"void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\\n#ifdef INVERTED\\nvec3 color=vec3(1.0-depth);\\n#else\\nvec3 color=vec3(depth);\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n\n/**\r\n * A depth visualization effect.\r\n *\r\n * Useful for debugging.\r\n */\r\n\r\nclass DepthEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new depth effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Boolean} [options.inverted=false] - Whether the depth values should be inverted.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, inverted = false } = {}) {\r\n\r\n\t\tsuper(\"DepthEffect\", fragmentShader$l, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.DEPTH\r\n\r\n\t\t});\r\n\r\n\t\tthis.inverted = inverted;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether depth should be inverted.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget inverted() {\r\n\r\n\t\treturn this.defines.has(\"INVERTED\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables depth inversion.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset inverted(value) {\r\n\r\n\t\tif(this.inverted !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"INVERTED\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"INVERTED\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$m = \"uniform sampler2D nearColorBuffer;uniform sampler2D farColorBuffer;uniform sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}\";\n\n/**\r\n * A depth of field effect.\r\n *\r\n * Based on a graphics study by Adrian CourrÃ¨ges and an article by Steve Avery:\r\n *  https://www.adriancourreges.com/blog/2016/09/09/doom-2016-graphics-study/\r\n *  https://pixelmischiefblog.wordpress.com/2016/11/25/bokeh-depth-of-field/\r\n */\r\n\r\nclass DepthOfFieldEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new depth of field effect.\r\n\t *\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.focusDistance=0.0] - The normalized focus distance. Range is [0.0, 1.0].\r\n\t * @param {Number} [options.focalLength=0.05] - The focal length. Range is [0.0, 1.0].\r\n\t * @param {Number} [options.bokehScale=1.0] - The scale of the bokeh blur.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t */\r\n\r\n\tconstructor(camera, {\r\n\t\tblendFunction = BlendFunction.NORMAL,\r\n\t\tfocusDistance = 0.0,\r\n\t\tfocalLength = 0.1,\r\n\t\tbokehScale = 1.0,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"DepthOfFieldEffect\", fragmentShader$m, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"nearColorBuffer\", new Uniform(null)],\r\n\t\t\t\t[\"farColorBuffer\", new Uniform(null)],\r\n\t\t\t\t[\"nearCoCBuffer\", new Uniform(null)],\r\n\t\t\t\t[\"scale\", new Uniform(1.0)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * A render target for intermediate results.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTarget = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false\r\n\t\t});\r\n\r\n\t\tthis.renderTarget.texture.name = \"DoF.Intermediate\";\r\n\t\tthis.renderTarget.texture.generateMipmaps = false;\r\n\r\n\t\t/**\r\n\t\t * A render target for masked background colors (premultiplied with CoC).\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetMasked = this.renderTarget.clone();\r\n\t\tthis.renderTargetMasked.texture.name = \"DoF.Masked.Far\";\r\n\r\n\t\t/**\r\n\t\t * A render target for the blurred foreground colors.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetNear = this.renderTarget.clone();\r\n\t\tthis.renderTargetNear.texture.name = \"DoF.Bokeh.Near\";\r\n\r\n\t\tthis.uniforms.get(\"nearColorBuffer\").value = this.renderTargetNear.texture;\r\n\r\n\t\t/**\r\n\t\t * A render target for the blurred background colors.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetFar = this.renderTarget.clone();\r\n\t\tthis.renderTargetFar.texture.name = \"DoF.Bokeh.Far\";\r\n\r\n\t\tthis.uniforms.get(\"farColorBuffer\").value = this.renderTargetFar.texture;\r\n\r\n\t\t/**\r\n\t\t * A render target for the circle of confusion.\r\n\t\t *\r\n\t\t * - Negative values are stored in the `RED` channel (foreground).\r\n\t\t * - Positive values are stored in the `GREEN` channel (background).\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetCoC = this.renderTarget.clone();\r\n\t\tthis.renderTargetCoC.texture.format = RGBFormat;\r\n\t\tthis.renderTargetCoC.texture.name = \"DoF.CoC\";\r\n\r\n\t\t/**\r\n\t\t * A render target that stores a blurred copy of the circle of confusion.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetCoCBlurred = this.renderTargetCoC.clone();\r\n\t\tthis.renderTargetCoCBlurred.texture.name = \"DoF.CoC.Blurred\";\r\n\r\n\t\tthis.uniforms.get(\"nearCoCBuffer\").value = this.renderTargetCoCBlurred.texture;\r\n\r\n\t\t/**\r\n\t\t * A circle of confusion pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.cocPass = new ShaderPass(new CircleOfConfusionMaterial(camera));\r\n\t\tconst cocMaterial = this.circleOfConfusionMaterial;\r\n\t\tcocMaterial.uniforms.focusDistance.value = focusDistance;\r\n\t\tcocMaterial.uniforms.focalLength.value = focalLength;\r\n\r\n\t\t/**\r\n\t\t * This pass blurs the foreground CoC buffer to soften edges.\r\n\t\t *\r\n\t\t * @type {BlurPass}\r\n\t\t */\r\n\r\n\t\tthis.blurPass = new BlurPass({ width, height, kernelSize: KernelSize.MEDIUM });\r\n\t\tthis.blurPass.resolution.resizable = this;\r\n\r\n\t\t/**\r\n\t\t * A mask pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.maskPass = new ShaderPass(new MaskMaterial(this.renderTargetCoC.texture));\r\n\t\tconst maskMaterial = this.maskPass.getFullscreenMaterial();\r\n\t\tmaskMaterial.maskFunction = MaskFunction.MULTIPLY_RGB_SET_ALPHA;\r\n\t\tmaskMaterial.colorChannel = ColorChannel.GREEN;\r\n\r\n\t\t/**\r\n\t\t * A bokeh blur pass for the foreground colors.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.bokehNearBasePass = new ShaderPass(new BokehMaterial(false, true));\r\n\r\n\t\t/**\r\n\t\t * A bokeh fill pass for the foreground colors.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.bokehNearFillPass = new ShaderPass(new BokehMaterial(true, true));\r\n\r\n\t\t/**\r\n\t\t * A bokeh blur pass for the background colors.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.bokehFarBasePass = new ShaderPass(new BokehMaterial(false, false));\r\n\r\n\t\t/**\r\n\t\t * A bokeh fill pass for the background colors.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.bokehFarFillPass = new ShaderPass(new BokehMaterial(true, false));\r\n\r\n\t\tthis.bokehScale = bokehScale;\r\n\r\n\t\t/**\r\n\t\t * A target position that should be kept in focus.\r\n\t\t *\r\n\t\t * Set this to `null` to disable auto focus.\r\n\t\t *\r\n\t\t * @type {Vector3}\r\n\t\t */\r\n\r\n\t\tthis.target = null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The circle of confusion material.\r\n\t *\r\n\t * @type {CircleOfConfusionMaterial}\r\n\t */\r\n\r\n\tget circleOfConfusionMaterial() {\r\n\r\n\t\treturn this.cocPass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The resolution of this effect.\r\n\t *\r\n\t * @type {Resizer}\r\n\t */\r\n\r\n\tget resolution() {\r\n\r\n\t\treturn this.blurPass.resolution;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current bokeh scale.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget bokehScale() {\r\n\r\n\t\treturn this.uniforms.get(\"scale\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the bokeh scale.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset bokehScale(value) {\r\n\r\n\t\tconst passes = [\r\n\t\t\tthis.bokehNearBasePass,\r\n\t\t\tthis.bokehNearFillPass,\r\n\t\t\tthis.bokehFarBasePass,\r\n\t\t\tthis.bokehFarFillPass\r\n\t\t];\r\n\r\n\t\tpasses.map((p) => p.getFullscreenMaterial().uniforms.scale).forEach((u) => {\r\n\r\n\t\t\tu.value = value;\r\n\r\n\t\t});\r\n\r\n\t\tthis.maskPass.getFullscreenMaterial().uniforms.strength.value = value;\r\n\t\tthis.uniforms.get(\"scale\").value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Calculates the focus distance from the camera to the given position.\r\n\t *\r\n\t * @param {Vector3} target - The target.\r\n\t * @return {Number} The normalized focus distance.\r\n\t */\r\n\r\n\tcalculateFocusDistance(target) {\r\n\r\n\t\tconst camera = this.camera;\r\n\t\tconst viewDistance = camera.far - camera.near;\r\n\t\tconst distance = camera.position.distanceTo(target);\r\n\r\n\t\treturn Math.min(Math.max((distance / viewDistance), 0.0), 1.0);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.circleOfConfusionMaterial;\r\n\t\tmaterial.uniforms.depthBuffer.value = depthTexture;\r\n\t\tmaterial.depthPacking = depthPacking;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst renderTarget = this.renderTarget;\r\n\t\tconst renderTargetCoC = this.renderTargetCoC;\r\n\t\tconst renderTargetCoCBlurred = this.renderTargetCoCBlurred;\r\n\t\tconst renderTargetMasked = this.renderTargetMasked;\r\n\r\n\t\tconst bokehFarBasePass = this.bokehFarBasePass;\r\n\t\tconst bokehFarFillPass = this.bokehFarFillPass;\r\n\t\tconst farBaseUniforms = bokehFarBasePass.getFullscreenMaterial().uniforms;\r\n\t\tconst farFillUniforms = bokehFarFillPass.getFullscreenMaterial().uniforms;\r\n\r\n\t\tconst bokehNearBasePass = this.bokehNearBasePass;\r\n\t\tconst bokehNearFillPass = this.bokehNearFillPass;\r\n\t\tconst nearBaseUniforms = bokehNearBasePass.getFullscreenMaterial().uniforms;\r\n\t\tconst nearFillUniforms = bokehNearFillPass.getFullscreenMaterial().uniforms;\r\n\r\n\t\t// Auto focus.\r\n\t\tif(this.target !== null) {\r\n\r\n\t\t\tconst distance = this.calculateFocusDistance(this.target);\r\n\t\t\tthis.circleOfConfusionMaterial.uniforms.focusDistance.value = distance;\r\n\r\n\t\t}\r\n\r\n\t\t// Render the CoC and create a blurred version for soft near field blending.\r\n\t\tthis.cocPass.render(renderer, null, renderTargetCoC);\r\n\t\tthis.blurPass.render(renderer, renderTargetCoC, renderTargetCoCBlurred);\r\n\r\n\t\t// Prevent sharp colors from bleeding onto the background.\r\n\t\tthis.maskPass.render(renderer, inputBuffer, renderTargetMasked);\r\n\r\n\t\t// Use the sharp CoC buffer and render the background bokeh.\r\n\t\tfarBaseUniforms.cocBuffer.value = farFillUniforms.cocBuffer.value = renderTargetCoC.texture;\r\n\t\tbokehFarBasePass.render(renderer, renderTargetMasked, renderTarget);\r\n\t\tbokehFarFillPass.render(renderer, renderTarget, this.renderTargetFar);\r\n\r\n\t\t// Use the blurred CoC buffer and render the foreground bokeh.\r\n\t\tnearBaseUniforms.cocBuffer.value = nearFillUniforms.cocBuffer.value = renderTargetCoCBlurred.texture;\r\n\t\tbokehNearBasePass.render(renderer, inputBuffer, renderTarget);\r\n\t\tbokehNearFillPass.render(renderer, renderTarget, this.renderTargetNear);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\r\n\t\tlet resizables = [\r\n\t\t\tthis.cocPass,\r\n\t\t\tthis.blurPass,\r\n\t\t\tthis.maskPass,\r\n\t\t\tthis.bokehNearBasePass,\r\n\t\t\tthis.bokehNearFillPass,\r\n\t\t\tthis.bokehFarBasePass,\r\n\t\t\tthis.bokehFarFillPass\r\n\t\t];\r\n\r\n\t\t// These buffers require full resolution to prevent bleeding artifacts.\r\n\t\tresizables.push(this.renderTargetCoC, this.renderTargetMasked);\r\n\t\tresizables.forEach((r) => r.setSize(width, height));\r\n\r\n\t\tconst w = resolution.width;\r\n\t\tconst h = resolution.height;\r\n\r\n\t\tresizables = [\r\n\t\t\tthis.renderTarget,\r\n\t\t\tthis.renderTargetNear,\r\n\t\t\tthis.renderTargetFar,\r\n\t\t\tthis.renderTargetCoCBlurred\r\n\t\t];\r\n\r\n\t\tresizables.forEach((r) => r.setSize(w, h));\r\n\r\n\t\t// The bokeh blur passes operate on the low resolution buffers.\r\n\t\tconst passes = [\r\n\t\t\tthis.bokehNearBasePass,\r\n\t\t\tthis.bokehNearFillPass,\r\n\t\t\tthis.bokehFarBasePass,\r\n\t\t\tthis.bokehFarFillPass\r\n\t\t];\r\n\r\n\t\tpasses.forEach((p) => p.getFullscreenMaterial().setTexelSize(1.0 / w, 1.0 / h));\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tconst initializables = [\r\n\t\t\tthis.cocPass,\r\n\t\t\tthis.maskPass,\r\n\t\t\tthis.bokehNearBasePass,\r\n\t\t\tthis.bokehNearFillPass,\r\n\t\t\tthis.bokehFarBasePass,\r\n\t\t\tthis.bokehFarFillPass\r\n\t\t];\r\n\r\n\t\tinitializables.forEach((i) => i.initialize(renderer, alpha, frameBufferType));\r\n\r\n\t\t// The blur pass operates on the CoC buffer.\r\n\t\tthis.blurPass.initialize(renderer, alpha, UnsignedByteType);\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTargetNear.texture.type = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTarget.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetNear.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetFar.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetMasked.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$n = \"uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}\";\n\n/**\r\n * A dot screen effect.\r\n */\r\n\r\nclass DotScreenEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new dot screen effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.angle=1.57] - The angle of the dot pattern.\r\n\t * @param {Number} [options.scale=1.0] - The scale of the dot pattern.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, angle = Math.PI * 0.5, scale = 1.0 } = {}) {\r\n\r\n\t\tsuper(\"DotScreenEffect\", fragmentShader$n, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"angle\", new Uniform(new Vector2$1())],\r\n\t\t\t\t[\"scale\", new Uniform(scale)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.setAngle(angle);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the pattern angle.\r\n\t *\r\n\t * @param {Number} [angle] - The angle of the dot pattern.\r\n\t */\r\n\r\n\tsetAngle(angle) {\r\n\r\n\t\tthis.uniforms.get(\"angle\").value.set(Math.sin(angle), Math.cos(angle));\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$o = \"uniform float gamma;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=LinearToGamma(max(inputColor,0.0),gamma);}\";\n\n/**\r\n * A gamma correction effect.\r\n *\r\n * @deprecated Set WebGLRenderer.outputEncoding to sRGBEncoding or GammaEncoding instead.\r\n */\r\n\r\nclass GammaCorrectionEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new gamma correction effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.gamma=2.0] - The gamma factor.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, gamma = 2.0 } = {}) {\r\n\r\n\t\tsuper(\"GammaCorrectionEffect\", fragmentShader$o, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"gamma\", new Uniform(gamma)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * Generates noise.\r\n *\r\n * @private\r\n * @param {Number} size - The linear texture size.\r\n * @param {Number} format - The texture format.\r\n * @param {Number} type - The texture type.\r\n * @return {TypedArray} The noise data.\r\n */\r\n\r\nfunction getNoise(size, format, type) {\r\n\r\n\tconst channels = new Map([\r\n\t\t[LuminanceFormat, 1],\r\n\t\t[RedFormat, 1],\r\n\t\t[RGFormat, 2],\r\n\t\t[RGBFormat, 3],\r\n\t\t[RGBAFormat, 4]\r\n\t]);\r\n\r\n\tlet data;\r\n\r\n\tif(!channels.has(format)) {\r\n\r\n\t\tconsole.error(\"Invalid noise texture format\");\r\n\r\n\t}\r\n\r\n\tif(type === UnsignedByteType) {\r\n\r\n\t\tdata = new Uint8Array(size * channels.get(format));\r\n\r\n\t\tfor(let i = 0, l = data.length; i < l; ++i) {\r\n\r\n\t\t\tdata[i] = Math.random() * 255;\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tdata = new Float32Array(size * channels.get(format));\r\n\r\n\t\tfor(let i = 0, l = data.length; i < l; ++i) {\r\n\r\n\t\t\tdata[i] = Math.random();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n}\r\n\r\n/**\r\n * A simple noise texture.\r\n */\r\n\r\nclass NoiseTexture extends DataTexture {\r\n\r\n\t/**\r\n\t * Constructs a new noise texture.\r\n\t *\r\n\t * The texture format can be either `LuminanceFormat`, `RGBFormat` or\r\n\t * `RGBAFormat`. Additionally, the formats `RedFormat` and `RGFormat` can be\r\n\t * used in a WebGL 2 context.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t * @param {Number} [format=LuminanceFormat] - The texture format.\r\n\t * @param {Number} [type=UnsignedByteType] - The texture type.\r\n\t */\r\n\r\n\tconstructor(width, height, format = LuminanceFormat, type = UnsignedByteType) {\r\n\r\n\t\tsuper(getNoise(width * height, format, type), width, height, format, type);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$p = \"uniform sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seed;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seed.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seed.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}vec2 normal=texture2D(perturbationMap,uv*random*random).rg;uv+=normal*seed*(random*0.2);}}\";\n\n/**\r\n * A label for generated data textures.\r\n *\r\n * @type {String}\r\n * @private\r\n */\r\n\r\nconst tag = \"Glitch.Generated\";\r\n\r\n/**\r\n * Returns a random float in the specified range.\r\n *\r\n * @private\r\n * @param {Number} low - The lowest possible value.\r\n * @param {Number} high - The highest possible value.\r\n * @return {Number} The random value.\r\n */\r\n\r\nfunction randomFloat(low, high) {\r\n\r\n\treturn low + Math.random() * (high - low);\r\n\r\n}\r\n\r\n/**\r\n * A glitch effect.\r\n *\r\n * This effect can influence the {@link ChromaticAberrationEffect}.\r\n *\r\n * Reference: https://github.com/staffantan/unityglitch\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\r\n\r\nclass GlitchEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new glitch effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Vector2} [options.chromaticAberrationOffset] - A chromatic aberration offset. If provided, the glitch effect will influence this offset.\r\n\t * @param {Vector2} [options.delay] - The minimum and maximum delay between glitch activations in seconds.\r\n\t * @param {Vector2} [options.duration] - The minimum and maximum duration of a glitch in seconds.\r\n\t * @param {Vector2} [options.strength] - The strength of weak and strong glitches.\r\n\t * @param {Texture} [options.perturbationMap] - A perturbation map. If none is provided, a noise texture will be created.\r\n\t * @param {Number} [options.dtSize=64] - The size of the generated noise map. Will be ignored if a perturbation map is provided.\r\n\t * @param {Number} [options.columns=0.05] - The scale of the blocky glitch columns.\r\n\t * @param {Number} [options.ratio=0.85] - The threshold for strong glitches.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tblendFunction = BlendFunction.NORMAL,\r\n\t\tchromaticAberrationOffset = null,\r\n\t\tdelay = new Vector2$1(1.5, 3.5),\r\n\t\tduration = new Vector2$1(0.6, 1.0),\r\n\t\tstrength = new Vector2$1(0.3, 1.0),\r\n\t\tcolumns = 0.05,\r\n\t\tratio = 0.85,\r\n\t\tperturbationMap = null,\r\n\t\tdtSize = 64\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"GlitchEffect\", fragmentShader$p, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"perturbationMap\", new Uniform(null)],\r\n\t\t\t\t[\"columns\", new Uniform(columns)],\r\n\t\t\t\t[\"active\", new Uniform(false)],\r\n\t\t\t\t[\"random\", new Uniform(1.0)],\r\n\t\t\t\t[\"seed\", new Uniform(new Vector2$1())],\r\n\t\t\t\t[\"distortion\", new Uniform(new Vector2$1())]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.setPerturbationMap((perturbationMap === null) ?\r\n\t\t\tthis.generatePerturbationMap(dtSize) :\r\n\t\t\tperturbationMap\r\n\t\t);\r\n\r\n\t\t/**\r\n\t\t * The minimum and maximum delay between glitch activations in seconds.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t */\r\n\r\n\t\tthis.delay = delay;\r\n\r\n\t\t/**\r\n\t\t * The minimum and maximum duration of a glitch in seconds.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t */\r\n\r\n\t\tthis.duration = duration;\r\n\r\n\t\t/**\r\n\t\t * A random glitch break point.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.breakPoint = new Vector2$1(\r\n\t\t\trandomFloat(this.delay.x, this.delay.y),\r\n\t\t\trandomFloat(this.duration.x, this.duration.y)\r\n\t\t);\r\n\r\n\t\t/**\r\n\t\t * A time accumulator.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.time = 0;\r\n\r\n\t\t/**\r\n\t\t * Random seeds.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.seed = this.uniforms.get(\"seed\").value;\r\n\r\n\t\t/**\r\n\t\t * A distortion vector.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.distortion = this.uniforms.get(\"distortion\").value;\r\n\r\n\t\t/**\r\n\t\t * The effect mode.\r\n\t\t *\r\n\t\t * @type {GlitchMode}\r\n\t\t */\r\n\r\n\t\tthis.mode = GlitchMode.SPORADIC;\r\n\r\n\t\t/**\r\n\t\t * The strength of weak and strong glitches.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t */\r\n\r\n\t\tthis.strength = strength;\r\n\r\n\t\t/**\r\n\t\t * The threshold for strong glitches, ranging from 0 to 1 where 0 means no\r\n\t\t * weak glitches and 1 means no strong ones. The default ratio of 0.85\r\n\t\t * offers a decent balance.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.ratio = ratio;\r\n\r\n\t\t/**\r\n\t\t * The chromatic aberration offset.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t */\r\n\r\n\t\tthis.chromaticAberrationOffset = chromaticAberrationOffset;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the glitch effect is currently active.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget active() {\r\n\r\n\t\treturn this.uniforms.get(\"active\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current perturbation map.\r\n\t *\r\n\t * @return {Texture} The current perturbation map.\r\n\t */\r\n\r\n\tgetPerturbationMap() {\r\n\r\n\t\treturn this.uniforms.get(\"perturbationMap\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Replaces the current perturbation map with the given one.\r\n\t *\r\n\t * The current map will be disposed if it was generated by this effect.\r\n\t *\r\n\t * @param {Texture} map - The new perturbation map.\r\n\t */\r\n\r\n\tsetPerturbationMap(map) {\r\n\r\n\t\tconst currentMap = this.getPerturbationMap();\r\n\r\n\t\tif(currentMap !== null && currentMap.name === tag) {\r\n\r\n\t\t\tcurrentMap.dispose();\r\n\r\n\t\t}\r\n\r\n\t\tmap.minFilter = map.magFilter = NearestFilter;\r\n\t\tmap.wrapS = map.wrapT = RepeatWrapping;\r\n\t\tmap.generateMipmaps = false;\r\n\r\n\t\tthis.uniforms.get(\"perturbationMap\").value = map;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Generates a perturbation map.\r\n\t *\r\n\t * @param {Number} [size=64] - The texture size.\r\n\t * @return {DataTexture} The perturbation map.\r\n\t */\r\n\r\n\tgeneratePerturbationMap(size = 64) {\r\n\r\n\t\tconst map = new NoiseTexture(size, size, RGBFormat);\r\n\t\tmap.name = tag;\r\n\r\n\t\treturn map;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst mode = this.mode;\r\n\t\tconst breakPoint = this.breakPoint;\r\n\t\tconst offset = this.chromaticAberrationOffset;\r\n\t\tconst s = this.strength;\r\n\r\n\t\tlet time = this.time;\r\n\t\tlet active = false;\r\n\t\tlet r = 0.0, a = 0.0;\r\n\t\tlet trigger;\r\n\r\n\t\tif(mode !== GlitchMode.DISABLED) {\r\n\r\n\t\t\tif(mode === GlitchMode.SPORADIC) {\r\n\r\n\t\t\t\ttime += deltaTime;\r\n\t\t\t\ttrigger = (time > breakPoint.x);\r\n\r\n\t\t\t\tif(time >= (breakPoint.x + breakPoint.y)) {\r\n\r\n\t\t\t\t\tbreakPoint.set(\r\n\t\t\t\t\t\trandomFloat(this.delay.x, this.delay.y),\r\n\t\t\t\t\t\trandomFloat(this.duration.x, this.duration.y)\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\ttime = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tr = Math.random();\r\n\t\t\tthis.uniforms.get(\"random\").value = r;\r\n\r\n\t\t\tif((trigger && r > this.ratio) || mode === GlitchMode.CONSTANT_WILD) {\r\n\r\n\t\t\t\tactive = true;\r\n\r\n\t\t\t\tr *= s.y * 0.03;\r\n\t\t\t\ta = randomFloat(-Math.PI, Math.PI);\r\n\r\n\t\t\t\tthis.seed.set(randomFloat(-s.y, s.y), randomFloat(-s.y, s.y));\r\n\t\t\t\tthis.distortion.set(randomFloat(0.0, 1.0), randomFloat(0.0, 1.0));\r\n\r\n\t\t\t} else if(trigger || mode === GlitchMode.CONSTANT_MILD) {\r\n\r\n\t\t\t\tactive = true;\r\n\r\n\t\t\t\tr *= s.x * 0.03;\r\n\t\t\t\ta = randomFloat(-Math.PI, Math.PI);\r\n\r\n\t\t\t\tthis.seed.set(randomFloat(-s.x, s.x), randomFloat(-s.x, s.x));\r\n\t\t\t\tthis.distortion.set(randomFloat(0.0, 1.0), randomFloat(0.0, 1.0));\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.time = time;\r\n\r\n\t\t}\r\n\r\n\t\tif(offset !== null) {\r\n\r\n\t\t\tif(active) {\r\n\r\n\t\t\t\toffset.set(Math.cos(a), Math.sin(a)).multiplyScalar(r);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\toffset.set(0.0, 0.0);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.uniforms.get(\"active\").value = active;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * A glitch mode enumeration.\r\n *\r\n * @type {Object}\r\n * @property {Number} DISABLED - No glitches.\r\n * @property {Number} SPORADIC - Sporadic glitches.\r\n * @property {Number} CONSTANT_MILD - Constant mild glitches.\r\n * @property {Number} CONSTANT_WILD - Constant wild glitches.\r\n */\r\n\r\nconst GlitchMode = {\r\n\r\n\tDISABLED: 0,\r\n\tSPORADIC: 1,\r\n\tCONSTANT_MILD: 2,\r\n\tCONSTANT_WILD: 3\r\n\r\n};\n\nvar fragmentShader$q = \"uniform sampler2D texture;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(texture,uv);}\";\n\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\r\n\r\nconst v = new Vector3();\r\n\r\n/**\r\n * A matrix.\r\n *\r\n * @type {Matrix4}\r\n * @private\r\n */\r\n\r\nconst m = new Matrix4();\r\n\r\n/**\r\n * A god rays effect.\r\n */\r\n\r\nclass GodRaysEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new god rays effect.\r\n\t *\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Mesh|Points} lightSource - The light source. Must not write depth and has to be flagged as transparent.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n\t * @param {Number} [options.samples=60.0] - The number of samples per pixel.\r\n\t * @param {Number} [options.density=0.96] - The density of the light rays.\r\n\t * @param {Number} [options.decay=0.9] - An illumination decay factor.\r\n\t * @param {Number} [options.weight=0.4] - A light ray weight factor.\r\n\t * @param {Number} [options.exposure=0.6] - A constant attenuation coefficient.\r\n\t * @param {Number} [options.clampMax=1.0] - An upper bound for the saturation of the overall effect.\r\n\t * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t * @param {KernelSize} [options.kernelSize=KernelSize.SMALL] - The blur kernel size. Has no effect if blur is disabled.\r\n\t * @param {Boolean} [options.blur=true] - Whether the god rays should be blurred to reduce artifacts.\r\n\t */\r\n\r\n\tconstructor(camera, lightSource, {\r\n\t\tblendFunction = BlendFunction.SCREEN,\r\n\t\tsamples = 60.0,\r\n\t\tdensity = 0.96,\r\n\t\tdecay = 0.9,\r\n\t\tweight = 0.4,\r\n\t\texposure = 0.6,\r\n\t\tclampMax = 1.0,\r\n\t\tresolutionScale = 0.5,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\tkernelSize = KernelSize.SMALL,\r\n\t\tblur = true\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"GodRaysEffect\", fragmentShader$q, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"texture\", new Uniform(null)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * The light source.\r\n\t\t *\r\n\t\t * @type {Mesh|Points}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.lightSource = lightSource;\r\n\t\tthis.lightSource.material.depthWrite = false;\r\n\t\tthis.lightSource.material.transparent = true;\r\n\r\n\t\t/**\r\n\t\t * A scene that only contains the light source.\r\n\t\t *\r\n\t\t * @type {Scene}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.lightScene = new Scene();\r\n\r\n\t\t/**\r\n\t\t * The light position in screen space.\r\n\t\t *\r\n\t\t * @type {Vector3}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.screenPosition = new Vector2$1();\r\n\r\n\t\t/**\r\n\t\t * A render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetA = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false\r\n\t\t});\r\n\r\n\t\tthis.renderTargetA.texture.name = \"GodRays.Target.A\";\r\n\r\n\t\t/**\r\n\t\t * A render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetB = this.renderTargetA.clone();\r\n\t\tthis.renderTargetB.texture.name = \"GodRays.Target.B\";\r\n\t\tthis.uniforms.get(\"texture\").value = this.renderTargetB.texture;\r\n\r\n\t\t/**\r\n\t\t * A render target for the light scene.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetLight = this.renderTargetA.clone();\r\n\t\tthis.renderTargetLight.texture.name = \"GodRays.Light\";\r\n\t\tthis.renderTargetLight.depthBuffer = true;\r\n\t\tthis.renderTargetLight.depthTexture = new DepthTexture();\r\n\r\n\t\t/**\r\n\t\t * A pass that only renders the light source.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderPassLight = new RenderPass(this.lightScene, camera);\r\n\t\tthis.renderPassLight.getClearPass().overrideClearColor = new Color(0x000000);\r\n\r\n\t\t/**\r\n\t\t * A clear pass.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass(true, false, false);\r\n\t\tthis.clearPass.overrideClearColor = new Color(0x000000);\r\n\r\n\t\t/**\r\n\t\t * A blur pass that reduces aliasing artifacts and makes the light softer.\r\n\t\t *\r\n\t\t * Disable this pass to improve performance.\r\n\t\t *\r\n\t\t * @type {BlurPass}\r\n\t\t */\r\n\r\n\t\tthis.blurPass = new BlurPass({ resolutionScale, width, height, kernelSize });\r\n\t\tthis.blurPass.resolution.resizable = this;\r\n\r\n\t\t/**\r\n\t\t * A depth mask pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.depthMaskPass = new ShaderPass(((depthTexture) => {\r\n\r\n\t\t\tconst material = new DepthMaskMaterial();\r\n\t\t\tmaterial.uniforms.depthBuffer1.value = depthTexture;\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t})(this.renderTargetLight.depthTexture));\r\n\r\n\t\t/**\r\n\t\t * A god rays blur pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.godRaysPass = new ShaderPass((() => {\r\n\r\n\t\t\tconst material = new GodRaysMaterial(this.screenPosition);\r\n\t\t\tmaterial.uniforms.density.value = density;\r\n\t\t\tmaterial.uniforms.decay.value = decay;\r\n\t\t\tmaterial.uniforms.weight.value = weight;\r\n\t\t\tmaterial.uniforms.exposure.value = exposure;\r\n\t\t\tmaterial.uniforms.clampMax.value = clampMax;\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t})());\r\n\r\n\t\tthis.samples = samples;\r\n\t\tthis.blur = blur;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * A texture that contains the intermediate result of this effect.\r\n\t *\r\n\t * This texture will be applied to the scene colors unless the blend function\r\n\t * is set to `SKIP`.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.renderTargetB.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The internal god rays material.\r\n\t *\r\n\t * @type {GodRaysMaterial}\r\n\t */\r\n\r\n\tget godRaysMaterial() {\r\n\r\n\t\treturn this.godRaysPass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The resolution of this effect.\r\n\t *\r\n\t * @type {Resizer}\r\n\t */\r\n\r\n\tget resolution() {\r\n\r\n\t\treturn this.blurPass.resolution;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current width of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.resolution.width;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render width.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tset width(value) {\r\n\r\n\t\tthis.resolution.width = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current height of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.resolution.height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render height.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tset height(value) {\r\n\r\n\t\tthis.resolution.height = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether dithering is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tget dithering() {\r\n\r\n\t\treturn this.godRaysMaterial.dithering;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables dithering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tset dithering(value) {\r\n\r\n\t\tconst material = this.godRaysMaterial;\r\n\r\n\t\tmaterial.dithering = value;\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the god rays should be blurred to reduce artifacts.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget blur() {\r\n\r\n\t\treturn this.blurPass.enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset blur(value) {\r\n\r\n\t\tthis.blurPass.enabled = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The blur kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tget kernelSize() {\r\n\r\n\t\treturn this.blurPass.kernelSize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the blur kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tset kernelSize(value) {\r\n\r\n\t\tthis.blurPass.kernelSize = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolution.scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolution.scale = scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The number of samples per pixel.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget samples() {\r\n\r\n\t\treturn this.godRaysMaterial.samples;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * A higher sample count improves quality at the cost of performance.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset samples(value) {\r\n\r\n\t\tthis.godRaysMaterial.samples = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.depthMaskPass.getFullscreenMaterial();\r\n\t\tmaterial.uniforms.depthBuffer0.value = depthTexture;\r\n\t\tmaterial.defines.DEPTH_PACKING_0 = depthPacking.toFixed(0);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst lightSource = this.lightSource;\r\n\t\tconst parent = lightSource.parent;\r\n\t\tconst matrixAutoUpdate = lightSource.matrixAutoUpdate;\r\n\r\n\t\tconst renderTargetA = this.renderTargetA;\r\n\t\tconst renderTargetLight = this.renderTargetLight;\r\n\r\n\t\t// Enable depth write for the light scene render pass.\r\n\t\tlightSource.material.depthWrite = true;\r\n\r\n\t\t// Update the world matrix.\r\n\t\tlightSource.matrixAutoUpdate = false;\r\n\t\tlightSource.updateWorldMatrix(true, false);\r\n\r\n\t\tif(parent !== null) {\r\n\r\n\t\t\tif(!matrixAutoUpdate) {\r\n\r\n\t\t\t\t// Remember the local transformation to restore it later.\r\n\t\t\t\tm.copy(lightSource.matrix);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Apply parent transformations.\r\n\t\t\tlightSource.matrix.copy(lightSource.matrixWorld);\r\n\r\n\t\t}\r\n\r\n\t\t// Render the light source and mask it based on depth.\r\n\t\tthis.lightScene.add(lightSource);\r\n\t\tthis.renderPassLight.render(renderer, renderTargetLight);\r\n\t\tthis.clearPass.render(renderer, renderTargetA);\r\n\t\tthis.depthMaskPass.render(renderer, renderTargetLight, renderTargetA);\r\n\r\n\t\t// Restore the original values.\r\n\t\tlightSource.material.depthWrite = false;\r\n\t\tlightSource.matrixAutoUpdate = matrixAutoUpdate;\r\n\r\n\t\tif(parent !== null) {\r\n\r\n\t\t\tif(!matrixAutoUpdate) {\r\n\r\n\t\t\t\tlightSource.matrix.copy(m);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tparent.add(lightSource);\r\n\r\n\t\t}\r\n\r\n\t\t// Calculate the screen light position.\r\n\t\tv.setFromMatrixPosition(lightSource.matrixWorld).project(this.camera);\r\n\r\n\t\t// Translate to [0.0, 1.0] and clamp to screen with a bias of 1.0.\r\n\t\tthis.screenPosition.set(\r\n\t\t\tMath.min(Math.max((v.x + 1.0) * 0.5, -1.0), 2.0),\r\n\t\t\tMath.min(Math.max((v.y + 1.0) * 0.5, -1.0), 2.0)\r\n\t\t);\r\n\r\n\t\tif(this.blur) {\r\n\r\n\t\t\t// Blur the masked scene to reduce artifacts.\r\n\t\t\tthis.blurPass.render(renderer, renderTargetA, renderTargetA);\r\n\r\n\t\t}\r\n\r\n\t\t// Blur the masked scene along radial lines towards the light source.\r\n\t\tthis.godRaysPass.render(renderer, renderTargetA, this.renderTargetB);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.blurPass.setSize(width, height);\r\n\t\tthis.renderPassLight.setSize(width, height);\r\n\t\tthis.depthMaskPass.setSize(width, height);\r\n\t\tthis.godRaysPass.setSize(width, height);\r\n\r\n\t\tconst w = this.resolution.width;\r\n\t\tconst h = this.resolution.height;\r\n\r\n\t\tthis.renderTargetA.setSize(w, h);\r\n\t\tthis.renderTargetB.setSize(w, h);\r\n\t\tthis.renderTargetLight.setSize(w, h);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tthis.blurPass.initialize(renderer, alpha, frameBufferType);\r\n\t\tthis.renderPassLight.initialize(renderer, alpha, frameBufferType);\r\n\t\tthis.depthMaskPass.initialize(renderer, alpha, frameBufferType);\r\n\t\tthis.godRaysPass.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTargetA.texture.format = RGBFormat;\r\n\t\t\tthis.renderTargetB.texture.format = RGBFormat;\r\n\t\t\tthis.renderTargetLight.texture.format = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTargetA.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetB.texture.type = frameBufferType;\r\n\t\t\tthis.renderTargetLight.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$r = \"uniform vec2 scale;uniform float lineWidth;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float grid=0.5-max(abs(mod(uv.x*scale.x,1.0)-0.5),abs(mod(uv.y*scale.y,1.0)-0.5));outputColor=vec4(vec3(smoothstep(0.0,lineWidth,grid)),inputColor.a);}\";\n\n/**\r\n * A grid effect.\r\n */\r\n\r\nclass GridEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new grid effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.OVERLAY] - The blend function of this effect.\r\n\t * @param {Number} [options.scale=1.0] - The scale of the grid pattern.\r\n\t * @param {Number} [options.lineWidth=0.0] - The line width of the grid pattern.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.OVERLAY, scale = 1.0, lineWidth = 0.0 } = {}) {\r\n\r\n\t\tsuper(\"GridEffect\", fragmentShader$r, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"scale\", new Uniform(new Vector2$1())],\r\n\t\t\t\t[\"lineWidth\", new Uniform(lineWidth)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The original resolution.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Vector2$1();\r\n\r\n\t\t/**\r\n\t\t * The grid scale, relative to the screen height.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.scale = Math.max(scale, 1e-6);\r\n\r\n\t\t/**\r\n\t\t * The grid line width.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.lineWidth = Math.max(lineWidth, 0.0);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current grid scale.\r\n\t *\r\n\t * @return {Number} The grid scale.\r\n\t */\r\n\r\n\tgetScale() {\r\n\r\n\t\treturn this.scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the grid scale.\r\n\t *\r\n\t * @param {Number} scale - The new grid scale.\r\n\t */\r\n\r\n\tsetScale(scale) {\r\n\r\n\t\tthis.scale = scale;\r\n\t\tthis.setSize(this.resolution.x, this.resolution.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current grid line width.\r\n\t *\r\n\t * @return {Number} The grid line width.\r\n\t */\r\n\r\n\tgetLineWidth() {\r\n\r\n\t\treturn this.lineWidth;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the grid line width.\r\n\t *\r\n\t * @param {Number} lineWidth - The new grid line width.\r\n\t */\r\n\r\n\tsetLineWidth(lineWidth) {\r\n\r\n\t\tthis.lineWidth = lineWidth;\r\n\t\tthis.setSize(this.resolution.x, this.resolution.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.resolution.set(width, height);\r\n\r\n\t\tconst aspect = width / height;\r\n\t\tconst scale = this.scale * (height * 0.125);\r\n\r\n\t\tthis.uniforms.get(\"scale\").value.set(aspect * scale, scale);\r\n\t\tthis.uniforms.get(\"lineWidth\").value = (scale / height) + this.lineWidth;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$s = \"uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}\";\n\n/**\r\n * A hue/saturation effect.\r\n *\r\n * Reference: https://github.com/evanw/glfx.js\r\n */\r\n\r\nclass HueSaturationEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new hue/saturation effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.hue=0.0] - The hue in radians.\r\n\t * @param {Number} [options.saturation=0.0] - The saturation factor, ranging from -1 to 1, where 0 means no change.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, hue = 0.0, saturation = 0.0 } = {}) {\r\n\r\n\t\tsuper(\"HueSaturationEffect\", fragmentShader$s, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"hue\", new Uniform(new Vector3())],\r\n\t\t\t\t[\"saturation\", new Uniform(saturation)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.setHue(hue);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the hue.\r\n\t *\r\n\t * @param {Number} hue - The hue in radians.\r\n\t */\r\n\r\n\tsetHue(hue) {\r\n\r\n\t\tconst s = Math.sin(hue), c = Math.cos(hue);\r\n\r\n\t\tthis.uniforms.get(\"hue\").value.set(\r\n\t\t\t2.0 * c, -Math.sqrt(3.0) * s - c, Math.sqrt(3.0) * s - c\r\n\t\t).addScalar(1.0).divideScalar(3.0);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$t = \"void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\\n#ifdef PREMULTIPLY\\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\\n#else\\noutputColor=vec4(noise,inputColor.a);\\n#endif\\n}\";\n\n/**\r\n * A noise effect.\r\n */\r\n\r\nclass NoiseEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new noise effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function of this effect.\r\n\t * @param {Boolean} [options.premultiply=false] - Whether the noise should be multiplied with the input color.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.SCREEN, premultiply = false } = {}) {\r\n\r\n\t\tsuper(\"NoiseEffect\", fragmentShader$t, { blendFunction });\r\n\r\n\t\tthis.premultiply = premultiply;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the noise should be multiplied with the input color.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget premultiply() {\r\n\r\n\t\treturn this.defines.has(\"PREMULTIPLY\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables noise premultiplication.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset premultiply(value) {\r\n\r\n\t\tif(this.premultiply !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"PREMULTIPLY\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"PREMULTIPLY\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$u = \"uniform sampler2D edgeTexture;uniform sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;\\n#ifdef USE_PATTERN\\nuniform sampler2D patternTexture;varying vec2 vUvPattern;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;\\n#ifndef X_RAY\\nedge.y=0.0;\\n#endif\\nedge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;\\n#ifdef USE_PATTERN\\nvec4 patternColor=texture2D(patternTexture,vUvPattern);\\n#ifdef X_RAY\\nfloat hiddenFactor=0.5;\\n#else\\nfloat hiddenFactor=0.0;\\n#endif\\nvisibilityFactor=(1.0-mask.y>0.0)? 1.0 : hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;\\n#endif\\nfloat alpha=max(max(edge.x,edge.y),visibilityFactor);\\n#ifdef ALPHA\\noutputColor=vec4(color,alpha);\\n#else\\noutputColor=vec4(color,max(alpha,inputColor.a));\\n#endif\\n}\";\n\nvar vertexShader$9 = \"uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}\";\n\n/**\r\n * An outline effect.\r\n */\r\n\r\nclass OutlineEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new outline effect.\r\n\t *\r\n\t * If you want dark outlines, remember to use an appropriate blend function.\r\n\t *\r\n\t * @param {Scene} scene - The main scene.\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.SCREEN] - The blend function.  Set this to `BlendFunction.ALPHA` for dark outlines.\r\n\t * @param {Number} [options.patternTexture=null] - A pattern texture.\r\n\t * @param {Number} [options.edgeStrength=1.0] - The edge strength.\r\n\t * @param {Number} [options.pulseSpeed=0.0] - The pulse speed. A value of zero disables the pulse effect.\r\n\t * @param {Number} [options.visibleEdgeColor=0xffffff] - The color of visible edges.\r\n\t * @param {Number} [options.hiddenEdgeColor=0x22090a] - The color of hidden edges.\r\n\t * @param {Number} [options.resolutionScale=0.5] - Deprecated. Use height or width instead.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t * @param {KernelSize} [options.kernelSize=KernelSize.VERY_SMALL] - The blur kernel size.\r\n\t * @param {Boolean} [options.blur=false] - Whether the outline should be blurred.\r\n\t * @param {Boolean} [options.xRay=true] - Whether occluded parts of selected objects should be visible.\r\n\t */\r\n\r\n\tconstructor(scene, camera, {\r\n\t\tblendFunction = BlendFunction.SCREEN,\r\n\t\tpatternTexture = null,\r\n\t\tedgeStrength = 1.0,\r\n\t\tpulseSpeed = 0.0,\r\n\t\tvisibleEdgeColor = 0xffffff,\r\n\t\thiddenEdgeColor = 0x22090a,\r\n\t\tresolutionScale = 0.5,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE,\r\n\t\tkernelSize = KernelSize.VERY_SMALL,\r\n\t\tblur = false,\r\n\t\txRay = true\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"OutlineEffect\", fragmentShader$u, {\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"maskTexture\", new Uniform(null)],\r\n\t\t\t\t[\"edgeTexture\", new Uniform(null)],\r\n\t\t\t\t[\"edgeStrength\", new Uniform(edgeStrength)],\r\n\t\t\t\t[\"visibleEdgeColor\", new Uniform(new Color(visibleEdgeColor))],\r\n\t\t\t\t[\"hiddenEdgeColor\", new Uniform(new Color(hiddenEdgeColor))],\r\n\t\t\t\t[\"pulse\", new Uniform(1.0)],\r\n\t\t\t\t[\"patternScale\", new Uniform(1.0)],\r\n\t\t\t\t[\"patternTexture\", new Uniform(null)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t// Handle alpha blending.\r\n\t\tthis.blendMode.addEventListener(\"change\", (event) => {\r\n\r\n\t\t\tif(this.blendMode.getBlendFunction() === BlendFunction.ALPHA) {\r\n\r\n\t\t\t\tthis.defines.set(\"ALPHA\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"ALPHA\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t});\r\n\r\n\t\tthis.blendMode.setBlendFunction(blendFunction);\r\n\t\tthis.setPatternTexture(patternTexture);\r\n\t\tthis.xRay = xRay;\r\n\r\n\t\t/**\r\n\t\t * The main scene.\r\n\t\t *\r\n\t\t * @type {Scene}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.scene = scene;\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * A render target for the outline mask.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetMask = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tformat: RGBFormat\r\n\t\t});\r\n\r\n\t\tthis.renderTargetMask.texture.name = \"Outline.Mask\";\r\n\r\n\t\tthis.uniforms.get(\"maskTexture\").value = this.renderTargetMask.texture;\r\n\r\n\t\t/**\r\n\t\t * A render target for the edge detection.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetOutline = this.renderTargetMask.clone();\r\n\t\tthis.renderTargetOutline.texture.name = \"Outline.Edges\";\r\n\t\tthis.renderTargetOutline.depthBuffer = false;\r\n\r\n\t\t/**\r\n\t\t * A render target for the blurred outline overlay.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetBlurredOutline = this.renderTargetOutline.clone();\r\n\t\tthis.renderTargetBlurredOutline.texture.name = \"Outline.BlurredEdges\";\r\n\r\n\t\t/**\r\n\t\t * A clear pass.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass();\r\n\t\tthis.clearPass.overrideClearColor = new Color(0x000000);\r\n\t\tthis.clearPass.overrideClearAlpha = 1.0;\r\n\r\n\t\t/**\r\n\t\t * A depth pass.\r\n\t\t *\r\n\t\t * @type {DepthPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.depthPass = new DepthPass(scene, camera);\r\n\r\n\t\t/**\r\n\t\t * A depth comparison mask pass.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.maskPass = new RenderPass(scene, camera,\r\n\t\t\tnew DepthComparisonMaterial(this.depthPass.texture, camera));\r\n\r\n\t\tconst clearPass = this.maskPass.getClearPass();\r\n\t\tclearPass.overrideClearColor = new Color(0xffffff);\r\n\t\tclearPass.overrideClearAlpha = 1.0;\r\n\r\n\t\t/**\r\n\t\t * A blur pass.\r\n\t\t *\r\n\t\t * @type {BlurPass}\r\n\t\t */\r\n\r\n\t\tthis.blurPass = new BlurPass({ resolutionScale, width, height, kernelSize });\r\n\t\tthis.blurPass.resolution.resizable = this;\r\n\t\tthis.blur = blur;\r\n\r\n\t\t/**\r\n\t\t * An outline detection pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.outlinePass = new ShaderPass(new OutlineMaterial());\r\n\t\tthis.outlinePass.getFullscreenMaterial().uniforms.inputBuffer.value = this.renderTargetMask.texture;\r\n\r\n\t\t/**\r\n\t\t * The current animation time.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.time = 0.0;\r\n\r\n\t\t/**\r\n\t\t * A selection of objects that will be outlined.\r\n\t\t *\r\n\t\t * @type {Selection}\r\n\t\t */\r\n\r\n\t\tthis.selection = new Selection();\r\n\r\n\t\t/**\r\n\t\t * The pulse speed. A value of zero disables the pulse effect.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.pulseSpeed = pulseSpeed;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The resolution of this effect.\r\n\t *\r\n\t * @type {Resizer}\r\n\t */\r\n\r\n\tget resolution() {\r\n\r\n\t\treturn this.blurPass.resolution;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current width of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tget width() {\r\n\r\n\t\treturn this.resolution.width;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render width.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.width instead.\r\n\t */\r\n\r\n\tset width(value) {\r\n\r\n\t\tthis.resolution.width = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The current height of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tget height() {\r\n\r\n\t\treturn this.resolution.height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the render height.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use resolution.height instead.\r\n\t */\r\n\r\n\tset height(value) {\r\n\r\n\t\tthis.resolution.height = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated Use selection.layer instead.\r\n\t */\r\n\r\n\tget selectionLayer() {\r\n\r\n\t\treturn this.selection.layer;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated Use selection.layer instead.\r\n\t */\r\n\r\n\tset selectionLayer(value) {\r\n\r\n\t\tthis.selection.layer = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether dithering is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tget dithering() {\r\n\r\n\t\treturn this.blurPass.dithering;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables dithering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t * @deprecated Set the frameBufferType of the EffectComposer to HalfFloatType instead.\r\n\t */\r\n\r\n\tset dithering(value) {\r\n\r\n\t\tthis.blurPass.dithering = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The blur kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tget kernelSize() {\r\n\r\n\t\treturn this.blurPass.kernelSize;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the kernel size.\r\n\t *\r\n\t * @type {KernelSize}\r\n\t * @deprecated Use blurPass.kernelSize instead.\r\n\t */\r\n\r\n\tset kernelSize(value) {\r\n\r\n\t\tthis.blurPass.kernelSize = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the outlines should be blurred.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget blur() {\r\n\r\n\t\treturn this.blurPass.enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset blur(value) {\r\n\r\n\t\tthis.blurPass.enabled = value;\r\n\r\n\t\tthis.uniforms.get(\"edgeTexture\").value = value ?\r\n\t\t\tthis.renderTargetBlurredOutline.texture :\r\n\t\t\tthis.renderTargetOutline.texture;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether X-Ray outlines are enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget xRay() {\r\n\r\n\t\treturn this.defines.has(\"X_RAY\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables X-Ray outlines.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset xRay(value) {\r\n\r\n\t\tif(this.xRay !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"X_RAY\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"X_RAY\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the pattern texture.\r\n\t *\r\n\t * @param {Texture} texture - The new texture.\r\n\t */\r\n\r\n\tsetPatternTexture(texture) {\r\n\r\n\t\tif(texture !== null) {\r\n\r\n\t\t\ttexture.wrapS = texture.wrapT = RepeatWrapping;\r\n\r\n\t\t\tthis.defines.set(\"USE_PATTERN\", \"1\");\r\n\t\t\tthis.uniforms.get(\"patternTexture\").value = texture;\r\n\t\t\tthis.setVertexShader(vertexShader$9);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.defines.delete(\"USE_PATTERN\");\r\n\t\t\tthis.uniforms.get(\"patternTexture\").value = null;\r\n\t\t\tthis.setVertexShader(null);\r\n\r\n\t\t}\r\n\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current resolution scale.\r\n\t *\r\n\t * @return {Number} The resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tgetResolutionScale() {\r\n\r\n\t\treturn this.resolution.scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution scale.\r\n\t *\r\n\t * @param {Number} scale - The new resolution scale.\r\n\t * @deprecated Adjust the fixed resolution width or height instead.\r\n\t */\r\n\r\n\tsetResolutionScale(scale) {\r\n\r\n\t\tthis.resolution.scale = scale;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the current selection and selects a list of objects.\r\n\t *\r\n\t * @param {Object3D[]} objects - The objects that should be outlined. This array will be copied.\r\n\t * @return {OutlinePass} This pass.\r\n\t * @deprecated Use selection.set instead.\r\n\t */\r\n\r\n\tsetSelection(objects) {\r\n\r\n\t\tthis.selection.set(objects);\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the list of selected objects.\r\n\t *\r\n\t * @return {OutlinePass} This pass.\r\n\t * @deprecated Use selection.clear instead.\r\n\t */\r\n\r\n\tclearSelection() {\r\n\r\n\t\tthis.selection.clear();\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Selects an object.\r\n\t *\r\n\t * @param {Object3D} object - The object that should be outlined.\r\n\t * @return {OutlinePass} This pass.\r\n\t * @deprecated Use selection.add instead.\r\n\t */\r\n\r\n\tselectObject(object) {\r\n\r\n\t\tthis.selection.add(object);\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Deselects an object.\r\n\t *\r\n\t * @param {Object3D} object - The object that should no longer be outlined.\r\n\t * @return {OutlinePass} This pass.\r\n\t * @deprecated Use selection.delete instead.\r\n\t */\r\n\r\n\tdeselectObject(object) {\r\n\r\n\t\tthis.selection.delete(object);\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst scene = this.scene;\r\n\t\tconst camera = this.camera;\r\n\t\tconst selection = this.selection;\r\n\t\tconst pulse = this.uniforms.get(\"pulse\");\r\n\r\n\t\tconst background = scene.background;\r\n\t\tconst mask = camera.layers.mask;\r\n\r\n\t\tif(selection.size > 0) {\r\n\r\n\t\t\tscene.background = null;\r\n\t\t\tpulse.value = 1.0;\r\n\r\n\t\t\tif(this.pulseSpeed > 0.0) {\r\n\r\n\t\t\t\tpulse.value = 0.625 + Math.cos(this.time * this.pulseSpeed * 10.0) * 0.375;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.time += deltaTime;\r\n\r\n\t\t\t// Render a custom depth texture and ignore selected objects.\r\n\t\t\tselection.setVisible(false);\r\n\t\t\tthis.depthPass.render(renderer);\r\n\t\t\tselection.setVisible(true);\r\n\r\n\t\t\t// Compare the depth of the selected objects with the depth texture.\r\n\t\t\tcamera.layers.set(selection.layer);\r\n\t\t\tthis.maskPass.render(renderer, this.renderTargetMask);\r\n\r\n\t\t\t// Restore the camera layer mask and the scene background.\r\n\t\t\tcamera.layers.mask = mask;\r\n\t\t\tscene.background = background;\r\n\r\n\t\t\t// Detect the outline.\r\n\t\t\tthis.outlinePass.render(renderer, null, this.renderTargetOutline);\r\n\r\n\t\t\tif(this.blur) {\r\n\r\n\t\t\t\tthis.blurPass.render(renderer, this.renderTargetOutline, this.renderTargetBlurredOutline);\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if(this.time > 0.0) {\r\n\r\n\t\t\tthis.clearPass.render(renderer, this.renderTargetMask);\r\n\t\t\tthis.time = 0.0;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.blurPass.setSize(width, height);\r\n\t\tthis.renderTargetMask.setSize(width, height);\r\n\r\n\t\tconst w = this.resolution.width;\r\n\t\tconst h = this.resolution.height;\r\n\r\n\t\tthis.depthPass.setSize(w, h);\r\n\t\tthis.renderTargetOutline.setSize(w, h);\r\n\t\tthis.renderTargetBlurredOutline.setSize(w, h);\r\n\t\tthis.outlinePass.getFullscreenMaterial().setTexelSize(1.0 / w, 1.0 / h);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\t// No need for high precision: the blur pass operates on a mask texture.\r\n\t\tthis.blurPass.initialize(renderer, alpha, UnsignedByteType);\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\t// These passes ignore the buffer type.\r\n\t\t\tthis.depthPass.initialize(renderer, alpha, frameBufferType);\r\n\t\t\tthis.maskPass.initialize(renderer, alpha, frameBufferType);\r\n\t\t\tthis.outlinePass.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$v = \"uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}\";\n\n/**\r\n * A pixelation effect.\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\r\n\r\nclass PixelationEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new pixelation effect.\r\n\t *\r\n\t * @param {Object} [granularity=30.0] - The pixel granularity.\r\n\t */\r\n\r\n\tconstructor(granularity = 30.0) {\r\n\r\n\t\tsuper(\"PixelationEffect\", fragmentShader$v, {\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"active\", new Uniform(false)],\r\n\t\t\t\t[\"d\", new Uniform(new Vector2$1())]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The original resolution.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Vector2$1();\r\n\r\n\t\t/**\r\n\t\t * The pixel granularity.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.granularity = granularity;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the pixel granularity.\r\n\t *\r\n\t * @return {Number} The granularity.\r\n\t */\r\n\r\n\tgetGranularity() {\r\n\r\n\t\treturn this.granularity;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the pixel granularity.\r\n\t *\r\n\t * A higher value yields coarser visuals.\r\n\t *\r\n\t * @param {Number} granularity - The new granularity.\r\n\t */\r\n\r\n\tsetGranularity(granularity) {\r\n\r\n\t\tgranularity = Math.floor(granularity);\r\n\r\n\t\tif(granularity % 2 > 0) {\r\n\r\n\t\t\tgranularity += 1;\r\n\r\n\t\t}\r\n\r\n\t\tconst uniforms = this.uniforms;\r\n\t\tuniforms.get(\"active\").value = (granularity > 0.0);\r\n\t\tuniforms.get(\"d\").value.set(granularity, granularity).divide(this.resolution);\r\n\r\n\t\tthis.granularity = granularity;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the granularity.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.resolution.set(width, height);\r\n\t\tthis.setGranularity(this.granularity);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$w = \"uniform float focus;uniform float focalLength;uniform float fStop;uniform float maxBlur;uniform float luminanceThreshold;uniform float luminanceGain;uniform float bias;uniform float fringe;\\n#ifdef MANUAL_DOF\\nuniform vec4 dof;\\n#endif\\n#ifdef PENTAGON\\nfloat pentagon(const in vec2 coords){const vec4 HS0=vec4(1.0,0.0,0.0,1.0);const vec4 HS1=vec4(0.309016994,0.951056516,0.0,1.0);const vec4 HS2=vec4(-0.809016994,0.587785252,0.0,1.0);const vec4 HS3=vec4(-0.809016994,-0.587785252,0.0,1.0);const vec4 HS4=vec4(0.309016994,-0.951056516,0.0,1.0);const vec4 HS5=vec4(0.0,0.0,1.0,1.0);const vec4 ONE=vec4(1.0);const float P_FEATHER=0.4;const float N_FEATHER=-P_FEATHER;float inOrOut=-4.0;vec4 P=vec4(coords,vec2(RINGS_FLOAT-1.3));vec4 dist=vec4(dot(P,HS0),dot(P,HS1),dot(P,HS2),dot(P,HS3));dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dot(dist,ONE);dist.x=dot(P,HS4);dist.y=HS5.w-abs(P.z);dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dist.x;return clamp(inOrOut,0.0,1.0);}\\n#endif\\nvec3 processTexel(const in vec2 coords,const in float blur){vec2 scale=texelSize*fringe*blur;vec3 c=vec3(texture2D(inputBuffer,coords+vec2(0.0,1.0)*scale).r,texture2D(inputBuffer,coords+vec2(-0.866,-0.5)*scale).g,texture2D(inputBuffer,coords+vec2(0.866,-0.5)*scale).b);float luminance=linearToRelativeLuminance(c);float threshold=max((luminance-luminanceThreshold)*luminanceGain,0.0);return c+mix(vec3(0.0),c,threshold*blur);}float gather(const in float i,const in float j,const in float ringSamples,const in vec2 uv,const in vec2 blurFactor,const in float blur,inout vec3 color){float step=PI2/ringSamples;vec2 wh=vec2(cos(j*step)*i,sin(j*step)*i);\\n#ifdef PENTAGON\\nfloat p=pentagon(wh);\\n#else\\nfloat p=1.0;\\n#endif\\ncolor+=processTexel(wh*blurFactor+uv,blur)*mix(1.0,i/RINGS_FLOAT,bias)*p;return mix(1.0,i/RINGS_FLOAT,bias)*p;}void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){\\n#ifdef PERSPECTIVE_CAMERA\\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\\n#else\\nfloat linearDepth=depth;\\n#endif\\n#ifdef MANUAL_DOF\\nfloat focalPlane=linearDepth-focus;float farDoF=(focalPlane-dof.z)/dof.w;float nearDoF=(-focalPlane-dof.x)/dof.y;float blur=(focalPlane>0.0)? farDoF : nearDoF;\\n#else\\nconst float CIRCLE_OF_CONFUSION=0.03;float focalPlaneMM=focus*1000.0;float depthMM=linearDepth*1000.0;float focalPlane=(depthMM*focalLength)/(depthMM-focalLength);float farDoF=(focalPlaneMM*focalLength)/(focalPlaneMM-focalLength);float nearDoF=(focalPlaneMM-focalLength)/(focalPlaneMM*fStop*CIRCLE_OF_CONFUSION);float blur=abs(focalPlane-farDoF)*nearDoF;\\n#endif\\nconst int MAX_RING_SAMPLES=RINGS_INT*SAMPLES_INT;blur=clamp(blur,0.0,1.0);vec3 color=inputColor.rgb;if(blur>=0.05){vec2 blurFactor=blur*maxBlur*texelSize;float s=1.0;int ringSamples;for(int i=1;i<=RINGS_INT;i++){ringSamples=i*SAMPLES_INT;for(int j=0;j<MAX_RING_SAMPLES;j++){if(j>=ringSamples){break;}s+=gather(float(i),float(j),float(ringSamples),uv,blurFactor,blur,color);}}color/=s;}\\n#ifdef SHOW_FOCUS\\nfloat edge=0.002*linearDepth;float m=clamp(smoothstep(0.0,edge,blur),0.0,1.0);float e=clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);color=mix(color,vec3(1.0,0.5,0.0),(1.0-m)*0.6);color=mix(color,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n\n/**\r\n * Depth of Field shader v2.4.\r\n *\r\n * Yields more realistic results but is also more demanding.\r\n *\r\n * Original shader code by Martins Upitis:\r\n *  http://blenderartists.org/forum/showthread.php?237488-GLSL-depth-of-field-with-bokeh-v2-4-(update)\r\n *\r\n * @deprecated Use DepthOfFieldEffect instead.\r\n */\r\n\r\nclass RealisticBokehEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new bokeh effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.focus=1.0] - The focus distance in world units.\r\n\t * @param {Number} [options.focalLength=24.0] - The focal length of the main camera.\r\n\t * @param {Number} [options.fStop=0.9] - The ratio of the lens focal length to the diameter of the entrance pupil (aperture).\r\n\t * @param {Number} [options.luminanceThreshold=0.5] - A luminance threshold.\r\n\t * @param {Number} [options.luminanceGain=2.0] - A luminance gain factor.\r\n\t * @param {Number} [options.bias=0.5] - A blur bias.\r\n\t * @param {Number} [options.fringe=0.7] - A blur offset.\r\n\t * @param {Number} [options.maxBlur=1.0] - The maximum blur strength.\r\n\t * @param {Boolean} [options.rings=3] - The number of blur iterations.\r\n\t * @param {Boolean} [options.samples=2] - The amount of samples taken per ring.\r\n\t * @param {Boolean} [options.showFocus=false] - Whether the focal point should be highlighted. Useful for debugging.\r\n\t * @param {Boolean} [options.manualDoF=false] - Enables manual control over the depth of field.\r\n\t * @param {Boolean} [options.pentagon=false] - Enables pentagonal blur shapes. Requires a high number of rings and samples.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tblendFunction = BlendFunction.NORMAL,\r\n\t\tfocus = 1.0,\r\n\t\tfocalLength = 24.0,\r\n\t\tfStop = 0.9,\r\n\t\tluminanceThreshold = 0.5,\r\n\t\tluminanceGain = 2.0,\r\n\t\tbias = 0.5,\r\n\t\tfringe = 0.7,\r\n\t\tmaxBlur = 1.0,\r\n\t\trings = 3,\r\n\t\tsamples = 2,\r\n\t\tshowFocus = false,\r\n\t\tmanualDoF = false,\r\n\t\tpentagon = false\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"RealisticBokehEffect\", fragmentShader$w, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"focus\", new Uniform(focus)],\r\n\t\t\t\t[\"focalLength\", new Uniform(focalLength)],\r\n\t\t\t\t[\"fStop\", new Uniform(fStop)],\r\n\t\t\t\t[\"luminanceThreshold\", new Uniform(luminanceThreshold)],\r\n\t\t\t\t[\"luminanceGain\", new Uniform(luminanceGain)],\r\n\t\t\t\t[\"bias\", new Uniform(bias)],\r\n\t\t\t\t[\"fringe\", new Uniform(fringe)],\r\n\t\t\t\t[\"maxBlur\", new Uniform(maxBlur)],\r\n\t\t\t\t[\"dof\", new Uniform(null)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.rings = rings;\r\n\t\tthis.samples = samples;\r\n\t\tthis.showFocus = showFocus;\r\n\t\tthis.manualDoF = manualDoF;\r\n\t\tthis.pentagon = pentagon;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The amount of blur iterations.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget rings() {\r\n\r\n\t\treturn Number.parseInt(this.defines.get(\"RINGS_INT\"));\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of blur iterations.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset rings(value) {\r\n\r\n\t\tconst r = Math.floor(value);\r\n\t\tthis.defines.set(\"RINGS_INT\", r.toFixed(0));\r\n\t\tthis.defines.set(\"RINGS_FLOAT\", r.toFixed(1));\r\n\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The amount of blur samples per ring.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget samples() {\r\n\r\n\t\treturn Number.parseInt(this.defines.get(\"SAMPLES_INT\"));\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of blur samples per ring.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset samples(value) {\r\n\r\n\t\tconst s = Math.floor(value);\r\n\t\tthis.defines.set(\"SAMPLES_INT\", s.toFixed(0));\r\n\t\tthis.defines.set(\"SAMPLES_FLOAT\", s.toFixed(1));\r\n\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the focal point will be highlighted.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget showFocus() {\r\n\r\n\t\treturn this.defines.has(\"SHOW_FOCUS\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables focal point highlighting.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset showFocus(value) {\r\n\r\n\t\tif(this.showFocus !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"SHOW_FOCUS\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"SHOW_FOCUS\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the Depth of Field should be calculated manually.\r\n\t *\r\n\t * If enabled, the Depth of Field can be adjusted via the `dof` uniform.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget manualDoF() {\r\n\r\n\t\treturn this.defines.has(\"MANUAL_DOF\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables manual Depth of Field.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset manualDoF(value) {\r\n\r\n\t\tif(this.manualDoF !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"MANUAL_DOF\", \"1\");\r\n\t\t\t\tthis.uniforms.get(\"dof\").value = new Vector4(0.2, 1.0, 0.2, 2.0);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"MANUAL_DOF\");\r\n\t\t\t\tthis.uniforms.get(\"dof\").value = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the blur shape should be pentagonal.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget pentagon() {\r\n\r\n\t\treturn this.defines.has(\"PENTAGON\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables pentagonal blur.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset pentagon(value) {\r\n\r\n\t\tif(this.pentagon !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"PENTAGON\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"PENTAGON\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$x = \"uniform float count;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 sl=vec2(sin(uv.y*count),cos(uv.y*count));vec3 scanlines=vec3(sl.x,sl.y,sl.x);outputColor=vec4(scanlines,inputColor.a);}\";\n\n/**\r\n * A scanline effect.\r\n *\r\n * Based on an implementation by Georg 'Leviathan' Steinrohder (CC BY 3.0):\r\n * http://www.truevision3d.com/forums/showcase/staticnoise_colorblackwhite_scanline_shaders-t18698.0.html\r\n */\r\n\r\nclass ScanlineEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new scanline effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.OVERLAY] - The blend function of this effect.\r\n\t * @param {Number} [options.density=1.25] - The scanline density.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.OVERLAY, density = 1.25 } = {}) {\r\n\r\n\t\tsuper(\"ScanlineEffect\", fragmentShader$x, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"count\", new Uniform(0.0)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The original resolution.\r\n\t\t *\r\n\t\t * @type {Vector2}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Vector2$1();\r\n\r\n\t\t/**\r\n\t\t * The amount of scanlines, relative to the screen height.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.density = density;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current scanline density.\r\n\t *\r\n\t * @return {Number} The scanline density.\r\n\t */\r\n\r\n\tgetDensity() {\r\n\r\n\t\treturn this.density;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the scanline density.\r\n\t *\r\n\t * @param {Number} density - The new scanline density.\r\n\t */\r\n\r\n\tsetDensity(density) {\r\n\r\n\t\tthis.density = density;\r\n\t\tthis.setSize(this.resolution.x, this.resolution.y);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of this pass.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.resolution.set(width, height);\r\n\t\tthis.uniforms.get(\"count\").value = Math.round(height * this.density);\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$y = \"uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}\";\n\nvar vertexShader$a = \"uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}\";\n\n/**\r\n * Half PI.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst HALF_PI = Math.PI * 0.5;\r\n\r\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\r\n\r\nconst v$1 = new Vector3();\r\n\r\n/**\r\n * A vector.\r\n *\r\n * @type {Vector3}\r\n * @private\r\n */\r\n\r\nconst ab = new Vector3();\r\n\r\n/**\r\n * A shock wave effect.\r\n *\r\n * Based on a Gist by Jean-Philippe Sarda:\r\n *  https://gist.github.com/jpsarda/33cea67a9f2ecb0a0eda\r\n *\r\n * Warning: This effect cannot be merged with convolution effects.\r\n */\r\n\r\nclass ShockWaveEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new shock wave effect.\r\n\t *\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Vector3} [epicenter] - The world position of the shock wave epicenter.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {Number} [options.speed=2.0] - The animation speed.\r\n\t * @param {Number} [options.maxRadius=1.0] - The extent of the shock wave.\r\n\t * @param {Number} [options.waveSize=0.2] - The wave size.\r\n\t * @param {Number} [options.amplitude=0.05] - The distortion amplitude.\r\n\t */\r\n\r\n\tconstructor(camera, epicenter = new Vector3(), {\r\n\t\tspeed = 2.0,\r\n\t\tmaxRadius = 1.0,\r\n\t\twaveSize = 0.2,\r\n\t\tamplitude = 0.05\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"ShockWaveEffect\", fragmentShader$y, {\r\n\r\n\t\t\tvertexShader: vertexShader$a,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"active\", new Uniform(false)],\r\n\t\t\t\t[\"center\", new Uniform(new Vector2$1(0.5, 0.5))],\r\n\t\t\t\t[\"cameraDistance\", new Uniform(1.0)],\r\n\t\t\t\t[\"size\", new Uniform(1.0)],\r\n\t\t\t\t[\"radius\", new Uniform(-waveSize)],\r\n\t\t\t\t[\"maxRadius\", new Uniform(maxRadius)],\r\n\t\t\t\t[\"waveSize\", new Uniform(waveSize)],\r\n\t\t\t\t[\"amplitude\", new Uniform(amplitude)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * The epicenter.\r\n\t\t *\r\n\t\t * @type {Vector3}\r\n\t\t * @example shockWavePass.epicenter = myMesh.position;\r\n\t\t */\r\n\r\n\t\tthis.epicenter = epicenter;\r\n\r\n\t\t/**\r\n\t\t * The object position in screen space.\r\n\t\t *\r\n\t\t * @type {Vector3}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.screenPosition = this.uniforms.get(\"center\").value;\r\n\r\n\t\t/**\r\n\t\t * The speed of the shock wave animation.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.speed = speed;\r\n\r\n\t\t/**\r\n\t\t * A time accumulator.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.time = 0.0;\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the shock wave animation is active.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.active = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Emits the shock wave.\r\n\t */\r\n\r\n\texplode() {\r\n\r\n\t\tthis.time = 0.0;\r\n\t\tthis.active = true;\r\n\t\tthis.uniforms.get(\"active\").value = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [delta] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, delta) {\r\n\r\n\t\tconst epicenter = this.epicenter;\r\n\t\tconst camera = this.camera;\r\n\t\tconst uniforms = this.uniforms;\r\n\t\tconst uniformActive = uniforms.get(\"active\");\r\n\r\n\t\tif(this.active) {\r\n\r\n\t\t\tconst waveSize = uniforms.get(\"waveSize\").value;\r\n\r\n\t\t\t// Calculate direction vectors.\r\n\t\t\tcamera.getWorldDirection(v$1);\r\n\t\t\tab.copy(camera.position).sub(epicenter);\r\n\r\n\t\t\t// Don't render the effect if the object is behind the camera.\r\n\t\t\tuniformActive.value = (v$1.angleTo(ab) > HALF_PI);\r\n\r\n\t\t\tif(uniformActive.value) {\r\n\r\n\t\t\t\t// Scale the effect based on distance to the object.\r\n\t\t\t\tuniforms.get(\"cameraDistance\").value = camera.position.distanceTo(epicenter);\r\n\r\n\t\t\t\t// Calculate the screen position of the epicenter.\r\n\t\t\t\tv$1.copy(epicenter).project(camera);\r\n\t\t\t\tthis.screenPosition.set((v$1.x + 1.0) * 0.5, (v$1.y + 1.0) * 0.5);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Update the shock wave radius based on time.\r\n\t\t\tthis.time += delta * this.speed;\r\n\t\t\tconst radius = this.time - waveSize;\r\n\t\t\tuniforms.get(\"radius\").value = radius;\r\n\r\n\t\t\tif(radius >= (uniforms.get(\"maxRadius\").value + waveSize) * 2.0) {\r\n\r\n\t\t\t\tthis.active = false;\r\n\t\t\t\tuniformActive.value = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A selective bloom effect.\r\n *\r\n * This effect applies bloom only to selected objects by using layers. Make sure\r\n * to enable the selection layer for all relevant lights:\r\n *\r\n * `lights.forEach((l) => l.layers.enable(bloomEffect.selection.layer));`\r\n *\r\n * Attention: If you don't need to limit bloom to a subset of objects, consider\r\n * using the {@link BloomEffect} instead for better performance.\r\n */\r\n\r\nclass SelectiveBloomEffect extends BloomEffect {\r\n\r\n\t/**\r\n\t * Constructs a new selective bloom effect.\r\n\t *\r\n\t * @param {Scene} scene - The main scene.\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Object} [options] - The options. See {@link BloomEffect} for details.\r\n\t */\r\n\r\n\tconstructor(scene, camera, options) {\r\n\r\n\t\tsuper(options);\r\n\r\n\t\t/**\r\n\t\t * The main scene.\r\n\t\t *\r\n\t\t * @type {Scene}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.scene = scene;\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * A clear pass.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass(true, true, false);\r\n\t\tthis.clearPass.overrideClearColor = new Color(0x000000);\r\n\r\n\t\t/**\r\n\t\t * A render pass.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderPass = new RenderPass(scene, camera);\r\n\t\tthis.renderPass.clear = false;\r\n\r\n\t\t/**\r\n\t\t * A render pass that renders all objects solid black.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.blackoutPass = new RenderPass(scene, camera, new MeshBasicMaterial({ color: 0x000000 }));\r\n\t\tthis.blackoutPass.clear = false;\r\n\r\n\t\t/**\r\n\t\t * A render pass that only renders the background of the main scene.\r\n\t\t *\r\n\t\t * @type {RenderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.backgroundPass = (() => {\r\n\r\n\t\t\tconst backgroundScene = new Scene();\r\n\t\t\tconst pass = new RenderPass(backgroundScene, camera);\r\n\r\n\t\t\tbackgroundScene.background = scene.background;\r\n\t\t\tpass.clear = false;\r\n\r\n\t\t\treturn pass;\r\n\r\n\t\t})();\r\n\r\n\t\t/**\r\n\t\t * A render target.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetSelection = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: true\r\n\t\t});\r\n\r\n\t\tthis.renderTargetSelection.texture.name = \"Bloom.Selection\";\r\n\t\tthis.renderTargetSelection.texture.generateMipmaps = false;\r\n\r\n\t\t/**\r\n\t\t * A selection of objects.\r\n\t\t *\r\n\t\t * @type {Selection}\r\n\t\t */\r\n\r\n\t\tthis.selection = new Selection();\r\n\r\n\t\t/**\r\n\t\t * Indicates whether the selection should be considered inverted.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.inverted = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the scene background should be ignored.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget ignoreBackground() {\r\n\r\n\t\treturn !this.backgroundPass.enabled;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables background rendering.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset ignoreBackground(value) {\r\n\r\n\t\tthis.backgroundPass.enabled = !value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst scene = this.scene;\r\n\t\tconst camera = this.camera;\r\n\t\tconst selection = this.selection;\r\n\t\tconst renderTarget = this.renderTargetSelection;\r\n\r\n\t\tconst background = scene.background;\r\n\t\tconst mask = camera.layers.mask;\r\n\r\n\t\tthis.clearPass.render(renderer, renderTarget);\r\n\r\n\t\tif(!this.ignoreBackground) {\r\n\r\n\t\t\tthis.backgroundPass.render(renderer, renderTarget);\r\n\r\n\t\t}\r\n\r\n\t\tscene.background = null;\r\n\r\n\t\tif(this.inverted) {\r\n\r\n\t\t\tcamera.layers.set(selection.layer);\r\n\t\t\tthis.blackoutPass.render(renderer, renderTarget);\r\n\t\t\tcamera.layers.mask = mask;\r\n\r\n\t\t\tselection.setVisible(false);\r\n\t\t\tthis.renderPass.render(renderer, renderTarget);\r\n\t\t\tselection.setVisible(true);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tselection.setVisible(false);\r\n\t\t\tthis.blackoutPass.render(renderer, renderTarget);\r\n\t\t\tselection.setVisible(true);\r\n\r\n\t\t\tcamera.layers.set(selection.layer);\r\n\t\t\tthis.renderPass.render(renderer, renderTarget);\r\n\t\t\tcamera.layers.mask = mask;\r\n\r\n\t\t}\r\n\r\n\t\tscene.background = background;\r\n\t\tsuper.update(renderer, renderTarget, deltaTime);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tsuper.setSize(width, height);\r\n\r\n\t\tthis.backgroundPass.setSize(width, height);\r\n\t\tthis.blackoutPass.setSize(width, height);\r\n\t\tthis.renderPass.setSize(width, height);\r\n\r\n\t\tthis.renderTargetSelection.setSize(\r\n\t\t\tthis.resolution.width,\r\n\t\t\tthis.resolution.height\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tsuper.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\tthis.backgroundPass.initialize(renderer, alpha, frameBufferType);\r\n\t\tthis.blackoutPass.initialize(renderer, alpha, frameBufferType);\r\n\t\tthis.renderPass.initialize(renderer, alpha, frameBufferType);\r\n\r\n\t\tif(!alpha && frameBufferType === UnsignedByteType) {\r\n\r\n\t\t\tthis.renderTargetSelection.texture.format = RGBFormat;\r\n\r\n\t\t}\r\n\r\n\t\tif(frameBufferType !== undefined) {\r\n\r\n\t\t\tthis.renderTargetSelection.texture.type = frameBufferType;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$z = \"uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,vec3(1.0-0.607*intensity,0.769*intensity,0.189*intensity)),dot(inputColor.rgb,vec3(0.349*intensity,1.0-0.314*intensity,0.168*intensity)),dot(inputColor.rgb,vec3(0.272*intensity,0.534*intensity,1.0-0.869*intensity)));outputColor=vec4(color,inputColor.a);}\";\n\n/**\r\n * A sepia effect.\r\n */\r\n\r\nclass SepiaEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new sepia effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Number} [options.intensity=1.0] - The intensity of the effect.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, intensity = 1.0 } = {}) {\r\n\r\n\t\tsuper(\"SepiaEffect\", fragmentShader$z, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"intensity\", new Uniform(intensity)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\n\n// Generated with SMAASearchImageData.generate().toCanvas().toDataURL(), cropped, high dynamic range.\r\nvar searchImageDataURL = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC\";\n\n// Generated with SMAAAreaImageData.generate().toCanvas().toDataURL().\r\nvar areaImageDataURL = \"data:image/png;base64,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\";\n\nvar fragmentShader$A = \"uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}\";\n\nvar vertexShader$b = \"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}\";\n\n/**\r\n * Subpixel Morphological Antialiasing (SMAA).\r\n *\r\n * https://github.com/iryoku/smaa/releases/tag/v2.8\r\n */\r\n\r\nclass SMAAEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new SMAA effect.\r\n\t *\r\n\t * @param {Image} searchImage - The SMAA search image. Preload this image using the {@link SMAAImageLoader}.\r\n\t * @param {Image} areaImage - The SMAA area image. Preload this image using the {@link SMAAImageLoader}.\r\n\t * @param {SMAAPreset} [preset=SMAAPreset.HIGH] - An SMAA quality preset.\r\n\t * @param {EdgeDetectionMode} [edgeDetectionMode=EdgeDetectionMode.COLOR] - The edge detection mode.\r\n\t */\r\n\r\n\tconstructor(searchImage, areaImage, preset = SMAAPreset.HIGH, edgeDetectionMode = EdgeDetectionMode.COLOR) {\r\n\r\n\t\tsuper(\"SMAAEffect\", fragmentShader$A, {\r\n\r\n\t\t\tvertexShader: vertexShader$b,\r\n\t\t\tblendFunction: BlendFunction.NORMAL,\r\n\t\t\tattributes: EffectAttribute.CONVOLUTION | EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"weightMap\", new Uniform(null)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * A render target for the edge detection.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetEdges = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false,\r\n\t\t\tformat: RGBFormat\r\n\t\t});\r\n\r\n\t\tthis.renderTargetEdges.texture.name = \"SMAA.Edges\";\r\n\r\n\t\t/**\r\n\t\t * A render target for the edge weights.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetWeights = this.renderTargetEdges.clone();\r\n\r\n\t\tthis.renderTargetWeights.texture.name = \"SMAA.Weights\";\r\n\t\tthis.renderTargetWeights.texture.format = RGBAFormat;\r\n\r\n\t\tthis.uniforms.get(\"weightMap\").value = this.renderTargetWeights.texture;\r\n\r\n\t\t/**\r\n\t\t * A clear pass for the edges buffer.\r\n\t\t *\r\n\t\t * @type {ClearPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.clearPass = new ClearPass(true, false, false);\r\n\t\tthis.clearPass.overrideClearColor = new Color(0x000000);\r\n\t\tthis.clearPass.overrideClearAlpha = 1.0;\r\n\r\n\t\t/**\r\n\t\t * An edge detection pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.edgeDetectionPass = new ShaderPass(\r\n\t\t\tnew EdgeDetectionMaterial(new Vector2$1(), edgeDetectionMode)\r\n\t\t);\r\n\r\n\t\t/**\r\n\t\t * An SMAA weights pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.weightsPass = new ShaderPass(new SMAAWeightsMaterial());\r\n\r\n\t\tconst searchTexture = new Texture(searchImage);\r\n\t\tsearchTexture.name = \"SMAA.Search\";\r\n\t\tsearchTexture.magFilter = NearestFilter;\r\n\t\tsearchTexture.minFilter = NearestFilter;\r\n\t\tsearchTexture.format = RGBAFormat;\r\n\t\tsearchTexture.generateMipmaps = false;\r\n\t\tsearchTexture.needsUpdate = true;\r\n\t\tsearchTexture.flipY = true;\r\n\r\n\t\tconst areaTexture = new Texture(areaImage);\r\n\t\tareaTexture.name = \"SMAA.Area\";\r\n\t\tareaTexture.minFilter = LinearFilter;\r\n\t\tareaTexture.format = RGBAFormat;\r\n\t\tareaTexture.generateMipmaps = false;\r\n\t\tareaTexture.needsUpdate = true;\r\n\t\tareaTexture.flipY = false;\r\n\r\n\t\tconst weightsMaterial = this.weightsPass.getFullscreenMaterial();\r\n\t\tweightsMaterial.uniforms.searchTexture.value = searchTexture;\r\n\t\tweightsMaterial.uniforms.areaTexture.value = areaTexture;\r\n\r\n\t\tthis.applyPreset(preset);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The internal edge detection material.\r\n\t *\r\n\t * @type {EdgeDetectionMaterial}\r\n\t */\r\n\r\n\tget edgeDetectionMaterial() {\r\n\r\n\t\treturn this.edgeDetectionPass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The internal edge detection material.\r\n\t *\r\n\t * @type {EdgeDetectionMaterial}\r\n\t * @deprecated Use edgeDetectionMaterial instead.\r\n\t */\r\n\r\n\tget colorEdgesMaterial() {\r\n\r\n\t\treturn this.edgeDetectionMaterial;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The internal edge weights material.\r\n\t *\r\n\t * @type {SMAAWeightsMaterial}\r\n\t */\r\n\r\n\tget weightsMaterial() {\r\n\r\n\t\treturn this.weightsPass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the edge detection sensitivity.\r\n\t *\r\n\t * See {@link EdgeDetectionMaterial#setEdgeDetectionThreshold} for more details.\r\n\t *\r\n\t * @deprecated Use applyPreset or edgeDetectionMaterial instead.\r\n\t * @param {Number} threshold - The edge detection sensitivity. Range: [0.05, 0.5].\r\n\t */\r\n\r\n\tsetEdgeDetectionThreshold(threshold) {\r\n\r\n\t\tthis.edgeDetectionPass.getFullscreenMaterial().setEdgeDetectionThreshold(threshold);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the maximum amount of horizontal/vertical search steps.\r\n\t *\r\n\t * See {@link SMAAWeightsMaterial#setOrthogonalSearchSteps} for more details.\r\n\t *\r\n\t * @deprecated Use applyPreset or weightsMaterial instead.\r\n\t * @param {Number} steps - The search steps. Range: [0, 112].\r\n\t */\r\n\r\n\tsetOrthogonalSearchSteps(steps) {\r\n\r\n\t\tthis.weightsPass.getFullscreenMaterial().setOrthogonalSearchSteps(steps);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies the given quality preset.\r\n\t *\r\n\t * @param {SMAAPreset} preset - The preset.\r\n\t */\r\n\r\n\tapplyPreset(preset) {\r\n\r\n\t\tconst edgeDetectionMaterial = this.edgeDetectionMaterial;\r\n\t\tconst weightsMaterial = this.weightsMaterial;\r\n\r\n\t\tswitch(preset) {\r\n\r\n\t\t\tcase SMAAPreset.LOW:\r\n\t\t\t\tedgeDetectionMaterial.setEdgeDetectionThreshold(0.15);\r\n\t\t\t\tweightsMaterial.setOrthogonalSearchSteps(4);\r\n\t\t\t\tweightsMaterial.diagonalDetection = false;\r\n\t\t\t\tweightsMaterial.cornerRounding = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase SMAAPreset.MEDIUM:\r\n\t\t\t\tedgeDetectionMaterial.setEdgeDetectionThreshold(0.1);\r\n\t\t\t\tweightsMaterial.setOrthogonalSearchSteps(8);\r\n\t\t\t\tweightsMaterial.diagonalDetection = false;\r\n\t\t\t\tweightsMaterial.cornerRounding = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase SMAAPreset.HIGH:\r\n\t\t\t\tedgeDetectionMaterial.setEdgeDetectionThreshold(0.1);\r\n\t\t\t\tweightsMaterial.setOrthogonalSearchSteps(16);\r\n\t\t\t\tweightsMaterial.setDiagonalSearchSteps(8);\r\n\t\t\t\tweightsMaterial.setCornerRounding(25);\r\n\t\t\t\tweightsMaterial.diagonalDetection = true;\r\n\t\t\t\tweightsMaterial.cornerRounding = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase SMAAPreset.ULTRA:\r\n\t\t\t\tedgeDetectionMaterial.setEdgeDetectionThreshold(0.05);\r\n\t\t\t\tweightsMaterial.setOrthogonalSearchSteps(32);\r\n\t\t\t\tweightsMaterial.setDiagonalSearchSteps(16);\r\n\t\t\t\tweightsMaterial.setCornerRounding(25);\r\n\t\t\t\tweightsMaterial.diagonalDetection = true;\r\n\t\t\t\tweightsMaterial.cornerRounding = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.edgeDetectionMaterial;\r\n\t\tmaterial.uniforms.depthBuffer.value = depthTexture;\r\n\t\tmaterial.depthPacking = depthPacking;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tthis.clearPass.render(renderer, this.renderTargetEdges);\r\n\t\tthis.edgeDetectionPass.render(renderer, inputBuffer, this.renderTargetEdges);\r\n\t\tthis.weightsPass.render(renderer, this.renderTargetEdges, this.renderTargetWeights);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst edgeDetectionMaterial = this.edgeDetectionPass.getFullscreenMaterial();\r\n\t\tconst weightsMaterial = this.weightsPass.getFullscreenMaterial();\r\n\r\n\t\tthis.renderTargetEdges.setSize(width, height);\r\n\t\tthis.renderTargetWeights.setSize(width, height);\r\n\r\n\t\tweightsMaterial.uniforms.resolution.value.set(width, height);\r\n\t\tweightsMaterial.uniforms.texelSize.value.set(1.0 / width, 1.0 / height);\r\n\t\tedgeDetectionMaterial.uniforms.texelSize.value.copy(weightsMaterial.uniforms.texelSize.value);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes internal render targets and textures.\r\n\t */\r\n\r\n\tdispose() {\r\n\r\n\t\tconst uniforms = this.weightsPass.getFullscreenMaterial().uniforms;\r\n\t\tuniforms.searchTexture.value.dispose();\r\n\t\tuniforms.areaTexture.value.dispose();\r\n\r\n\t\tsuper.dispose();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The SMAA search image, encoded as a base64 data URL.\r\n\t *\r\n\t * Use this image data to create an Image instance and use it together with\r\n\t * the area image to create an {@link SMAAEffect}.\r\n\t *\r\n\t * @type {String}\r\n\t * @deprecated Use SMAAImageLoader instead.\r\n\t * @example\r\n\t * const searchImage = new Image();\r\n\t * searchImage.addEventListener(\"load\", progress);\r\n\t * searchImage.src = SMAAEffect.searchImageDataURL;\r\n\t */\r\n\r\n\tstatic get searchImageDataURL() {\r\n\r\n\t\treturn searchImageDataURL;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The SMAA area image, encoded as a base64 data URL.\r\n\t *\r\n\t * Use this image data to create an Image instance and use it together with\r\n\t * the search image to create an {@link SMAAEffect}.\r\n\t *\r\n\t * @type {String}\r\n\t * @deprecated Use SMAAImageLoader instead.\r\n\t * @example\r\n\t * const areaImage = new Image();\r\n\t * areaImage.addEventListener(\"load\", progress);\r\n\t * areaImage.src = SMAAEffect.areaImageDataURL;\r\n\t */\r\n\r\n\tstatic get areaImageDataURL() {\r\n\r\n\t\treturn areaImageDataURL;\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An enumeration of SMAA presets.\r\n *\r\n * @type {Object}\r\n * @property {Number} LOW - Results in around 60% of the maximum quality.\r\n * @property {Number} MEDIUM - Results in around 80% of the maximum quality.\r\n * @property {Number} HIGH - Results in around 95% of the maximum quality.\r\n * @property {Number} ULTRA - Results in around 99% of the maximum quality.\r\n */\r\n\r\nconst SMAAPreset = {\r\n\r\n\tLOW: 0,\r\n\tMEDIUM: 1,\r\n\tHIGH: 2,\r\n\tULTRA: 3\r\n\r\n};\n\nvar fragmentShader$B = \"uniform sampler2D aoBuffer;uniform float luminanceInfluence;\\n#ifdef DEPTH_AWARE_UPSAMPLING\\n#ifdef GL_FRAGMENT_PRECISION_HIGH\\nuniform highp sampler2D normalDepthBuffer;\\n#else\\nuniform mediump sampler2D normalDepthBuffer;\\n#endif\\n#endif\\n#ifdef COLORIZE\\nuniform vec3 color;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){float aoLinear=texture2D(aoBuffer,uv).r;\\n#if defined(DEPTH_AWARE_UPSAMPLING) && __VERSION__ == 300\\nvec4 normalDepth[4]=vec4[](textureOffset(normalDepthBuffer,uv,ivec2(0,0)),textureOffset(normalDepthBuffer,uv,ivec2(0,1)),textureOffset(normalDepthBuffer,uv,ivec2(1,0)),textureOffset(normalDepthBuffer,uv,ivec2(1,1)));float dot01=dot(normalDepth[0].rgb,normalDepth[1].rgb);float dot02=dot(normalDepth[0].rgb,normalDepth[2].rgb);float dot03=dot(normalDepth[0].rgb,normalDepth[3].rgb);float minDot=min(dot01,min(dot02,dot03));float s=step(THRESHOLD,minDot);float smallestDistance=1.0;int index;for(int i=0;i<4;++i){float distance=abs(depth-normalDepth[i].a);if(distance<smallestDistance){smallestDistance=distance;index=i;}}ivec2 offsets[4]=ivec2[](ivec2(0,0),ivec2(0,1),ivec2(1,0),ivec2(1,1));ivec2 coord=ivec2(uv*vec2(textureSize(aoBuffer,0)))+offsets[index];float aoNearest=texelFetch(aoBuffer,coord,0).r;float ao=mix(aoNearest,aoLinear,s);\\n#else\\nfloat ao=aoLinear;\\n#endif\\nfloat l=linearToRelativeLuminance(inputColor.rgb);ao=mix(ao,1.0,l*luminanceInfluence);\\n#ifdef COLORIZE\\noutputColor=vec4(1.0-(1.0-ao)*(1.0-color),inputColor.a);\\n#else\\noutputColor=vec4(vec3(ao),inputColor.a);\\n#endif\\n}\";\n\n/**\r\n * The size of the generated noise texture.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst NOISE_TEXTURE_SIZE = 64;\r\n\r\n/**\r\n * A Screen Space Ambient Occlusion (SSAO) effect.\r\n *\r\n * For high quality visuals use two SSAO effect instances in a row with\r\n * different radii, one for rough AO and one for fine details.\r\n *\r\n * This effect supports depth-aware upsampling and should be rendered at a lower\r\n * resolution. The resolution should match that of the downsampled normals and\r\n * depth. If you intend to render SSAO at full resolution, do not provide a\r\n * downsampled `normalDepthBuffer` and make sure to disable\r\n * `depthAwareUpsampling`.\r\n *\r\n * It's recommended to specify a relative render resolution using the\r\n * `resolutionScale` constructor parameter to avoid undesired sampling patterns.\r\n *\r\n * Based on \"Scalable Ambient Obscurance\" by Morgan McGuire et al. and\r\n * \"Depth-aware upsampling experiments\" by Eleni Maria Stea:\r\n * https://research.nvidia.com/publication/scalable-ambient-obscurance\r\n * https://eleni.mutantstargoat.com/hikiko/on-depth-aware-upsampling\r\n */\r\n\r\nclass SSAOEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new SSAO effect.\r\n\t *\r\n\t * @todo Move normalBuffer to options.\r\n\t * @param {Camera} camera - The main camera.\r\n\t * @param {Texture} normalBuffer - A texture that contains the scene normals. May be null if a normalDepthBuffer is provided. See {@link NormalPass}.\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.MULTIPLY] - The blend function of this effect.\r\n\t * @param {Boolean} [options.distanceScaling=true] - Enables or disables distance-based radius scaling.\r\n\t * @param {Boolean} [options.depthAwareUpsampling=true] - Enables or disables depth-aware upsampling. Has no effect if WebGL 2 is not supported.\r\n\t * @param {Texture} [options.normalDepthBuffer=null] - A texture that contains downsampled scene normals and depth. See {@link DepthDownsamplingPass}.\r\n\t * @param {Number} [options.samples=9] - The amount of samples per pixel. Should not be a multiple of the ring count.\r\n\t * @param {Number} [options.rings=7] - The amount of spiral turns in the occlusion sampling pattern. Should be a prime number.\r\n\t * @param {Number} [options.distanceThreshold=0.97] - A global distance threshold at which the occlusion effect starts to fade out. Range [0.0, 1.0].\r\n\t * @param {Number} [options.distanceFalloff=0.03] - The distance falloff. Influences the smoothness of the overall occlusion cutoff. Range [0.0, 1.0].\r\n\t * @param {Number} [options.rangeThreshold=0.0005] - A local occlusion range threshold at which the occlusion starts to fade out. Range [0.0, 1.0].\r\n\t * @param {Number} [options.rangeFalloff=0.001] - The occlusion range falloff. Influences the smoothness of the proximity cutoff. Range [0.0, 1.0].\r\n\t * @param {Number} [options.minRadiusScale=0.33] - The minimum radius scale. Has no effect if distance scaling is disabled.\r\n\t * @param {Number} [options.luminanceInfluence=0.7] - Determines how much the luminance of the scene influences the ambient occlusion.\r\n\t * @param {Number} [options.radius=0.1825] - The occlusion sampling radius, expressed as a resolution independent scale. Range [1e-6, 1.0].\r\n\t * @param {Number} [options.intensity=1.0] - The intensity of the ambient occlusion.\r\n\t * @param {Number} [options.bias=0.025] - An occlusion bias. Eliminates artifacts caused by depth discontinuities.\r\n\t * @param {Number} [options.fade=0.01] - Influences the smoothness of the shadows. A lower value results in higher contrast.\r\n\t * @param {Color} [options.color=null] - The color of the ambient occlusion.\r\n\t * @param {Number} [options.resolutionScale=1.0] - The resolution scale.\r\n\t * @param {Number} [options.width=Resizer.AUTO_SIZE] - The render width.\r\n\t * @param {Number} [options.height=Resizer.AUTO_SIZE] - The render height.\r\n\t */\r\n\r\n\tconstructor(camera, normalBuffer, {\r\n\t\tblendFunction = BlendFunction.MULTIPLY,\r\n\t\tdistanceScaling = true,\r\n\t\tdepthAwareUpsampling = true,\r\n\t\tnormalDepthBuffer = null,\r\n\t\tsamples = 9,\r\n\t\trings = 7,\r\n\t\tdistanceThreshold = 0.97,\r\n\t\tdistanceFalloff = 0.03,\r\n\t\trangeThreshold = 0.0005,\r\n\t\trangeFalloff = 0.001,\r\n\t\tminRadiusScale = 0.33,\r\n\t\tluminanceInfluence = 0.7,\r\n\t\tradius = 0.1825,\r\n\t\tintensity = 1.0,\r\n\t\tbias = 0.025,\r\n\t\tfade = 0.01,\r\n\t\tcolor = null,\r\n\t\tresolutionScale = 1.0,\r\n\t\twidth = Resizer.AUTO_SIZE,\r\n\t\theight = Resizer.AUTO_SIZE\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"SSAOEffect\", fragmentShader$B, {\r\n\r\n\t\t\tblendFunction,\r\n\t\t\tattributes: EffectAttribute.DEPTH,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"aoBuffer\", new Uniform(null)],\r\n\t\t\t\t[\"normalDepthBuffer\", new Uniform(null)],\r\n\t\t\t\t[\"luminanceInfluence\", new Uniform(luminanceInfluence)],\r\n\t\t\t\t[\"color\", new Uniform(null)],\r\n\t\t\t\t[\"scale\", new Uniform(0.0)] // Unused.\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * A render target for the ambient occlusion shadows.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetAO = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false,\r\n\t\t\tformat: RGBFormat\r\n\t\t});\r\n\r\n\t\tthis.renderTargetAO.texture.name = \"AO.Target\";\r\n\t\tthis.renderTargetAO.texture.generateMipmaps = false;\r\n\r\n\t\tthis.uniforms.get(\"aoBuffer\").value = this.renderTargetAO.texture;\r\n\r\n\t\t/**\r\n\t\t * The resolution of this effect.\r\n\t\t *\r\n\t\t * @type {Resizer}\r\n\t\t */\r\n\r\n\t\tthis.resolution = new Resizer(this, width, height, resolutionScale);\r\n\r\n\t\t/**\r\n\t\t * The current radius relative to the render height.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.r = 1.0;\r\n\r\n\t\t/**\r\n\t\t * The main camera.\r\n\t\t *\r\n\t\t * @type {Camera}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\t/**\r\n\t\t * An SSAO pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.ssaoPass = new ShaderPass((() => {\r\n\r\n\t\t\tconst noiseTexture = new NoiseTexture(NOISE_TEXTURE_SIZE, NOISE_TEXTURE_SIZE);\r\n\t\t\tnoiseTexture.wrapS = noiseTexture.wrapT = RepeatWrapping;\r\n\r\n\t\t\tconst material = new SSAOMaterial(camera);\r\n\t\t\tmaterial.uniforms.noiseTexture.value = noiseTexture;\r\n\t\t\tmaterial.uniforms.intensity.value = intensity;\r\n\t\t\tmaterial.uniforms.minRadiusScale.value = minRadiusScale;\r\n\t\t\tmaterial.uniforms.fade.value = fade;\r\n\t\t\tmaterial.uniforms.bias.value = bias;\r\n\r\n\t\t\tif(normalDepthBuffer !== null) {\r\n\r\n\t\t\t\tmaterial.uniforms.normalDepthBuffer.value = normalDepthBuffer;\r\n\t\t\t\tmaterial.defines.NORMAL_DEPTH = \"1\";\r\n\r\n\t\t\t\tif(depthAwareUpsampling) {\r\n\r\n\t\t\t\t\tthis.depthAwareUpsampling = depthAwareUpsampling;\r\n\t\t\t\t\tthis.uniforms.get(\"normalDepthBuffer\").value = normalDepthBuffer;\r\n\t\t\t\t\tthis.defines.set(\"THRESHOLD\", \"0.997\");\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaterial.uniforms.normalBuffer.value = normalBuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t})());\r\n\r\n\t\tthis.distanceScaling = distanceScaling;\r\n\t\tthis.samples = samples;\r\n\t\tthis.rings = rings;\r\n\t\tthis.color = color;\r\n\r\n\t\t// @todo Special case treatment added for backwards-compatibility.\r\n\t\tthis.radius = (radius > 1.0) ? (radius / 100.0) : radius;\r\n\r\n\t\tthis.setDistanceCutoff(distanceThreshold, distanceFalloff);\r\n\t\tthis.setProximityCutoff(rangeThreshold, rangeFalloff);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The SSAO material.\r\n\t *\r\n\t * @type {SSAOMaterial}\r\n\t */\r\n\r\n\tget ssaoMaterial() {\r\n\r\n\t\treturn this.ssaoPass.getFullscreenMaterial();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The amount of occlusion samples per pixel.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget samples() {\r\n\r\n\t\treturn Number(this.ssaoMaterial.defines.SAMPLES_INT);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of occlusion samples per pixel.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset samples(value) {\r\n\r\n\t\tconst material = this.ssaoMaterial;\r\n\t\tmaterial.defines.SAMPLES_INT = value.toFixed(0);\r\n\t\tmaterial.defines.SAMPLES_FLOAT = value.toFixed(1);\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The amount of spiral turns in the occlusion sampling pattern.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget rings() {\r\n\r\n\t\treturn Number(this.ssaoMaterial.defines.SPIRAL_TURNS);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the amount of spiral turns in the occlusion sampling pattern.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset rings(value) {\r\n\r\n\t\tconst material = this.ssaoMaterial;\r\n\t\tmaterial.defines.SPIRAL_TURNS = value.toFixed(1);\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The occlusion sampling radius.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget radius() {\r\n\r\n\t\treturn this.r;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the occlusion sampling radius. Range [1e-6, 1.0].\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset radius(value) {\r\n\r\n\t\tthis.r = Math.min(Math.max(value, 1e-6), 1.0);\r\n\r\n\t\tconst radius = this.r * this.resolution.height;\r\n\t\tconst material = this.ssaoMaterial;\r\n\t\tmaterial.defines.RADIUS = radius.toFixed(11);\r\n\t\tmaterial.defines.RADIUS_SQ = (radius * radius).toFixed(11);\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether depth-aware upsampling is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget depthAwareUpsampling() {\r\n\r\n\t\treturn this.defines.has(\"DEPTH_AWARE_UPSAMPLING\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables depth-aware upsampling.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset depthAwareUpsampling(value) {\r\n\r\n\t\tif(this.depthAwareUpsampling !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"DEPTH_AWARE_UPSAMPLING\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"DEPTH_AWARE_UPSAMPLING\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether distance-based radius scaling is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget distanceScaling() {\r\n\r\n\t\treturn (this.ssaoMaterial.defines.DISTANCE_SCALING !== undefined);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables distance-based radius scaling.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset distanceScaling(value) {\r\n\r\n\t\tif(this.distanceScaling !== value) {\r\n\r\n\t\t\tconst material = this.ssaoMaterial;\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tmaterial.defines.DISTANCE_SCALING = \"1\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdelete material.defines.DISTANCE_SCALING;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The color of the ambient occlusion.\r\n\t *\r\n\t * @type {Color}\r\n\t */\r\n\r\n\tget color() {\r\n\r\n\t\treturn this.uniforms.get(\"color\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the color of the ambient occlusion.\r\n\t *\r\n\t * Set to `null` to disable colorization.\r\n\t *\r\n\t * @type {Color}\r\n\t */\r\n\r\n\tset color(value) {\r\n\r\n\t\tconst uniforms = this.uniforms;\r\n\t\tconst defines = this.defines;\r\n\r\n\t\tif(value !== null) {\r\n\r\n\t\t\tif(defines.has(\"COLORIZE\")) {\r\n\r\n\t\t\t\tuniforms.get(\"color\").value.set(value);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdefines.set(\"COLORIZE\", \"1\");\r\n\t\t\t\tuniforms.get(\"color\").value = new Color(value);\r\n\t\t\t\tthis.setChanged();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if(defines.has(\"COLORIZE\")) {\r\n\r\n\t\t\tdefines.delete(\"COLORIZE\");\r\n\t\t\tuniforms.get(\"color\").value = null;\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the occlusion distance cutoff.\r\n\t *\r\n\t * @param {Number} threshold - The distance threshold. Range [0.0, 1.0].\r\n\t * @param {Number} falloff - The falloff. Range [0.0, 1.0].\r\n\t */\r\n\r\n\tsetDistanceCutoff(threshold, falloff) {\r\n\r\n\t\tthis.ssaoMaterial.uniforms.distanceCutoff.value.set(\r\n\t\t\tMath.min(Math.max(threshold, 0.0), 1.0),\r\n\t\t\tMath.min(Math.max(threshold + falloff, 0.0), 1.0)\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the occlusion proximity cutoff.\r\n\t *\r\n\t * @param {Number} threshold - The range threshold. Range [0.0, 1.0].\r\n\t * @param {Number} falloff - The falloff. Range [0.0, 1.0].\r\n\t */\r\n\r\n\tsetProximityCutoff(threshold, falloff) {\r\n\r\n\t\tthis.ssaoMaterial.uniforms.proximityCutoff.value.set(\r\n\t\t\tMath.min(Math.max(threshold, 0.0), 1.0),\r\n\t\t\tMath.min(Math.max(threshold + falloff, 0.0), 1.0)\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the depth texture.\r\n\t *\r\n\t * @param {Texture} depthTexture - A depth texture.\r\n\t * @param {Number} [depthPacking=0] - The depth packing.\r\n\t */\r\n\r\n\tsetDepthTexture(depthTexture, depthPacking = 0) {\r\n\r\n\t\tconst material = this.ssaoMaterial;\r\n\r\n\t\tif(material.defines.NORMAL_DEPTH === undefined) {\r\n\r\n\t\t\tmaterial.uniforms.normalDepthBuffer.value = depthTexture;\r\n\t\t\tmaterial.depthPacking = depthPacking;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tthis.ssaoPass.render(renderer, null, this.renderTargetAO);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the camera projection matrix uniforms and the size of internal\r\n\t * render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tconst resolution = this.resolution;\r\n\t\tresolution.base.set(width, height);\r\n\r\n\t\tconst w = resolution.width;\r\n\t\tconst h = resolution.height;\r\n\r\n\t\tthis.renderTargetAO.setSize(w, h);\r\n\t\tthis.ssaoMaterial.setTexelSize(1.0 / w, 1.0 / h);\r\n\r\n\t\tconst camera = this.camera;\r\n\t\tconst uniforms = this.ssaoMaterial.uniforms;\r\n\t\tuniforms.noiseScale.value.set(w, h).divideScalar(NOISE_TEXTURE_SIZE);\r\n\t\tuniforms.inverseProjectionMatrix.value.getInverse(camera.projectionMatrix);\r\n\t\tuniforms.projectionMatrix.value.copy(camera.projectionMatrix);\r\n\r\n\t\t// Update the absolute radius.\r\n\t\tthis.radius = this.r;\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$C = \"uniform sampler2D texture;\\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\\nvarying vec2 vUv2;\\n#endif\\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){\\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\\nvec4 texel=texelToLinear(texture2D(texture,vUv2));\\n#else\\nvec4 texel=texelToLinear(texture2D(texture,uv));\\n#endif\\noutputColor=TEXEL;}\";\n\nvar vertexShader$c = \"#ifdef ASPECT_CORRECTION\\nuniform float scale;\\n#else\\nuniform mat3 uvTransform;\\n#endif\\nvarying vec2 vUv2;void mainSupport(const in vec2 uv){\\n#ifdef ASPECT_CORRECTION\\nvUv2=uv*vec2(aspect,1.0)*scale;\\n#else\\nvUv2=(uvTransform*vec3(uv,1.0)).xy;\\n#endif\\n}\";\n\n/**\r\n * A texture effect.\r\n */\r\n\r\nclass TextureEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new texture effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Texture} [options.texture] - A texture.\r\n\t * @param {Boolean} [options.aspectCorrection=false] - Deprecated. Enable uvTransform instead and adjust the texture's offset, repeat and center.\r\n\t */\r\n\r\n\tconstructor({ blendFunction = BlendFunction.NORMAL, texture = null, aspectCorrection = false } = {}) {\r\n\r\n\t\tsuper(\"TextureEffect\", fragmentShader$C, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tdefines: new Map([\r\n\t\t\t\t[\"TEXEL\", \"texel\"]\r\n\t\t\t]),\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"texture\", new Uniform(null)],\r\n\t\t\t\t[\"scale\", new Uniform(1.0)],\r\n\t\t\t\t[\"uvTransform\", new Uniform(null)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.texture = texture;\r\n\t\tthis.aspectCorrection = aspectCorrection;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tget texture() {\r\n\r\n\t\treturn this.uniforms.get(\"texture\").value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the texture.\r\n\t *\r\n\t * @type {Texture}\r\n\t */\r\n\r\n\tset texture(value) {\r\n\r\n\t\tconst currentTexture = this.texture;\r\n\r\n\t\tif(currentTexture !== value) {\r\n\r\n\t\t\tconst previousEncoding = (currentTexture !== null) ? currentTexture.encoding : null;\r\n\t\t\tthis.uniforms.get(\"texture\").value = value;\r\n\r\n\t\t\tif(value !== null) {\r\n\r\n\t\t\t\tif(value.encoding === sRGBEncoding) {\r\n\r\n\t\t\t\t\tthis.defines.set(\"texelToLinear(texel)\", \"sRGBToLinear(texel)\");\r\n\r\n\t\t\t\t} else if(value.encoding === LinearEncoding) {\r\n\r\n\t\t\t\t\tthis.defines.set(\"texelToLinear(texel)\", \"texel\");\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.log(\"Unsupported encoding: \" + value.encoding);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(previousEncoding !== value.encoding) {\r\n\r\n\t\t\t\t\tthis.setChanged();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether aspect correction is enabled.\r\n\t *\r\n\t * If enabled, the texture can be scaled using the `scale` uniform.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use uvTransform instead for full control over the texture coordinates.\r\n\t */\r\n\r\n\tget aspectCorrection() {\r\n\r\n\t\treturn this.defines.has(\"ASPECT_CORRECTION\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables aspect correction.\r\n\t *\r\n\t * @type {Number}\r\n\t * @deprecated Use uvTransform instead for full control over the texture coordinates.\r\n\t */\r\n\r\n\tset aspectCorrection(value) {\r\n\r\n\t\tif(this.aspectCorrection !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tif(this.uvTransform) {\r\n\r\n\t\t\t\t\tthis.uvTransform = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.defines.set(\"ASPECT_CORRECTION\", \"1\");\r\n\t\t\t\tthis.setVertexShader(vertexShader$c);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"ASPECT_CORRECTION\");\r\n\t\t\t\tthis.setVertexShader(null);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether the texture UV coordinates will be transformed using the\r\n\t * transformation matrix of the texture.\r\n\t *\r\n\t * Cannot be used if aspect correction is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget uvTransform() {\r\n\r\n\t\treturn this.defines.has(\"UV_TRANSFORM\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables texture UV transformation.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset uvTransform(value) {\r\n\r\n\t\tif(this.uvTransform !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tif(this.aspectCorrection) {\r\n\r\n\t\t\t\t\tthis.aspectCorrection = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.defines.set(\"UV_TRANSFORM\", \"1\");\r\n\t\t\t\tthis.uniforms.get(\"uvTransform\").value = new Matrix3();\r\n\t\t\t\tthis.setVertexShader(vertexShader$c);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"UV_TRANSFORM\");\r\n\t\t\t\tthis.uniforms.get(\"uvTransform\").value = null;\r\n\t\t\t\tthis.setVertexShader(null);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the swizzles that will be applied to the `r`, `g`, `b`, and `a`\r\n\t * components of a texel before it is written to the output color.\r\n\t *\r\n\t * @param {ColorChannel} r - The swizzle for the `r` component.\r\n\t * @param {ColorChannel} [g=r] - The swizzle for the `g` component.\r\n\t * @param {ColorChannel} [b=r] - The swizzle for the `b` component.\r\n\t * @param {ColorChannel} [a=r] - The swizzle for the `a` component.\r\n\t */\r\n\r\n\tsetTextureSwizzleRGBA(r, g = r, b = r, a = r) {\r\n\r\n\t\tconst rgba = \"rgba\";\r\n\t\tlet swizzle = \"\";\r\n\r\n\t\tif(r !== ColorChannel.RED || g !== ColorChannel.GREEN ||\r\n\t\t\tb !== ColorChannel.BLUE || a !== ColorChannel.ALPHA) {\r\n\r\n\t\t\tswizzle = [\".\", rgba[r], rgba[g], rgba[b], rgba[a]].join(\"\");\r\n\r\n\t\t}\r\n\r\n\t\tthis.defines.set(\"TEXEL\", \"texel\" + swizzle);\r\n\t\tthis.setChanged();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tconst texture = this.uniforms.get(\"texture\").value;\r\n\r\n\t\tif(this.uvTransform && texture.matrixAutoUpdate) {\r\n\r\n\t\t\ttexture.updateMatrix();\r\n\t\t\tthis.uniforms.get(\"uvTransform\").value.copy(texture.matrix);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$D = \"uniform sampler2D luminanceMap;uniform float middleGrey;uniform float maxLuminance;uniform float averageLuminance;vec3 toneMap(vec3 c){\\n#ifdef ADAPTED_LUMINANCE\\nfloat lumAvg=texture2D(luminanceMap,vec2(0.5)).r;\\n#else\\nfloat lumAvg=averageLuminance;\\n#endif\\nfloat lumPixel=linearToRelativeLuminance(c);float lumScaled=(lumPixel*middleGrey)/lumAvg;float lumCompressed=(lumScaled*(1.0+(lumScaled/(maxLuminance*maxLuminance))))/(1.0+lumScaled);return lumCompressed*c;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(toneMap(inputColor.rgb),inputColor.a);}\";\n\n/**\r\n * A tone mapping effect that supports adaptive luminosity.\r\n *\r\n * If adaptivity is enabled, this effect generates a texture that represents the\r\n * luminosity of the current scene and adjusts it over time to simulate the\r\n * optic nerve responding to the amount of light it is receiving.\r\n *\r\n * Reference:\r\n *  GDC2007 - Wolfgang Engel, Post-Processing Pipeline\r\n *  http://perso.univ-lyon1.fr/jean-claude.iehl/Public/educ/GAMA/2007/gdc07/Post-Processing_Pipeline.pdf\r\n */\r\n\r\nclass ToneMappingEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new tone mapping effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Boolean} [options.adaptive=true] - Whether the tone mapping should use an adaptive luminance map.\r\n\t * @param {Number} [options.resolution=256] - The render texture resolution of the luminance map.\r\n\t * @param {Number} [options.middleGrey=0.6] - The middle grey factor.\r\n\t * @param {Number} [options.maxLuminance=16.0] - The maximum luminance.\r\n\t * @param {Number} [options.averageLuminance=1.0] - The average luminance.\r\n\t * @param {Number} [options.adaptationRate=1.0] - The luminance adaptation rate.\r\n\t */\r\n\r\n\tconstructor({\r\n\t\tblendFunction = BlendFunction.NORMAL,\r\n\t\tadaptive = true,\r\n\t\tresolution = 256,\r\n\t\tmiddleGrey = 0.6,\r\n\t\tmaxLuminance = 16.0,\r\n\t\taverageLuminance = 1.0,\r\n\t\tadaptationRate = 2.0\r\n\t} = {}) {\r\n\r\n\t\tsuper(\"ToneMappingEffect\", fragmentShader$D, {\r\n\r\n\t\t\tblendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"luminanceMap\", new Uniform(null)],\r\n\t\t\t\t[\"middleGrey\", new Uniform(middleGrey)],\r\n\t\t\t\t[\"maxLuminance\", new Uniform(maxLuminance)],\r\n\t\t\t\t[\"averageLuminance\", new Uniform(averageLuminance)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * The render target for the current luminance.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t * @todo Remove LinearMipMapLinearFilter in next major release.\r\n\t\t */\r\n\r\n\t\tthis.renderTargetLuminance = new WebGLRenderTarget(1, 1, {\r\n\t\t\tminFilter: (LinearMipmapLinearFilter !== undefined) ? LinearMipmapLinearFilter : LinearMipMapLinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false,\r\n\t\t\tformat: RGBFormat\r\n\t\t});\r\n\r\n\t\tthis.renderTargetLuminance.texture.name = \"ToneMapping.Luminance\";\r\n\t\tthis.renderTargetLuminance.texture.generateMipmaps = true;\r\n\r\n\t\t/**\r\n\t\t * The render target for adapted luminance.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetAdapted = this.renderTargetLuminance.clone();\r\n\t\tthis.renderTargetAdapted.texture.name = \"ToneMapping.AdaptedLuminance\";\r\n\t\tthis.renderTargetAdapted.texture.generateMipmaps = false;\r\n\t\tthis.renderTargetAdapted.texture.minFilter = LinearFilter;\r\n\r\n\t\t/**\r\n\t\t * A render target that holds a copy of the adapted luminance.\r\n\t\t *\r\n\t\t * @type {WebGLRenderTarget}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.renderTargetPrevious = this.renderTargetAdapted.clone();\r\n\t\tthis.renderTargetPrevious.texture.name = \"ToneMapping.PreviousLuminance\";\r\n\r\n\t\t/**\r\n\t\t * A save pass.\r\n\t\t *\r\n\t\t * @type {SavePass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.savePass = new SavePass(this.renderTargetPrevious, false);\r\n\r\n\t\t/**\r\n\t\t * A luminance shader pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.luminancePass = new ShaderPass(new LuminanceMaterial());\r\n\r\n\t\tconst luminanceMaterial = this.luminancePass.getFullscreenMaterial();\r\n\t\tluminanceMaterial.useThreshold = false;\r\n\r\n\t\t/**\r\n\t\t * An adaptive luminance shader pass.\r\n\t\t *\r\n\t\t * @type {ShaderPass}\r\n\t\t * @private\r\n\t\t */\r\n\r\n\t\tthis.adaptiveLuminancePass = new ShaderPass(new AdaptiveLuminanceMaterial());\r\n\r\n\t\tconst uniforms = this.adaptiveLuminancePass.getFullscreenMaterial().uniforms;\r\n\t\tuniforms.previousLuminanceBuffer.value = this.renderTargetPrevious.texture;\r\n\t\tuniforms.currentLuminanceBuffer.value = this.renderTargetLuminance.texture;\r\n\r\n\t\tthis.adaptationRate = adaptationRate;\r\n\t\tthis.resolution = resolution;\r\n\t\tthis.adaptive = adaptive;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The resolution of the render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget resolution() {\r\n\r\n\t\treturn this.renderTargetLuminance.width;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the resolution of the internal render targets.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset resolution(value) {\r\n\r\n\t\t// Round the given value to the next power of two.\r\n\t\tconst exponent = Math.max(0, Math.ceil(Math.log2(value)));\r\n\t\tconst size = Math.pow(2, exponent);\r\n\r\n\t\tthis.renderTargetLuminance.setSize(size, size);\r\n\t\tthis.renderTargetPrevious.setSize(size, size);\r\n\t\tthis.renderTargetAdapted.setSize(size, size);\r\n\r\n\t\tconst material = this.adaptiveLuminancePass.getFullscreenMaterial();\r\n\t\tmaterial.defines.MIP_LEVEL_1X1 = exponent.toFixed(1);\r\n\t\tmaterial.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether this pass uses adaptive luminance.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget adaptive() {\r\n\r\n\t\treturn this.defines.has(\"ADAPTED_LUMINANCE\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables adaptive luminance.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset adaptive(value) {\r\n\r\n\t\tif(this.adaptive !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"ADAPTED_LUMINANCE\", \"1\");\r\n\t\t\t\tthis.uniforms.get(\"luminanceMap\").value = this.renderTargetAdapted.texture;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"ADAPTED_LUMINANCE\");\r\n\t\t\t\tthis.uniforms.get(\"luminanceMap\").value = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The luminance adaptation rate.\r\n\t *\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tget adaptationRate() {\r\n\r\n\t\treturn this.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t */\r\n\r\n\tset adaptationRate(value) {\r\n\r\n\t\tthis.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value = value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated\r\n\t */\r\n\r\n\tget distinction() {\r\n\r\n\t\tconsole.warn(this.name, \"The distinction field has been removed.\");\r\n\r\n\t\treturn 1.0;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @type {Number}\r\n\t * @deprecated\r\n\t */\r\n\r\n\tset distinction(value) {\r\n\r\n\t\tconsole.warn(this.name, \"The distinction field has been removed.\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates this effect.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {WebGLRenderTarget} inputBuffer - A frame buffer that contains the result of the previous pass.\r\n\t * @param {Number} [deltaTime] - The time between the last frame and the current one in seconds.\r\n\t */\r\n\r\n\tupdate(renderer, inputBuffer, deltaTime) {\r\n\r\n\t\tif(this.adaptive) {\r\n\r\n\t\t\t// Render the luminance of the current scene into a mipmap render target.\r\n\t\t\tthis.luminancePass.render(renderer, inputBuffer, this.renderTargetLuminance);\r\n\r\n\t\t\t// Use the frame delta to adapt the luminance over time.\r\n\t\t\tconst uniforms = this.adaptiveLuminancePass.getFullscreenMaterial().uniforms;\r\n\t\t\tuniforms.deltaTime.value = deltaTime;\r\n\t\t\tthis.adaptiveLuminancePass.render(renderer, null, this.renderTargetAdapted);\r\n\r\n\t\t\t// Save the adapted luminance for the next frame.\r\n\t\t\tthis.savePass.render(renderer, this.renderTargetAdapted);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the size of internal render targets.\r\n\t *\r\n\t * @param {Number} width - The width.\r\n\t * @param {Number} height - The height.\r\n\t */\r\n\r\n\tsetSize(width, height) {\r\n\r\n\t\tthis.savePass.setSize(width, height);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Performs initialization tasks.\r\n\t *\r\n\t * @param {WebGLRenderer} renderer - The renderer.\r\n\t * @param {Boolean} alpha - Whether the renderer uses the alpha channel or not.\r\n\t * @param {Number} frameBufferType - The type of the main frame buffers.\r\n\t */\r\n\r\n\tinitialize(renderer, alpha, frameBufferType) {\r\n\r\n\t\tconst clearPass = new ClearPass(true, false, false);\r\n\t\tclearPass.overrideClearColor = new Color(0x7fffff);\r\n\t\tclearPass.render(renderer, this.renderTargetPrevious);\r\n\t\tclearPass.dispose();\r\n\r\n\t}\r\n\r\n}\n\nvar fragmentShader$E = \"uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\\n#ifdef ESKIL\\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\\n#else\\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\\n#endif\\noutputColor=vec4(color,inputColor.a);}\";\n\n/**\r\n * A vignette effect.\r\n */\r\n\r\nclass VignetteEffect extends Effect {\r\n\r\n\t/**\r\n\t * Constructs a new vignette effect.\r\n\t *\r\n\t * @param {Object} [options] - The options.\r\n\t * @param {BlendFunction} [options.blendFunction=BlendFunction.NORMAL] - The blend function of this effect.\r\n\t * @param {Boolean} [options.eskil=false] - Enables Eskil's vignette technique.\r\n\t * @param {Number} [options.offset=0.5] - The vignette offset.\r\n\t * @param {Number} [options.darkness=0.5] - The vignette darkness.\r\n\t */\r\n\r\n\tconstructor(options = {}) {\r\n\r\n\t\tconst settings = Object.assign({\r\n\t\t\tblendFunction: BlendFunction.NORMAL,\r\n\t\t\teskil: false,\r\n\t\t\toffset: 0.5,\r\n\t\t\tdarkness: 0.5\r\n\t\t}, options);\r\n\r\n\t\tsuper(\"VignetteEffect\", fragmentShader$E, {\r\n\r\n\t\t\tblendFunction: settings.blendFunction,\r\n\r\n\t\t\tuniforms: new Map([\r\n\t\t\t\t[\"offset\", new Uniform(settings.offset)],\r\n\t\t\t\t[\"darkness\", new Uniform(settings.darkness)]\r\n\t\t\t])\r\n\r\n\t\t});\r\n\r\n\t\tthis.eskil = settings.eskil;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether Eskil's vignette technique is enabled.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tget eskil() {\r\n\r\n\t\treturn this.defines.has(\"ESKIL\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables Eskil's vignette technique.\r\n\t *\r\n\t * @type {Boolean}\r\n\t */\r\n\r\n\tset eskil(value) {\r\n\r\n\t\tif(this.eskil !== value) {\r\n\r\n\t\t\tif(value) {\r\n\r\n\t\t\t\tthis.defines.set(\"ESKIL\", \"1\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.defines.delete(\"ESKIL\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setChanged();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * Creates a new canvas from raw image data.\r\n *\r\n * @private\r\n * @param {Number} width - The image width.\r\n * @param {Number} height - The image height.\r\n * @param {Uint8ClampedArray} data - The image data.\r\n * @return {Canvas} The canvas.\r\n */\r\n\r\nfunction createCanvas(width, height, data) {\r\n\r\n\tconst canvas = document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"canvas\");\r\n\tconst context = canvas.getContext(\"2d\");\r\n\r\n\tconst imageData = context.createImageData(width, height);\r\n\timageData.data.set(data);\r\n\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\r\n\tcontext.putImageData(imageData, 0, 0);\r\n\r\n\treturn canvas;\r\n\r\n}\r\n\r\n/**\r\n * A container for raw image data.\r\n */\r\n\r\nclass RawImageData {\r\n\r\n\t/**\r\n\t * Constructs a new image data container.\r\n\t *\r\n\t * @param {Number} [width=0] - The width of the image.\r\n\t * @param {Number} [height=0] - The height of the image.\r\n\t * @param {Uint8ClampedArray} [data=null] - The image data.\r\n\t */\r\n\r\n\tconstructor(width = 0, height = 0, data = null) {\r\n\r\n\t\t/**\r\n\t\t * The width of the image.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.width = width;\r\n\r\n\t\t/**\r\n\t\t * The height of the image.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.height = height;\r\n\r\n\t\t/**\r\n\t\t * The image data.\r\n\t\t *\r\n\t\t * @type {Uint8ClampedArray}\r\n\t\t */\r\n\r\n\t\tthis.data = data;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a canvas from this image data.\r\n\t *\r\n\t * @return {Canvas} The canvas or null if it couldn't be created.\r\n\t */\r\n\r\n\ttoCanvas() {\r\n\r\n\t\treturn (typeof document === \"undefined\") ? null : createCanvas(\r\n\t\t\tthis.width,\r\n\t\t\tthis.height,\r\n\t\t\tthis.data\r\n\t\t);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new image data container.\r\n\t *\r\n\t * @param {Object} data - Raw image data.\r\n\t * @return {RawImageData} The image data.\r\n\t */\r\n\r\n\tstatic from(data) {\r\n\r\n\t\treturn new RawImageData(data.width, data.height, data.data);\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * A 2D vector.\r\n *\r\n * @private\r\n */\r\n\r\nclass Vector2 {\r\n\r\n\t/**\r\n\t * Constructs a new vector.\r\n\t *\r\n\t * @param {Number} [x=0] - The initial x value.\r\n\t * @param {Number} [y=0] - The initial y value.\r\n\t */\r\n\r\n\tconstructor(x = 0, y = 0) {\r\n\r\n\t\t/**\r\n\t\t * The X component.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.x = x;\r\n\r\n\t\t/**\r\n\t\t * The Y component.\r\n\t\t *\r\n\t\t * @type {Number}\r\n\t\t */\r\n\r\n\t\tthis.y = y;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the components of this vector.\r\n\t *\r\n\t * @param {Number} x - The new x value.\r\n\t * @param {Number} y - The new y value.\r\n\t * @return {Vector2} This vector.\r\n\t */\r\n\r\n\tset(x, y) {\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the given vector equals this vector.\r\n\t *\r\n\t * @param {Vector2} v - A vector.\r\n\t * @return {Boolean} Whether this vector equals the given one.\r\n\t */\r\n\r\n\tequals(v) {\r\n\r\n\t\treturn (this === v || (this.x === v.x && this.y === v.y));\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * A 2D box.\r\n *\r\n * @private\r\n */\r\n\r\nclass Box2 {\r\n\r\n\t/**\r\n\t * Constructs a new box.\r\n\t */\r\n\r\n\tconstructor() {\r\n\r\n\t\tthis.min = new Vector2();\r\n\t\tthis.max = new Vector2();\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * A box.\r\n *\r\n * @type {Box2}\r\n * @private\r\n */\r\n\r\nconst b0 = new Box2();\r\n\r\n/**\r\n * A box.\r\n *\r\n * @type {Box2}\r\n * @private\r\n */\r\n\r\nconst b1 = new Box2();\r\n\r\n/**\r\n * The orthogonal texture size.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst ORTHOGONAL_SIZE = 16;\r\n\r\n/**\r\n * The diagonal texture size.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst DIAGONAL_SIZE = 20;\r\n\r\n/**\r\n * The number of samples for calculating areas in the diagonal textures.\r\n * Diagonal areas are calculated using brute force sampling.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst DIAGONAL_SAMPLES = 30;\r\n\r\n/**\r\n * The maximum distance for smoothing U-shapes.\r\n *\r\n * @type {Number}\r\n * @private\r\n */\r\n\r\nconst SMOOTH_MAX_DISTANCE = 32;\r\n\r\n/**\r\n * Subsampling offsets for orthogonal areas.\r\n *\r\n * @type {Float32Array}\r\n * @private\r\n */\r\n\r\nconst orthogonalSubsamplingOffsets = new Float32Array([\r\n\t0.0, -0.25, 0.25, -0.125, 0.125, -0.375, 0.375\r\n]);\r\n\r\n/**\r\n * Subsampling offset pairs for diagonal areas.\r\n *\r\n * @type {Float32Array[]}\r\n * @private\r\n */\r\n\r\nconst diagonalSubsamplingOffsets = [\r\n\r\n\tnew Float32Array([0.0, 0.0]),\r\n\tnew Float32Array([0.25, -0.25]),\r\n\tnew Float32Array([-0.25, 0.25]),\r\n\tnew Float32Array([0.125, -0.125]),\r\n\tnew Float32Array([-0.125, 0.125])\r\n\r\n];\r\n\r\n/**\r\n * Orthogonal pattern positioning coordinates.\r\n *\r\n * Used for placing each pattern subtexture into a specific spot.\r\n *\r\n * @type {Uint8Array[]}\r\n * @private\r\n */\r\n\r\nconst orthogonalEdges = [\r\n\r\n\tnew Uint8Array([0, 0]),\r\n\tnew Uint8Array([3, 0]),\r\n\tnew Uint8Array([0, 3]),\r\n\tnew Uint8Array([3, 3]),\r\n\r\n\tnew Uint8Array([1, 0]),\r\n\tnew Uint8Array([4, 0]),\r\n\tnew Uint8Array([1, 3]),\r\n\tnew Uint8Array([4, 3]),\r\n\r\n\tnew Uint8Array([0, 1]),\r\n\tnew Uint8Array([3, 1]),\r\n\tnew Uint8Array([0, 4]),\r\n\tnew Uint8Array([3, 4]),\r\n\r\n\tnew Uint8Array([1, 1]),\r\n\tnew Uint8Array([4, 1]),\r\n\tnew Uint8Array([1, 4]),\r\n\tnew Uint8Array([4, 4])\r\n\r\n];\r\n\r\n/**\r\n * Diagonal pattern positioning coordinates.\r\n *\r\n * Used for placing each pattern subtexture into a specific spot.\r\n *\r\n * @type {Uint8Array[]}\r\n * @private\r\n */\r\n\r\nconst diagonalEdges = [\r\n\r\n\tnew Uint8Array([0, 0]),\r\n\tnew Uint8Array([1, 0]),\r\n\tnew Uint8Array([0, 2]),\r\n\tnew Uint8Array([1, 2]),\r\n\r\n\tnew Uint8Array([2, 0]),\r\n\tnew Uint8Array([3, 0]),\r\n\tnew Uint8Array([2, 2]),\r\n\tnew Uint8Array([3, 2]),\r\n\r\n\tnew Uint8Array([0, 1]),\r\n\tnew Uint8Array([1, 1]),\r\n\tnew Uint8Array([0, 3]),\r\n\tnew Uint8Array([1, 3]),\r\n\r\n\tnew Uint8Array([2, 1]),\r\n\tnew Uint8Array([3, 1]),\r\n\tnew Uint8Array([2, 3]),\r\n\tnew Uint8Array([3, 3])\r\n\r\n];\r\n\r\n/**\r\n * Linearly interpolates between two values.\r\n *\r\n * @private\r\n * @param {Number} a - The initial value.\r\n * @param {Number} b - The target value.\r\n * @param {Number} p - The interpolation value.\r\n * @return {Number} The interpolated value.\r\n */\r\n\r\nfunction lerp(a, b, p) {\r\n\r\n\treturn a + (b - a) * p;\r\n\r\n}\r\n\r\n/**\r\n * Clamps a value to the range [0, 1].\r\n *\r\n * @private\r\n * @param {Number} a - The value.\r\n * @return {Number} The saturated value.\r\n */\r\n\r\nfunction saturate(a) {\r\n\r\n\treturn Math.min(Math.max(a, 0.0), 1.0);\r\n\r\n}\r\n\r\n/**\r\n * A smoothing function for small U-patterns.\r\n *\r\n * @private\r\n * @param {Number} d - A smoothing factor.\r\n * @param {Box2} b - The area that should be smoothed.\r\n * @return {Box2} The smoothed area.\r\n */\r\n\r\nfunction smoothArea(d, b) {\r\n\r\n\tconst a1 = b.min;\r\n\tconst a2 = b.max;\r\n\r\n\tconst b1X = Math.sqrt(a1.x * 2.0) * 0.5;\r\n\tconst b1Y = Math.sqrt(a1.y * 2.0) * 0.5;\r\n\tconst b2X = Math.sqrt(a2.x * 2.0) * 0.5;\r\n\tconst b2Y = Math.sqrt(a2.y * 2.0) * 0.5;\r\n\r\n\tconst p = saturate(d / SMOOTH_MAX_DISTANCE);\r\n\r\n\ta1.set(lerp(b1X, a1.x, p), lerp(b1Y, a1.y, p));\r\n\ta2.set(lerp(b2X, a2.x, p), lerp(b2Y, a2.y, p));\r\n\r\n\treturn b;\r\n\r\n}\r\n\r\n/**\r\n * Calculates the area under the line p1 -> p2, for the pixels (x, x + 1).\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The starting point of the line.\r\n * @param {Vector2} p2 - The ending point of the line.\r\n * @param {Number} x - The pixel index.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The area.\r\n */\r\n\r\nfunction calculateOrthogonalArea(p1, p2, x, result) {\r\n\r\n\tconst dX = p2.x - p1.x;\r\n\tconst dY = p2.y - p1.y;\r\n\r\n\tconst x1 = x;\r\n\tconst x2 = x + 1.0;\r\n\r\n\tconst y1 = p1.y + dY * (x1 - p1.x) / dX;\r\n\tconst y2 = p1.y + dY * (x2 - p1.x) / dX;\r\n\r\n\tlet a, a1, a2, t;\r\n\r\n\t// Check if x is inside the area.\r\n\tif((x1 >= p1.x && x1 < p2.x) || (x2 > p1.x && x2 <= p2.x)) {\r\n\r\n\t\t// Check if this is a trapezoid.\r\n\t\tif(Math.sign(y1) === Math.sign(y2) || Math.abs(y1) < 1e-4 || Math.abs(y2) < 1e-4) {\r\n\r\n\t\t\ta = (y1 + y2) / 2.0;\r\n\r\n\t\t\tif(a < 0.0) {\r\n\r\n\t\t\t\tresult.set(Math.abs(a), 0.0);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(0.0, Math.abs(a));\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Two triangles.\r\n\t\t\tt = -p1.y * dX / dY + p1.x;\r\n\r\n\t\t\ta1 = (t > p1.x) ? y1 * (t - Math.trunc(t)) / 2.0 : 0.0;\r\n\t\t\ta2 = (t < p2.x) ? y2 * (1.0 - (t - Math.trunc(t))) / 2.0 : 0.0;\r\n\r\n\t\t\ta = (Math.abs(a1) > Math.abs(a2)) ? a1 : -a2;\r\n\r\n\t\t\tif(a < 0.0) {\r\n\r\n\t\t\t\tresult.set(Math.abs(a1), Math.abs(a2));\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(Math.abs(a2), Math.abs(a1));\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tresult.set(0, 0);\r\n\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\n/**\r\n * Calculates the area for a given pattern and distances to the left and to the\r\n * right, biased by an offset.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Number} left - The left distance.\r\n * @param {Number} right - The right distance.\r\n * @param {Number} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The orthogonal area.\r\n */\r\n\r\nfunction calculateOrthogonalAreaForPattern(pattern, left, right, offset, result) {\r\n\r\n\tconst p1 = b0.min;\r\n\tconst p2 = b0.max;\r\n\tconst a1 = b1.min;\r\n\tconst a2 = b1.max;\r\n\tconst a = b1;\r\n\r\n\t/* o1           |\r\n\t *      .-------Â´\r\n\t * o2   |\r\n\t *\r\n\t *      <---d--->\r\n\t */\r\n\r\n\tconst o1 = 0.5 + offset;\r\n\tconst o2 = 0.5 + offset - 1.0;\r\n\tconst d = left + right + 1;\r\n\r\n\tswitch(pattern) {\r\n\r\n\t\tcase 0: {\r\n\r\n\t\t\t//    ------\r\n\r\n\t\t\tresult.set(0, 0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 1: {\r\n\r\n\t\t\t/*   .------\r\n\t\t\t *   |\r\n\t\t\t *\r\n\t\t\t * The offset is only applied to L patterns in the crossing edge side to\r\n\t\t\t * make it converge with the unfiltered pattern 0.\r\n\t\t\t * The pattern 0 must not be filtered to avoid artifacts.\r\n\t\t\t */\r\n\r\n\t\t\tif(left <= right) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, result);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(0, 0);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 2: {\r\n\r\n\t\t\t/*    ------.\r\n\t\t\t *          |\r\n\t\t\t */\r\n\r\n\t\t\tif(left >= right) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, result);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(0, 0);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 3: {\r\n\r\n\t\t\t/*   .------.\r\n\t\t\t *   |      |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, a1);\r\n\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, a2);\r\n\r\n\t\t\tsmoothArea(d, a);\r\n\r\n\t\t\tresult.set(a1.x + a2.x, a1.y + a2.y);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 4: {\r\n\r\n\t\t\t/*   |\r\n\t\t\t *   `------\r\n\t\t\t */\r\n\r\n\t\t\tif(left <= right) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, result);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(0, 0);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 5: {\r\n\r\n\t\t\t/*   |\r\n\t\t\t *   +------\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tresult.set(0, 0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 6: {\r\n\r\n\t\t\t/*   |\r\n\t\t\t *   `------.\r\n\t\t\t *          |\r\n\t\t\t *\r\n\t\t\t * A problem of not offseting L patterns (see above) is that for certain\r\n\t\t\t * max search distances, the pixels in the center of a Z pattern will\r\n\t\t\t * detect the full Z pattern, while the pixels in the sides will detect an\r\n\t\t\t * L pattern. To avoid discontinuities, the full offsetted Z\r\n\t\t\t * revectorization is blended with partially offsetted L patterns.\r\n\t\t\t */\r\n\r\n\t\t\tif(Math.abs(offset) > 0.0) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, a1);\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, a2);\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o2), left, result);\r\n\t\t\t\ta2.set(a2.x + result.x, a2.y + result.y);\r\n\r\n\t\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 7: {\r\n\r\n\t\t\t/*   |\r\n\t\t\t *   +------.\r\n\t\t\t *   |      |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 8: {\r\n\r\n\t\t\t/*          |\r\n\t\t\t *    ------Â´\r\n\t\t\t */\r\n\r\n\t\t\tif(left >= right) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, result);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.set(0, 0);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 9: {\r\n\r\n\t\t\t/*          |\r\n\t\t\t *   .------Â´\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tif(Math.abs(offset) > 0.0) {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, a1);\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d / 2.0, 0.0), left, a2);\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, result);\r\n\t\t\t\ta2.set(a2.x + result.x, a2.y + result.y);\r\n\r\n\t\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 10: {\r\n\r\n\t\t\t/*          |\r\n\t\t\t *    ------+\r\n\t\t\t *          |\r\n\t\t\t */\r\n\r\n\t\t\tresult.set(0, 0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 11: {\r\n\r\n\t\t\t/*          |\r\n\t\t\t *   .------+\r\n\t\t\t *   |      |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 12: {\r\n\r\n\t\t\t/*   |      |\r\n\t\t\t *   `------Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d / 2.0, 0.0), left, a1);\r\n\t\t\tcalculateOrthogonalArea(p1.set(d / 2.0, 0.0), p2.set(d, o1), left, a2);\r\n\r\n\t\t\tsmoothArea(d, a);\r\n\r\n\t\t\tresult.set(a1.x + a2.x, a1.y + a2.y);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 13: {\r\n\r\n\t\t\t/*   |      |\r\n\t\t\t *   +------Â´\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o2), p2.set(d, o1), left, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 14: {\r\n\r\n\t\t\t/*   |      |\r\n\t\t\t *   `------+\r\n\t\t\t *          |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateOrthogonalArea(p1.set(0.0, o1), p2.set(d, o2), left, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 15: {\r\n\r\n\t\t\t/*   |      |\r\n\t\t\t *   +------+\r\n\t\t\t *   |      |\r\n\t\t\t */\r\n\r\n\t\t\tresult.set(0, 0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\n/**\r\n * Determines whether the given pixel is inside the specified area.\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Vector2} x - The X-coordinates.\r\n * @param {Vector2} y - The Y-coordinates.\r\n * @return {Vector2} Whether the pixel lies inside the area.\r\n */\r\n\r\nfunction isInsideArea(p1, p2, x, y) {\r\n\r\n\tlet result = p1.equals(p2);\r\n\r\n\tif(!result) {\r\n\r\n\t\tlet xm = (p1.x + p2.x) / 2.0;\r\n\t\tlet ym = (p1.y + p2.y) / 2.0;\r\n\r\n\t\tlet a = p2.y - p1.y;\r\n\t\tlet b = p1.x - p2.x;\r\n\r\n\t\tlet c = a * (x - xm) + b * (y - ym);\r\n\r\n\t\tresult = (c > 0.0);\r\n\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\n/**\r\n * Calculates the area under the line p1 -> p2 for the pixel p using brute force\r\n * sampling.\r\n *\r\n * @private\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Number} pX - The X-coordinates.\r\n * @param {Number} pY - The Y-coordinates.\r\n * @return {Number} The amount of pixels inside the area relative to the total amount of sampled pixels.\r\n */\r\n\r\nfunction calculateDiagonalAreaForPixel(p1, p2, pX, pY) {\r\n\r\n\tlet a;\r\n\tlet x, y;\r\n\tlet offsetX, offsetY;\r\n\r\n\tfor(a = 0, y = 0; y < DIAGONAL_SAMPLES; ++y) {\r\n\r\n\t\tfor(x = 0; x < DIAGONAL_SAMPLES; ++x) {\r\n\r\n\t\t\toffsetX = x / (DIAGONAL_SAMPLES - 1.0);\r\n\t\t\toffsetY = y / (DIAGONAL_SAMPLES - 1.0);\r\n\r\n\t\t\tif(isInsideArea(p1, p2, pX + offsetX, pY + offsetY)) {\r\n\r\n\t\t\t\t++a;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn a / (DIAGONAL_SAMPLES * DIAGONAL_SAMPLES);\r\n\r\n}\r\n\r\n/**\r\n * Calculates the area under the line p1 -> p2. This includes the pixel and its\r\n * opposite.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Vector2} p1 - The lower bounds of the area.\r\n * @param {Vector2} p2 - The upper bounds of the area.\r\n * @param {Number} left - The left distance.\r\n * @param {Float32Array} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The area.\r\n */\r\n\r\nfunction calculateDiagonalArea(pattern, p1, p2, left, offset, result) {\r\n\r\n\tconst e = diagonalEdges[pattern];\r\n\tconst e1 = e[0];\r\n\tconst e2 = e[1];\r\n\r\n\tif(e1 > 0) {\r\n\r\n\t\tp1.x += offset[0];\r\n\t\tp1.y += offset[1];\r\n\r\n\t}\r\n\r\n\tif(e2 > 0) {\r\n\r\n\t\tp2.x += offset[0];\r\n\t\tp2.y += offset[1];\r\n\r\n\t}\r\n\r\n\treturn result.set(\r\n\t\t1.0 - calculateDiagonalAreaForPixel(p1, p2, 1.0 + left, 0.0 + left),\r\n\t\tcalculateDiagonalAreaForPixel(p1, p2, 1.0 + left, 1.0 + left)\r\n\t);\r\n\r\n}\r\n\r\n/**\r\n * Calculates the area for a given pattern and distances to the left and to the\r\n * right, biased by an offset.\r\n *\r\n * @private\r\n * @param {Number} pattern - A pattern index.\r\n * @param {Number} left - The left distance.\r\n * @param {Number} right - The right distance.\r\n * @param {Float32Array} offset - An offset.\r\n * @param {Vector2} result - A target vector to store the area in.\r\n * @return {Vector2} The orthogonal area.\r\n */\r\n\r\nfunction calculateDiagonalAreaForPattern(pattern, left, right, offset, result) {\r\n\r\n\tconst p1 = b0.min;\r\n\tconst p2 = b0.max;\r\n\tconst a1 = b1.min;\r\n\tconst a2 = b1.max;\r\n\r\n\tconst d = left + right + 1;\r\n\r\n\t/* There is some Black Magic involved in the diagonal area calculations.\r\n\t *\r\n\t * Unlike orthogonal patterns, the \"null\" pattern (one without crossing edges)\r\n\t * must be filtered, and the ends of both the \"null\" and L patterns are not\r\n\t * known: L and U patterns have different endings, and the adjacent pattern is\r\n\t * unknown. Therefore, a blend of both possibilities is computed.\r\n\t */\r\n\r\n\tswitch(pattern) {\r\n\r\n\t\tcase 0: {\r\n\r\n\t\t\t/*         .-Â´\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   Â´\r\n\t\t\t */\r\n\r\n\t\t\t// First possibility.\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\r\n\t\t\t// Second possibility.\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\t// Blend both possibilities together.\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 1: {\r\n\r\n\t\t\t/*         .-Â´\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 2: {\r\n\r\n\t\t\t/*         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 3: {\r\n\r\n\t\t\t/*\r\n\t\t\t *         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 4: {\r\n\r\n\t\t\t/*         .-Â´\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * ----Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 5: {\r\n\r\n\t\t\t/*         .-Â´\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * --.-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(0.0 + d, 0.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 6: {\r\n\r\n\t\t\t/*         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * ----Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 7: {\r\n\r\n\t\t\t/*         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * --.-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 8: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         |\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 9: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         |\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 10: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(0.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 11: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t *   .-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 12: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         |\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * ----Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, result);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 13: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         |\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * --.-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 1.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 14: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * ----Â´\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tcase 15: {\r\n\r\n\t\t\t/*         |\r\n\t\t\t *         .----\r\n\t\t\t *       .-Â´\r\n\t\t\t *     .-Â´\r\n\t\t\t * --.-Â´\r\n\t\t\t *   |\r\n\t\t\t *   |\r\n\t\t\t */\r\n\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 1.0), p2.set(1.0 + d, 1.0 + d), left, offset, a1);\r\n\t\t\tcalculateDiagonalArea(pattern, p1.set(1.0, 0.0), p2.set(1.0 + d, 0.0 + d), left, offset, a2);\r\n\r\n\t\t\tresult.set((a1.x + a2.x) / 2.0, (a1.y + a2.y) / 2.0);\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\n/**\r\n * Calculates orthogonal or diagonal patterns for a given offset.\r\n *\r\n * @private\r\n * @param {RawImageData[]} patterns - The patterns to assemble.\r\n * @param {Number|Float32Array} offset - A pattern offset. Diagonal offsets are pairs.\r\n * @param {Boolean} orthogonal - Whether the patterns are orthogonal or diagonal.\r\n */\r\n\r\nfunction generatePatterns(patterns, offset, orthogonal) {\r\n\r\n\tconst result = new Vector2();\r\n\r\n\tlet i, l;\r\n\tlet x, y;\r\n\tlet c;\r\n\r\n\tlet pattern;\r\n\tlet data, size;\r\n\r\n\tfor(i = 0, l = patterns.length; i < l; ++i) {\r\n\r\n\t\tpattern = patterns[i];\r\n\r\n\t\tdata = pattern.data;\r\n\t\tsize = pattern.width;\r\n\r\n\t\tfor(y = 0; y < size; ++y) {\r\n\r\n\t\t\tfor(x = 0; x < size; ++x) {\r\n\r\n\t\t\t\tif(orthogonal) {\r\n\r\n\t\t\t\t\tcalculateOrthogonalAreaForPattern(i, x, y, offset, result);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tcalculateDiagonalAreaForPattern(i, x, y, offset, result);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc = (y * size + x) * 2;\r\n\r\n\t\t\t\tdata[c] = result.x * 255;\r\n\t\t\t\tdata[c + 1] = result.y * 255;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Assembles orthogonal or diagonal patterns into the final area image.\r\n *\r\n * @private\r\n * @param {Vector2} base - A base position.\r\n * @param {RawImageData[]} patterns - The patterns to assemble.\r\n * @param {Uint8Array[]} edges - Edge coordinate pairs, used for positioning.\r\n * @param {Number} size - The pattern size.\r\n * @param {Boolean} orthogonal - Whether the patterns are orthogonal or diagonal.\r\n * @param {RawImageData} target - The target image data.\r\n */\r\n\r\nfunction assemble(base, patterns, edges, size, orthogonal, target) {\r\n\r\n\tconst p = new Vector2();\r\n\r\n\tconst dstData = target.data;\r\n\tconst dstWidth = target.width;\r\n\r\n\tlet i, l;\r\n\tlet x, y;\r\n\tlet c, d;\r\n\r\n\tlet edge;\r\n\tlet pattern;\r\n\tlet srcData, srcWidth;\r\n\r\n\tfor(i = 0, l = patterns.length; i < l; ++i) {\r\n\r\n\t\tedge = edges[i];\r\n\t\tpattern = patterns[i];\r\n\r\n\t\tsrcData = pattern.data;\r\n\t\tsrcWidth = pattern.width;\r\n\r\n\t\tfor(y = 0; y < size; ++y) {\r\n\r\n\t\t\tfor(x = 0; x < size; ++x) {\r\n\r\n\t\t\t\tp.set(\r\n\t\t\t\t\tedge[0] * size + base.x + x,\r\n\t\t\t\t\tedge[1] * size + base.y + y\r\n\t\t\t\t);\r\n\r\n\t\t\t\tc = (p.y * dstWidth + p.x) * 4;\r\n\r\n\t\t\t\t/* The texture coordinates of orthogonal patterns are compressed\r\n\t\t\t\tquadratically to reach longer distances for a given texture size. */\r\n\t\t\t\td = orthogonal ? ((y * y * srcWidth + x * x) * 2) :\r\n\t\t\t\t\t((y * srcWidth + x) * 2);\r\n\r\n\t\t\t\tdstData[c] = srcData[d];\r\n\t\t\t\tdstData[c + 1] = srcData[d + 1];\r\n\t\t\t\tdstData[c + 2] = 0;\r\n\t\t\t\tdstData[c + 3] = 255;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * SMAA area image data.\r\n *\r\n * This texture allows to obtain the area for a certain pattern and distances\r\n * to the left and to the right of the identified line.\r\n *\r\n * Based on the official python scripts:\r\n *  https://github.com/iryoku/smaa/tree/master/Scripts\r\n */\r\n\r\nclass SMAAAreaImageData {\r\n\r\n\t/**\r\n\t * Creates a new area image.\r\n\t *\r\n\t * @return {RawImageData} The generated image data.\r\n\t */\r\n\r\n\tstatic generate() {\r\n\r\n\t\tconst width = 2 * 5 * ORTHOGONAL_SIZE;\r\n\t\tconst height = orthogonalSubsamplingOffsets.length * 5 * ORTHOGONAL_SIZE;\r\n\r\n\t\tconst data = new Uint8ClampedArray(width * height * 4);\r\n\t\tconst result = new RawImageData(width, height, data);\r\n\r\n\t\tconst orthogonalPatternSize = Math.pow(ORTHOGONAL_SIZE - 1, 2) + 1;\r\n\t\tconst diagonalPatternSize = DIAGONAL_SIZE;\r\n\r\n\t\tconst orthogonalPatterns = [];\r\n\t\tconst diagonalPatterns = [];\r\n\r\n\t\tconst base = new Vector2();\r\n\r\n\t\tlet i, l;\r\n\r\n\t\t// Prepare 16 image data sets for the orthogonal and diagonal subtextures.\r\n\t\tfor(i = 0; i < 16; ++i) {\r\n\r\n\t\t\torthogonalPatterns.push(new RawImageData(orthogonalPatternSize, orthogonalPatternSize,\r\n\t\t\t\tnew Uint8ClampedArray(orthogonalPatternSize * orthogonalPatternSize * 2), 2));\r\n\r\n\t\t\tdiagonalPatterns.push(new RawImageData(diagonalPatternSize, diagonalPatternSize,\r\n\t\t\t\tnew Uint8ClampedArray(diagonalPatternSize * diagonalPatternSize * 2), 2));\r\n\r\n\t\t}\r\n\r\n\t\tfor(i = 0, l = orthogonalSubsamplingOffsets.length; i < l; ++i) {\r\n\r\n\t\t\t// Generate 16 orthogonal patterns for each offset.\r\n\t\t\tgeneratePatterns(orthogonalPatterns, orthogonalSubsamplingOffsets[i], true);\r\n\r\n\t\t\t// Assemble the orthogonal patterns and place them on the left side.\r\n\t\t\tbase.set(0, 5 * ORTHOGONAL_SIZE * i);\r\n\t\t\tassemble(base, orthogonalPatterns, orthogonalEdges, ORTHOGONAL_SIZE, true, result);\r\n\r\n\t\t}\r\n\r\n\t\tfor(i = 0, l = diagonalSubsamplingOffsets.length; i < l; ++i) {\r\n\r\n\t\t\t// Generate 16 diagonal patterns for each offset.\r\n\t\t\tgeneratePatterns(diagonalPatterns, diagonalSubsamplingOffsets[i], false);\r\n\r\n\t\t\t// Assemble the diagonal patterns and place them on the right side.\r\n\t\t\tbase.set(5 * ORTHOGONAL_SIZE, 4 * DIAGONAL_SIZE * i);\r\n\t\t\tassemble(base, diagonalPatterns, diagonalEdges, DIAGONAL_SIZE, false, result);\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n}\n\n/**\r\n * This dictionary returns which edges are active for a certain bilinear fetch:\r\n * it's the reverse lookup of the bilinear function.\r\n *\r\n * @type {Map}\r\n * @private\r\n */\r\n\r\nconst edges = new Map([\r\n\r\n\t[bilinear([0, 0, 0, 0]), [0, 0, 0, 0]],\r\n\t[bilinear([0, 0, 0, 1]), [0, 0, 0, 1]],\r\n\t[bilinear([0, 0, 1, 0]), [0, 0, 1, 0]],\r\n\t[bilinear([0, 0, 1, 1]), [0, 0, 1, 1]],\r\n\r\n\t[bilinear([0, 1, 0, 0]), [0, 1, 0, 0]],\r\n\t[bilinear([0, 1, 0, 1]), [0, 1, 0, 1]],\r\n\t[bilinear([0, 1, 1, 0]), [0, 1, 1, 0]],\r\n\t[bilinear([0, 1, 1, 1]), [0, 1, 1, 1]],\r\n\r\n\t[bilinear([1, 0, 0, 0]), [1, 0, 0, 0]],\r\n\t[bilinear([1, 0, 0, 1]), [1, 0, 0, 1]],\r\n\t[bilinear([1, 0, 1, 0]), [1, 0, 1, 0]],\r\n\t[bilinear([1, 0, 1, 1]), [1, 0, 1, 1]],\r\n\r\n\t[bilinear([1, 1, 0, 0]), [1, 1, 0, 0]],\r\n\t[bilinear([1, 1, 0, 1]), [1, 1, 0, 1]],\r\n\t[bilinear([1, 1, 1, 0]), [1, 1, 1, 0]],\r\n\t[bilinear([1, 1, 1, 1]), [1, 1, 1, 1]]\r\n\r\n]);\r\n\r\n/**\r\n * Linearly interpolates between two values.\r\n *\r\n * @private\r\n * @param {Number} a - The initial value.\r\n * @param {Number} b - The target value.\r\n * @param {Number} p - The interpolation value.\r\n * @return {Number} The interpolated value.\r\n */\r\n\r\nfunction lerp$1(a, b, p) {\r\n\r\n\treturn a + (b - a) * p;\r\n\r\n}\r\n\r\n/**\r\n * Calculates the bilinear fetch for a certain edge combination.\r\n *\r\n *     e[0]       e[1]\r\n *\r\n *              x <-------- Sample Position: (-0.25, -0.125)\r\n *     e[2]       e[3] <--- Current Pixel [3]: (0.0, 0.0)\r\n *\r\n * @private\r\n * @param {Number[]} e - The edge combination.\r\n * @return {Number} The interpolated value.\r\n */\r\n\r\nfunction bilinear(e) {\r\n\r\n\tconst a = lerp$1(e[0], e[1], 1.0 - 0.25);\r\n\tconst b = lerp$1(e[2], e[3], 1.0 - 0.25);\r\n\r\n\treturn lerp$1(a, b, 1.0 - 0.125);\r\n\r\n}\r\n\r\n/**\r\n * Computes the delta distance to add in the last step of searches to the left.\r\n *\r\n * @private\r\n * @param {Number[]} left - The left edge combination.\r\n * @param {Number[]} top - The top edge combination.\r\n * @return {Number} The left delta distance.\r\n */\r\n\r\nfunction deltaLeft(left, top) {\r\n\r\n\tlet d = 0;\r\n\r\n\t// If there is an edge, continue.\r\n\tif(top[3] === 1) {\r\n\r\n\t\td += 1;\r\n\r\n\t}\r\n\r\n\t/* If an edge was previously found, there is another edge and there are no\r\n\tcrossing edges, continue. */\r\n\tif(d === 1 && top[2] === 1 && left[1] !== 1 && left[3] !== 1) {\r\n\r\n\t\td += 1;\r\n\r\n\t}\r\n\r\n\treturn d;\r\n\r\n}\r\n\r\n/**\r\n * Computes the delta distance to add in the last step of searches to the right.\r\n *\r\n * @private\r\n * @param {Number[]} left - The left edge combination.\r\n * @param {Number[]} top - The top edge combination.\r\n * @return {Number} The right delta distance.\r\n */\r\n\r\nfunction deltaRight(left, top) {\r\n\r\n\tlet d = 0;\r\n\r\n\t// If there is an edge, and no crossing edges, continue.\r\n\tif(top[3] === 1 && left[1] !== 1 && left[3] !== 1) {\r\n\r\n\t\td += 1;\r\n\r\n\t}\r\n\r\n\t/* If an edge was previously found, there is another edge and there are no\r\n\tcrossing edges, continue. */\r\n\tif(d === 1 && top[2] === 1 && left[0] !== 1 && left[2] !== 1) {\r\n\r\n\t\td += 1;\r\n\r\n\t}\r\n\r\n\treturn d;\r\n\r\n}\r\n\r\n/**\r\n * SMAA search image data.\r\n *\r\n * This image stores information about how many pixels the line search\r\n * algorithm must advance in the last step.\r\n *\r\n * Based on the official python scripts:\r\n *  https://github.com/iryoku/smaa/tree/master/Scripts\r\n */\r\n\r\nclass SMAASearchImageData {\r\n\r\n\t/**\r\n\t * Creates a new search image.\r\n\t *\r\n\t * @return {RawImageData} The generated image data.\r\n\t */\r\n\r\n\tstatic generate() {\r\n\r\n\t\tconst width = 66;\r\n\t\tconst height = 33;\r\n\t\tconst halfWidth = width / 2;\r\n\r\n\t\tconst croppedWidth = 64;\r\n\t\tconst croppedHeight = 16;\r\n\r\n\t\tconst data = new Uint8ClampedArray(width * height);\r\n\t\tconst croppedData = new Uint8ClampedArray(croppedWidth * croppedHeight * 4);\r\n\r\n\t\tlet x, y;\r\n\t\tlet s, t, i;\r\n\t\tlet e1, e2;\r\n\r\n\t\t// Calculate delta distances.\r\n\t\tfor(y = 0; y < height; ++y) {\r\n\r\n\t\t\tfor(x = 0; x < width; ++x) {\r\n\r\n\t\t\t\ts = 0.03125 * x;\r\n\t\t\t\tt = 0.03125 * y;\r\n\r\n\t\t\t\tif(edges.has(s) && edges.has(t)) {\r\n\r\n\t\t\t\t\te1 = edges.get(s);\r\n\t\t\t\t\te2 = edges.get(t);\r\n\r\n\t\t\t\t\ti = y * width + x;\r\n\r\n\t\t\t\t\t// Maximize the dynamic range to help the compression.\r\n\t\t\t\t\tdata[i] = (127 * deltaLeft(e1, e2));\r\n\t\t\t\t\tdata[i + halfWidth] = (127 * deltaRight(e1, e2));\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Crop the result to powers-of-two to make it BC4-friendly.\r\n\t\tfor(i = 0, y = height - croppedHeight; y < height; ++y) {\r\n\r\n\t\t\tfor(x = 0; x < croppedWidth; ++x, i += 4) {\r\n\r\n\t\t\t\tcroppedData[i] = data[y * width + x];\r\n\t\t\t\tcroppedData[i + 3] = 255;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn new RawImageData(croppedWidth, croppedHeight, croppedData);\r\n\r\n\t}\r\n\r\n}\n\nvar workerProgram = \"!function(){\\\"use strict\\\";function e(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\\\"value\\\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}var n=function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e(this,t),this.width=a,this.height=n,this.data=s}return a(t,[{key:\\\"toCanvas\\\",value:function(){return\\\"undefined\\\"==typeof document?null:(e=this.width,t=this.height,a=this.data,n=document.createElementNS(\\\"http://www.w3.org/1999/xhtml\\\",\\\"canvas\\\"),s=n.getContext(\\\"2d\\\"),(r=s.createImageData(e,t)).data.set(a),n.width=e,n.height=t,s.putImageData(r,0,0),n);var e,t,a,n,s,r}}],[{key:\\\"from\\\",value:function(e){return new t(e.width,e.height,e.data)}}]),t}(),s=function(){function t(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,t),this.x=a,this.y=n}return a(t,[{key:\\\"set\\\",value:function(e,t){return this.x=e,this.y=t,this}},{key:\\\"equals\\\",value:function(e){return this===e||this.x===e.x&&this.y===e.y}}]),t}(),r=function t(){e(this,t),this.min=new s,this.max=new s},i=new r,y=new r,c=16,u=30,h=new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),o=[new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125])],w=[new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4])],x=[new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3])];function f(e,t,a){return e+(t-e)*a}function l(e,t){var a,n=t.min,s=t.max,r=.5*Math.sqrt(2*n.x),i=.5*Math.sqrt(2*n.y),y=.5*Math.sqrt(2*s.x),c=.5*Math.sqrt(2*s.y),u=(a=e/32,Math.min(Math.max(a,0),1));return n.set(f(r,n.x,u),f(i,n.y,u)),s.set(f(y,s.x,u),f(c,s.y,u)),t}function b(e,t,a,n){var s,r,i,y,c=t.x-e.x,u=t.y-e.y,h=a,o=a+1,w=e.y+u*(h-e.x)/c,x=e.y+u*(o-e.x)/c;return h>=e.x&&h<t.x||o>e.x&&o<=t.x?Math.sign(w)===Math.sign(x)||Math.abs(w)<1e-4||Math.abs(x)<1e-4?(s=(w+x)/2)<0?n.set(Math.abs(s),0):n.set(0,Math.abs(s)):(r=(y=-e.y*c/u+e.x)>e.x?w*(y-Math.trunc(y))/2:0,i=y<t.x?x*(1-(y-Math.trunc(y)))/2:0,(s=Math.abs(r)>Math.abs(i)?r:-i)<0?n.set(Math.abs(r),Math.abs(i)):n.set(Math.abs(i),Math.abs(r))):n.set(0,0),n}function A(e,t,a,n,s){var r=i.min,c=i.max,u=y.min,h=y.max,o=y,w=.5+n,x=.5+n-1,f=t+a+1;switch(e){case 0:s.set(0,0);break;case 1:t<=a?b(r.set(0,x),c.set(f/2,0),t,s):s.set(0,0);break;case 2:t>=a?b(r.set(f/2,0),c.set(f,x),t,s):s.set(0,0);break;case 3:b(r.set(0,x),c.set(f/2,0),t,u),b(r.set(f/2,0),c.set(f,x),t,h),l(f,o),s.set(u.x+h.x,u.y+h.y);break;case 4:t<=a?b(r.set(0,w),c.set(f/2,0),t,s):s.set(0,0);break;case 5:s.set(0,0);break;case 6:Math.abs(n)>0?(b(r.set(0,w),c.set(f,x),t,u),b(r.set(0,w),c.set(f/2,0),t,h),b(r.set(f/2,0),c.set(f,x),t,s),h.set(h.x+s.x,h.y+s.y),s.set((u.x+h.x)/2,(u.y+h.y)/2)):b(r.set(0,w),c.set(f,x),t,s);break;case 7:b(r.set(0,w),c.set(f,x),t,s);break;case 8:t>=a?b(r.set(f/2,0),c.set(f,w),t,s):s.set(0,0);break;case 9:Math.abs(n)>0?(b(r.set(0,x),c.set(f,w),t,u),b(r.set(0,x),c.set(f/2,0),t,h),b(r.set(f/2,0),c.set(f,w),t,s),h.set(h.x+s.x,h.y+s.y),s.set((u.x+h.x)/2,(u.y+h.y)/2)):b(r.set(0,x),c.set(f,w),t,s);break;case 10:s.set(0,0);break;case 11:b(r.set(0,x),c.set(f,w),t,s);break;case 12:b(r.set(0,w),c.set(f/2,0),t,u),b(r.set(f/2,0),c.set(f,w),t,h),l(f,o),s.set(u.x+h.x,u.y+h.y);break;case 13:b(r.set(0,x),c.set(f,w),t,s);break;case 14:b(r.set(0,w),c.set(f,x),t,s);break;case 15:s.set(0,0)}return s}function v(e,t,a,n){var s=e.equals(t);if(!s){var r=(e.x+t.x)/2,i=(e.y+t.y)/2;s=(t.y-e.y)*(a-r)+(e.x-t.x)*(n-i)>0}return s}function k(e,t,a,n){var s,r,i;for(s=0,i=0;i<u;++i)for(r=0;r<u;++r)v(e,t,a+r/29,n+i/29)&&++s;return s/900}function U(e,t,a,n,s,r){var i=x[e],y=i[0],c=i[1];return y>0&&(t.x+=s[0],t.y+=s[1]),c>0&&(a.x+=s[0],a.y+=s[1]),r.set(1-k(t,a,1+n,0+n),k(t,a,1+n,1+n))}function d(e,t,a,n,s){var r=i.min,c=i.max,u=y.min,h=y.max,o=t+a+1;switch(e){case 0:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 1:U(e,r.set(1,0),c.set(0+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 2:U(e,r.set(0,0),c.set(1+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 3:U(e,r.set(1,0),c.set(1+o,0+o),t,n,s);break;case 4:U(e,r.set(1,1),c.set(0+o,0+o),t,n,u),U(e,r.set(1,1),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 5:U(e,r.set(1,1),c.set(0+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 6:U(e,r.set(1,1),c.set(1+o,0+o),t,n,s);break;case 7:U(e,r.set(1,1),c.set(1+o,0+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 8:U(e,r.set(0,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,1+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 9:U(e,r.set(1,0),c.set(1+o,1+o),t,n,s);break;case 10:U(e,r.set(0,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 11:U(e,r.set(1,0),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 12:U(e,r.set(1,1),c.set(1+o,1+o),t,n,s);break;case 13:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,1+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 14:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,1),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2);break;case 15:U(e,r.set(1,1),c.set(1+o,1+o),t,n,u),U(e,r.set(1,0),c.set(1+o,0+o),t,n,h),s.set((u.x+h.x)/2,(u.y+h.y)/2)}return s}function g(e,t,a){var n,r,i,y,c,u,h,o,w=new s;for(n=0,r=e.length;n<r;++n)for(h=(u=e[n]).data,o=u.width,y=0;y<o;++y)for(i=0;i<o;++i)a?A(n,i,y,t,w):d(n,i,y,t,w),h[c=2*(y*o+i)]=255*w.x,h[c+1]=255*w.y}function m(e,t,a,n,r,i){var y,c,u,h,o,w,x,f,l,b,A=new s,v=i.data,k=i.width;for(y=0,c=t.length;y<c;++y)for(x=a[y],l=(f=t[y]).data,b=f.width,h=0;h<n;++h)for(u=0;u<n;++u)A.set(x[0]*n+e.x+u,x[1]*n+e.y+h),w=r?2*(h*h*b+u*u):2*(h*b+u),v[o=4*(A.y*k+A.x)]=l[w],v[o+1]=l[w+1],v[o+2]=0,v[o+3]=255}var M=function(){function t(){e(this,t)}return a(t,null,[{key:\\\"generate\\\",value:function(){var e,t,a=5*h.length*c,r=new Uint8ClampedArray(160*a*4),i=new n(160,a,r),y=Math.pow(15,2)+1,u=[],f=[],l=new s;for(e=0;e<16;++e)u.push(new n(y,y,new Uint8ClampedArray(y*y*2),2)),f.push(new n(20,20,new Uint8ClampedArray(800),2));for(e=0,t=h.length;e<t;++e)g(u,h[e],!0),l.set(0,80*e),m(l,u,w,c,!0,i);for(e=0,t=o.length;e<t;++e)g(f,o[e],!1),l.set(80,80*e),m(l,f,x,20,!1,i);return i}}]),t}(),p=new Map([[q([0,0,0,0]),[0,0,0,0]],[q([0,0,0,1]),[0,0,0,1]],[q([0,0,1,0]),[0,0,1,0]],[q([0,0,1,1]),[0,0,1,1]],[q([0,1,0,0]),[0,1,0,0]],[q([0,1,0,1]),[0,1,0,1]],[q([0,1,1,0]),[0,1,1,0]],[q([0,1,1,1]),[0,1,1,1]],[q([1,0,0,0]),[1,0,0,0]],[q([1,0,0,1]),[1,0,0,1]],[q([1,0,1,0]),[1,0,1,0]],[q([1,0,1,1]),[1,0,1,1]],[q([1,1,0,0]),[1,1,0,0]],[q([1,1,0,1]),[1,1,0,1]],[q([1,1,1,0]),[1,1,1,0]],[q([1,1,1,1]),[1,1,1,1]]]);function C(e,t,a){return e+(t-e)*a}function q(e){var t=C(e[0],e[1],.75),a=C(e[2],e[3],.75);return C(t,a,.875)}function F(e,t){var a=0;return 1===t[3]&&1!==e[1]&&1!==e[3]&&(a+=1),1===a&&1===t[2]&&1!==e[0]&&1!==e[2]&&(a+=1),a}var D=function(){function t(){e(this,t)}return a(t,null,[{key:\\\"generate\\\",value:function(){var e,t,a,s,r,i,y,c,u,h,o=new Uint8ClampedArray(2178),w=new Uint8ClampedArray(4096);for(t=0;t<33;++t)for(e=0;e<66;++e)a=.03125*e,s=.03125*t,p.has(a)&&p.has(s)&&(i=p.get(a),y=p.get(s),o[r=66*t+e]=127*(c=i,h=void 0,h=0,1===(u=y)[3]&&(h+=1),1===h&&1===u[2]&&1!==c[1]&&1!==c[3]&&(h+=1),h),o[r+33]=127*F(i,y));for(r=0,t=17;t<33;++t)for(e=0;e<64;++e,r+=4)w[r]=o[66*t+e],w[r+3]=255;return new n(64,16,w)}}]),t}();self.addEventListener(\\\"message\\\",(function(e){var t=M.generate(),a=D.generate();postMessage({areaImageData:t,searchImageData:a},[t.data.buffer,a.data.buffer]),close()}))}();\\n\";\n\n/**\r\n * Generates the SMAA data images.\r\n *\r\n * @private\r\n * @param {Boolean} [disableCache=false] - Determines whether the generated image data should be cached.\r\n * @return {Promise} A promise that returns the search image and area image as a data URL pair.\r\n */\r\n\r\nfunction generate(disableCache = false) {\r\n\r\n\tconst workerURL = URL.createObjectURL(new Blob([workerProgram], { type: \"text/javascript\" }));\r\n\tconst worker = new Worker(workerURL);\r\n\r\n\treturn new Promise((resolve, reject) => {\r\n\r\n\t\tworker.addEventListener(\"error\", (event) => reject(event.error));\r\n\t\tworker.addEventListener(\"message\", (event) => {\r\n\r\n\t\t\tconst searchImageData = RawImageData.from(event.data.searchImageData);\r\n\t\t\tconst areaImageData = RawImageData.from(event.data.areaImageData);\r\n\r\n\t\t\tconst urls = [\r\n\t\t\t\tsearchImageData.toCanvas().toDataURL(),\r\n\t\t\t\tareaImageData.toCanvas().toDataURL()\r\n\t\t\t];\r\n\r\n\t\t\tif(!disableCache && window.localStorage !== undefined) {\r\n\r\n\t\t\t\tlocalStorage.setItem(\"smaa-search\", urls[0]);\r\n\t\t\t\tlocalStorage.setItem(\"smaa-area\", urls[1]);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tURL.revokeObjectURL(workerURL);\r\n\t\t\tresolve(urls);\r\n\r\n\t\t});\r\n\r\n\t\tworker.postMessage(null);\r\n\r\n\t});\r\n\r\n}\r\n\r\n/**\r\n * An SMAA image loader.\r\n *\r\n * This loader uses a worker thread to generate the search and area images. The\r\n * Generated data URLs will be cached using localStorage, if available. To\r\n * disable caching, please refer to {@link SMAAImageLoader.disableCache}.\r\n *\r\n * @experimental Added for testing, API might change in patch or minor releases. Requires three >= r108.\r\n */\r\n\r\nclass SMAAImageLoader extends Loader {\r\n\r\n\t/**\r\n\t * Constructs a new SMAA image loader.\r\n\t *\r\n\t * @param {LoadingManager} [manager] - A loading manager.\r\n\t */\r\n\r\n\tconstructor(manager) {\r\n\r\n\t\tsuper(manager);\r\n\r\n\t\t/**\r\n\t\t * Indicates whether data image caching is disabled.\r\n\t\t *\r\n\t\t * @type {Boolean}\r\n\t\t */\r\n\r\n\t\tthis.disableCache = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the SMAA data images.\r\n\t *\r\n\t * @param {Function} [onLoad] - A function to call when the loading process is done.\r\n\t * @param {Function} [onError] - A function to call when an error occurs.\r\n\t * @return {Promise<Image[]>} A promise that returns the search image and area image as a pair.\r\n\t */\r\n\r\n\tload(onLoad = () => {}, onError = () => {}) {\r\n\r\n\t\t// Conform to the signature (url, onLoad, onProgress, onError).\r\n\t\tif(arguments.length === 4) {\r\n\r\n\t\t\tonLoad = arguments[1];\r\n\t\t\tonError = arguments[3];\r\n\r\n\t\t} else if(arguments.length === 3 || typeof arguments[0] !== \"function\") {\r\n\r\n\t\t\tonLoad = arguments[1];\r\n\t\t\tonError = () => {};\r\n\r\n\t\t}\r\n\r\n\t\tconst externalManager = this.manager;\r\n\t\tconst internalManager = new LoadingManager();\r\n\r\n\t\texternalManager.itemStart(\"smaa-search\");\r\n\t\texternalManager.itemStart(\"smaa-area\");\r\n\t\tinternalManager.itemStart(\"smaa-search\");\r\n\t\tinternalManager.itemStart(\"smaa-area\");\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tconst cachedURLs = (!this.disableCache && window.localStorage !== undefined) ? [\r\n\t\t\t\tlocalStorage.getItem(\"smaa-search\"),\r\n\t\t\t\tlocalStorage.getItem(\"smaa-area\")\r\n\t\t\t] : [null, null];\r\n\r\n\t\t\tconst promise = (cachedURLs[0] !== null && cachedURLs[1] !== null) ?\r\n\t\t\t\tPromise.resolve(cachedURLs) : generate(this.disableCache);\r\n\r\n\t\t\tpromise.then((urls) => {\r\n\r\n\t\t\t\tconst result = [new Image(), new Image()];\r\n\r\n\t\t\t\tinternalManager.onLoad = () => {\r\n\r\n\t\t\t\t\tonLoad(result);\r\n\t\t\t\t\tresolve(result);\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tresult[0].addEventListener(\"load\", () => {\r\n\r\n\t\t\t\t\texternalManager.itemEnd(\"smaa-search\");\r\n\t\t\t\t\tinternalManager.itemEnd(\"smaa-search\");\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tresult[1].addEventListener(\"load\", () => {\r\n\r\n\t\t\t\t\texternalManager.itemEnd(\"smaa-area\");\r\n\t\t\t\t\tinternalManager.itemEnd(\"smaa-area\");\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tresult[0].src = urls[0];\r\n\t\t\t\tresult[1].src = urls[1];\r\n\r\n\t\t\t}).catch((error) => {\r\n\r\n\t\t\t\texternalManager.itemError(\"smaa-search\");\r\n\t\t\t\texternalManager.itemError(\"smaa-area\");\r\n\r\n\t\t\t\tonError(error);\r\n\t\t\t\treject(error);\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\n\nexport { AdaptiveLuminanceMaterial, BlendFunction, BlendMode, BloomEffect, BlurPass, BokehEffect, BokehMaterial, BrightnessContrastEffect, ChromaticAberrationEffect, CircleOfConfusionMaterial, ClearMaskPass, ClearPass, ColorAverageEffect, ColorChannel, ColorDepthEffect, ColorEdgesMaterial, ConvolutionMaterial, CopyMaterial, DepthComparisonMaterial, DepthDownsamplingMaterial, DepthDownsamplingPass, DepthEffect, DepthMaskMaterial, DepthOfFieldEffect, DepthPass, Disposable, DotScreenEffect, EdgeDetectionMaterial, EdgeDetectionMode, Effect, EffectAttribute, EffectComposer, EffectMaterial, EffectPass, GammaCorrectionEffect, GlitchEffect, GlitchMode, GodRaysEffect, GodRaysMaterial, GridEffect, HueSaturationEffect, Initializable, KernelSize, LambdaPass, LuminanceMaterial, MaskFunction, MaskMaterial, MaskPass, NoiseEffect, NoiseTexture, NormalPass, OutlineEdgesMaterial, OutlineEffect, OutlineMaterial, OverrideMaterialManager, Pass, PixelationEffect, PredicationMode, RawImageData, RealisticBokehEffect, RenderPass, Resizable, Resizer, SMAAAreaImageData, SMAAEffect, SMAAImageLoader, SMAAPreset, SMAASearchImageData, SMAAWeightsMaterial, SSAOEffect, SSAOMaterial, SavePass, ScanlineEffect, Section, Selection, SelectiveBloomEffect, SepiaEffect, ShaderPass, ShockWaveEffect, TextureEffect, ToneMappingEffect, VignetteEffect, WebGLExtension };\n"]},"metadata":{},"sourceType":"module"}