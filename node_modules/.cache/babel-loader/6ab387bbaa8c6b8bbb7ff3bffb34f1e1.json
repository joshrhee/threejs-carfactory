{"ast":null,"code":"import { EventDispatcher, Matrix4, Plane, Raycaster, Vector2, Vector3 } from \"../../../build/three.module.js\";\n\nvar DragControls = function (_objects, _camera, _domElement) {\n  var _plane = new Plane();\n\n  var _raycaster = new Raycaster();\n\n  var _mouse = new Vector2();\n\n  var _offset = new Vector3();\n\n  var _intersection = new Vector3();\n\n  var _worldPosition = new Vector3();\n\n  var _inverseMatrix = new Matrix4();\n\n  var _intersections = [];\n  var _selected = null,\n      _hovered = null; //\n\n  var scope = this;\n\n  function activate() {\n    _domElement.addEventListener('mousemove', onDocumentMouseMove, false);\n\n    _domElement.addEventListener('mousedown', onDocumentMouseDown, false);\n\n    _domElement.addEventListener('mouseup', onDocumentMouseCancel, false);\n\n    _domElement.addEventListener('mouseleave', onDocumentMouseCancel, false);\n\n    _domElement.addEventListener('touchmove', onDocumentTouchMove, false);\n\n    _domElement.addEventListener('touchstart', onDocumentTouchStart, false);\n\n    _domElement.addEventListener('touchend', onDocumentTouchEnd, false);\n  }\n\n  function deactivate() {\n    _domElement.removeEventListener('mousemove', onDocumentMouseMove, false);\n\n    _domElement.removeEventListener('mousedown', onDocumentMouseDown, false);\n\n    _domElement.removeEventListener('mouseup', onDocumentMouseCancel, false);\n\n    _domElement.removeEventListener('mouseleave', onDocumentMouseCancel, false);\n\n    _domElement.removeEventListener('touchmove', onDocumentTouchMove, false);\n\n    _domElement.removeEventListener('touchstart', onDocumentTouchStart, false);\n\n    _domElement.removeEventListener('touchend', onDocumentTouchEnd, false);\n\n    _domElement.style.cursor = '';\n  }\n\n  function dispose() {\n    deactivate();\n  }\n\n  function getObjects() {\n    return _objects;\n  }\n\n  function onDocumentMouseMove(event) {\n    event.preventDefault();\n\n    var rect = _domElement.getBoundingClientRect();\n\n    _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;\n    _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n    _raycaster.setFromCamera(_mouse, _camera);\n\n    if (_selected && scope.enabled) {\n      if (_raycaster.ray.intersectPlane(_plane, _intersection)) {\n        _selected.position.copy(_intersection.sub(_offset).applyMatrix4(_inverseMatrix));\n      }\n\n      scope.dispatchEvent({\n        type: 'drag',\n        object: _selected\n      });\n      return;\n    }\n\n    _intersections.length = 0;\n\n    _raycaster.setFromCamera(_mouse, _camera);\n\n    _raycaster.intersectObjects(_objects, true, _intersections);\n\n    if (_intersections.length > 0) {\n      var object = _intersections[0].object;\n\n      _plane.setFromNormalAndCoplanarPoint(_camera.getWorldDirection(_plane.normal), _worldPosition.setFromMatrixPosition(object.matrixWorld));\n\n      if (_hovered !== object) {\n        scope.dispatchEvent({\n          type: 'hoveron',\n          object: object\n        });\n        _domElement.style.cursor = 'pointer';\n        _hovered = object;\n      }\n    } else {\n      if (_hovered !== null) {\n        scope.dispatchEvent({\n          type: 'hoveroff',\n          object: _hovered\n        });\n        _domElement.style.cursor = 'auto';\n        _hovered = null;\n      }\n    }\n  }\n\n  function onDocumentMouseDown(event) {\n    event.preventDefault();\n    _intersections.length = 0;\n\n    _raycaster.setFromCamera(_mouse, _camera);\n\n    _raycaster.intersectObjects(_objects, true, _intersections);\n\n    if (_intersections.length > 0) {\n      _selected = scope.transformGroup === true ? _objects[0] : _intersections[0].object;\n\n      if (_raycaster.ray.intersectPlane(_plane, _intersection)) {\n        _inverseMatrix.getInverse(_selected.parent.matrixWorld);\n\n        _offset.copy(_intersection).sub(_worldPosition.setFromMatrixPosition(_selected.matrixWorld));\n      }\n\n      _domElement.style.cursor = 'move';\n      scope.dispatchEvent({\n        type: 'dragstart',\n        object: _selected\n      });\n    }\n  }\n\n  function onDocumentMouseCancel(event) {\n    event.preventDefault();\n\n    if (_selected) {\n      scope.dispatchEvent({\n        type: 'dragend',\n        object: _selected\n      });\n      _selected = null;\n    }\n\n    _domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n  }\n\n  function onDocumentTouchMove(event) {\n    event.preventDefault();\n    event = event.changedTouches[0];\n\n    var rect = _domElement.getBoundingClientRect();\n\n    _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;\n    _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n    _raycaster.setFromCamera(_mouse, _camera);\n\n    if (_selected && scope.enabled) {\n      if (_raycaster.ray.intersectPlane(_plane, _intersection)) {\n        _selected.position.copy(_intersection.sub(_offset).applyMatrix4(_inverseMatrix));\n      }\n\n      scope.dispatchEvent({\n        type: 'drag',\n        object: _selected\n      });\n      return;\n    }\n  }\n\n  function onDocumentTouchStart(event) {\n    event.preventDefault();\n    event = event.changedTouches[0];\n\n    var rect = _domElement.getBoundingClientRect();\n\n    _mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;\n    _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n    _intersections.length = 0;\n\n    _raycaster.setFromCamera(_mouse, _camera);\n\n    _raycaster.intersectObjects(_objects, true, _intersections);\n\n    if (_intersections.length > 0) {\n      _selected = scope.transformGroup === true ? _objects[0] : _intersections[0].object;\n\n      _plane.setFromNormalAndCoplanarPoint(_camera.getWorldDirection(_plane.normal), _worldPosition.setFromMatrixPosition(_selected.matrixWorld));\n\n      if (_raycaster.ray.intersectPlane(_plane, _intersection)) {\n        _inverseMatrix.getInverse(_selected.parent.matrixWorld);\n\n        _offset.copy(_intersection).sub(_worldPosition.setFromMatrixPosition(_selected.matrixWorld));\n      }\n\n      _domElement.style.cursor = 'move';\n      scope.dispatchEvent({\n        type: 'dragstart',\n        object: _selected\n      });\n    }\n  }\n\n  function onDocumentTouchEnd(event) {\n    event.preventDefault();\n\n    if (_selected) {\n      scope.dispatchEvent({\n        type: 'dragend',\n        object: _selected\n      });\n      _selected = null;\n    }\n\n    _domElement.style.cursor = 'auto';\n  }\n\n  activate(); // API\n\n  this.enabled = true;\n  this.transformGroup = false;\n  this.activate = activate;\n  this.deactivate = deactivate;\n  this.dispose = dispose;\n  this.getObjects = getObjects;\n};\n\nDragControls.prototype = Object.create(EventDispatcher.prototype);\nDragControls.prototype.constructor = DragControls;\nexport { DragControls };","map":{"version":3,"sources":["/Users/sangjunerhee/Desktop/Git/threejs-carfactory/node_modules/three/examples/jsm/controls/DragControls.js"],"names":["EventDispatcher","Matrix4","Plane","Raycaster","Vector2","Vector3","DragControls","_objects","_camera","_domElement","_plane","_raycaster","_mouse","_offset","_intersection","_worldPosition","_inverseMatrix","_intersections","_selected","_hovered","scope","activate","addEventListener","onDocumentMouseMove","onDocumentMouseDown","onDocumentMouseCancel","onDocumentTouchMove","onDocumentTouchStart","onDocumentTouchEnd","deactivate","removeEventListener","style","cursor","dispose","getObjects","event","preventDefault","rect","getBoundingClientRect","x","clientX","left","width","y","clientY","top","height","setFromCamera","enabled","ray","intersectPlane","position","copy","sub","applyMatrix4","dispatchEvent","type","object","length","intersectObjects","setFromNormalAndCoplanarPoint","getWorldDirection","normal","setFromMatrixPosition","matrixWorld","transformGroup","getInverse","parent","changedTouches","prototype","Object","create","constructor"],"mappings":"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","sourcesContent":["import {\n\tEventDispatcher,\n\tMatrix4,\n\tPlane,\n\tRaycaster,\n\tVector2,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar DragControls = function ( _objects, _camera, _domElement ) {\n\n\tvar _plane = new Plane();\n\tvar _raycaster = new Raycaster();\n\n\tvar _mouse = new Vector2();\n\tvar _offset = new Vector3();\n\tvar _intersection = new Vector3();\n\tvar _worldPosition = new Vector3();\n\tvar _inverseMatrix = new Matrix4();\n\tvar _intersections = [];\n\n\tvar _selected = null, _hovered = null;\n\n\t//\n\n\tvar scope = this;\n\n\tfunction activate() {\n\n\t\t_domElement.addEventListener( 'mousemove', onDocumentMouseMove, false );\n\t\t_domElement.addEventListener( 'mousedown', onDocumentMouseDown, false );\n\t\t_domElement.addEventListener( 'mouseup', onDocumentMouseCancel, false );\n\t\t_domElement.addEventListener( 'mouseleave', onDocumentMouseCancel, false );\n\t\t_domElement.addEventListener( 'touchmove', onDocumentTouchMove, false );\n\t\t_domElement.addEventListener( 'touchstart', onDocumentTouchStart, false );\n\t\t_domElement.addEventListener( 'touchend', onDocumentTouchEnd, false );\n\n\t}\n\n\tfunction deactivate() {\n\n\t\t_domElement.removeEventListener( 'mousemove', onDocumentMouseMove, false );\n\t\t_domElement.removeEventListener( 'mousedown', onDocumentMouseDown, false );\n\t\t_domElement.removeEventListener( 'mouseup', onDocumentMouseCancel, false );\n\t\t_domElement.removeEventListener( 'mouseleave', onDocumentMouseCancel, false );\n\t\t_domElement.removeEventListener( 'touchmove', onDocumentTouchMove, false );\n\t\t_domElement.removeEventListener( 'touchstart', onDocumentTouchStart, false );\n\t\t_domElement.removeEventListener( 'touchend', onDocumentTouchEnd, false );\n\n\t\t_domElement.style.cursor = '';\n\n\t}\n\n\tfunction dispose() {\n\n\t\tdeactivate();\n\n\t}\n\n\tfunction getObjects() {\n\n\t\treturn _objects;\n\n\t}\n\n\tfunction onDocumentMouseMove( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tvar rect = _domElement.getBoundingClientRect();\n\n\t\t_mouse.x = ( ( event.clientX - rect.left ) / rect.width ) * 2 - 1;\n\t\t_mouse.y = - ( ( event.clientY - rect.top ) / rect.height ) * 2 + 1;\n\n\t\t_raycaster.setFromCamera( _mouse, _camera );\n\n\t\tif ( _selected && scope.enabled ) {\n\n\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t_intersections.length = 0;\n\n\t\t_raycaster.setFromCamera( _mouse, _camera );\n\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\tif ( _intersections.length > 0 ) {\n\n\t\t\tvar object = _intersections[ 0 ].object;\n\n\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( object.matrixWorld ) );\n\n\t\t\tif ( _hovered !== object ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'hoveron', object: object } );\n\n\t\t\t\t_domElement.style.cursor = 'pointer';\n\t\t\t\t_hovered = object;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( _hovered !== null ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t_hovered = null;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction onDocumentMouseDown( event ) {\n\n\t\tevent.preventDefault();\n\n\t\t_intersections.length = 0;\n\n\t\t_raycaster.setFromCamera( _mouse, _camera );\n\t\t_raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t_selected = ( scope.transformGroup === true ) ? _objects[ 0 ] : _intersections[ 0 ].object;\n\n\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t_inverseMatrix.getInverse( _selected.parent.matrixWorld );\n\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t}\n\n\n\t}\n\n\tfunction onDocumentMouseCancel( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tif ( _selected ) {\n\n\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t_selected = null;\n\n\t\t}\n\n\t\t_domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n\n\t}\n\n\tfunction onDocumentTouchMove( event ) {\n\n\t\tevent.preventDefault();\n\t\tevent = event.changedTouches[ 0 ];\n\n\t\tvar rect = _domElement.getBoundingClientRect();\n\n\t\t_mouse.x = ( ( event.clientX - rect.left ) / rect.width ) * 2 - 1;\n\t\t_mouse.y = - ( ( event.clientY - rect.top ) / rect.height ) * 2 + 1;\n\n\t\t_raycaster.setFromCamera( _mouse, _camera );\n\n\t\tif ( _selected && scope.enabled ) {\n\n\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t}\n\n\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\treturn;\n\n\t\t}\n\n\t}\n\n\tfunction onDocumentTouchStart( event ) {\n\n\t\tevent.preventDefault();\n\t\tevent = event.changedTouches[ 0 ];\n\n\t\tvar rect = _domElement.getBoundingClientRect();\n\n\t\t_mouse.x = ( ( event.clientX - rect.left ) / rect.width ) * 2 - 1;\n\t\t_mouse.y = - ( ( event.clientY - rect.top ) / rect.height ) * 2 + 1;\n\n\t\t_intersections.length = 0;\n\n\t\t_raycaster.setFromCamera( _mouse, _camera );\n\t\t _raycaster.intersectObjects( _objects, true, _intersections );\n\n\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t_selected = ( scope.transformGroup === true ) ? _objects[ 0 ] : _intersections[ 0 ].object;\n\n\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t_inverseMatrix.getInverse( _selected.parent.matrixWorld );\n\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t}\n\n\n\t}\n\n\tfunction onDocumentTouchEnd( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tif ( _selected ) {\n\n\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t_selected = null;\n\n\t\t}\n\n\t\t_domElement.style.cursor = 'auto';\n\n\t}\n\n\tactivate();\n\n\t// API\n\n\tthis.enabled = true;\n\tthis.transformGroup = false;\n\n\tthis.activate = activate;\n\tthis.deactivate = deactivate;\n\tthis.dispose = dispose;\n\tthis.getObjects = getObjects;\n\n};\n\nDragControls.prototype = Object.create( EventDispatcher.prototype );\nDragControls.prototype.constructor = DragControls;\n\nexport { DragControls };\n"]},"metadata":{},"sourceType":"module"}